// ==UserScript==
// @name				Greek Empire Overview
// @name:el-gr			Ελληνική Επισκόπηση Αυτοκρατορίας
// @author				germano / 1.17 to 1.18 by Ariston / up 1.183 germano/ from 1.183+ improvement by all players
// @description			Script improvement for Ikariam 0.7.x, Overview tables for resources, buildings and military inspired by Ikariam Empire Board
// @description:el-gr	Βελτίωση του κώδικα για το Ikariam 0.7.x, Πίνακες επισκόπησης για πόρους, κτήρια και στρατό εμπνευσμένα από το Ikariam Empire Board
// @icon				https://gf1.geo.gfsrv.net/cdn6f/271aa7178ede3b0ab441cdcf84094d.png
// @namespace			GreekEmpireOverview
// @grant				unsafeWindow
// @grant				GM_getValue
// @grant				GM_setValue
// @grant				GM_deleteValue
// @grant				GM_addStyle
// @grant				GM_registerMenuCommand
// @grant				GM_xmlhttpRequest
// @grant				GM_openInTab
//
// @exclude				http://board.*.ikariam.gameforge.com*
// @exclude				http://*.ikariam.gameforge.*/board
// @include				/https?:\/\/s[0-9]*-[a-z]{2}\.ikariam\.gameforge\.com\/.*/
//
// @require				https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js
// @require				https://ajax.googleapis.com/ajax/libs/jqueryui/1.9.2/jquery-ui.min.js
// @require				http://malsup.github.com/jquery.form.js
// @require				https://momentjs.com/downloads/moment-with-locales.min.js
// @require				https://momentjs.com/downloads/moment-timezone-with-data.js
// @require				https://cdnjs.cloudflare.com/ajax/libs/anchorme/2.0.0/anchorme.min.js
//
// @license				GPL-3.0-or-later
// @compatible			chrome
//
// @version				1.2
//
// ==/UserScript==
/*************************************************
******************** Includes ********************
*************************************************/
(function($)
{
	var jQuery = $;
	if(typeof unsafeWindow.jQuery === 'undefined')
		return ;
	var isChrome = window.navigator.vendor.match(/Google/) ? true : false;
	if(!isChrome) { this.$ = this.jQuery = jQuery.noConflict(true); }
	$.extend(
	{
		exclusive: function(arr) { return $.grep(arr,function(v,k) { return $.inArray(v,arr)===k;}); },
		mergeValues: function(a,b,c)
		{
			var length = arguments.length;
			if(length==1 || typeof arguments[0]!=="object" || typeof arguments[1]!=="object")
			{
				return arguments[0];
			}
			var args = jQuery.makeArray(arguments);
			var i = 1;
			var target = args[0];
			for(;i<length;i++)
			{
				var copy = args[i];
				for(var name in copy)
				{
					if(!target.hasOwnProperty(name))
					{
						target[name] = copy[name];
						continue;
					}
					if(typeof target[name]=="object" && typeof copy[name]=="object")
					{
						target[name] = jQuery.mergeValues(target[name],copy[name]);
					}
					else if(copy.hasOwnProperty(name) && copy[name]!==undefined)
					{
						target[name] = copy[name];
					}
				}
			}
			return target;
		},
		decodeUrlParam: function(string)
		{
			var str = string.split('?').pop().split('&');
			var obj = {};
			for(var i=0;i<str.length;i++)
			{
				var param = str[i].split('=');
				if(param.length!==2) { continue; }
				obj[param[0]] = decodeURIComponent(param[1].replace(/\+/g,' '));
			}
			return obj;
		}
	});
	var events = (function()
	{
		var _events = {};
		var retEvents = function(id) {
			var callbacks, topic = id && _events[id];
			if(!topic)
			{
				callbacks = $.Callbacks('');
				topic = {pub:callbacks.fire,sub:callbacks.add,unsub: callbacks.remove};
				if(id) { _events[id] = topic; }
			}
			return topic;
		};
		retEvents.scheduleAction = function(callback,time) {return clearTimeout.bind(undefined,setTimeout(callback,time||0));};
		retEvents.scheduleActionAtTime = function(callback,time) {return retEvents.scheduleAction(callback,(time-$.now()>0?time-$.now():0));};
		retEvents.scheduleActionAtInterval = function(callback,time) {return clearInterval.bind(undefined,setInterval(callback,time));};
		return retEvents;
	})();
/************************************************
******************** Globals ********************
************************************************/
	var debug = true;
	var log = false;
	var timing = false;
	if(!unsafeWindow) unsafeWindow = window;
/************************************************
************ Inject button into page ************
************************************************/
	$('.menu_slots > .expandable:last').after('<li class="expandable slot9 empire_Menu"><div class="empire_Menu image" style="background: url(skin/buttons/premiumadvisors_plus.png) 2px +1px / 32px auto"></div><div class="name"><span class="namebox" style="color:#145BAA">The Greek Empire Overview</span></div></li>');
/************************************************
*************** Utility Functions ***************
************************************************/
	var Utils = {
		islandids:{50:{50:1,49:4,48:6,51:9,52:15,54:40,55:43,46:60,45:62,57:103,58:104,42:152,41:153,62:230,61:231,64:437,65:439,35:563,36:564,34:569,67:676,68:677,69:679,70:682,32:859,31:861,30:863,72:1003,73:1004,74:1007,75:1008,25:1193,24:1195,22:1663,21:1665,20:1668,19:1670,80:1878,81:1880,16:2126,17:2127,84:2373,85:2376,14:2706,13:2708,87:3052,88:3053,10:3451,9:3453,11:3454,96:3770,97:3772,98:3774,99:3776,6:4099,7:4101,3:4719,4:4725,2:4733},51:{50:2,49:5,54:41,55:42,57:105,58:106,59:109,43:150,42:151,41:154,38:332,39:333,64:440,65:441,35:561,36:562,73:1005,72:1006,74:1009,75:1010,28:1173,27:1175,77:1443,78:1445,20:1667,19:1669,81:1881,82:1882,16:2125,17:2128,84:2374,85:2375,90:2383,91:2385,93:3064,94:3066,10:3450,9:3452,96:3771,97:3773,98:3775,99:3777,100:3778,6:4098,7:4100},49:{48:7,51:11,52:13,49:16,46:61,45:63,44:68,57:101,58:102,60:227,61:228,62:229,39:335,38:337,64:436,65:438,36:565,35:566,34:570,67:675,68:678,69:680,70:681,32:858,31:860,30:862,29:866,73:1000,74:1002,27:1185,26:1187,25:1194,24:1196,78:1441,77:1442,22:1664,21:1666,80:1877,81:1879,83:2367,84:2369,14:2707,13:2709,87:3050,88:3051,89:3054,91:3057,92:3059,93:3061,94:3063,11:3455,10:3456,7:4106,6:4108,3:4723,4:4724,2:4732},47:{50:17,49:18,48:24,52:31,53:32,54:36,55:37,46:66,45:67,57:99,58:100,42:157,41:158,60:222,61:223,39:339,38:341,63:434,64:435,33:571,32:572,66:671,67:672,68:673,71:685,70:686,30:867,29:868,26:1189,27:1190,76:1436,77:1438,22:1671,23:1672,24:1675,80:1873,81:1874,17:2131,16:2132,19:2135,18:2136,20:2137,84:2370,85:2371,13:2712,14:2713,87:3046,88:3047,11:3459,10:3460,9:3463,96:3760,97:3762,98:3764,4:4727,3:4728},46:{49:19,50:20,48:25,52:30,53:33,57:97,58:98,42:159,43:160,41:165,60:221,61:224,39:340,38:342,37:343,36:345,63:432,64:433,32:573,33:574,34:575,66:669,67:670,68:674,70:687,71:688,73:996,74:998,26:1191,27:1192,76:1433,77:1435,23:1673,22:1674,24:1676,79:1868,80:1870,81:1872,82:1876,20:2138,19:2139,88:3045,90:3041,91:3042,87:3044,11:3461,10:3462,7:3473,6:3474,93:3755,94:3757,97:3766,98:3767,3:4730,4:4731},45:{50:26,49:28,52:34,53:35,46:70,45:71,55:93,56:94,57:96,43:161,42:162,37:344,36:346,63:430,64:431,34:576,33:577,66:667,67:668,30:869,29:870,73:995,74:997,76:1432,77:1434,24:1677,23:1678,79:1867,80:1869,81:1871,82:1875,84:2364,85:2365,16:2714,17:2715,14:2725,13:2727,90:3039,91:3043,8:3469,7:3470,6:3475,93:3754,94:3756,95:3759,97:3768,98:3769},44:{50:27,49:29,45:72,46:73,47:74,55:92,56:95,43:163,42:164,59:218,60:219,39:347,40:348,62:427,63:429,33:578,34:579,29:871,30:872,31:873,70:984,71:986,69:990,73:992,74:994,26:1197,27:1198,23:1679,24:1680,21:2140,20:2141,84:2362,85:2363,16:2716,17:2717,18:2718,14:2726,13:2728,12:2732,11:2733,87:3009,88:3011,89:3013,90:3038,9:3465,8:3467,7:3471,93:3751,94:3753,95:3758,4:4120,3:4121},48:{55:38,54:39,46:64,45:65,44:69,42:155,41:156,60:225,61:226,39:336,38:338,36:567,35:568,70:683,71:684,30:864,29:865,73:999,74:1001,27:1186,26:1188,76:1437,77:1439,78:1440,16:2129,17:2130,18:2133,19:2134,83:2366,84:2368,85:2372,14:2710,13:2711,87:3048,88:3049,89:3055,91:3056,92:3058,93:3060,94:3062,11:3457,10:3458,9:3464,96:3761,97:3763,98:3765,7:4107,6:4109,4:4726,3:4729},52:{54:44,53:45,52:48,47:57,46:58,57:107,58:108,59:110,44:144,43:145,61:232,62:233,39:330,38:331,64:442,65:443,36:559,35:560,67:691,68:693,69:695,70:697,33:851,32:853,31:855,30:857,28:1174,27:1176,26:1181,25:1183,77:1444,78:1446,79:1451,23:1652,22:1654,81:1883,82:1884,17:2121,16:2124,87:2377,88:2379,89:2381,90:2384,91:2386,14:2694,13:2695,12:2705,93:3065,94:3067,100:3779,99:3780,6:4095,5:4097,3:4709,2:4710},53:{53:46,54:47,52:49,50:50,49:52,48:54,47:56,46:59,56:111,57:112,44:143,43:146,42:149,61:234,62:235,40:327,39:329,38:334,65:444,64:445,67:692,68:694,69:696,70:698,71:701,33:850,32:852,31:854,30:856,73:1011,74:1013,75:1021,28:1177,27:1179,26:1182,25:1184,77:1447,78:1449,79:1452,23:1653,22:1655,21:1656,81:1885,82:1886,84:1887,85:1889,19:2117,18:2119,17:2122,16:2123,87:2378,88:2380,89:2382,14:2693,13:2696,12:2699,93:3068,94:3070,10:3441,9:3443,8:3445,96:3783,97:3785,6:4094,5:4096,3:4711,2:4712,1:4717},54:{50:51,49:53,48:55,57:113,56:114,43:147,42:148,61:243,60:244,59:247,40:326,39:328,36:552,35:553,70:699,71:700,73:1012,74:1014,75:1022,28:1178,27:1180,77:1448,78:1450,21:1657,22:1658,84:1888,85:1890,19:2118,18:2120,13:2697,12:2698,93:3069,94:3071,92:3072,91:3073,10:3440,9:3442,8:3444,96:3784,97:3786,98:3787,99:3789,100:3791,2:4713,1:4714},43:{47:75,46:76,52:85,53:87,58:215,59:216,60:220,40:349,39:350,62:426,63:428,36:580,37:581,65:665,66:666,31:874,30:875,68:981,69:982,70:983,71:985,73:991,74:993,27:1199,26:1200,76:1427,77:1429,78:1431,80:1863,81:1864,82:1866,21:2142,20:2143,84:2360,85:2361,18:2719,17:2720,14:2729,13:2730,12:2731,11:2734,87:3008,88:3010,89:3012,90:3034,91:3037,9:3466,8:3468,7:3476,93:3750,94:3752,5:4110,4:4112,3:4122,97:4417,98:4418},42:{47:77,48:78,50:81,51:83,52:86,53:88,54:89,44:166,43:167,42:173,56:208,57:209,58:214,59:217,40:351,39:354,37:582,36:583,35:586,34:589,66:663,65:664,30:876,31:877,32:878,68:978,69:980,70:987,27:1201,28:1202,76:1426,77:1428,78:1430,24:1681,23:1682,80:1861,81:1862,82:1865,21:2144,20:2145,84:2358,85:2359,17:2721,16:2724,90:3035,91:3036,5:4111,4:4113,96:4410,97:4412,98:4414,99:4416},41:{48:79,47:80,50:82,51:84,54:90,53:91,43:168,44:169,45:170,42:174,56:207,57:210,58:211,40:352,39:353,62:424,61:425,36:584,37:585,35:587,34:588,64:658,65:660,66:661,32:879,31:880,68:977,69:979,28:1203,27:1204,72:1413,73:1415,74:1417,76:1423,77:1425,23:1683,24:1684,25:1685,80:1859,81:1860,21:2146,20:2147,19:2151,17:2722,16:2723,13:2737,14:2738,87:3004,88:3005,11:3477,10:3479,9:3483,8:3485,7:3487,93:3748,94:3749,5:4114,4:4115,96:4409,97:4411,98:4413,99:4415,2:4736,1:4739},55:{54:115,53:117,52:119,46:135,45:136,63:263,60:246,59:248,64:265,66:446,67:447,68:457,37:549,36:550,35:554,34:555,33:558,31:840,30:842,73:1015,74:1017,80:1453,81:1455,82:1461,24:1647,25:1648,21:1659,22:1660,85:1891,86:1893,88:2387,89:2388,16:2686,15:2688,91:3074,92:3075,8:3446,7:3449,98:3788,99:3790,100:3792,97:3793,5:4707,4:4708,2:4715,1:4716},56:{54:116,53:118,52:120,51:121,55:124,49:127,48:128,47:131,46:134,45:137,44:139,43:142,59:249,58:250,57:253,63:264,64:266,62:267,41:323,40:325,66:448,67:449,68:456,38:545,37:548,36:551,34:556,33:557,70:702,71:703,31:841,30:843,73:1016,74:1018,76:1023,77:1025,80:1454,81:1456,79:1457,82:1460,83:1462,27:1640,28:1641,26:1646,25:1649,24:1650,21:1661,22:1662,85:1892,86:1894,19:2114,18:2116,88:2389,89:2390,16:2685,15:2687,14:2690,13:2692,11:3438,91:3076,92:3077,94:3086,95:3087,10:3439,8:3447,7:3448,97:3794,98:3795,4:4705,5:4706},57:{51:122,52:123,55:125,54:126,49:129,48:130,47:132,46:133,44:140,43:141,59:262,58:252,57:254,62:268,63:269,61:270,41:322,40:324,66:450,67:451,38:546,37:547,70:704,71:705,31:844,30:846,73:1019,74:1020,76:1024,77:1026,79:1458,80:1459,83:1463,82:1464,27:1642,28:1643,26:1651,85:1895,86:1897,19:2113,18:2115,88:2391,89:2392,16:2682,15:2684,14:2689,13:2691,10:3436,11:3437,94:3083,95:3084,4:4703,3:4704},40:{45:171,44:172,58:212,57:213,60:421,61:422,62:423,64:657,65:659,28:1205,29:1206,27:1209,73:1414,72:1412,71:1411,74:1416,76:1422,77:1424,25:1686,24:1687,23:1688,79:1854,80:1856,81:1858,21:2148,20:2149,19:2150,83:2353,84:2354,85:2355,14:2739,13:2740,87:3001,88:3003,89:3007,11:3478,10:3480,9:3484,8:3486,7:3488,91:3737,92:3739,93:3741,94:3743,4:4116,5:4117,2:4738,1:4740},39:{47:175,48:176,49:179,50:180,51:184,52:186,54:187,55:190,40:355,41:356,42:359,60:420,38:590,37:591,35:601,34:602,32:881,31:882,67:974,68:975,29:1207,28:1208,70:1408,71:1410,76:1419,77:1421,79:1853,80:1855,81:1857,83:2350,84:2352,85:2356,14:2741,13:2743,16:2745,17:2746,87:3000,88:3002,89:3006,11:3481,10:3482,91:3736,92:3738,93:3740,94:3742,95:3744,96:3747,4:4118,5:4119,98:4419,99:4420,2:4741,1:4743},38:{47:177,48:178,49:181,50:182,51:183,52:185,54:188,55:189,56:203,57:206,41:357,40:358,42:360,44:368,45:369,59:417,60:419,38:592,37:593,36:598,35:600,34:603,62:640,63:642,64:643,65:649,32:883,31:884,67:973,68:976,74:1406,70:1407,71:1409,73:1404,76:1418,77:1420,26:1689,25:1691,24:1693,23:1695,20:2152,21:2153,83:2349,84:2351,14:2742,13:2744,16:2747,17:2748,18:2749,8:3489,7:3490,95:3745,96:3746,98:4421,99:4422,2:4742,1:4744},37:{56:204,57:205,42:361,41:362,45:370,44:371,59:416,60:418,38:594,37:595,62:639,63:641,64:647,65:648,32:885,31:886,67:971,68:972,28:1210,29:1211,74:1405,73:1403,26:1690,25:1692,24:1694,23:1696,79:1847,80:1849,81:1852,20:2154,21:2155,18:2750,17:2751,11:2765,10:2767,86:2991,87:2993,88:2995,89:2997,90:2999,8:3491,7:3492,93:3732,92:3734,5:4123,4:4124,99:4423,100:4424,2:4745,1:4746},58:{61:271,62:272,63:273,41:319,40:321,66:452,65:453,70:706,69:710,35:830,34:832,33:838,31:845,30:847,76:1027,77:1029,27:1644,28:1645,85:1896,86:1898,24:2102,23:2103,22:2106,21:2107,19:2110,18:2112,88:2393,89:2394,90:2395,16:2681,15:2683,92:3078,93:3080,94:3082,95:3085,9:3434,10:3435,97:3803,98:3804,6:4092,7:4093,4:4701,3:4702},59:{59:274,58:275,56:282,55:285,53:293,52:295,51:302,50:303,48:305,47:307,46:309,45:311,43:313,42:315,41:318,40:320,65:454,66:455,38:540,37:544,72:719,70:708,69:711,68:712,73:721,35:831,34:833,33:839,31:848,30:849,76:1028,77:1030,75:1031,79:1465,80:1466,82:1477,83:1478,25:2098,24:2101,23:2104,22:2105,21:2108,19:2109,18:2111,90:2396,89:2397,12:2679,13:2680,92:3079,93:3081,9:3432,10:3433,97:3802,98:3805,7:4090,6:4091,4:4699,3:4700},60:{58:276,59:277,60:278,56:283,55:286,53:294,52:296,51:301,50:304,48:306,47:308,46:310,45:312,43:314,42:316,62:458,63:459,37:538,38:539,72:720,68:713,69:714,73:722,34:834,35:836,75:1032,76:1033,79:1467,80:1468,82:1479,83:1480,84:1483,27:1638,28:1639,86:1900,87:1902,25:2099,24:2100,16:2671,15:2673,14:2675,13:2677,12:2678,95:3796,96:3798,97:3800,7:4088,6:4089},61:{59:279,60:280,58:281,55:287,56:288,52:297,51:298,62:460,63:461,64:462,65:465,40:532,39:535,38:536,37:537,67:715,68:716,71:723,72:724,34:835,35:837,32:1171,31:1172,78:1469,79:1470,80:1476,82:1481,83:1482,84:1484,28:1635,29:1636,27:1637,87:1899,86:1901,89:2398,90:2399,19:2660,18:2661,22:2667,21:2669,16:2670,15:2672,14:2674,13:2676,92:3088,93:3090,10:3426,9:3427,95:3797,96:3799,97:3801,99:3806,100:3808,7:4086,6:4087,4:4690,3:4691},62:{54:289,55:290,51:299,52:300,64:463,63:464,65:466,49:498,48:500,47:502,45:506,44:508,43:510,42:512,40:533,39:534,67:717,68:718,72:725,71:726,70:727,74:1034,75:1035,32:1169,31:1170,78:1471,79:1472,77:1473,28:1633,29:1634,86:1903,87:1904,25:2090,24:2091,89:2400,90:2401,19:2658,18:2659,22:2666,21:2668,92:3089,93:3091,11:3423,10:3425,9:3428,99:3807,100:3809,7:4084,6:4085,4:4688,3:4689},63:{55:291,54:292,61:467,60:468,59:471,58:472,57:475,49:499,48:501,47:503,45:507,44:509,43:511,42:513,70:728,71:729,72:730,37:818,36:820,74:1036,75:1037,34:1161,33:1163,32:1165,31:1167,77:1474,78:1475,81:1485,82:1486,28:1631,29:1632,86:1905,85:1907,84:1909,26:2087,25:2089,24:2092,89:2402,90:2403,19:2656,18:2657,22:2662,21:2665,92:3092,93:3093,94:3094,95:3096,96:3098,16:3410,15:3412,14:3414,13:3416,11:3422,10:3424,9:3429,99:3810,98:3812,4:4686,3:4687,2:4696},36:{41:363,42:364,40:365,44:372,45:373,46:374,47:377,49:378,50:379,51:382,53:386,54:387,38:596,37:597,63:650,64:654,33:887,32:888,34:891,35:893,67:968,68:969,29:1212,28:1213,70:1336,71:1338,72:1400,73:1402,76:1836,77:1837,79:1844,80:1846,81:1851,20:2156,21:2157,83:2346,84:2348,18:2752,17:2754,15:2756,14:2758,13:2760,12:2762,11:2764,10:2766,86:2990,87:2992,88:2994,89:2996,90:2998,8:3493,7:3494,93:3731,92:3733,94:3735,5:4125,4:4126,96:4400,97:4401,99:4425,100:4426},35:{40:366,41:367,46:375,47:376,49:380,50:381,51:383,53:388,54:389,55:390,56:391,58:398,59:400,60:413,61:414,37:604,38:605,63:652,64:653,33:889,32:890,34:892,35:894,66:965,67:966,68:970,30:1214,29:1215,70:1335,71:1337,72:1399,73:1401,26:1697,25:1698,75:1833,76:1834,77:1838,79:1843,80:1845,20:2158,21:2159,22:2160,23:2161,83:2345,84:2347,18:2753,17:2755,15:2757,14:2759,13:2761,12:2763,8:3495,7:3496,93:3728,94:3730,4:4127,5:4128,3:4129,2:4132,96:4402,97:4403},34:{51:384,50:385,56:392,55:393,54:394,53:395,58:399,59:401,60:412,61:415,43:617,44:619,63:655,64:656,66:964,67:967,29:1216,30:1217,25:1699,26:1700,27:1701,75:1832,76:1835,23:2162,22:2163,82:2342,83:2344,12:2768,13:2769,86:2983,87:2985,8:3497,9:3498,10:3499,91:3720,90:3722,89:3724,93:3727,94:3729,3:4130,2:4131,96:4404,97:4405,98:4406},33:{56:396,55:397,38:606,39:607,40:610,41:615,43:618,44:620,45:625,47:627,48:628,36:895,35:896,32:1218,33:1219,69:1332,70:1333,27:1702,26:1703,72:1818,73:1819,76:1839,77:1842,20:2173,19:2175,79:2338,80:2339,82:2341,83:2343,15:2770,16:2771,17:2774,85:2975,86:2977,87:2984,10:3500,9:3501,91:3719,90:3721,89:3723,6:4133,5:4134,97:4407,98:4408},64:{60:469,61:470,58:473,59:474,57:476,52:486,51:487,49:504,48:505,41:514,42:515,43:518,67:731,68:732,66:735,63:740,64:741,39:814,38:816,37:819,36:821,74:1038,75:1039,34:1162,33:1164,32:1166,31:1168,81:1487,82:1488,80:1489,86:1906,85:1908,84:1910,26:2086,25:2088,88:2404,89:2405,19:2654,18:2655,22:2663,21:2664,94:3095,95:3097,96:3099,16:3411,15:3413,14:3415,13:3417,9:3430,10:3431,99:3811,98:3813,7:4077,6:4079,4:4684,3:4685,2:4692,1:4693},65:{55:477,54:478,51:488,52:489,42:516,41:517,45:519,46:520,68:733,67:734,66:736,69:737,64:742,63:743,39:815,38:817,74:1040,75:1041,76:1042,71:1045,72:1046,80:1490,81:1491,79:1492,78:1495,28:1629,29:1630,26:2083,25:2085,24:2097,88:2406,89:2407,19:2652,18:2653,92:3100,91:3101,13:3418,12:3421,7:4076,6:4078,2:4694,1:4695},66:{54:479,55:480,56:481,57:484,52:490,51:492,46:521,45:522,44:523,47:526,48:527,49:528,69:738,68:739,63:744,62:746,60:752,59:753,37:822,38:823,39:826,75:1043,76:1044,71:1047,72:1048,35:1153,34:1155,33:1157,32:1159,79:1493,80:1494,78:1496,81:1497,30:1626,29:1627,28:1628,83:1911,84:1912,26:2082,25:2084,24:2093,23:2096,88:2408,87:2409,86:2412,21:2647,20:2649,19:2651,92:3102,91:3103,94:3120,95:3122,16:3406,15:3407,13:3419,12:3420,97:3814,98:3815,10:4057,9:4058,7:4073,6:4075,5:4081,4:4083},67:{55:482,56:483,57:485,52:491,51:493,44:524,45:525,49:529,48:530,47:531,63:745,62:747,66:1055,65:1054,60:754,59:755,42:801,41:803,38:824,37:825,39:827,72:1049,73:1050,35:1154,34:1156,33:1158,32:1160,30:1624,29:1625,83:1913,84:1914,24:2094,23:2095,88:2410,87:2411,86:2413,21:2646,20:2648,19:2650,91:3110,90:3111,94:3121,95:3123,17:3397,16:3399,15:3401,97:3816,98:3817,10:4056,9:4059,7:4072,6:4074,5:4080,4:4082,1:5141,2:5142},68:{53:494,52:497,60:756,59:757,42:802,41:804,39:828,38:829,72:1051,73:1052,65:1056,66:1057,68:1064,69:1065,70:1068,79:1498,78:1500,77:1502,76:1504,75:1506,30:1622,29:1623,83:1915,82:1916,81:1919,27:2074,26:2076,90:3112,91:3113,94:3124,93:3125,17:3396,16:3398,15:3400,14:3402,13:3405,97:3818,11:4054,10:4055,1:5139,2:5140},69:{53:495,52:496,59:758,60:759,61:760,57:763,56:766,55:767,50:781,49:783,47:789,46:791,45:793,44:795,41:807,42:809,64:1058,65:1059,63:1062,68:1066,69:1067,70:1069,36:1145,35:1148,79:1499,78:1501,77:1503,76:1505,75:1507,33:1610,32:1612,30:1620,29:1621,83:1917,82:1918,81:1920,27:2075,26:2077,25:2078,24:2080,85:2414,86:2415,22:2637,21:2639,20:2644,19:2645,90:3114,89:3115,88:3116,93:3126,94:3127,14:3403,13:3404,97:3819,96:3820,11:4051,10:4053,8:4070,7:4071,99:4427,100:4428,5:4669,4:4671,1:5137,2:5138},32:{38:608,39:609,40:614,41:616,43:621,44:624,45:626,47:629,48:630,49:631,36:897,35:898,53:935,51:931,52:933,58:945,59:946,60:948,62:952,63:954,64:956,65:958,33:1220,32:1221,31:1226,30:1228,29:1230,67:1328,68:1329,69:1331,70:1334,26:1704,27:1705,72:1820,73:1821,74:1822,76:1840,77:1841,24:2164,23:2166,22:2168,21:2170,20:2172,19:2174,79:2336,80:2337,15:2772,16:2773,17:2775,85:2976,86:2978,12:3502,13:3503,90:3716,91:3718,92:3726,6:4135,5:4136,7:4137,94:4390,95:4391,3:4751,2:4756},31:{43:622,44:623,49:632,48:633,47:634,36:899,35:900,52:934,53:936,51:932,54:939,56:941,57:943,58:944,59:947,60:949,62:953,63:955,64:957,65:959,33:1222,32:1225,31:1227,30:1229,29:1231,67:1327,68:1330,27:1706,26:1707,74:1823,73:1824,24:2165,23:2167,22:2169,21:2171,79:2334,80:2335,16:2776,15:2777,82:2973,83:2974,85:2979,86:2981,87:2986,88:2988,12:3504,13:3505,11:3508,90:3715,91:3717,92:3725,7:4138,6:4139,8:4140,9:4141,5:4144,94:4387,95:4389,96:4392,97:4394,3:4752,2:4755,100:4966,99:4967},30:{46:635,47:636,36:901,35:902,38:903,37:904,41:907,40:908,53:937,54:938,56:940,57:942,60:950,59:951,62:960,63:962,33:1223,32:1224,70:1814,71:1815,74:1825,75:1826,73:2294,77:2329,78:2331,79:2333,80:2340,15:2778,16:2779,18:2780,19:2781,82:2971,83:2972,85:2980,86:2982,87:2987,88:2989,12:3506,13:3507,11:3509,9:4142,8:4143,96:4393,97:4395,3:4757,2:4759,99:4964,100:4965},29:{47:637,46:638,38:905,37:906,41:909,40:910,42:911,43:919,44:921,62:961,63:963,49:1278,50:1279,51:1281,65:1321,66:1322,30:1708,29:1709,28:1712,27:1713,26:1716,68:1806,69:1807,70:1816,71:1817,74:1827,75:1828,73:1829,24:2176,23:2178,77:2328,78:2330,79:2332,18:2782,19:2783,20:2784,21:2785,82:2968,83:2969,90:3713,91:3714,93:4375,94:4377,96:4396,97:4398,3:4758,2:4760,1:4761,5:4764,6:4765,100:4962,99:4963},70:{61:761,60:762,57:764,56:765,55:768,50:782,49:784,47:790,46:792,45:794,44:796,41:808,42:810,40:812,64:1060,65:1061,63:1063,67:1070,68:1071,38:1141,37:1144,36:1146,35:1147,73:1508,72:1509,33:1611,32:1613,25:2079,24:2081,85:2416,86:2417,22:2636,21:2638,20:2640,19:2642,89:3117,88:3118,90:3119,93:3128,92:3129,94:3132,17:3387,16:3389,97:3821,96:3822,11:4050,10:4052,8:4068,7:4069,99:4429,100:4430,5:4670,4:4672,1:5135,2:5136},71:{57:769,58:771,53:773,52:776,50:785,49:786,47:799,46:800,41:811,40:813,67:1072,68:1073,38:1142,37:1143,72:1510,73:1511,71:1512,70:1513,74:1516,32:1614,31:1616,30:1618,82:1921,81:1922,80:1925,79:1926,76:1933,77:1934,28:2060,27:2068,85:2418,84:2419,20:2641,19:2643,92:3130,93:3131,94:3133,17:3386,16:3388,15:3390,14:3392,12:4046,11:4048,8:4066,7:4067,99:4431,100:4432,5:4673,4:4675,1:5133,2:5134},72:{57:770,58:772,53:774,52:775,55:777,54:780,50:787,49:788,64:1074,65:1075,62:1083,61:1086,60:1088,44:1130,43:1131,37:1149,38:1150,70:1514,71:1515,73:1517,74:1518,35:1600,34:1602,32:1615,31:1617,30:1619,82:1923,81:1924,80:1927,79:1928,76:1935,77:1936,28:2061,27:2069,84:2420,85:2421,86:2422,87:2423,25:2625,24:2627,23:2629,22:2631,89:3134,90:3135,15:3391,14:3393,96:3823,97:3825,12:4047,11:4049,9:4062,8:4064,99:4433,100:4434,5:4674,4:4676},73:{55:778,54:779,64:1076,65:1077,66:1079,67:1081,62:1084,61:1085,60:1087,47:1123,46:1124,45:1126,44:1128,43:1132,41:1133,40:1135,37:1151,38:1152,70:1521,69:1522,35:1601,34:1603,79:1929,80:1930,76:1937,77:1938,28:2070,27:2072,87:2424,86:2425,25:2624,24:2626,23:2628,22:2630,21:2632,20:2634,89:3136,90:3137,91:3140,92:3141,18:3374,17:3376,15:3394,14:3395,96:3824,97:3826,95:3827,94:3829,12:4060,11:4061,9:4063,8:4065,99:4435,100:4436,5:4678,6:4680,4:4682,1:5131,2:5132},28:{42:912,41:913,43:920,44:922,32:1232,33:1233,34:1236,35:1237,49:1277,50:1280,51:1282,53:1294,54:1295,56:1300,57:1301,58:1304,59:1307,60:1308,65:1320,66:1323,30:1710,29:1711,28:1714,27:1715,26:1717,68:1808,69:1809,24:2177,23:2179,20:2786,21:2787,19:2788,81:2965,82:2967,16:3510,15:3511,85:3697,86:3698,88:3705,89:3707,90:3709,91:3711,13:4145,12:4147,11:4152,10:4153,9:4154,8:4155,93:4376,94:4378,96:4397,97:4399,1:4762,2:4763,5:4766,6:4767,99:4960,100:4961},74:{65:1078,66:1080,67:1082,61:1089,62:1090,58:1095,57:1096,52:1112,51:1115,50:1117,48:1119,47:1121,46:1125,45:1127,44:1129,41:1134,40:1136,70:1523,69:1524,35:1604,34:1606,33:1608,79:1931,80:1932,76:1939,77:1940,75:1941,72:1944,73:1945,30:2056,31:2058,28:2071,27:2073,83:2426,84:2427,82:2430,21:2633,20:2635,90:3138,91:3139,92:3142,18:3375,17:3377,95:3828,94:3830,5:4679,6:4681,4:4683,1:5128,2:5129},75:{62:1091,63:1092,57:1097,58:1098,59:1099,55:1106,54:1108,53:1110,52:1113,51:1114,50:1118,48:1120,47:1122,42:1137,41:1139,38:1593,37:1594,35:1605,34:1607,33:1609,75:1942,76:1943,72:1946,73:1947,31:2053,30:2055,83:2428,84:2429,82:2431,85:2432,25:2619,24:2621,23:2623,88:3143,87:3144,18:3378,17:3380,16:3383,15:3385,13:4038,12:4040,97:4449,98:4450,10:4661,9:4662,8:4663,1:5127,2:5130},76:{63:1093,62:1094,59:1100,58:1101,60:1102,57:1105,55:1107,54:1109,53:1111,52:1116,42:1138,41:1140,70:1525,69:1526,68:1529,66:1533,65:1534,44:1578,45:1579,39:1589,38:1591,37:1595,72:1948,73:1949,31:2054,30:2057,85:2433,84:2434,80:2435,79:2436,78:2439,28:2613,27:2615,26:2617,25:2618,24:2620,23:2622,88:3145,87:3146,21:3361,20:3363,18:3379,17:3381,16:3382,15:3384,90:3831,91:3833,92:3835,93:3837,94:3839,95:3841,13:4039,12:4041,97:4451,98:4452,8:4664,9:4665,10:4666,5:5118,6:5119,3:5121,2:5122,1:5126},77:{60:1103,59:1104,69:1527,70:1528,68:1530,66:1535,65:1536,50:1571,49:1572,48:1574,47:1576,45:1580,44:1581,39:1590,38:1592,72:1950,73:1951,74:1952,75:1955,35:2046,34:2047,32:2049,31:2051,30:2059,80:2437,79:2438,78:2440,77:2441,81:2446,82:2447,28:2612,27:2614,26:2616,88:3147,87:3148,21:3362,20:3364,90:3832,91:3834,92:3836,93:3838,94:3840,95:3842,12:4042,13:4044,97:4453,98:4454,10:4667,9:4668,5:5117,6:5120,2:5123,3:5124,1:5125},27:{32:1234,33:1235,34:1238,35:1239,36:1242,38:1247,39:1248,46:1268,47:1270,49:1283,50:1284,53:1293,54:1296,56:1302,57:1303,59:1305,58:1306,60:1309,62:1312,63:1313,64:1316,65:1317,26:1718,27:1719,68:1810,69:1811,24:2180,23:2182,71:2311,72:2312,73:2315,74:2316,76:2320,77:2322,78:2324,79:2326,81:2964,82:2966,16:3512,15:3513,17:3514,84:3695,85:3696,86:3699,88:3706,89:3708,90:3710,91:3712,13:4148,12:4149,11:4150,10:4151,9:4156,8:4157,94:4379,93:4381,5:4768,6:4771,4:4772},26:{35:1240,36:1241,32:1243,33:1246,39:1249,38:1250,41:1255,42:1256,43:1259,44:1260,46:1269,47:1271,52:1290,53:1291,54:1297,59:1310,60:1311,62:1314,63:1315,64:1318,65:1319,66:1326,29:1720,30:1721,68:1812,69:1813,24:2181,23:2183,71:2310,72:2313,73:2314,74:2317,76:2321,77:2323,78:2325,79:2327,20:2789,21:2790,81:2961,82:2963,17:3515,16:3516,18:3517,84:3692,85:3694,86:3704,94:4380,93:4382,5:4769,6:4770,4:4773,96:4949,97:4951,98:4953,99:4955,100:4957,2:5143,1:5144},25:{38:1251,39:1252,41:1257,42:1258,43:1261,44:1262,46:1272,47:1273,48:1276,50:1286,51:1287,52:1289,53:1292,54:1298,65:1324,66:1325,29:1722,30:1723,56:1788,57:1789,26:2184,27:2185,73:2318,74:2319,20:2791,21:2792,81:2960,82:2962,18:3518,17:3519,16:3520,84:3691,85:3693,14:4158,13:4159,88:4365,89:4366,90:4373,91:4374,93:4383,94:4385,8:4774,9:4776,10:4778,11:4781,96:4948,97:4950,98:4952,99:4954,100:4956,2:5145,1:5146},24:{38:1253,39:1254,42:1263,41:1266,47:1274,48:1275,50:1285,51:1288,30:1724,31:1725,33:1728,34:1729,35:1732,36:1733,56:1787,57:1790,58:1791,60:1798,61:1799,62:1802,63:1803,69:2296,68:2295,26:2186,27:2187,24:2193,25:2194,70:2303,71:2304,21:2793,22:2794,77:2951,78:2953,79:2955,85:3700,86:3703,13:4160,14:4161,88:4367,89:4368,90:4371,91:4372,93:4384,94:4386,8:4775,9:4777,10:4779,11:4780,7:4782,99:4958,100:4959,2:5147,3:5148,4:5151,5:5152},23:{41:1264,42:1265,30:1726,31:1727,33:1730,34:1731,35:1734,36:1735,44:1753,45:1757,53:1777,54:1779,58:1792,57:1793,60:1800,61:1801,62:1804,63:1805,27:2188,28:2189,25:2192,24:2195,65:2292,66:2293,68:2297,69:2298,70:2305,71:2306,72:2309,21:2795,22:2796,20:2797,74:2939,75:2941,77:2952,78:2954,79:2956,80:2959,18:3521,17:3523,82:3681,83:3682,85:3701,86:3702,14:4162,15:4163,88:4369,89:4370,7:4783,8:4784,97:4946,96:4947,3:5149,4:5150,5:5153},78:{68:1531,69:1532,65:1537,64:1538,66:1541,63:1543,62:1544,57:1555,56:1556,54:1563,53:1565,51:1567,50:1569,49:1573,48:1575,47:1577,44:1582,45:1583,43:1585,42:1588,40:1596,39:1598,74:1953,75:1954,36:2043,35:2044,34:2048,32:2050,31:2052,77:2442,78:2443,80:2444,81:2445,82:2448,88:3149,87:3150,85:3151,84:3152,24:3347,23:3348,21:3365,20:3367,18:4026,17:4028,16:4034,15:4036,12:4043,13:4045,97:4455,98:4456,7:5112,6:5114,5:5116},79:{64:1539,65:1540,66:1542,62:1545,63:1546,60:1547,59:1549,57:1557,56:1558,55:1561,54:1564,53:1566,51:1568,50:1570,44:1584,43:1586,42:1587,40:1597,39:1599,71:1956,72:1957,37:2041,36:2042,35:2045,29:2608,28:2609,85:3153,84:3154,26:3342,25:3344,24:3346,23:3349,21:3366,20:3368,90:3843,91:3845,18:4027,17:4029,16:4035,15:4037,93:4437,94:4439,97:4457,96:4458,10:5099,9:5100,7:5111,6:5113,5:5115,2:5398,3:5399},80:{60:1548,59:1550,57:1559,56:1560,55:1562,71:1958,72:1959,69:1960,70:1961,68:1964,48:2012,47:2014,46:2016,37:2038,36:2039,74:2483,75:2484,33:2600,32:2601,30:2604,29:2605,28:2610,85:3155,84:3156,86:3159,87:3160,82:3167,81:3168,77:3176,78:3178,79:3180,26:3343,25:3345,20:3369,90:3844,91:3846,89:3847,17:4030,16:4032,93:4438,94:4440,97:4459,96:4460,99:4461,100:4462,13:4657,12:4658,10:5101,9:5102,3:5396,2:5397},81:{59:1551,60:1553,69:1962,70:1963,68:1965,65:1968,66:1969,63:1979,62:1980,53:1999,52:2000,50:2007,49:2009,48:2013,47:2015,46:2017,44:2020,43:2022,42:2028,41:2030,40:2032,38:2034,37:2036,36:2040,75:2485,74:2482,34:2598,33:2599,32:2602,30:2606,29:2607,28:2611,85:3157,84:3158,86:3161,87:3162,82:3169,81:3170,77:3177,78:3179,79:3181,23:3357,22:3358,20:3370,19:3371,89:3848,90:3849,91:3850,17:4031,16:4033,93:4441,94:4443,99:4463,100:4464,14:4649,13:4650,12:4659,10:5103,9:5104,8:5108,7:5110,5:5391,4:5393,3:5395},82:{59:1552,60:1554,68:1966,69:1967,65:1970,66:1971,63:1981,62:1982,57:1987,56:1989,53:2001,52:2002,54:2003,50:2008,49:2010,46:2018,47:2019,44:2021,43:2023,42:2029,41:2031,40:2033,38:2035,37:2037,74:2481,73:2458,72:2461,34:2595,33:2596,82:3171,79:3182,26:3350,25:3352,24:3354,23:3356,22:3359,19:3372,20:3373,93:4442,94:4444,99:4465,98:4466,97:4471,96:4472,100:4474,14:4651,13:4652,12:4660,10:5105,9:5106,8:5107,7:5109,5:5392,4:5394},22:{34:1736,35:1737,38:1740,39:1741,44:1754,45:1755,46:1762,47:1763,49:1766,50:1767,51:1770,53:1776,54:1778,55:1782,58:1794,57:1795,27:2190,28:2191,65:2290,66:2291,68:2299,69:2300,71:2307,72:2308,20:2798,21:2799,74:2940,75:2942,79:2957,80:2958,18:3522,17:3524,82:3683,83:3684,15:4164,14:4165,10:4785,11:4786,12:4789,91:4936,92:4938,94:4939,95:4941,96:4944,97:4945,99:5549,100:5550},21:{34:1738,35:1739,38:1742,39:1743,37:1744,40:1747,41:1750,42:1751,44:1758,45:1759,46:1764,47:1765,49:1768,50:1769,51:1771,54:1780,55:1781,58:1796,57:1797,30:2196,31:2197,32:2200,60:2279,61:2280,63:2282,64:2283,65:2286,66:2287,68:2301,69:2302,23:2800,24:2802,25:2804,74:2943,75:2945,76:2947,77:2949,18:3525,17:3527,82:3685,83:3686,84:3690,86:4363,87:4364,10:4787,11:4788,12:4790,89:4931,90:4933,91:4935,92:4937,94:4940,95:4942,96:4943,8:5154,7:5156,6:5158,5:5160,3:5440,2:5441,99:5547,100:5548},20:{37:1745,38:1746,40:1748,41:1749,42:1752,44:1760,45:1761,51:1772,52:1773,54:1783,55:1784,30:2198,31:2199,32:2201,60:2277,61:2278,63:2284,64:2285,65:2288,66:2289,23:2801,24:2803,25:2805,27:2814,28:2815,71:2931,72:2932,74:2944,75:2946,76:2948,77:2950,18:3526,17:3528,20:3536,21:3537,79:3677,80:3678,82:3687,83:3688,84:3689,15:4166,14:4167,86:4361,87:4362,12:4791,11:4793,89:4932,90:4934,8:5155,7:5157,6:5159,5:5161,3:5438,2:5439,98:5543,99:5545},19:{52:1774,51:1775,54:1785,55:1786,32:2202,33:2203,31:2206,34:2208,35:2209,47:2242,48:2244,49:2246,58:2269,59:2271,60:2275,61:2276,24:2813,25:2812,27:2816,28:2817,68:2925,69:2927,71:2933,72:2934,21:3539,20:3538,79:3676,80:3679,14:4168,15:4169,86:4359,87:4360,12:4792,11:4794,8:5162,9:5164,92:5326,93:5328,94:5330,95:5332,96:5334,3:5436,2:5437,98:5544,99:5546},83:{65:1972,66:1973,63:1983,62:1984,57:1988,56:1990,54:2004,53:2005,52:2006,77:2488,73:2460,72:2462,76:2486,71:2465,35:2591,34:2593,33:2597,82:3172,83:3173,79:3183,80:3184,31:3332,30:3333,29:3338,28:3339,26:3351,25:3353,24:3355,23:3360,85:3851,86:3853,93:4445,92:4446,99:4467,98:4468,97:4469,96:4470,94:4473,90:4475,89:4477,88:4479,17:4647,16:4648,14:4653,13:4654},84:{65:1974,66:1975,67:1978,63:1985,62:1986,58:1991,57:1992,60:1995,59:1996,76:2487,71:2464,70:2466,69:2469,77:2489,75:2490,50:2552,49:2553,47:2554,46:2555,45:2558,44:2559,42:2566,41:2567,39:2579,38:2580,37:2583,35:2592,34:2594,33:2603,83:3174,82:3175,80:3185,79:3186,31:3334,30:3335,29:3340,28:3341,85:3852,86:3854,21:4019,20:4020,93:4447,92:4448,90:4476,89:4478,88:4480,18:4639,17:4641,16:4643,14:4655,13:4656,11:5383,10:5384,8:5400,7:5402,6:5404,5:5407,4:5408},85:{66:1976,67:1977,58:1993,57:1994,60:1997,59:1998,70:2467,71:2468,69:2470,75:2491,76:2492,74:2493,73:2494,77:2497,55:2543,54:2545,52:2546,51:2547,50:2550,49:2551,47:2556,46:2557,45:2560,44:2561,42:2568,41:2569,39:2581,38:2582,37:2584,31:3336,30:3337,85:3855,86:3857,26:3996,25:3997,23:4014,22:4017,21:4018,20:4021,88:4481,89:4482,18:4640,17:4642,16:4644,95:4983,96:4984,97:4986,11:5385,10:5386,8:5401,7:5403,6:5405,5:5406,4:5409},18:{33:2204,32:2205,34:2207,35:2210,37:2211,38:2212,39:2215,40:2216,42:2235,43:2236,45:2238,46:2240,47:2241,48:2243,49:2245,58:2270,59:2272,60:2281,28:2818,29:2819,63:2917,64:2918,66:2921,67:2922,68:2926,69:2928,71:2935,72:2936,20:3540,21:3541,22:3542,74:3659,75:3660,77:3671,78:3673,79:3675,80:3680,15:4170,16:4171,17:4174,18:4175,82:4352,83:4354,85:4355,86:4358,8:5163,9:5165,89:5317,90:5318,92:5325,93:5327,94:5329,95:5331,96:5333,6:5428,5:5430,4:5432,3:5434,2:5435},17:{37:2213,38:2214,39:2217,40:2218,42:2230,43:2232,45:2237,46:2239,51:2255,52:2256,53:2259,55:2260,56:2261,58:2273,59:2274,28:2820,29:2821,30:2822,62:2914,63:2915,64:2919,66:2923,67:2924,69:2929,68:2930,71:2937,72:2938,21:3543,22:3544,23:3545,25:3549,26:3550,74:3661,75:3662,77:3672,78:3674,16:4172,15:4173,18:4176,17:4177,82:4351,83:4353,85:4356,86:4357,13:4795,12:4798,11:4800,88:5313,89:5315,90:5316,6:5429,5:5431,4:5433,3:5442,98:5703,99:5704},16:{38:2219,39:2220,42:2229,43:2231,48:2247,49:2248,50:2251,51:2252,52:2257,53:2258,55:2262,56:2263,30:2823,29:2824,28:2825,32:2826,33:2827,34:2838,35:2839,61:2911,62:2913,63:2916,23:3546,22:3547,21:3548,25:3551,26:3552,74:3663,75:3664,18:4178,19:4179,80:4344,81:4346,82:4348,83:4350,13:4796,12:4797,11:4799,9:5242,8:5243,88:5312,89:5314,90:5319,91:5320,92:5324,94:5531,95:5533,96:5541,98:5705,99:5706,100:5709},15:{38:2221,39:2222,41:2225,42:2228,43:2234,48:2249,49:2250,50:2253,51:2254,56:2264,57:2265,32:2828,33:2829,34:2840,35:2841,36:2842,45:2861,46:2863,59:2907,60:2909,61:2910,62:2912,63:2920,25:3553,26:3554,65:3644,66:3646,68:3647,69:3649,70:3651,71:3653,72:3655,74:3665,75:3666,76:3667,19:4180,18:4181,78:4340,79:4342,80:4343,81:4345,82:4347,83:4349,11:4803,12:4805,15:4807,16:4808,86:4928,85:4930,9:5244,8:5245,91:5321,92:5323,6:5443,5:5445,4:5447,3:5449,94:5532,95:5534,96:5542,99:5707,98:5708,100:5710},14:{38:2223,39:2224,41:2226,42:2227,43:2233,56:2266,57:2267,32:2830,33:2831,36:2843,35:2844,45:2862,46:2864,53:2884,54:2885,59:2906,60:2908,25:3555,26:3556,28:3557,29:3558,30:3561,65:3643,66:3645,68:3648,69:3650,70:3652,71:3654,72:3656,74:3668,75:3669,76:3670,21:4182,22:4183,23:4186,78:4339,79:4341,11:4804,12:4806,15:4809,16:4810,14:4811,86:4927,85:4929,9:5246,8:5247,88:5335,89:5336,6:5444,5:5446,4:5448,3:5450,94:5535,95:5537},13:{51:2878,32:2832,33:2833,45:2865,46:2867,47:2872,49:2874,50:2875,53:2886,54:2887,28:3559,29:3560,30:3562,62:3637,63:3639,64:3641,65:3642,71:3657,70:3658,22:4184,21:4185,23:4187,20:4193,14:4812,15:4813,16:4814,17:4815,18:4818,81:4918,82:4919,84:4921,85:4924,86:4925,9:5248,8:5249,88:5337,89:5338,90:5341,91:5342,92:5346,94:5536,95:5538,97:5692,98:5694,99:5696,100:5698},86:{73:2495,74:2496,64:2515,63:2517,62:2518,55:2542,54:2544,52:2548,51:2549,45:2562,44:2563,42:2570,41:2571,37:2585,36:2586,79:3188,80:3189,81:3192,82:3193,34:3323,33:3325,85:3856,86:3858,84:3859,28:3992,27:3993,26:3995,25:3998,23:4015,22:4016,89:4483,88:4484,16:4645,17:4646,91:4968,92:4969,94:4979,95:4981,96:4985,97:4987,14:5096,13:5097,11:5387,10:5388,4:5410,3:5411},87:{71:2498,70:2499,68:2506,67:2507,66:2510,65:2511,60:2521,64:2516,63:2519,62:2520,59:2522,57:2534,56:2536,55:2538,54:2540,45:2564,44:2565,42:2572,41:2573,40:2574,39:2575,37:2587,36:2588,79:3190,80:3191,81:3194,82:3195,77:3196,76:3197,49:3282,48:3283,47:3286,34:3324,33:3326,84:3860,85:3861,31:3983,30:3985,29:3987,28:3991,23:4022,22:4024,20:4631,19:4632,91:4970,92:4971,94:4980,95:4982,14:5095,13:5098,11:5389,10:5390,3:5412,4:5413,8:5414,7:5415,6:5418},88:{71:2500,70:2501,68:2508,67:2509,66:2512,60:2523,59:2524,57:2535,56:2537,55:2539,54:2541,40:2576,39:2577,41:2578,37:2589,36:2590,76:3198,77:3199,74:3210,73:3211,52:3270,51:3271,49:3284,48:3285,47:3287,34:3327,33:3329,31:3984,30:3986,29:3988,26:3999,25:4000,23:4023,22:4025,87:4491,88:4493,20:4633,19:4634,91:4972,90:4973,97:5047,98:5049,17:5087,16:5089,15:5091,14:5093,8:5416,7:5417,6:5419},89:{71:2502,70:2503,64:3233,60:2525,59:2526,61:2527,77:3200,76:3201,78:3204,79:3206,74:3212,73:3213,63:3234,52:3272,51:3273,49:3288,48:3289,45:3298,44:3299,43:3301,34:3328,33:3330,81:3863,82:3864,31:3989,30:3990,26:4001,25:4002,27:4005,84:4485,85:4487,86:4489,87:4492,88:4494,20:4635,19:4636,91:4974,90:4975,92:4978,94:5009,95:5010,97:5048,98:5050,17:5088,16:5090,15:5092,14:5094,11:5381,12:5382,8:5420,9:5421,6:5424,5:5425,3:5607,2:5608},90:{71:2504,70:2505,61:2528,60:2529,59:2530,58:2531,76:3202,77:3203,78:3205,79:3207,74:3214,73:3215,67:3231,68:3232,64:3235,63:3236,65:3237,56:3260,55:3262,54:3264,52:3274,51:3275,46:3295,45:3296,44:3300,43:3302,41:3305,40:3306,38:3314,37:3315,36:3318,81:3862,82:3865,26:4003,27:4004,28:4006,84:4486,85:4488,86:4490,23:4621,22:4622,20:4637,19:4638,91:4976,92:4977,94:5008,95:5011,98:5051,99:5052,12:5378,11:5379,9:5422,8:5423,5:5426,6:5427,3:5605,2:5606},91:{58:2532,59:2533,79:3208,78:3209,73:3216,68:3229,67:3230,65:3238,64:3239,56:3261,55:3263,54:3265,52:3276,51:3277,50:3278,48:3290,47:3291,46:3294,45:3297,41:3307,40:3308,38:3316,37:3317,36:3319,35:3320,81:3866,82:3867,33:3972,32:3974,28:4007,27:4008,29:4011,30:4012,88:4500,89:4502,24:4619,23:4620,22:4623,95:5016,96:5017,99:5053,98:5054,17:5362,16:5363,14:5373,13:5375,12:5377,11:5380,3:5603,2:5604,1:5611},12:{35:2845,36:2846,37:2849,38:2850,40:2853,41:2854,42:2859,45:2866,46:2868,44:2869,47:2873,49:2876,50:2877,51:2879,53:2888,54:2889,56:2894,57:2895,58:2898,59:2899,60:2905,28:3563,29:3564,62:3636,63:3638,64:3640,21:4191,22:4190,20:4192,25:4194,26:4195,67:4336,68:4337,17:4816,18:4817,73:4901,74:4903,75:4905,76:4907,77:4909,79:4913,80:4916,81:4917,82:4920,84:4922,85:4923,86:4926,12:5178,11:5179,9:5250,8:5251,88:5339,89:5340,90:5343,91:5344,92:5345,5:5459,6:5460,3:5475,2:5476,94:5539,95:5540,97:5691,98:5693,99:5695,100:5697},11:{35:2847,36:2848,37:2851,38:2852,40:2855,41:2856,42:2860,44:2870,45:2871,51:2880,50:2881,53:2890,54:2891,56:2896,57:2897,59:2900,58:2901,60:2904,31:3565,32:3566,33:3569,26:4196,25:4197,24:4198,66:4334,67:4335,68:4338,70:4887,71:4888,73:4902,74:4904,75:4906,76:4908,77:4910,79:4914,80:4915,15:5166,14:5167,13:5176,12:5177,11:5180,9:5252,8:5253,6:5456,5:5458,3:5473,2:5474,1:5477,99:5699,100:5702},10:{40:2857,41:2858,51:2882,50:2883,53:2892,54:2893,59:2902,60:2903,31:3567,32:3568,33:3570,47:3595,48:3596,63:3634,62:3635,24:4199,25:4200,23:4201,22:4204,26:4225,28:4226,29:4227,65:4329,66:4331,67:4333,20:4819,19:4821,18:4823,17:4826,70:4889,71:4890,73:4911,74:4912,15:5168,14:5169,13:5174,12:5175,82:5307,83:5309,6:5455,5:5457,3:5471,2:5472,1:5478,85:5521,86:5523,87:5525,88:5527,89:5529,92:5652,91:5653,94:5681,95:5682,96:5683,97:5684,99:5700,100:5701},92:{73:3217,72:3218,70:3221,69:3222,68:3225,67:3226,65:3246,64:3247,62:3248,61:3249,55:3266,54:3267,50:3279,51:3280,52:3281,48:3292,47:3293,46:3303,45:3304,41:3309,42:3310,43:3311,35:3321,36:3322,81:3868,82:3869,83:3873,84:3875,76:3884,75:3885,33:3973,32:3975,28:4009,29:4010,30:4013,86:4495,87:4497,88:4499,89:4501,90:4503,25:4617,24:4618,23:4624,22:4630,92:4996,93:4997,95:5022,96:5023,99:5055,98:5057,19:5084,20:5085,17:5364,16:5365,14:5374,13:5376,9:5568,8:5569,6:5594,5:5596,2:5609,1:5610},93:{72:3219,73:3220,69:3223,70:3224,67:3227,68:3228,62:3250,61:3251,60:3252,59:3253,58:3256,57:3257,55:3268,54:3269,43:3312,42:3313,79:3876,82:3871,83:3872,84:3874,78:3877,76:3886,75:3887,39:3965,38:3966,32:3976,33:3978,86:4496,87:4498,90:4504,89:4505,26:4615,25:4616,24:4629,92:4998,93:4999,99:5056,98:5058,20:5081,19:5082,17:5366,16:5367,11:5564,10:5566,9:5567,8:5570,6:5595,5:5597,4:5598,2:5612,1:5613},94:{60:3254,59:3255,58:3258,57:3259,79:3878,78:3879,80:3880,76:3888,75:3889,65:3910,64:3911,52:3932,51:3933,49:3935,48:3936,46:3949,45:3950,40:3961,39:3964,38:3967,37:3968,36:3970,32:3977,33:3979,34:3981,30:4611,29:4613,26:4625,27:4626,92:5000,93:5001,95:5036,96:5038,22:5077,21:5078,20:5080,19:5083,17:5368,16:5369,15:5370,13:5559,12:5561,11:5563,10:5565,4:5599,5:5600},9:{33:3571,34:3572,36:3575,37:3576,38:3579,43:3587,44:3588,47:3597,48:3598,46:3599,56:3621,57:3622,62:3632,63:3633,23:4202,22:4203,24:4224,29:4228,28:4229,65:4328,66:4330,67:4332,20:4820,19:4822,18:4824,17:4825,69:4891,70:4892,15:5170,14:5171,10:5214,9:5215,76:5286,77:5287,79:5301,80:5303,81:5305,82:5306,83:5308,7:5451,6:5454,85:5520,86:5522,87:5524,88:5526,89:5528,92:5650,91:5651,94:5679,95:5680,96:5685,97:5686},8:{33:3573,34:3574,36:3577,37:3578,38:3580,39:3581,40:3584,41:3585,43:3589,44:3590,46:3600,47:3601,48:3602,49:3603,50:3604,52:3607,53:3608,55:3617,56:3620,57:3623,59:3625,60:3627,61:3629,62:3631,31:4233,30:4232,28:4231,29:4230,27:4237,26:4238,69:4893,70:4894,15:5172,14:5173,12:5210,11:5211,10:5212,9:5213,72:5279,73:5281,74:5285,76:5288,77:5289,79:5300,80:5302,81:5304,82:5310,83:5311,7:5452,6:5453,3:5469,4:5470,91:5648,92:5649,97:5687,98:5688},7:{39:3582,40:3583,41:3586,43:3591,44:3592,50:3605,49:3606,52:3609,53:3610,55:3618,56:3619,57:3624,59:3626,60:3628,61:3630,31:4235,30:4236,26:4239,27:4240,28:4241,24:4827,23:4829,64:4879,65:4880,69:4895,68:4896,67:4897,70:4900,21:5181,20:5183,18:5193,17:5194,12:5208,11:5209,72:5278,73:5280,74:5284,76:5290,77:5291,4:5466,3:5468,85:5516,86:5517,88:5640,89:5641,90:5646,91:5647,94:5662,95:5663,97:5689,98:5690},6:{43:3593,44:3594,52:3611,53:3612,33:4244,34:4245,35:4250,36:4251,37:4252,46:4300,47:4301,24:4828,23:4830,64:4881,65:4882,63:4883,67:4898,68:4899,21:5182,20:5184,18:5195,17:5196,16:5201,14:5202,13:5203,12:5206,11:5207,9:5240,8:5241,73:5282,74:5283,76:5292,77:5293,78:5294,79:5295,6:5461,5:5463,4:5465,3:5467,81:5509,82:5510,84:5512,85:5515,86:5518,88:5642,89:5643,90:5644,91:5645,94:5664,95:5665,93:5666},5:{53:3613,54:3614,33:4246,34:4247,35:4248,36:4249,37:4253,39:4256,40:4259,41:4260,46:4302,47:4303,48:4306,49:4308,50:4311,56:4316,57:4318,58:4321,59:4322,60:4324,61:4327,23:4831,24:4834,26:4838,27:4839,29:4849,30:4851,31:4853,63:4884,64:4885,65:4886,20:5187,17:5197,16:5200,14:5204,13:5205,12:5216,9:5238,8:5239,70:5268,71:5269,79:5299,78:5298,6:5462,5:5464,81:5507,82:5508,84:5513,85:5514,86:5519,93:5667,94:5668,97:5711,98:5712},4:{54:3615,53:3616,35:4254,34:4255,39:4257,40:4258,41:4261,43:4288,44:4289,46:4304,47:4305,48:4309,49:4310,50:4312,51:4313,56:4317,57:4319,58:4320,59:4323,60:4325,61:4326,23:4832,24:4833,22:4835,26:4840,27:4841,29:4850,30:4852,31:4854,20:5188,19:5190,17:5198,16:5199,10:5233,9:5234,8:5237,67:5265,68:5267,70:5270,71:5271,72:5274,73:5275,2:5489,3:5490,75:5491,76:5492,81:5505,82:5506,88:5635,89:5636,91:5675,93:5673,92:5674,97:5713,98:5714,96:5715},95:{79:3881,80:3882,78:3883,76:3890,75:3891,74:3892,72:3895,71:3897,70:3899,69:3901,67:3905,66:3906,65:3909,64:3912,63:3913,62:3914,55:3926,54:3927,53:3930,52:3931,51:3934,48:3937,49:3938,46:3951,45:3952,44:3957,43:3958,42:3959,40:3962,39:3963,37:3969,36:3971,33:3980,34:3982,82:4506,83:4509,84:4510,85:4513,30:4610,29:4612,26:4627,27:4628,87:4988,88:4989,92:5002,93:5003,91:5004,90:5005,95:5037,96:5039,97:5044,98:5045,24:5072,23:5073,22:5076,21:5079,15:5371,16:5372,13:5560,12:5562,11:5571,10:5572,8:5584,7:5585,5:5601,4:5602,1:5624,2:5625},96:{74:3893,75:3894,72:3896,71:3898,70:3900,69:3902,67:3907,66:3908,62:3915,63:3916,64:3917,60:3918,59:3919,58:3922,57:3923,55:3928,54:3929,49:3939,48:3940,46:3953,45:3954,44:3955,43:3956,42:3960,82:4507,83:4508,84:4511,85:4512,31:4606,30:4609,87:4990,88:4991,91:5006,90:5007,96:5040,97:5043,98:5046,24:5074,23:5075,22:5086,19:5359,18:5360,8:5586,7:5587,2:5621,1:5622},97:{72:3903,71:3904,60:3920,59:3921,58:3924,57:3925,49:3941,50:3942,51:3945,52:3946,85:4514,84:4515,77:4518,78:4520,79:4522,80:4524,40:4583,39:4584,37:4593,36:4594,35:4599,33:4601,32:4602,31:4607,30:4608,87:4992,88:4993,93:5032,94:5033,96:5041,97:5042,28:5059,27:5062,26:5064,20:5356,19:5357,18:5361,16:5557,15:5558,13:5573,12:5574,11:5582,8:5588,7:5589,9:5592,5:5614,4:5616,3:5618,2:5620,1:5623},98:{50:3943,49:3944,51:3947,52:3948,85:4516,84:4517,77:4519,78:4521,79:4523,80:4525,81:4528,82:4529,74:4531,75:4532,69:4539,68:4540,66:4547,65:4549,64:4551,63:4553,62:4555,54:4559,55:4560,47:4575,46:4576,45:4579,44:4580,40:4585,39:4586,41:4588,42:4590,37:4595,36:4596,35:4600,33:4603,32:4604,31:4614,87:4994,88:4995,91:5026,90:5024,92:5028,93:5030,94:5034,28:5060,27:5063,26:5065,24:5347,23:5348,22:5351,21:5352,20:5355,19:5358,16:5555,15:5556,13:5575,12:5576,11:5583,8:5590,7:5591,9:5593,5:5615,4:5617,3:5619},3:{39:4262,38:4263,37:4264,43:4290,44:4291,51:4314,50:4315,22:4836,23:4837,26:4842,27:4843,31:4855,32:4856,20:5191,19:5192,14:5225,13:5226,11:5229,10:5231,9:5235,8:5236,63:5254,64:5258,65:5260,66:5262,67:5264,68:5266,70:5272,71:5273,72:5276,73:5277,6:5479,5:5481,4:5483,3:5485,2:5487,75:5493,76:5494,77:5495,78:5496,80:5501,81:5504,82:5511,84:5626,85:5628,86:5630,87:5632,88:5634,89:5637,91:5676,92:5677,93:5678,96:5716,97:5717,95:5718,98:5721},2:{37:4265,38:4266,39:4267,42:4298,43:4292,44:4293,41:4299,26:4844,27:4845,25:4846,32:4857,31:4858,30:4859,29:4860,53:4863,54:4865,55:4867,56:4869,58:4871,59:4873,60:4875,61:4877,17:5217,16:5219,15:5222,14:5223,13:5227,11:5230,10:5232,63:5257,64:5259,65:5261,66:5263,6:5480,5:5482,4:5484,3:5486,2:5488,77:5497,78:5498,76:5499,75:5500,80:5502,81:5503,84:5627,85:5629,86:5631,87:5633,95:5719,96:5720},1:{43:4294,44:4295,42:4296,41:4297,25:4847,26:4848,29:4861,30:4862,53:4864,54:4866,55:4868,56:4870,58:4872,59:4874,60:4876,61:4878,17:5218,16:5220,15:5221,14:5224,13:5228,86:5638,87:5639},99:{80:4526,81:4527,82:4530,75:4533,74:4534,73:4535,72:4536,69:4541,68:4542,70:4545,66:4548,65:4550,64:4552,63:4554,62:4556,54:4561,55:4562,56:4563,57:4565,58:4567,59:4569,60:4571,47:4577,46:4578,45:4581,44:4582,40:4587,41:4589,42:4591,39:4592,37:4597,36:4598,90:5025,91:5027,92:5029,93:5031,94:5035,28:5068,29:5070,24:5349,23:5350,22:5353,21:5354,17:5551,16:5553,13:5577,12:5579},100:{72:4537,73:4538,69:4543,68:4544,70:4546,66:4557,65:4558,56:4564,57:4566,58:4568,59:4570,60:4572,55:4573,54:4574,28:5069,29:5071,17:5552,16:5554,13:5580,12:5581}},
		wrapInClosure: function(obj)
		{
			return (function(x) { return function() { return x; }; })(obj);
		},
		existsIn: function(input,test)
		{
			var ret;
			try { ret = input.indexOf(test)!==-1; }
			catch(e) { return false; }
			return ret;
		},
		calcDist: function(x1,y1,x2,y2)
		{
			return Math.sqrt(Math.pow(x1-x2,2)+Math.pow(y1-y2,2));
		},
		estimateTravelTime:function(dist)
		{
			// (dist*72000)/(speed+[speed*SMALevel(for ships only)]*gov%)*(1+[PosLevel%+CargoPerShip%]+Triton)
//			var time = 20*(dist==0?0.5:dist);
//			var d = dist || false;
//			if(!city1 || !city2) return 0;
			return Math.floor(20*(dist==0?0.5:dist)*60*1000);
		},
		addStyleSheet: function(style)
		{
			var getHead = document.getElementsByTagName('head')[0];
			var cssNode = window.document.createElement('style');
			var elementStyle = getHead.appendChild(cssNode);
			elementStyle.innerHTML = style;
			return elementStyle;
		},
		escapeRegExp: function(str) { return str.replace(/[\[\]\/\{\}\(\)\-\?\$\*\+\.\\\^\|]/g, "\\$&"); },
		format: function(inputString, replacements)
		{
			var str = inputString;
			var keys = Object.keys(replacements);
			var i = keys.length;
			while(i--) { str = str.replace(new RegExp(this.escapeRegExp('{' + keys[i] + '}'), 'g'), replacements[keys[i]]); }
			return str;
		},
		cacheFunction: function(toExecute,expiry)
		{
			expiry = expiry || 1000;
			var cachedTime = $.now;
			var cachedResult;
			cachedResult = undefined;
			return function()
			{
				if(cachedTime < $.now() - expiry || cachedResult === undefined)
				{
					cachedResult = toExecute();
					cachedTime = $.now();
				}
				return cachedResult;
			};
		},
		getClone: function($node)
		{
			if ($node.hasClass('ui-sortable-helper') || $node.parent().find('.ui-sortable-helper').length) { return $node; }
			return $($node.get(0).cloneNode(true));
		},
		setClone: function($node,$clone)
		{
			if($node.hasClass('ui-sortable-helper') || $node.parent().find('.ui-sortable-helper').length) { return $node; }
			$node.get(0).parentNode.replaceChild($clone.get(0), $node.get(0));
			return $node;
		},
		replaceNode: function(node,html)
		{
			var t = node.cloneNode(false);
			t.innerHTML = html;
			node.parentNode.replaceChild(t,node);
			return t;
		},
		FormatTimeLengthToStr: function(timeString,precision,spacer)
		{
			var LD = Constant.LanguageData[database.settings.languageChange.value];
			timeString = timeString || 0;
			precision = precision || 2;
			spacer = spacer || ' ';
			if(!isFinite(timeString)){return ' \u221E ';}
			if(timeString < 0) timeString *= -1;
			var a = {'second':1,'minute':60,'hour':60,'day':24,'month':30,'year':365};
			var b = {};
			var l = {};
			var c = 1;
			for(var d in Object.keys(a))
			{
				c *= a[Object.keys(a)[d]];
				b[Object.keys(a)[d]] = c/(d==Object.keys(a).length-1?30:1);
				l[Object.keys(a)[d]] = LD[Object.keys(a)[d]];
			}
			var i = Object.keys(a).length;
			var z = {};
			while(i--){z[Object.keys(a)[i]] = b[Object.keys(a)[i]];}
			timeString = Math.ceil(timeString/1000);
			var retarr = [];
			for(var f in z)
			{
				var timeInSecs=Math.floor(timeString/z[f]);
				if(isNaN(timeInSecs)) {return retarr.join(' ');}
				if(precision>0 && (timeInSecs>0 || retarr.length>0))
				{
					timeString = timeString-timeInSecs*z[f];
					if(timeInSecs>0) { retarr.push(timeInSecs+l[f]); }
					precision = timeInSecs==0 ? precision : (precision-1);
				}
			}
			return retarr.join(' ');
		},
		FormatFullTimeToDateString: function (timeString,short)
		{
			var LD = Constant.LanguageData[database.settings.languageChange.value];
			timeString = timeString || 0;
			short = short || false;
			if(!isFinite(timeString) || timeString == 'Invalid Date') { return ''; }
			if(timeString < 0) timeString *= -1;
			moment.locale(database.settings.languageChange.value);
			var compDate = new Date(timeString);
			var diff = Math.floor(moment(compDate).diff(moment().startOf('day'),'seconds')/86400);
			var day = '';
			switch(diff) {
				case -1:
					day = LD.yesterday+' '+LD.at+' ';
					break;
				case 0:
					day = LD.today+' '+LD.at+' ';
					break;
				case 1:
					day = LD.tomorrow+' '+LD.at+' ';
					break;
				default:
					day = moment(compDate).format(short==false ? LD.dateformat : LD.dateformatshort)+' ';
			}
			return day + moment(compDate).format(short==false ? LD.timeformat : LD.timeformatshort);
		},
		FormatRemainingTime:function(time,brackets)
		{
			brackets = brackets || false;
			var arrInTime = Utils.FormatTimeLengthToStr(time,3,' ');
			return (arrInTime==='') ? '' : (brackets?'(':'')+arrInTime+(brackets?')':'');
		},
		FormatNumToStr:function(inputNum,outputSign,precision)
		{
			var LD = Constant.LanguageData[database.settings.languageChange.value];
			var tho = LD.thousandSeperator;
			var dec = LD.decimalPoint;
			var p = Math.abs(inputNum).toString().split('.');
			var num = parseFloat(parseInt(p[0]).toString()+(precision!==undefined ? '.'+parseFloat(p[1]!==undefined ? '0.'+p[1]: 0).toFixed(precision).split('.')[1]:''));
			var sgn = num==0?'':Math.sign(inputNum)==-1?'-':'+';
			return (outputSign || sgn=='-' ? sgn : '')+(precision==undefined && num==0 ? '' : parseInt(p[0]).toString().replace(/\B(?=(\d{3})+(?!\d))/g,tho))+(precision!==undefined && precision>0 ? dec+parseFloat(p[1]!==undefined ? '0.'+p[1]: 0).toFixed(precision).split('.')[1] : '');
		},
		FormatLocDurToSecs:function(a)
		{
			var LD = Constant.LanguageData[database.settings.languageChange.value];
			var z = {'second':1,'minute':60,'hour':60,'day':24,'month':30,'year':365};
			var u = 1;
			var y = {};
			for(var x in Object.keys(z))
			{
				u *= z[Object.keys(z)[x]];
				y[Object.keys(z)[x]] = u/(x==Object.keys(z).length-1?30:1);
			}
			var b = database.getGlobalData.localStrings;
			var c = a.split(' ');
			var test = 0;
			if(c && Array.isArray(c) && c.length>0)
			{
				$.each(c,function(i,d)
				{
					test += parseInt(d.match(/\d+/)[0])*y[Object.keys(b)[Object.values(b).indexOf(d.replace(/[^a-z]/gi,''))]];
				});
			}
			return test;
		},
		FormatQuantityToLoad:function(q,p,c)
		{
			var LD = Constant.LanguageData[database.settings.languageChange.value];
			var p = p && p===true ? true : false;
			var q = q>0 ? q : 0;
			var c = c && [100,200,300,400,500].indexOf(c)!=-1 ? c : 500;
			var s = '<img src="skin/relatedCities/trade_ship_20.png" style="width:auto;height:10px;display:inline;margin-left:-3px;">';
			var f = parseInt($('#js_GlobalMenu_maxTransporters').text()); // Συνολικός αριθμός πλοίων
			var r = Math.floor(q/(f*c)); // Πλήρεις διαδρομές
			var rs = Math.ceil((q%(f*c))/c) // Υπόλοιπα πλοία μετά τις πλήρεις διαδρομές
			var t = p===false ? [' &nbsp;'+s+s+s,' &nbsp;'+s] : (r==1 ? [' '+LD.qltxts[0],' '+LD.qltxts[2]] : [' '+LD.qltxts[1],' '+LD.qltxts[3]]);
			return database.settings.quantityLoads.value?(q>0 ? (r>0?Utils.FormatNumToStr(r,false,0)+t[0]:'')+(r>0&&rs>0?' + ':'')+(rs>0?Utils.FormatNumToStr(rs,false,0)+t[1]:'') : ''):'';
		},
		Nth:function(n)
		{
			var LD = Constant.LanguageData[database.settings.languageChange.value];
			var n = parseInt(n) || 0;
			var s = LD.ordinal;
			var v=n%100;
			return Utils.FormatNumToStr(n,false,0)+'<sup>'+(Array.isArray(s)?(s[(v-20)%10]||s[v]||s[0]):s)+'</sup>';
		},
		waitElem:function(s,a,b,i,v)
		{
			var t, f;
			t = typeof(i)=='undefined' ? $(s) : $(i).contents().find(s);
			if(t && t.length>0)
			{
				f = true;
				t.each(function()
				{
					var j = $(this);
					var af = j.data('alreadyFound') || false;
					if(!af)
					{
						var cf = a(j);
						if(cf)
						{
							f = false;
						}
						else
						{
							j.data('alreadyFound',true);
						}
					}
				});
			}
			else
			{
				f = false;
			}
			var c = Utils.waitElem.c || {};
			var k = s.replace(/[^\w]/g,'_');
			var tc = c[k];
			if(f && b && tc)
			{
				clearInterval(tc);
				delete c[k]
			}
			else
			{
				if(!tc)
				{
					tc = setInterval(function() { Utils.waitElem(s,a,b,i); },(v?v:100));
					c[k] = tc;
				}
			}
			Utils.waitElem.c = c;
		},
		trackEvents(s)
		{
			var events = [];
			$(s).on('AlertActive AlertClose CheckboxStateChange DOMActivate DOMAttrModified DOMAttributeNameChanged DOMAutoComplete DOMCharacterDataModified DOMContentLoaded DOMElementNameChanged DOMFocusIn DOMFocusOut DOMFrameContentLoaded DOMLinkAdded DOMLinkRemoved DOMMenuItemActive DOMMenuItemInactive DOMMetaAdded DOMMetaRemoved DOMModalDialogClosed DOMMouseScroll DOMNodeInserted DOMNodeInsertedIntoDocument DOMNodeRemoved DOMNodeRemovedFromDocument DOMPopupBlocked DOMSubtreeModified DOMTitleChanged DOMWillOpenModalDialog DOMWindowClose DOMWindowCreated Firefox MSManipulationStateChanged MSPointerHover MozAfterPaint MozAudioAvailable MozBeforeResize MozEdgeUIGesture MozEnteredDomFullscreen MozGamepadButtonDown MozGamepadButtonUp MozMagnifyGesture MozMagnifyGestureStart MozMagnifyGestureUpdate MozMousePixelScroll MozOrientation MozPressTapGesture MozRotateGesture MozRotateGestureStart MozRotateGestureUpdate MozScrolledAreaChanged MozSwipeGesture MozTapGesture MozTouchDown MozTouchMove MozTouchUp OS RadioStateChange SSTabClosing SSTabRestored SSTabRestoring SSWindowClosing SSWindowStateBusy SSWindowStateReady SVGAbort SVGError SVGLoad SVGResize SVGScroll SVGUnload SVGZoom TabClose TabHide TabOpen TabPinned TabSelect TabShow TabUnpinned ValueChange abort afterprint afterscriptexecute alerting animationcancel animationend animationiteration animationstart appinstalled audioend audioprocess audiostart beforeinstallprompt beforeprint beforescriptexecute beforeunload beginEvent blocked blur boundary broadcast busy callschanged canplay canplaythrough cardstatechange cfstatechange change chargingchange chargingtimechange click close command commandupdate complete compositionend compositionstart compositionupdate connected connecting connectionInfoUpdate contextmenu copy cut datachange dataerror dblclick delivered devicechange devicemotion deviceorientation dialing disabled dischargingtimechange disconnected disconnecting drag dragdrop dragend dragenter dragexit draggesture dragleave dragover dragstart drop durationchange emptied enabled end endEvent ended error focus focusin focusout fullscreen fullscreenchange fullscreenerror gamepadconnected gamepaddisconnected gotpointercapture hashchange held holding icccardlockerror iccinfochange incoming input invalid keydown keypress keyup languagechange levelchange load loadeddata loadedmetadata loadend loadstart localized lostpointercapture mark message messageerror mousedown mouseenter mouseleave mousemove mouseout mouseover mouseup mousewheel mozbrowseractivitydone mozbrowserasyncscroll mozbrowseraudioplaybackchange mozbrowsercaretstatechanged mozbrowserclose mozbrowsercontextmenu mozbrowserdocumentfirstpaint mozbrowsererror mozbrowserfindchange mozbrowserfirstpaint mozbrowsericonchange mozbrowserloadend mozbrowserloadstart mozbrowserlocationchange mozbrowsermanifestchange mozbrowsermetachange mozbrowseropensearch mozbrowseropentab mozbrowseropenwindow mozbrowserresize mozbrowserscroll mozbrowserscrollareachanged mozbrowserscrollviewchange mozbrowsersecuritychange mozbrowserselectionstatechanged mozbrowsershowmodalprompt mozbrowsertitlechange mozbrowserusernameandpasswordrequired mozbrowservisibilitychange moztimechange msContentZoom nomatch notificationclick offline onconnected online open orientationchange overflow pagehide pageshow paste pause play playing pointercancel pointerdown pointerenter pointerleave pointerlockchange pointerlockerror pointermove pointerout pointerover pointerup popstate popuphidden popuphiding popupshowing popupshown progress push pushsubscriptionchange ratechange readystatechange received repeatEvent reset resize resourcetimingbufferfull result resume resuming scroll seeked seeking select selectionchange selectstart sent show sizemodechange slotchange smartcard-insert smartcard-remove soundend soundstart specific speechend speechstart stalled start statechange statuschange stkcommand stksessionend storage submit success suspend textInput timeout timeupdate touchcancel touchend touchenter touchleave touchmove touchstart transitionend underflow unload upgradeneeded uploadprogress userproximity ussdreceived valueInput versionchange visibilitychange voicechange voiceschanged volumechange waiting wheel',function(e)
			{
				if(events.indexOf(e.type)==-1)
				{
					events.push(e.type)
				}
				else
				{
					events.sort();
					console.log(events.join(' '));
				}
			});
		},
		mul(p)
		{
			p = parseInt(p);
			switch(true)
			{
				case (p >= 1 && p <= 5):
					return 3-0.25*p;
				case (p >= 6 && p <= 10):
					return 2.25-0.125*p;
				case (p >= 11 && p <= 20):
					return 0.875;
				case (p >= 21 && p <= 30):
					return 0.75;
				case (p >= 31 && p <= 50):
					return 0.5;
				case (p >= 51):
					return 0;
			}
		},
		isXYtoID(x,y)
		{
			if(isNaN(x) || isNaN(y)) { return false; }
			return Utils.islandids[parseInt(x)][parseInt(y)];
		},
		isIDtoXY(a)
		{
			if(isNaN(a)) { return false; }
			var xy = {X:null,Y:null};
			$.each(Utils.islandids,function(x,i) { $.each(i,function(y,id) { if(parseInt(a)==id) { xy.Y = parseInt(y); return false; } }); if(xy.Y!=null) { xy.X = parseInt(x); return false; } });
			return xy;
		}
	};
/************************************************
******************** CLASSES ********************
************************************************/
	function Movement(id,originCityId,targetCityId,arrivalTime,mission,loadingTime,resources,military,ships,eventid,queuedTime)
	{
		if(typeof id==="object")
		{
			this._id = id._id || null;
			this._originCityId = id._originCityId || null;
			this._targetCityId = id._targetCityId || null;
			this._arrivalTime = id._arrivalTime || null;
			this._mission = id._mission || null;
			this._loadingTime = id._loadingTime || null;
			this._resources = id._resources || {wood:0,wine:0,marble:0,glass:0,sulfur:0,gold:0};
			this._military = id._military || new MilitaryUnits();
			this._ships = id._ships || null;
			this._eventid = id._eventid || null;
			this._queuedTime = id._queuedTime || null;
			this._updatedCity = id._updatedCity || false;
			this._complete = id._complete || false;
			this._updateTimer = id._updateTimer || null;
		}
		else
		{
			this._id = id || null;
			this._originCityId = originCityId || null;
			this._targetCityId = targetCityId || null;
			this._arrivalTime = arrivalTime || null;
			this._mission = mission || null;
			this._loadingTime = loadingTime || null;
			this._resources = resources || {wood:0,wine:0,marble:0,glass:0,sulfur:0,gold:0};
			this._military = military || new MilitaryUnits();
			this._ships = ships || null;
			this._eventid = eventid || null;
			this._queuedTime = queuedTime || 0;
			this._updatedCity = false;
			this._complete = false;
			this._updateTimer = null;
		}
	}
	Movement.prototype = {
		startUpdateTimer: function()
		{
			this.clearUpdateTimer();
			if(this.isCompleted)
			{
				this.updateTransportComplete();
			}
			else
			{
				this._updateTimer = events.scheduleActionAtTime(this.updateTransportComplete.bind(this),this._arrivalTime+1000);
			}
		},
		clearUpdateTimer: function()
		{
			var ret = !this._updateTimer || this._updateTimer();
			this._updateTimer = null;
			return ret;
		},
		get getId() { return this._id; },
		get getEventId() { return this._eventid; },
		get getOriginCityId() { return this._originCityId; },
		get getTargetCityId() { return this._targetCityId; },
		get getArrivalTime() { return this._arrivalTime; },
		get getMission() { return this._mission; },
		get getLoadingTime() { return this._loadingTime - $.now(); },// includes the queuedtime
		get getQueuedTime() { return this._loadingTime - this._queuedTime; },
		get getResources() { return this._resources; },
		getResource: function(resourceName) { return this._resources[resourceName]; },
		get getMilitary() { return this._military; },
		get getShips() { return this._ships; },
		get getCapacityPerShip()
		{
			var a = Object.values(this._resources).reduce((a,b)=>a+b);
			return Math.ceil(a/this._ships);
		},
		get isCompleted() { return this._arrivalTime < $.now(); },
		get isLoading() { return this._loadingTime > $.now(); },
		get isQueued() { return this._queuedTime > $.now(); },
		get getRemainingTime() { return this._arrivalTime - $.now(); },
		updateTransportComplete: function()
		{
			if(this.isCompleted && !this._updatedCity)
			{
				var city = database.getCityFromId(this._targetCityId);
				var changes = [];
				if(city)
				{
					for(var resource in Constant.Resources)
					{
						if(this.getResource(Constant.Resources[resource]))
						{
							changes.push(Constant.Resources[resource]);
						}
						city.getResource(Constant.Resources[resource]).increment(this.getResource(Constant.Resources[resource]));
					}
					this._updatedCity = true;
					city = database.getCityFromId(this.originCityId);
					if(city)
					{
						city.updateActionPoints(city.getAvailableActions+1);
					}
					if(changes.length)
					{
						events(Constant.Events.MOVEMENTS_UPDATED).pub([this.getTargetCityId]);
						events(Constant.Events.RESOURCES_UPDATED).pub(this.getTargetCityId,changes);
					}
					events.scheduleAction(function() { database.getGlobalData.removeFleetMovement(this._id); }.bind(this));
					return true;
				}
			}
			else if(this._updatedCity)
			{
				events.scheduleAction(function() { database.getGlobalData.removeFleetMovement(this._id); }.bind(this));
			}
			return false;
		}
	};
	function Resource(city,name)
	{
		this._current = 0;
		this._production = 0;
		this._consumption = 0;
		this._currentChangedDate = $.now();
		this.city = Utils.wrapInClosure(city);
		this._name = name;
		this.currlevel = 0;
		this.branchOffice = 0;
		return this;
	}
	Resource.prototype = {
		get name() { return this._name; },
		update: function(current,production,consumption,currlevel,branchOffice)
		{
			var changed = (current % this._current > 10) || (production != this._production) || (consumption != this._consumption) || (currlevel != this.currlevel) || (branchOffice != this.branchOffice);
			this._current = current;
			this._production = production;
			this._consumption = consumption;
			this._currentChangedDate = $.now();
			this.currlevel = currlevel;
			this.branchOffice = branchOffice;
			return changed;
		},
		project: function()
		{
			var limit = Math.floor($.now() / 1000);
			var start = Math.floor(this._currentChangedDate / 1000);
			while(limit > start)
			{
				this._current += this._production;
				if(Math.floor(start / 3600) != Math.floor((start + 1) / 3600))
				{
					if(this._current > this._consumption)
					{
						this._current -= this._consumption;
					} else {
						this.city().projectPopData(start * 1000);
						this._consumption = 0;
					}
				}
				start++;
			}
			this._currentChangedDate = limit * 1000;
			this.city().projectPopData(limit * 1000);
		},
		increment: function(amount)
		{
			if(amount !== 0)
			{
				this._current += amount;
				return true;
			}
			return false;
		},
		get getEmptyTime()
		{
			var net = this.getProduction * 3600 - this.getConsumption;
			return (net < 0) ? this.getCurrent / net * -1 : Infinity;
		},
		get getFullTime()
		{
			var net = this.getProduction * 3600 - this.getConsumption;
			return (net > 0) ? (this.city().maxResourceCapacities.capacity - this.getCurrent) / net : 0;
		},
		get getCurrent() { return Math.floor(this._current); },
		get getProduction() { return this._production || 0; },
		get getConsumption() { return Math.round(this._consumption) || 0; },
		get getCurrLevel() { return this.currlevel || 0; },
		get getbranchOffice() { return this.branchOffice || 0; }
	};
	function Military(city)
	{
		this.city = Utils.wrapInClosure(city);
		this._units = new MilitaryUnits();
		this._advisorLastUpdate = 0;
		this.armyTraining = [];
		this._trainingTimer = null;
	}
	Military.prototype = {
		init: function()
		{
			this._trainingTimer = null;
			this._startTrainingTimer();
		},
		_getTrainingTotals: function()
		{
			var ret = {};
			$.each(this.armyTraining,function(index,training)
			{
				$.each(Constant.UnitData,function(unitId,info)
				{
					ret[unitId] = ret[unitId]?ret[unitId]+(training.units[unitId]||0):training.units[unitId]||0;
				});
			});
			return ret;
		},
		get getTrainingTotals()
		{
			if(!this._trainingTotals)
			{
				this._trainingTotals = Utils.cacheFunction(this._getTrainingTotals.bind(this),1000);
			}
			return this._trainingTotals();
		},
		_getIncomingTotals: function()
		{
			var ret = {};
			$.each(this.city().getIncomingMilitary, function(index,element)
			{
				for(var unitName in Constant.UnitData)
				{
					ret[unitName] = ret[unitName] ? ret[unitName]+(element.getMilitary.totals[unitName]||0) : element.getMilitary.totals[unitName]||0;
				}
			});
			return ret;
		},
		get getIncomingTotals()
		{
			if(!this._incomingTotals) { this._incomingTotals = Utils.cacheFunction(this._getIncomingTotals.bind(this),1000); }
			return this._incomingTotals();
		},
		getTrainingForUnit: function(unit)
		{
			var ret = [];
			$.each(this.armyTraining,function(index,training)
			{
				$.each(training.units,function(unitId,count)
				{
					if(unitId===unit)
					{
						ret.push({count:count,time:training.completionTime});
					}
				});
			});
			return ret;
		},
		setTraining: function(trainingQueue)
		{
			if(!trainingQueue.length) return false;
			this._stopTrainingTimer();
			var type = trainingQueue[0].type;
			var changes = this._clearTrainingForType(type);
			$.each(trainingQueue, function(index,training)
			{
				this.armyTraining.push(training);
				$.each(training.units, function(unitId,count)
				{
					changes.push(unitId);
				});
			}.bind(this));
			this.armyTraining.sort(function(a,b)
			{
				return a.completionTime-b.completionTime;
			});
			this._startTrainingTimer();
			return $.exclusive(changes);
		},
		_clearTrainingForType: function(type)
		{
			var oldTraining = this.armyTraining.filter(function(item) { return item.type === type; });
			this.armyTraining = this.armyTraining.filter(function(item) { return item.type !== type; });
			var changes = [];
			$.each(oldTraining,function(index,training){$.each(training.units,function(unitId,count){changes.push(unitId);});});
			return changes;
		},
		_completeTraining: function()
		{
			if(this.armyTraining.length)
			{
				if(this.armyTraining[0].completionTime<$.now()+5000)
				{
					var changes = [];
					var training = this.armyTraining.shift();
					$.each(training.units, function(id,count)
					{
						this.getUnits.addUnit(id, count);
						changes.push(id);
					}.bind(this));
					if(changes.length)events(Constant.Events.MILITARY_UPDATED).pub(this.city().getId, changes);
				}
			}
			this._startTrainingTimer();
		},
		_startTrainingTimer: function()
		{
			this._stopTrainingTimer();
			if(this.armyTraining.length)
			{
				this._trainingTimer = events.scheduleActionAtTime(this._completeTraining.bind(this),this.armyTraining[0].completionTime);
			}
		},
		_stopTrainingTimer: function()
		{
			if(this._trainingTimer)
			{
				this._trainingTimer();
			}
			this._trainingTimer = null;
		},
		updateUnits: function(counts)
		{
			var changes = [];
			$.each(counts, function(unitId,count) {if(this._units.setUnit(unitId,count)) { changes.push(unitId); }}.bind(this));
			return changes;
		},
		get getUnits() { return this._units; }
	};
	function MilitaryUnits(obj) { this._units = obj !== undefined ? obj._units: {}; }
	MilitaryUnits.prototype = {
		getUnit: function(unitId) { return this._units[unitId] || 0; },
		setUnit: function(unitId,count)
		{
			var changed = this._units[unitId] != count;
			this._units[unitId] = count;
			return changed;
		},
		get totals() { return this._units; },
		addUnit: function(unitId, count) { return this.setUnit(unitId, this.getUnit(unitId) + count); },
		removeUnit: function(unitId,count) { return this.setUnit(unitId,Math.max(0,this.getUnit[unitId]-count)); }
	};
	function Building(city, pos) {
		this._position = pos;
		this._level = 0;
		this._name = null;
		this.city = Utils.wrapInClosure(city);
		this._updateTimer = null;
	}
	Building.prototype = {
		startUpgradeTimer: function()
		{
			if(this._updateTimer)
			{
				this._updateTimer();
				delete this._updateTimer;
			}
			if(this._completionTime)
			{
				if(this._completionTime-$.now() < 5000)
				{
					this.completeUpgrade();
				}
				else
				{
					this._updateTimer = events.scheduleActionAtTime(this.completeUpgrade.bind(this),this._completionTime-4000);
				}
			}
			var statusPoll = function(a,b)
			{
				return events.scheduleActionAtInterval(function()
				{
					if(a!=this.isUpgradable || b!=this.isUpgrading)
					{
						var changes = {position:this._position,name:this.getName,upgraded:this.isUpgrading!=b};
						events(Constant.Events.BUILDINGS_UPDATED).pub([changes]);
						a = this.isUpgradable;
						b = this.isUpgrading;
					}
				}.bind(this),3000);
			}(this.isUpgradable,this.isUpgrading);
		},
		update: function(data)
		{
			var changes;
			var name = data.building.split(' ')[0];
			var level = parseInt(data.level) || 0;
			var completion = ('undefined' !== typeof data.completed) ? parseInt(data.completed) : 0;
			var changed = (name !== this._name || level !== this._level || !!completion != this.isUpgrading); // todo
			if(changed) { changes = {position:this._position,name:this.getName,upgraded:this.isUpgrading!=!completion}; }
			if(completion)
			{
				this._completionTime = completion*1000;
				this.startUpgradeTimer();
			}
			else if(this._completionTime) { delete this._completionTime; }
			this._name = name;
			this._level = level;
			if(changed) { return changes; }
			return false;
		},
		get getUrlParams() { return {view:this.getName,cityId:this.city().getId,position:this.getPosition}; },
		get getUpgradeCost()
		{
			var carpenter, architect, vineyard, fireworker, optician;
			var level = this._level+this.isUpgrading;
			if(this.isEmpty) { return {wood:Infinity,glass:0,marble:0,sulfur:0,wine:0,time:0}; }
			var time = Constant.BuildingData[this._name].time;
			var bon = 1;
			var bonTime = 1 + Constant.GovernmentData[database.getGlobalData.getGovernmentType].buildingTime;
			bon -= database.getGlobalData.getResearchTopicLevel(Constant.Research.Economy.PULLEY) ? 0.02 : 0;
			bon -= database.getGlobalData.getResearchTopicLevel(Constant.Research.Economy.GEOMETRY) ? 0.04 : 0;
			bon -= database.getGlobalData.getResearchTopicLevel(Constant.Research.Economy.SPIRIT_LEVEL) ? 0.08 : 0;
			return {
				wood:Math.floor((Constant.BuildingData[this._name].wood[level]||0)*(bon-(carpenter=this.city().getBuildingFromName(Constant.Buildings.CARPENTER),carpenter?carpenter.getLevel/100:0))),
				wine:Math.floor((Constant.BuildingData[this._name].wine[level]||0)*(bon-(vineyard=this.city().getBuildingFromName(Constant.Buildings.VINEYARD),vineyard?vineyard.getLevel/100:0))),
				marble:Math.floor((Constant.BuildingData[this._name].marble[level]||0)*(bon-(architect=this.city().getBuildingFromName(Constant.Buildings.ARCHITECT),architect?architect.getLevel/100:0))),
				glass:Math.floor((Constant.BuildingData[this._name].glass[level]||0)*(bon-(optician= this.city().getBuildingFromName(Constant.Buildings.OPTICIAN),optician?optician.getLevel/100:0))),
				sulfur:Math.floor((Constant.BuildingData[this._name].sulfur[level]||0)*(bon-(fireworker= this.city().getBuildingFromName(Constant.Buildings.FIREWORK_TEST_AREA),fireworker?fireworker.getLevel/100:0))),
				time:((this._name==Constant.Buildings.PIRATE_FORTRESS?time[level]:Math.round(time.a/time.b*Math.pow(time.c,level+1)-time.d))-(time.e!=undefined?(time.e[level]!=undefined?time.e[level]:0):0))*1000*bonTime
			};
		},
		get getName() { return this._name; },
		get getType() { return Constant.BuildingData[this.getName].type; },
		get getLevel() { return this._level; },
		get isEmpty() { return this._name == 'buildingGround' || this._name === null; },
		get isUpgrading() { return (this._completionTime > $.now()); },
		subtractUpgradeResourcesFromCity: function()
		{
			var cost = this.getUpgradeCost;
			$.each(Constant.Resources,function(key,resourceName){this.city().getResource(resourceName).increment(cost[resourceName]*-1);}.bind(this));
			this._completionTime = $.now()+cost.time;
		},
		get isUpgradable()
		{
			if(this.isEmpty || this.noNeedToUpgrade || this.isMaxLevel) { return false; }
			var cost = this.getUpgradeCost;
			var upgradable = true;
			$.each(Constant.Resources,function(key,value)
			{
				upgradable = upgradable && (!cost[value] || cost[value] <= this.city().getResource(value).getCurrent);
			}.bind(this));
			return upgradable;
		},
		get getCompletionTime() { return this._completionTime; },
		get getCompletionDate() { },
		get noNeedToUpgrade() { return Constant.BuildingData[this.getName].maxLevel === this.getLevel+1 && this.isUpgrading; },
		get isMaxLevel() { return Constant.BuildingData[this.getName].maxLevel === this.getLevel; },
		get getPosition() { return this._position; },
		completeUpgrade: function()
		{
			this._level++;
			delete this._completionTime;
			delete this._updateTimer;
			events(Constant.Events.BUILDINGS_UPDATED).pub(this.city().getId,[{position:this._position,name:this.getName,upgraded:true}]);
		}
	};
	function CityResearch(city)
	{
		this._researchersLastUpdate = 0;
		this._researchers = 0;
		this._researchCostLastUpdate = 0;
		this._researchCost = 0;
		this.city = Utils.wrapInClosure(city);
	}
	CityResearch.prototype = {
		updateResearchers: function(researchers)
		{
			var changed = this._researchers !== researchers;
			this._researchers = researchers;
			this._researchersLastUpdate = $.now();
			this._researchCost = this.getResearchCost;
			return changed;
		},
		updateCost: function(cost)
		{
			var changed = this._researchCost !== cost;
			this._researchCost = cost;
			this._researchCostLastUpdate = $.now();
			this._researchers = this.getResearchers;
			return changed;
		},
		get getResearchers()
		{
			return this._researchersLastUpdate<this._researchCostLastUpdate ? Math.floor(this._researchCost/this._researchCostModifier) : this._researchers;
		},
		get getResearch() { return this.researchData.total; },
		get researchData()
		{ 
			if(!this._researchData)
			{
				this._researchData = Utils.cacheFunction(this.researchDataCached.bind(this),1000);
			}
			return this._researchData();
		},
		researchDataCached: function()
		{
			var resBon = 0+(database.getGlobalData.getResearchTopicLevel(Constant.Research.Science.PAPER)*0.02)+(database.getGlobalData.getResearchTopicLevel(Constant.Research.Science.INK)*0.04)+(database.getGlobalData.getResearchTopicLevel(Constant.Research.Science.MECHANICAL_PEN)*0.08)+(database.getGlobalData.getResearchTopicLevel(Constant.Research.Science.SCIENTIFIC_FUTURE)*0.02);
			var premBon = parseFloat(database.getGlobalData.hasPremiumFeature(Constant.Premium.RESEARCH_POINTS_BONUS) ? Constant.PremiumData[Constant.Premium.RESEARCH_POINTS_BONUS].bonus : 0);
			var goods = Constant.GovernmentData[database.getGlobalData.getGovernmentType].researchPerCulturalGood*this.city()._culturalGoods;
			var researchers = this.getResearchers;
			var corruptionSpend = researchers * this.city().getCorruption;
			var nonCorruptedResearchers = researchers * (1 - this.city().getCorruption);
			var premiumResBonus = nonCorruptedResearchers * premBon;
			var researchBonus = nonCorruptedResearchers * resBon;
			var premiumGoodsBonus = goods * premBon;
			var serverTyp = ikariam.Server()=='s201' || ikariam.Server()=='s202' ? 3 : 1;
			return {
				scientists: researchers,
				researchBonus: researchBonus,
				premiumScientistBonus: premiumResBonus,
				premiumResearchBonus: (researchBonus*premBon),
				culturalGoods: goods,
				premiumCulturalGoodsBonus: premiumGoodsBonus,
				corruption: corruptionSpend,
				total: ((nonCorruptedResearchers+researchBonus+premiumResBonus+goods+premiumGoodsBonus+(researchBonus*premBon))*Constant.GovernmentData[database.getGlobalData.getGovernmentType].researchBonus)*serverTyp
			};
		},
		get _researchCostModifier()
		{
			var serverTyp = 1;
			if (ikariam.Server() == 's201' || ikariam.Server() == 's202') serverTyp = 3;
			return (6+Constant.GovernmentData[database.getGlobalData.getGovernmentType].researcherCost-(database.getGlobalData.getResearchTopicLevel(Constant.Research.Science.LETTER_CHUTE)*3))*serverTyp;
		},
		get getResearchCost() { return this.getResearchers * this._researchCostModifier; }
	};
	function Changes(city,type,changes)
	{
		this.city = city || null;
		this.type = type || null;
		this.changes = changes || [];
	}
	function Population(city)
	{
		this._population = 0;
		this._citizens = 0;
		this._resourceWorkers = 0;
		this._tradeWorkers = 0;
		this._priests = 0;
		this._culturalGoods = 0;
		this._popChanged = $.now();
		this._citizensChanged = $.now();
		this._culturalGoodsChanged = $.now();
		this._priestsChanged = $.now();
		this.city = Utils.wrapInClosure(city);
	}
	Population.prototype = {
		updatePopulationData: function(population,citizens,priests,culturalGoods)
		{
			var changes = [];
			if(population && population != this._population)
			{
				changes.push({population:true});
				this.population = population;
			}
			if(citizens && citizens != this._priests)
			{
				changes.push({citizens:true});
				this.citizens = citizens;
			}
			if(priests && priests != this._priests) {
				changes.push({priests: true});
				this.priests = priests;
			}
			if(culturalGoods && culturalGoods != this._culturalGoods) {
				changes.push({culturalGoods:true});
				this.culturalGoods = culturalGoods;
			}
		},
		updateWorkerData: function(resourceName,workers) { },
		updatePriests: function(newCount) { },
		updateCulturalGoods: function(newCount) { },
		get population() { return this._population; },
		set population(newVal)
		{
			this._population = newVal;
			this._popChanged = $.now();
		},
		get citizens() { return this._citizens; },
		set citizens(newVal)
		{
			this._citizens = newVal;
			this._citizensChanged = $.now();
		},
		get priests() { return this._priests;
		},
		set priests(newVal)
		{
			this._priests = newVal;
			this._priestsChanged = $.now();
		}
	};
	function City(id)
	{
		this._id = id || 0;
		this._name = '';
		this._resources = {
			gold: new Resource(this,Constant.Resources.GOLD),
			wood: new Resource(this,Constant.Resources.WOOD),
			wine: new Resource(this,Constant.Resources.WINE),
			marble: new Resource(this,Constant.Resources.MARBLE),
			glass: new Resource(this,Constant.Resources.GLASS),
			sulfur: new Resource(this,Constant.Resources.SULFUR)
		};
		this._capacities = {
			capacity: 0,
			safe: 0,
			buildings:
			{
				dump:{storage:0,safe:0},
				warehouse:{storage:0,safe:0},
				townHall:{storage:2500,safe:100}
			},
			branchOffice:{storage:0,safe:0},
			invalid:true
		};
		this._tradeGoodID = 0;
		this.knownTime = $.now();
		this._lastPopUpdate = $.now();
		this._buildings = new Array(unsafeWindow.ikariam.backgroundView.screen.data.position.length); // unsafeWindow.ikariam.backgroundView.screen.data.position.length
		var i = this._buildings.length;
		while(i--) { this._buildings[i] = new Building(this, i); }
		this._research = new CityResearch(this);
		this.actionPoints = 0;
		this._actionPoints = 0;
		this._spies = {ondefense:0,inmission:0};
		this.maxSci = 0;
		this._coordinates = {x:0,y:0};
		this._islandID = null;
		this.population = new Population(this);
		this._population = 0;
		this._citizens = 0;
		this._resourceWorkers = 0;
		this._tradeWorkers = 0;
		this._priests = 0;
		this._culturalGoods = 0;
		this._military = new Military(this);
		this._wonder = {id:0,level:0,endUpgradeTime:0,donatedResources:0,faithlevel:0,curislandfaith:0,maxislandfaith:0,islandshare:0,submittime:0};
		this._forest = {level:0,workers:0,endUpgradeTime:0,donatedResources:0,curwood:0,maxwood:0};
		this._mine = {level:0,workers:0,endUpgradeTime:0,donatedResources:0,curwood:0,maxwood:0};
		this.fleetMovements = {};
		this.militaryMovements = {};
		this.unitBuildList = [];
		this.goldIncome = 0;
		this.goldExpend = 0;
		this._pop = {currentPop:0,maxPop:0,satisfaction:{city:196,museum:{cultural:0,level:0},government:0,tavern:{wineConsumption:0,level:0},research:0,priest:0,total:0},happiness:0,growth:0};
		events('updateCityData').sub(this.updateCityDataFromAjax.bind(this));
		events('updateBuildingData').sub(this.updateBuildingsDataFromAjax.bind(this));
	}
	City.prototype = {
		init: function()
		{
			$.each(this._buildings,function(idx,building) { building.startUpgradeTimer(); });
			this.military.init();
			$.each(this._resources,function(resourceName,resource) { resource.project(); });
			events.scheduleActionAtInterval(function()
			{
				$.each(this._resources, function(resourceName,resource) { resource.project(); }.bind(this));
			}.bind(this),1000);
		},
		projectResource: function(seconds) { },
		updateBuildingsDataFromAjax: function(id,position)
		{
			var changes = [];
			if(id==this.getId && ikariam.viewIsCity)
			{
				if(position)
				{
					$.each(position,function(i,item)
					{
						var change = this.getBuildingFromPosition(i).update(item);
						if(change) changes.push(change);
					}.bind(this));
					if(changes.length)
					{
						this._capacities.invalid = true;
						events(Constant.Events.BUILDINGS_UPDATED).pub(id,changes);
					}
				}
			}
		},
		updateCityDataFromAjax: function(id,cityData)
		{
			var resourcesChanged = false;
			var changes = {};
			if(id==this.getId)
			{
				try
				{
					var wineUse = Constant.BuildingData[Constant.Buildings.TAVERN]['wineUse'+(ikariam.Server()=='s202' ? 2 :'')];
					var L = this.getBuildingFromName(Constant.Buildings.VINEYARD)?this.getBuildingFromName(Constant.Buildings.VINEYARD).getLevel:0;
					var wc = parseInt($('#js_GlobalMenu_WineConsumption').text());
					var bc = Math.round(wc*(100/(100-L)));
					var ws = cityData.wineSpendings;
					var bcmax = Math.max(bc,ws);
					var baseWineConsumption = 0, wineConsumption = 0, currlevel = 0;
					for(var i=0;i<wineUse.length;i++) { if(Math.abs(wineUse[i]-bcmax)<=1) { break; } }
					currlevel = i;
					wineConsumption = wineUse[i]*((100-L)/100);
					this.updateTradeGoodID(parseInt(cityData.producedTradegood));
					for(k in Constant.Resources)
					{
						if(k!='GOLD')
						{
							if(k=='WOOD')
							{
								resourcesChanged = this.updateResource(Constant.Resources[k],cityData.currentResources[Constant.ResourceIDs[k]],cityData.resourceProduction,0,0,parseInt(cityData.branchOfficeResources['resource'])) || resourcesChanged;
							}
							else
							{
								resourcesChanged = this.updateResource(Constant.Resources[k],cityData.currentResources[Constant.ResourceIDs[k]],this.getTradeGoodID==Constant.ResourceIDs[k]?cityData.tradegoodProduction:0,k=='WINE'?wineConsumption:0,k=='WINE'?currlevel:0,parseInt(cityData.branchOfficeResources[Constant.ResourceIDs[k]])) || resourcesChanged;
							}
						}
					}
					this.knownTime = $.now();
					var $actionPointElem = $('#js_GlobalMenu_maxActionPoints');
					changes.actionPoints = cityData.maxActionPoints ? this.updateActionPoints(cityData.maxActionPoints || 0) : this.updateActionPoints(parseInt($actionPointElem.text()) || 0);
					changes.coordinates = this.updateCoordinates(parseInt(cityData.islandXCoord),parseInt(cityData.islandYCoord));
					if(ikariam.viewIsCity)
					{
						changes.name = this.updateName(cityData.name);
						changes.population = this.updatePopulation(cityData.currentResources.population);
						changes.islandId = this.updateIslandID(parseInt(cityData.islandId));
						changes.coordinates = this.updateCoordinates(parseInt(cityData.islandXCoord),parseInt(cityData.islandYCoord));
					}
					if(ikariam.viewIsIsland)
					{
						changes.islandId = this.updateIslandID(parseInt(cityData.id));
						changes.coordinates = this.updateCoordinates(parseInt(cityData.xCoord),parseInt(cityData.yCoord));
						changes.forest = this.updateForest({level:parseInt(cityData.resourceLevel),endUpgradeTime:parseInt(cityData.resourceEndUpgradeTime)});
						changes.mine = this.updateMine({level:parseInt(cityData.tradegoodLevel),endUpgradeTime:parseInt(cityData.tradegoodEndUpgradeTime)});
					}
//					console.log(cityData.currentResources.citizens);
					changes.citizens = this.updateCitizens(parseFloat(cityData.currentResources.citizens));
					if(cityData.gold) { database.getGlobalData.finance.currentGold = parseFloat(cityData.gold); }
				}
				catch(e) { empire.error('fetchCurrentCityData', e); }
				finally { cityData = null; }
				events(Constant.Events.CITY_UPDATED).pub(this.getId,changes);
				if(resourcesChanged) { events(Constant.Events.RESOURCES_UPDATED).pub(this.getId, resourcesChanged); }
			}
//			console.log(cityData.branchOfficeResources.resource);
		},
		get getCorruption()
		{
			if(typeof this._corruption != "function")
			{
				this._corruption = Utils.cacheFunction(function()
				{
					var h = 0;
					if(this.getBuildingFromName(Constant.Buildings.GOVERNORS_RESIDENCE) && (this.getBuildingFromName(Constant.Buildings.GOVERNORS_RESIDENCE).getLevel/database.getCityCount!=1))
					{
						h = Constant.GovernmentData[database.getGlobalData.getGovernmentType].governors;
					}
					return Math.max(0,1-((this.getBuildingFromName(Constant.Buildings.GOVERNORS_RESIDENCE)?this.getBuildingFromName(Constant.Buildings.GOVERNORS_RESIDENCE).getLevel:this.getBuildingFromName(Constant.Buildings.PALACE) ? this.getBuildingFromName(Constant.Buildings.PALACE).getLevel:0)+1)/database.getCityCount + Constant.GovernmentData[database.getGlobalData.getGovernmentType].corruption+h);
				}.bind(this),1000);
			}
			return this._corruption();
		},
		get isCurrentCity() { return this.getId == ikariam.CurrentCityId; },
		getResource: function(name) { return this._resources[name]; },
		updateResource: function(resourceName,current,production,consumption,currlevel,branchOffice)
		{
			return this.getResource(resourceName).update(current,production,consumption,currlevel,branchOffice);
		},
		get getIncome()
		{
			var serverTyp = ikariam.Server() == 's202'? 3 : 1;
			var priestsGold = Math.floor(this._priests*Constant.GovernmentData[database.getGlobalData.getGovernmentType].goldBonusPerPriest);
			return this._citizens*3*serverTyp+priestsGold;
		},
		updateIncome: function(value)
		{
			//if(Math.abs(this._citizens-value/3)>2) { return this.updateCitizens((value/3)) }
			return false;
		},
		get getExpenses() { return -1*this._research.getResearchCost; },
		updateExpenses: function(value) { return this._research.updateCost(Math.abs(value)); },
		get getBuildings() { return this._buildings; },
		getBuildingsFromName: function(name)
		{
			var ret = [];
			var i = this._buildings.length;
			while(i--) { if(this._buildings[i].getName == name) ret.push(this._buildings[i]); }
			return ret;
		},
		getBuildingFromName: function(name)
		{
			var i = this._buildings.length;
			while(i--)
			{
				if(this._buildings[i].getName == name) { return this._buildings[i]; }
			}
			return null;
		},
		getBuildingFromPosition	: function(position) { return this._buildings[position]; },
		getWonder : function() {
			var i = 7;
			ikariam.wonder();
			return i;
		},
		get getTradeGood()
		{
			for(var resourceName in Constant.ResourceIDs)
			{
				if(this._tradeGoodID == Constant.ResourceIDs[resourceName])
				{
					return Constant.Resources[resourceName];
				}
			}
			return null;
		},
		get getTradeGoodID() { return this._tradeGoodID; },
		updateTradeGoodID: function(value)
		{
			var changed = this._tradeGoodID != value;
			if(changed) { this._tradeGoodID = value; }
			return changed;
		},
		updatePriests: function(priests)
		{
			var changed = this._priests != priests;
			this._priests = priests;
			return changed;
		},
		get getName() { return this._name; },
		updateName: function(value)
		{
			var changed = this._name != value;
			if(changed) { this._name = value; }
			return changed;
		},
		get getId() { return this._id; },
		get research() { return this._research; },
		updateResearchers: function(value) { return this._research.updateResearchers(value); },
		updateResearchCost: function(value) { return this._research.updateCost(value); },
		get garrisonland() { return 250+((this.getBuildingFromName(Constant.Buildings.TOWN_HALL) ? this.getBuildingFromName(Constant.Buildings.TOWN_HALL).getLevel : 0)+(this.getBuildingFromName(Constant.Buildings.WALL) ? this.getBuildingFromName(Constant.Buildings.WALL).getLevel : 0))*50; },
		get garrisonsea() { return 125+Math.max(this.getBuildingFromName(Constant.Buildings.TRADING_PORT) ? this.getBuildingFromName(Constant.Buildings.TRADING_PORT).getLevel : 0,this.getBuildingFromName(Constant.Buildings.SHIPYARD) ? this.getBuildingFromName(Constant.Buildings.SHIPYARD).getLevel : 0)*25; },
		get plundergold() { return this.getBuildingFromName(Constant.Buildings.PALACE) || database.getCityCount == 1 ? Math.floor(this.getBuildingFromName(Constant.Buildings.TOWN_HALL).getLevel)*950 : 0;	},
		get maxculturalgood() { return this.getBuildingFromName(Constant.Buildings.MUSEUM) ? this.getBuildingFromName(Constant.Buildings.MUSEUM).getLevel : 0; },
		get maxtavernlevel() { return this.getBuildingFromName(Constant.Buildings.TAVERN) ? this.getBuildingFromName(Constant.Buildings.TAVERN).getLevel : 0; },
		get tavernlevel()
		{
			var wineUse, i;
			if(this.getResource(Constant.Resources.WINE).getCurrLevel)
			{
				i = this.getResource(Constant.Resources.WINE).getCurrLevel;
			}
			else if(this.getBuildingFromName(Constant.Buildings.TAVERN))
			{
				wineUse = Constant.BuildingData[Constant.Buildings.TAVERN].wineUse;
				if(ikariam.Server() == 's202') { wineUse = Constant.BuildingData[Constant.Buildings.TAVERN].wineUse2; }
				var consumption = Math.floor(this.getResource(Constant.Resources.WINE).getConsumption*(100/(100-(this.getBuildingFromName(Constant.Buildings.VINEYARD) ? this.getBuildingFromName(Constant.Buildings.VINEYARD).getLevel : 0))));
				for(var i=0;i<wineUse.length;i++) { if(Math.abs(wineUse[i]-consumption)<=1) { break; } }
			}
			//	return i > 0 ? i : '';
			return this.getResource(Constant.Resources.WINE).getCurrLevel;
		},
		get CorruptionCity() { return Math.floor((Math.max(0,1-((this.getBuildingFromName(Constant.Buildings.GOVERNORS_RESIDENCE)?this.getBuildingFromName(Constant.Buildings.GOVERNORS_RESIDENCE).getLevel:this.getBuildingFromName(Constant.Buildings.PALACE)?this.getBuildingFromName(Constant.Buildings.PALACE).getLevel:0)+1)/database.getCityCount+Constant.GovernmentData[database.getGlobalData.getGovernmentType].corruption)+(this.getBuildingFromName(Constant.Buildings.GOVERNORS_RESIDENCE) && (this.getBuildingFromName(Constant.Buildings.GOVERNORS_RESIDENCE).getLevel/database.getCityCount!=1) ? Constant.GovernmentData[database.getGlobalData.getGovernmentType].governors : 0))*100); },
		get maxAP() { return Constant.BuildingData[Constant.Buildings.TOWN_HALL].actionPointsMax[this.getBuildingFromName(Constant.Buildings.TOWN_HALL) ? this.getBuildingFromName(Constant.Buildings.TOWN_HALL).getLevel : 0]; },
		get maxSci() { return Constant.BuildingData[Constant.Buildings.ACADEMY].maxScientists[this.getBuildingFromName(Constant.Buildings.ACADEMY) ? this.getBuildingFromName(Constant.Buildings.ACADEMY).getLevel : 0] || ''; },
		get iSci () { return this.getBuildingFromName(Constant.Buildings.ACADEMY) ? 0 : ''; },
		get storageCapacity() { return null; },
		get getAvailableActions() { return this._actionPoints; },
		updateActionPoints: function(value)
		{
			var changed = this._actionPoints != value;
			this._actionPoints = value;
			return changed;
		},
		get getSpies() { return this._spies; },
		updateSpies: function(spies)
		{
			this._spies = $.extend(this.getSpies,spies);
			return false;
		},
		get getPirates() { return this._pirates; },
		updatePirates: function(pirates)
		{
			this._pirates = $.extend(this.getPirates,pirates);
			return false;
		},
		get getCoordinates()
		{
			return (this._coordinates ? [this._coordinates.x,this._coordinates.y] : null);
		},
		updateCoordinates: function(x,y)
		{
			this._coordinates = {x:x,y:y};
			return false;
		},
		get getIslandID() { return this._islandID; },
		get getWonder() { return this._wonder; },
		get getForest() { return this._forest; },
		get getMine() { return this._mine; },
		updateIslandID: function(id)
		{
			this._islandID = id;
			return false;
		},
		updateWonder: function(wonder)
		{
			this._wonder = $.extend(this.getWonder,wonder);
			return false;
		},
		updateForest: function(forest)
		{
			var changed = this._forest !== forest ? forest : this._forest;
			if(changed)
			{
				this._forest = $.extend(this._forest,forest);
			}
			return changed;
		},
		updateMine: function(mine)
		{
			var changed = this._mine !== mine ? mine : this._mine;
			if (changed)
			{
				this._mine = $.extend(this._mine,mine);
			}
			return changed;
		},
		get getCulturalGoods() { return this._culturalGoods; },
		updateCulturalGoods: function(value)
		{
			var changed = this._culturalGoods !== value;
			if (changed)
			{
				this._culturalGoods = value;
			}
			return changed;
		},
		get getIncomingResources() { return database.getGlobalData.getResourceMovementsToCity(this.getId); },
		get getIncomingMilitary() { return database.getGlobalData.getMilitaryMovementsToCity(this.getId); },
		get _getMaxPopulation() { return (this.getBuildingFromName(Constant.Buildings.TOWN_HALL) ? Math.floor((10*Math.pow(this.getBuildingFromName(Constant.Buildings.TOWN_HALL).getLevel, 1.5)))*2+40 : 0)+(database.getGlobalData.getResearchTopicLevel(Constant.Research.Science.WELL_CONSTRUCTION) && (this.getBuildingFromName(Constant.Buildings.PALACE) || database.getCityCount == 1) ? 50 : 0)+(database.getGlobalData.getResearchTopicLevel(Constant.Research.Economy.UTOPIA) && this.getBuildingFromName(Constant.Buildings.PALACE) ? 200 : 0)+(database.getGlobalData.getResearchTopicLevel(Constant.Research.Economy.HOLIDAY) ? 50 : 0)+(database.getGlobalData.getResearchTopicLevel(Constant.Research.Economy.ECONOMIC_FUTURE)*20); },
		get military() { return this._military; },
		get getAvailableBuildings()
		{
			var i = 18+database.getGlobalData.getResearchTopicLevel(Constant.Research.Economy.BUREACRACY)+database.getGlobalData.getResearchTopicLevel(Constant.Research.Seafaring.PIRACY);
			$.each(this.getBuildings, function(idx,building) { i -= !building.isEmpty; });
			return i-(database.settings.noPiracy.value && database.getGlobalData.getResearchTopicLevel(Constant.Research.Seafaring.PIRACY) ? 1 : 0);
		},
		get maxResourceCapacities()
		{
			if(!this._capacities.invalid) { return this._capacities; }
			var LD = Constant.LanguageData[database.settings.languageChange.value];
			var ret = {};
			ret[Constant.Buildings.DUMP] = {storage:0,safe:0,lang:LD.dump};
			ret[Constant.Buildings.WAREHOUSE] = {storage:0,safe:0,lang:LD.warehouse};
			ret[Constant.Buildings.TOWN_HALL] = {storage:2500,safe:100,lang:LD.townHall};
			$.each(this.getBuildingsFromName(Constant.Buildings.WAREHOUSE),function(i,building)
			{
				ret[Constant.Buildings.WAREHOUSE].storage += building.getLevel*8000;
				ret[Constant.Buildings.WAREHOUSE].safe += building.getLevel*480;
			});
			$.each(this.getBuildingsFromName(Constant.Buildings.DUMP),function(i,building)
			{
				ret[Constant.Buildings.DUMP].storage += building.getLevel*32000;
			});
			var capacity = 0;
			var safe = 0;
			for(var key in ret)
			{
				capacity += ret[key].storage;
				safe += ret[key].safe;
			}
			var branchstorage = this.isBranchOffice ? 400*Math.pow(this.getBuildingFromName(Constant.Buildings.TRADING_POST).getLevel,2) : 0;
			this._capacities = {
				capacity : capacity*(1+(database.getGlobalData.hasPremiumFeature(Constant.Premium.STORAGECAPACITY_BONUS)*Constant.PremiumData[Constant.Premium.STORAGECAPACITY_BONUS].bonus)),
				safe: safe*(1+(database.getGlobalData.hasPremiumFeature(Constant.Premium.SAFECAPACITY_BONUS) * Constant.PremiumData[Constant.Premium.SAFECAPACITY_BONUS].bonus)),
				buildings: ret,
				branchOffice:{storage:branchstorage,safe:this.isBranchOffice?safe*(1+(database.getGlobalData.hasPremiumFeature(Constant.Premium.SAFECAPACITY_BONUS) * Constant.PremiumData[Constant.Premium.SAFECAPACITY_BONUS].bonus)):0,lang:LD.branchOffice}
			};
			return this._capacities;
		},
		get _getSatisfactionData()
		{
			var r = {
				city:196,
				museum:{cultural:0,level:0},
				government:0,
				tavern:{wineConsumption:0,level:0},
				research:0,
				priest:0,
				total:0
			};
			if(this.getBuildingFromName(Constant.Buildings.MUSEUM))
			{
				var eventBonus = 0;
				r.museum.cultural = this.getCulturalGoods*50+eventBonus;
				r.museum.level = this.getBuildingFromName(Constant.Buildings.MUSEUM).getLevel*20;
			}
			r.government = Constant.GovernmentData[database.getGlobalData.getGovernmentType].happiness+(Constant.GovernmentData[database.getGlobalData.getGovernmentType].happinessWithoutTemple*(this.getBuildingFromName(Constant.Buildings.TEMPLE) == undefined)); //todo
			if(this.getBuildingFromName(Constant.Buildings.TAVERN))
			{
				var wineUse = Constant.BuildingData[Constant.Buildings.TAVERN]['wineUse'+(ikariam.Server()=='s202' ? 2 :'')];
				r.tavern.level = this.getBuildingFromName(Constant.Buildings.TAVERN).getLevel*12;
				r.tavern.wineConsumption = this.getResource(Constant.Resources.WINE).getCurrLevel*60;
			}
			r.research = (database.getGlobalData.getResearchTopicLevel(2080)*25)+(database.getGlobalData.getResearchTopicLevel(2999)*10)+(this.getBuildingFromName(Constant.Buildings.PALACE)?50*database.getGlobalData.getResearchTopicLevel(3010):0)+(this.getBuildingFromName(Constant.Buildings.PALACE)?200*database.getGlobalData.getResearchTopicLevel(2120):0)+(database.getCityCount==1?50*database.getGlobalData.getResearchTopicLevel(3010):0)-(this.getBuildingFromName(Constant.Buildings.PALACE) && database.getCityCount==1?50*database.getGlobalData.getResearchTopicLevel(3010):0);
			r.priest = this._priests*500/this._getMaxPopulation*Constant.GovernmentData[database.getGlobalData.getGovernmentType].happinessBonusWithTempleConversion;
			r.priest = (r.priest<=150?r.priest:150);
			r.city = 196;
			var total = 0;
			for(var n in r) {if(typeof r[n] === 'object') { for(var o in r[n]) { total += r[n][o]; } } else { total += r[n];}}
			r.total = total;
			r.corruption = Math.round(this._population+this._pop.happiness-total);
			return r;
		},
		updatePopulation: function(population)
		{
			var changed = this._population != population;
			this._population = population;
			this._lastPopUpdate = $.now();
			return changed;
		},
		updateCitizens: function(citizens)
		{
			var changed = this._citizens != citizens;
			this._citizens = citizens;
			this._lastPopUpdate = $.now();
			return changed;
		},
		projectPopData: function(untilTime)
		{
			var serverTyp = ikariam.Server() == 's201' || ikariam.Server() == 's202' ? 3 : 1;
			var plus = this._getSatisfactionData;
			var maxPopulation = this._getMaxPopulation;
			var happiness = (1 - this.getCorruption) * plus.total - this._population;
			var hours = ((untilTime - this._lastPopUpdate) / 3600000);
			var pop = this._population + happiness * (1 - Math.pow(Math.E, - (hours / 50)));
			pop = (pop > maxPopulation) ? this._population > maxPopulation ? this._population : maxPopulation : pop;
			happiness = ((1 - this.getCorruption) * plus.total - pop);
			this._citizens = this._citizens + pop - this._population;
			this._population = pop;
			this._lastPopUpdate = untilTime;
			var old = $.extend({}, this._pop);
			this._pop = {currentPop: pop, maxPop: maxPopulation, satisfaction: plus, happiness: happiness, growth: happiness * 0.02 * serverTyp};
			if(Math.floor(old.currentPop) != Math.floor(this._pop.currentPop) || Math.floor(old.maxPop) != Math.floor(this._pop.maxPop) || Math.floor(old.happiness) != Math.floor(this._pop.happiness))
			{
				events(Constant.Events.CITY_UPDATED).pub(this.getId, {population: true});
			}
		},
		get populationData() { return this._pop; },
		processUnitBuildList: function()
		{
			var newList = [];
			var j;
			for(var i=0;i<this.unitBuildList.length;i++)
			{
				var list = this.unitBuildList[i];
				if(list.completionTime <= $.now())
				{
					for(var uID in list.units) { j = this.army.length; }
					while(j)
					{
						j--;
						if(uID == this.army[j].id) { this.army[uID] += list.units[uID]; }
					}
				} else { newList.push(list); }
			}
			this.unitBuildList = newList;
		},
		clearUnitBuildList: function(type)
		{
			var newList = [];
			if(type) { for(var i=0;i<this.unitBuildList.length;i++) { if(this.unitBuildList[i].type != type) { newList.push(this.unitBuildList[i]); } } }
			this.unitBuildList = newList;
		},
		getUnitBuildsByUnit: function()
		{
			var ret = {};
			for(var i=0;i<this.unitBuildList.length;i++)
			{
				for(var uID in this.unitBuildList[i].units)
				{
					ret[uID] = ret[uID] || [];
					ret[uID].push({count:this.unitBuildList[i].units[uID],completionTime:this.unitBuildList[i].completionTime});
				}
			}
			return ret;
		},
		getUnitTransportsByUnit: function()
		{
			var ret = {};
			var data = database.getGlobalData.militaryMovements[this.getId];
			if(data)
			{
				for(var row in data)
				{
					for(var uID in data[row].troops)
					{
						ret[uID] = ret[uID] || [];
						ret[uID].push({count:data[row].troops[uID],arrivalTime:data[row].arrivalTime,origin:data[row].originCityId});
					}
				}
			}
			return ret;
		},
		get isCapital() { return this.getBuildingFromName(Constant.Buildings.PALACE) !== null; },
		get isColony() { return this.getBuildingFromName(Constant.Buildings.PALACE) === null; },
		get isEmbassy() { return this.getBuildingFromName(Constant.Buildings.EMBASSY) !== null; },
		get isSafehouse() { return this.getBuildingFromName(Constant.Buildings.SAFEHOUSE) !== null; },
		get isPirateFortress() { return this.getBuildingFromName(Constant.Buildings.PIRATE_FORTRESS) !== null; },
		get isBranchOffice() { return this.getBuildingFromName(Constant.Buildings.TRADING_POST) !== null; },
		get isTavern() { return this.getBuildingFromName(Constant.Buildings.TAVERN) !== null; },
		get isMuseum() { return this.getBuildingFromName(Constant.Buildings.MUSEUM) !== null; },
		get isWarehouse() { return this.getBuildingFromName(Constant.Buildings.WAREHOUSE) !== null; },
		get isDump() { return this.getBuildingFromName(Constant.Buildings.DUMP) !== null; },
		get isUpgrading()
		{
			var res = false;
			$.each(this.getBuildings,function(idx,building) { res = res || building.isUpgrading; });
			return res;
		}
	};
	function GlobalData()
	{
		this._version = {lastUpdateCheck:0,latestVersion:null,installedVersion:0};
		this._regDate = 0;
		this._giftsreceived = 0;
		this._research = {topics:{},unused:0,lastUpdate:0};
		this._embassy = {id:0,name:'',ranks:[{id:0,name:'',status:''},{id:0,name:'',status:''},{id:0,name:'',status:''},{id:0,name:'',status:''}]};
		this._potmuseumTreaties = {};
		this._museumTreaties = {};
		this._improvements = {};
		this._theater = {status:'inactive',serverTimezoneOffset:0,favour:{active:false,waitingTime:0,videoduration:0},resource:{active:false,waitingTime:0,cityId:0,videoduration:0},tradegood:{active:false,waitingTime:0,cityId:0,videoduration:0},mute:true,volume:0,lastUpdate:0};
		this._favour = 0;
		this._pirates = {
			points:0,								// parseInt(crewPoints)
			strength:0,								// parseInt(capturePoints)
			position:0,								// parseInt(highscore[highscorePlayerPosition].place)
			dailyreset:0,							// Ώρα ημερήσιας ανανέωσης βαθμολογίας
			resetin:0,								// highscoreTimeLeft*1000+$.now()
			miss:false,								// hasOngoingMission
			conv:false,								// hasOngoingConvertion
			auto:[false,false],						// Automations
			mission:{level:0,endtime:0,type:''},	// (ongoingMissionLevel-1)/2,ongoingMissionTimeRemaining*1000+$.now(),ongoingMissionType
			conversion:{points:0,endtime:0}			// ongoingConversionCapturePoints,ongoingConversionTimeRemaining*1000+$.now()
		};
		this._bonus = 0;
		this.governmentType = 'ikakratie';
		this.floorquantities = false;
		this.fleetMovements = [];
		this.militaryMovements = [];
		this.finance = {armyCost:0,armySupply:0,fleetCost:0,fleetSupply:0,currentGold:0,sigmaExpenses:0,sigmaIncome:0,lastUpdated:0};
		this.localStrings = {};
		this.premium = {};
		this.islands = {};
		this.premiumFeatures = {};
		this.tempdb = {'pot':{},'cts':{},'movs':{}};
	}
	GlobalData.prototype = {
		init: function()
		{
			var LD = Constant.LanguageData[database.settings.languageChange.value];
			$.each(this.fleetMovements,function(key,movement)
			{
				this.fleetMovements[key] = new Movement(movement);
				this.fleetMovements[key]._updateTimer = null;
				this.fleetMovements[key].startUpdateTimer();
			}.bind(this));
		},
		hasPremiumFeature: function(type) { this.clearPremiumFeature(); return this.premium[type] ? this.premium[type].endtime*1000 > $.now() || type : false; },
		setPremiumFeature:function(type,feature,endtime,cityId)
		{
			var ret = !this.hasPremiumFeature(type) && endtime*1000 > $.now();
			this.premium[type] = {name:feature,endtime:endtime,cityid:cityId};
			return ret;
		},
		getPremiumTimeRemaining:function(type){return this.premium[type] ? this.premium[type].endtime*1000-$.now() : 0;},
		getPremiumTimeType:function(type){return this.premium[type] ? type : false; },
		getPremiumTimeCityId:function(type){return this.premium[type]!==undefined ? this.premium[type].cityid : false; },
		clearPremiumFeature:function() { for(var t in this.premium) { if(this.premium[t].endtime*1000 <= $.now()) { delete this.premium[t]; } } },
		removeFleetMovement: function(id)
		{
			var index = -1;
			$.each(this.fleetMovements,function(i,movement)
			{
				if(movement.getId==id)
				{
					this.fleetMovements.splice(i,1);
					return false;
				}
			}.bind(this));
		},
		addFleetMovement: function(transport)
		{
			try
			{
				this.fleetMovements.push(transport);
				transport.startUpdateTimer();
				this.fleetMovements = this.fleetMovements.filter(function(m){return $.now()<m._arrivalTime;});
				this.fleetMovements.sort(function(a,b)
				{
					return a.getArrivalTime-b.getArrivalTime;
				});
				var changes = [];
				$.each(transport.getResources,function(resourceName,value)
				{
					changes.push(resourceName);
				});
				return changes;
			} catch(e) { empire.error('addFleetMovement', e); }
		},
		getMovementById: function(id)
		{
			for(var i in this.fleetMovements)
			{
				if(this.fleetMovements[i].getId == id)
				{
					return this.fleetMovements[i];
				}
			}
			return false;
		},
		clearFleetMovements: function()
		{
			var changes = [];
			$.each(this.fleetMovements, function(index,item)
			{
				changes.push(item.getTargetCityId);
				item.clearUpdateTimer();
			});
			this.fleetMovements.length = 0;
			return $.exclusive(changes);
		},
		getResourceMovementsToCity: function(cityID)
		{
			return this.fleetMovements.filter(function(el)
			{
				if(el.getTargetCityId == cityID)
				{
					return (el.getMission=='trade' || el.getMission=='transport' || el.getMission=='plunder');
				}
			});
		},
		getMilitaryMovementsToCity: function(cityID)
		{
			return this.fleetMovements.filter(function(el)
			{
				if(el.getOriginCityId == cityID)
				{
					return (el.getMission!='trade' && el.getMission!='transport' && el.getMission=='plunder' && el.getMission=='deploy');
				}
			});
		},
		getImprovements: function(unit) { return this._improvements[unit] || 0; },
		updateImprovements: function(unit,offense,defence)
		{
			var changed = this.getImprovements(unit)[0] != offense || this.getImprovements(unit)[1] != defence;
			this._improvements[unit] = [offense,defence];
			return changed;
		},
		getResearchTopicLevel: function(research) { return this._research.topics[research] || 0; },
		updateResearchTopic: function(topic,level)
		{
			var changed = this.getResearchTopicLevel(topic) != level;
			this._research.topics[topic] = level;
			return changed;
		},
		get getCurrRPRate()
		{
			var tot = [0,this._research.unused,0,0,0,0,0];
			$.each(database.cities,function(k,c)
			{
				tot[0] += c.research.getResearchers;
				tot[2] += c.research.getResearch;
				tot[3] += c.research.researchData.researchBonus;
				tot[4] += c.research.researchData.corruption;
				tot[5] += c.research.researchData.premiumCulturalGoodsBonus;
				tot[6] += c.research.researchData.culturalGoods;
			});
			return (tot[0]-tot[4]+tot[3]+tot[5]+tot[6]);
		},
		get getUnusedRPs()
		{
			var unused = this._research.unused;
			var lastupdate = this._research.lastUpdate;
			return unused+((moment()-lastupdate)/1e3)*this.getCurrRPRate/3.6e3;//[unused,(moment()-lastupdate)/1e3,((moment()-lastupdate)/1e3)*this.getCurrRPRate/3.6e3,this.getCurrRPRate,unused+((moment()-lastupdate)/1e3)*this.getCurrRPRate/3.6e3];//+(lastupdate>=moment()?0:(moment()-lastupdate)*this.getCurrRPRate);
		},
		get getTotalRPntsProduced()
		{
			var topics = this._research.topics;
			var rp = 0;
			$.each(topics,function(k,r)
			{
				rp += r*Constant.Research.Costs[k];
			});
			return rp;
		},
		get getRegDate() { return this._regDate; },
		get getGiftsReceived() { return this._giftsreceived; },
		get getGovernmentType() { return this.governmentType; },
		get getFavour() { return this._favour; },
		get getBonus() { return this._bonus; },
		get getPirates() { return this._pirates; },
		get getEmbassyData() { return this._embassy; },
		get getSafehouse() { return this._safehouse; },
		get getPirateFortress() { return this._piratesFortress; },
		get getPotMuseumTreaties() { return this._potmuseumTreaties; },
		get getMuseumTreaties() { return this._museumTreaties; },
		get getTheaterData() { return this._theater; },
		get getIslandData() { return this.islands; },
		get getPremiumFeatures() { return this.premiumFeatures; },
		getLocalisedString: function(string)
		{
			var lString;
			lString = this.localStrings[string.replace(/([A-Z])/g, "_$1").toLowerCase()];
			if(lString == undefined) { lString = this.localStrings[string.toLowerCase().split(' ').join('_')]; }
			return (lString == undefined) ? string : lString;
		},
		addLocalisedString: function(string,value) {
			if(this.getLocalisedString(string)==string) {this.localStrings[string.toLowerCase().split(' ').join('_')] = value;}
		},
		isOldVersion: function() { return this._version.latestVersion < this._version.installedVersion; }
	};
	function Setting(name)
	{
		this._name = name;
		this._value = null;
	}
	Setting.prototype = {
		get name() { return this._name; },
		get type() { return Constant.SettingData[this._name].type; },
		get description() { return this._name+'_description'; },
		get value() { return (this._value !==null?this._value:Constant.SettingData[this._name].default); },
		get categories() { return Constant.SettingData[this._name].categories; },
		get choices() { return Constant.SettingData[this._name].choices || false; },
		get selection() { return Constant.SettingData[this._name].selection || false; },
		set value(value)
		{ 
			if(this.type==='boolean') { this._value = !!value; } 
			else if(this.type==='number') { if(!isNaN(value)) { this._value = value; } }
			else if(this.type==='buildings') { if(!isNaN(value)) { this._value = value; } }
			else if (this.type === 'language') { this._value = value; }
			else if (this.type === 'array' || this.type === 'orderedList') { if (Object.prototype.toString.call(value) === '[object Array]') { this._value = value; } }
		},
		toJSON: function () { return {value:this._value}; }
	};
/***********************************************
******************** empire ********************
************************************************/
	const EMPIRE_STORAGE_PREFIX = ['',GM_info.script.namespace,GM_info.script.name,unsafeWindow.dataSetForView.avatarId,''].join('***');
	var empire = {
		version: 1.200,
		scriptId: 764,
		scriptName: 'Greek Empire Overview',
		logger: null,
		loaded: false,
		setVar: function(varname,varvalue) { GM_setValue(EMPIRE_STORAGE_PREFIX+varname,varvalue); },
		deleteVar: function(varname) { GM_deleteValue(EMPIRE_STORAGE_PREFIX + varname); },
		getVar: function(varname,vardefault)
		{
			var ret = GM_getValue(EMPIRE_STORAGE_PREFIX+varname);
			if (null===ret && 'undefined' != typeof vardefault)
			{
				return vardefault;
			}
			return ret;
		},
		log: function(val)
		{
			if(debug) { console.log('empire: ', $.makeArray(arguments)); }
			if(log)
			{
				if(this.logger)
				{
					this.logger.val(val+'\n'+this.logger.val());
					return true;
				}
				else
				{
					render.$tabs.append($(document.createElement("div")).attr('id','empire_Log'));
					$('#empire_Log').html('<div><textarea id="empire_Logbox" rows="20" cols="120"></textarea></div>');
					$('<li><a href="#empire_Log"><img class="ui-icon ui-icon-info"/></a></li>').appendTo("#empire_Tabs .ui-tabs-nav");
					render.$tabs.tabs('refresh');
					this.logger = $('#empire_Logbox');
					return this.log(val);
				}
			}
		},
		error: function(func,e)
		{
			this.log('****** Error raised in '+func+'******');
			this.log(e.name+' : '+e.message);
			this.log(e.stack);
			this.log('****** End ******');
			if(debug)
			{
				console.error('****** Error raised in ' + func + ' ******');
				console.error(e.name + ' : ' + e.message);
				console.error(e.stack);
				console.error('****** End ******');
			}
		},
		time: function(func,name)
		{
			if (timing) console.time(name);
			var ret = func();
			if (timing) console.timeEnd(name);
			return ret;
		},
		Init: function()
		{
			ikariam.Init();
			render.Init();
			database.Init(ikariam.Host());
			this.CheckForUpdates(false);
			GM_registerMenuCommand(this.scriptName+'Manual Update',function() { empire.CheckForUpdates(true); });
		},
		CheckForUpdates: function(forced)
		{
			var LD = Constant.LanguageData[database.settings.languageChange.value];
			if((forced) || ((database.getGlobalData.LastUpdateCheck + 86400000 <= $.now()) && database.settings.autoUpdates.value))
			{
				try
				{
					GM_xmlhttpRequest({
						method : 'GET',
						url	: 'https://greasyfork.org/scripts/'+empire.scriptId+'-empire-overview/code/Empire_Overview.meta.js',
						headers: {'Cache-Control': 'no-cache'},
						onload : function(resp)
						{
							var remote_version, rt;
							rt = resp.responseText;
							database.getGlobalData.LastUpdateCheck = $.now();
							remote_version = parseFloat(/@version\s*(.*?)\s*$/m.exec(rt)[1]);
							if(empire.version != -1)
							{
								if(remote_version > empire.version)
								{
									if(confirm(LD.alert_update+empire.scriptName+'".\n'+LD.alert_update1))
									{
										// if(confirm(Utils.format(LD.alert_update,[empire.scriptName]))) {
										GM_openInTab('https://greasyfork.org/scripts/'+empire.scriptId+'-empire-overview');
									}
								}
								else if(forced)
								{
									render.toast(Utils.format(LD.alert_noUpdate,[empire.scriptName]));
								}
							}
							database.getGlobalData.latestVersion = remote_version;
						}
					});
				} catch(err) { if(forced) { render.toast(LD.alert_error+'\n'+err); } }
			}
		},
		HardReset: function()
		{
			var LD = Constant.LanguageData[database.settings.languageChange.value];
			database = {};
			empire.deleteVar("settings");
			empire.deleteVar("Options");
			empire.deleteVar("options");
			empire.deleteVar("cities");
			empire.deleteVar("LocalStrings");
			empire.deleteVar("globalData");
			render.toast(LD.alert_toast);
			setTimeout(function() { document.location = document.getElementById('js_cityLink').children[0].href;
			},3500);
		}
	};
/*****************************************************
********************** database **********************
*****************************************************/
	var database = {
		_globalData: new GlobalData(),
		cities:{},
		settings: {version:empire.version,window:{left:110,top:200,activeTab:0,visible:true},addOptions: function(objVals) {return $.mergeValues(this, objVals);}},
		Init: function(host)
		{
			$.each(Constant.Settings,function(key,value) { this.settings[value] = new Setting(value); }.bind(database));
			var prefix = host;
			prefix = prefix.replace('.ikariam.','-');
			prefix = prefix.replace('.','-');
			this.Prefix = prefix;
			this.Load();
			events(Constant.Events.LOCAL_STRINGS_AVAILABLE).sub(ikariam.getLocalizationStrings.bind(this));
			$(window).on('beforeunload',function() { setTimeout(function() { database.Save();},0); });
		},
		addCity: function(id,a) {if(a) { return $.mergeValues(new City(id), a); } else return new City(id); },
		get getBuildingCounts()
		{
			var buildingCounts = {};
			$.each(this.cities, function(cityId,city)
			{
				$.each(Constant.Buildings,function(key,value)
				{
					if((database.settings.defaultBuildingList.value || database.settings.alternativeBuildingList.value) && (value === '')) {}
					else if(database.settings.compressedBuildingList.value && (value == Constant.Buildings.STONEMASON || value == Constant.Buildings.WINERY || value == Constant.Buildings.ALCHEMISTS_TOWER || value == Constant.Buildings.GLASSBLOWER))
					{
						buildingCounts.productionBuilding = Math.max(buildingCounts.productionBuilding || 0, city.getBuildingsFromName(value).length);
					}
					else if(database.settings.compressedBuildingList.value && (value == Constant.Buildings.GOVERNORS_RESIDENCE || value == Constant.Buildings.PALACE))
					{
						buildingCounts.colonyBuilding = Math.max(buildingCounts.colonyBuilding || 0, city.getBuildingsFromName(value).length);
					}
					else
					{
						buildingCounts[value] = Math.max(buildingCounts[value] || 0, city.getBuildingsFromName(value).length);
					}
				});
			});
			return buildingCounts;
		},
		startMonitoringChanges: function()
		{
			events(Constant.Events.BUILDINGS_UPDATED).sub(this.Save.bind(this));
			events(Constant.Events.GLOBAL_UPDATED).sub(this.Save.bind(this));
			events(Constant.Events.MOVEMENTS_UPDATED).sub(this.Save.bind(this));
			events(Constant.Events.RESOURCES_UPDATED).sub(this.Save.bind(this));
			events(Constant.Events.MILITARY_UPDATED).sub(this.Save.bind(this));
			events(Constant.Events.PREMIUM_UPDATED).sub(this.Save.bind(this));
		},
		Load: function()
		{
			var settings = this.UnSerialize(empire.getVar('settings',''));
			if(typeof settings === 'object')
			{
				if(!this.isDatabaseOutdated(settings.version))
				{
					$.mergeValues(this.settings, settings);
					var globalData = this.UnSerialize(empire.getVar('globalData',''));
					if (globalData.governmentType === '') globalData.governmentType = 'ikakratie';
					if(typeof globalData == 'object')
					{
						$.mergeValues(this._globalData, globalData);
					}
					var cities = this.UnSerialize(empire.getVar('cities',''));
					if(typeof cities == 'object')
					{
						for(var cityID in cities)
						{
							(this.cities[cityID] = this.addCity(cities[cityID]._id, cities[cityID])).init();
						}
					}
				}
				this._globalData.init();
			}
			events(Constant.Events.DATABASE_LOADED).pub();
		},
		Serialize: function(data)
		{
			var ret;
			if(data) { try { ret = JSON.stringify(data,null,'\t'); } catch(e) { empire.log('error saving'); } }
			return ret || undefined;
		},
		UnSerialize: function(data)
		{
			var ret;
			if(data) { try { ret = JSON.parse(data); } catch(e) { empire.log('error loading'); } }
			return ret || undefined;
		},
		Save: function()
		{
			events.scheduleAction(function()
			{
				empire.setVar('cities',database.Serialize(database.cities));
				empire.setVar('settings',database.Serialize(database.settings));
				empire.setVar('globalData',database.Serialize(database._globalData));
			});
		},
		get getGlobalData() { return this._globalData; },
		isDatabaseOutdated: function(version) { return 1.166 > (version || 0); },
		getCityFromId: function(id) { return this.cities[id] || null; },
		get getArmyTotals()
		{
			if(!this._armyTotals) { this._armyTotals = Utils.cacheFunction(this._getArmyTotals.bind(database),1000); }
			return this._armyTotals();
		},
		_getArmyTotals: function()
		{
			var totals = {};
			$.each(Constant.UnitData, function(unitId,info) { totals[unitId] = {training:0,total:0,incoming:0,plunder:0}; });
			$.each(this.cities, function(cityId,city)
			{
				var train = city.military.getTrainingTotals;
				var incoming = city.military.getIncomingTotals;
				var total = city.military.getUnits.totals;
				$.each(Constant.UnitData,function(unitId,info)
				{
					totals[unitId].training += train[unitId] || 0;
					totals[unitId].total += total[unitId] || 0;
					totals[unitId].incoming += incoming[unitId] || 0;
					//totals[unitId].plunder += plunder[unitId] || 0;
				});
			});
			return totals;
		},
		get getCityCount() { return Object.keys(this.cities).length; },
		_getArmyTrainingTotals :function(){ }
	};
/************************************************
****************** render view ******************
************************************************/
	var render = {
			mainContentBox: null,
			$tabs: null,
			cityRows:{building:{},resource:{},army:{}},
			_cssResLoaded: false,
			toolTip: {elem:null,timer:null,hide:function() { render.toolTip.elem.parent().hide(); },
			show: function() { render.toolTip.elem.parent().show(); },
			mouseOver: function(event)
			{
				if(render.toolTip.timer) { render.toolTip.timer(); }
				var f = function(shiftKey)
				{
					return function()
					{
						var elem;
						elem = $(event.target).attr('data-tooltip') ? event.target : $(event.target).parents('[data-tooltip]');
						render.toolTip.elem.html(render.toolTip.dynamicTip($(event.target).parents('tr').attr('id') ? $(event.target).parents('tr').attr('id').split('_').pop() : 0, elem));
						return render.toolTip.elem.html();
					};
				}(event.originalEvent.shiftKey);
				if(f(event.originalEvent.shiftKey))
				{
					render.toolTip.show();
					render.toolTip.timer = events.scheduleActionAtInterval(f,1000);
				}
			},
			mouseMove: function(event)
			{
				if(render.toolTip.timer && render.toolTip.elem)
				{
					var l = parseInt(render.mainContentBox.css('left').split('px')[0]);
					var t = parseInt(render.mainContentBox.css('top').split('px')[0]);
					var x = event.pageX - 15 - l;
					var y = event.pageY + 20 - t;
					if(render.mainContentBox.height() - render.toolTip.elem.height() < y)
					{
						y = event.pageY - render.toolTip.elem.height() - 15 - t;
					}
					if(render.mainContentBox.width() - render.toolTip.elem.width() < x)
					{
						x = event.pageX - render.toolTip.elem.width() + 15 - l;
					}
					render.toolTip.elem.parent().css({left:x+'px',top:y+'px'});
				}
			},
			mouseOut: function(event)
			{
				if(render.toolTip.timer)
				{
					render.toolTip.timer();
					render.toolTip.timer = null;
				}
				render.toolTip.hide();
			},
			init: function()
			{
				render.toolTip.elem = render.mainContentBox.append($('<div id="empireTip" style="z-index: 999999999;"><div class="content"></div></div>')).find('div.content');
				render.mainContentBox.on('mouseover', '[data-tooltip]', render.toolTip.mouseOver).on('mousemove', '[data-tooltip]', render.toolTip.mouseMove).on('mouseout', '[data-tooltip]', render.toolTip.mouseOut);
			},
			dynamicTip: function(id,elem)
			{
				var LD = Constant.LanguageData[database.settings.languageChange.value];
				var incB = {'WOOD':'FORESTER','WINE':'WINERY','MARBLE':'STONEMASON','GLASS':'GLASSBLOWER','SULFUR':'ALCHEMISTS_TOWER'};
				var $elem = $(elem);
				var tiptype;
				if($elem.attr('data-tooltip') === "dynamic")
				{
					tiptype = $elem.attr('class').split(" ");
				}
				else
				{
					return $elem.attr('data-tooltip') || '';
				}
				var city = database.getCityFromId(id);
				var resourceName;
				if(city)
				{
					resourceName = $elem.is('td') ? $elem.attr('class').split(' ').pop() : $elem.parent('td').attr('class').split(' ').pop();
					if(Object.keys(incB).indexOf(resourceName.toUpperCase())!=-1)
					{
						var F = (city.getBuildingFromName(Constant.Buildings[incB[resourceName.toUpperCase()]])?city.getBuildingFromName(Constant.Buildings[incB[resourceName.toUpperCase()]]).getLevel:0)*0.02;
						var resName = resourceName!==Constant.Resources.GLASS ? resourceName : 'CRYSTAL';
						// steam saw (cinema): 16, cityid: 0
						var B = 0;
//						console.log(database.getGlobalData.premium,Constant.Premium['WOOD_BONUS']);
						if(resourceName == Constant.Resources.WOOD && database.getGlobalData.hasPremiumFeature(Constant.Premium.WOOD_BONUS[0]) && database.getGlobalData.premium[Constant.Premium['WOOD_BONUS'][1]] && database.getGlobalData.premium[Constant.Premium['WOOD_BONUS'][1]].cityid==0)
						{
							B += parseFloat(Constant.PremiumData[Constant.Premium['WOOD_BONUS'][0]].bonus);
						}
						else if(resourceName == Constant.Resources.WOOD && database.getGlobalData.hasPremiumFeature(Constant.Premium.WOOD_BONUS[1]) && city.getId==database.getGlobalData.premium[Constant.Premium['WOOD_BONUS'][1]].cityid)
						{
							B += parseFloat(Constant.PremiumData[Constant.Premium['WOOD_BONUS'][1]].bonus);
						}
						else if(resourceName != Constant.Resources.WOOD && database.getGlobalData.hasPremiumFeature(Constant.Premium.TRADEGOOD_BONUS) && city.getId==database.getGlobalData.premium[Constant.Premium.TRADEGOOD_BONUS].cityid && city.getTradeGood == resourceName)
						{
							B += parseFloat(Constant.PremiumData[Constant.Premium.TRADEGOOD_BONUS].bonus);
						}
						else if(resourceName != Constant.Resources.WOOD && database.getGlobalData.hasPremiumFeature(Constant.Premium[resName.toUpperCase()+'_BONUS']) && database.getGlobalData.premium[Constant.Premium[resName.toUpperCase()+'_BONUS']].cityid==0 && city.getTradeGood == resourceName)
						{
							B += parseFloat(Constant.PremiumData[Constant.Premium[resName.toUpperCase()+'_BONUS']].bonus);
						}
						var rwrk = Math.round(city.getResource(resourceName).getProduction*3600/(1+F+B));
						var production = Math.floor(rwrk*(1+F+B));
					}
				}
				var total;
				switch(tiptype.shift())
				{
					case "incoming":
						return getIncomingTip();
						break;
					case "current":
						return getCurrentResTip();
						break;
					case "progressbar":
						if(resourceName!==Constant.Resources.GOLD) { return getProgressTip(); }
						break;
					case "total":
						switch($elem.attr('id').split('_').pop())
						{
							case "sigma":
								return getResourceTotalTip();
								break;
							case "growth":
								return getGrowthTotalTip();
								break;
							case "researchpoints":
								return getResearchTotalTip();
								break;
							case "goldincome":
								return getGoldIncomeTip();
								break;
							case "research":
								var researchDat;
								$.each(database.cities,function(cityId,city)
								{
									if(researchDat) { $.each(city.research.researchData,function(key,value) { researchDat[key] += value; }); } else { researchDat = $.extend({}, city.research.researchData); }
								});
								return getResearchTip();
								break;
							case "army":
								return "soon";
								break;
							case "currentwood":
							case "currentwine":
							case "currentmarble":
							case "currentglass":
							case "currentsulfur":
								total = 0;
								resourceName = $elem.attr('id').split('current').pop();
								$.each(database.cities, function(cityId,c)
								{
									total += resourceName!='gold' ? c.getResource(resourceName).getCurrent : 0;
								});
								return Utils.FormatQuantityToLoad(total);
								break;
							case "wineincome":
								total = 0;
								var consumption = 0;
								resourceName = $elem.attr('id').split('_').pop().split('income').shift();
								$.each(database.cities,function(i,c)
								{
									var F = (c.getBuildingFromName(Constant.Buildings[incB[resourceName.toUpperCase()]])?c.getBuildingFromName(Constant.Buildings[incB[resourceName.toUpperCase()]]).getLevel:0)*0.02;
									var resName = resourceName!==Constant.Resources.GLASS ? resourceName : 'CRYSTAL';
									var B = 0;
									if(resourceName == Constant.Resources.WOOD && database.getGlobalData.hasPremiumFeature(Constant.Premium.WOOD_BONUS[0]) && database.getGlobalData.premium[Constant.Premium['WOOD_BONUS'][1]] && database.getGlobalData.premium[Constant.Premium['WOOD_BONUS'][1]].cityid==0)
									{
										B += parseFloat(Constant.PremiumData[Constant.Premium['WOOD_BONUS'][0]].bonus);
									}
									else if(resourceName == Constant.Resources.WOOD && database.getGlobalData.hasPremiumFeature(Constant.Premium.WOOD_BONUS[1]) && c.getId==database.getGlobalData.premium[Constant.Premium['WOOD_BONUS'][1]].cityid)
									{
										B += parseFloat(Constant.PremiumData[Constant.Premium['WOOD_BONUS'][1]].bonus);
									}
									else if(resourceName != Constant.Resources.WOOD && database.getGlobalData.hasPremiumFeature(Constant.Premium.TRADEGOOD_BONUS) && c.getId==database.getGlobalData.premium[Constant.Premium.TRADEGOOD_BONUS].cityid && c.getTradeGood == resourceName)
									{
										B += parseFloat(Constant.PremiumData[Constant.Premium.TRADEGOOD_BONUS].bonus);
									}
									else if(resourceName != Constant.Resources.WOOD && database.getGlobalData.hasPremiumFeature(Constant.Premium[resName.toUpperCase()+'_BONUS']) && database.getGlobalData.premium[Constant.Premium[resName.toUpperCase()+'_BONUS']].cityid==0 && c.getTradeGood == resourceName)
									{
										B += parseFloat(Constant.PremiumData[Constant.Premium[resName.toUpperCase()+'_BONUS']].bonus);
									}
									var rwrk = Math.round(c.getResource(resourceName).getProduction*3600/(1+F+B));
									var production = Math.floor(rwrk*(1+F+B));
									total += production;
									consumption += c.getResource(resourceName).getConsumption;
								});
								return getProductionConsumptionSubSumTip(total,consumption,true);
								break;
							default :
								total = 0;
								resourceName = $elem.attr('id').split('_').pop().split('income').shift();
								$.each(database.cities,function(cityId,c)
								{
									var F = (c.getBuildingFromName(Constant.Buildings[incB[resourceName.toUpperCase()]])?c.getBuildingFromName(Constant.Buildings[incB[resourceName.toUpperCase()]]).getLevel:0)*0.02;
									var resName = resourceName!==Constant.Resources.GLASS ? resourceName : 'CRYSTAL';
									var B = 0;
									if(resourceName == Constant.Resources.WOOD && database.getGlobalData.hasPremiumFeature(Constant.Premium.WOOD_BONUS[0]) && database.getGlobalData.premium[Constant.Premium['WOOD_BONUS'][1]] && database.getGlobalData.premium[Constant.Premium['WOOD_BONUS'][1]].cityid==0)
									{
										B += parseFloat(Constant.PremiumData[Constant.Premium['WOOD_BONUS'][0]].bonus);
									}
									else if(resourceName == Constant.Resources.WOOD && database.getGlobalData.hasPremiumFeature(Constant.Premium.WOOD_BONUS[1]) && c.getId==database.getGlobalData.premium[Constant.Premium['WOOD_BONUS'][1]].cityid)
									{
										B += parseFloat(Constant.PremiumData[Constant.Premium['WOOD_BONUS'][1]].bonus);
									}
									else if(resourceName != Constant.Resources.WOOD && database.getGlobalData.hasPremiumFeature(Constant.Premium.TRADEGOOD_BONUS) && c.getId==database.getGlobalData.premium[Constant.Premium.TRADEGOOD_BONUS].cityid && c.getTradeGood == resourceName)
									{
										B += parseFloat(Constant.PremiumData[Constant.Premium.TRADEGOOD_BONUS].bonus);
									}
									else if(resourceName != Constant.Resources.WOOD && database.getGlobalData.hasPremiumFeature(Constant.Premium[resName.toUpperCase()+'_BONUS']) && database.getGlobalData.premium[Constant.Premium[resName.toUpperCase()+'_BONUS']].cityid==0 && c.getTradeGood == resourceName)
									{
										B += parseFloat(Constant.PremiumData[Constant.Premium[resName.toUpperCase()+'_BONUS']].bonus);
									}
									var rwrk = Math.round(c.getResource(resourceName).getProduction*3600/(1+F+B));
									var production = Math.floor(rwrk*(1+F+B));
									total += production;
								});
								return getProductionTip(total);
								break;
						}
						case "city_name":
							return getGovTip();
							break;
						case "pop":
							return getPopulationTip();
							break;
						case "happy":
							return getBonusTip();
							break;
						case "growth":
							return getGrowthTip();
							break;
						case "garrisonlimit":
							return getActionPointsTip();
							break;
						case "spies":
							return city.isSafehouse ? getSpyTip() : false;
							break;
						case "wonder":
							return getWonderTip();
							break;
						case "temple":
							return getTempleTip();
							break;
						case "dailytasks":
							return getDailyTasksTip();
							break;
						case "cinetheater":
							return getTheaterTip();
							break;
						case "pirates":
							return getPiratesTip();
							break;
						case "islandwood":
						case "islandgood":
							return getForestMineTip($elem.attr('class'));
							break;
						case "prodconssubsum consumption Red":
							return getFinanceTip();
							break;
						case "scientists":
							return getResearchTip();
							break;
						case "prodconssubsum":
							return resourceName === Constant.Resources.GOLD ? getFinanceTip() : getProductionConsumptionSubSumTip(production,city.getResource(resourceName).getConsumption);
							break;
						case "building":
							var bName = tiptype.shift();
							var index = parseInt(bName.slice(-1));
							bName = bName.slice(0, -1);
							return getBuildingTooltip(city.getBuildingsFromName(bName)[index]);
						case "army":
							switch(tiptype.shift())
							{
								case "unit":
									return '';
									break;
								case "movement":
									return getArmyMovementTip(tiptype.pop());
									break;
								case "incoming":
									return getIncomeMovementTip(tiptype.pop());
									break;
							/*	case "plunder":
									return getPlunderMovementTip(tiptype.pop());
									break;*/
							}
							break;
						default:
							return '';
							break;
				}
				function testTip()
				{
					return 'Hallo';
				}
				function getGoldIncomeTip()
				{
					var LD = Constant.LanguageData[database.settings.languageChange.value];
					var researchCost = 0;
					var income = 0;
					var sigmaIncome = 0;
					$.each(database.cities,function(cityID,city)
					{
						researchCost += Math.floor(city.getExpenses);
						income += Math.floor(city.getIncome);
					});
					var bonus = (income*(database.getGlobalData.hasPremiumFeature(Constant.Premium.GOLD_BONUS)*Constant.PremiumData[Constant.Premium.GOLD_BONUS].bonus));
					var expense = database.getGlobalData.finance.armyCost+database.getGlobalData.finance.armySupply+database.getGlobalData.finance.fleetCost+database.getGlobalData.finance.fleetSupply-researchCost;
					sigmaIncome	= income+bonus-expense;
					return '<table><thead><tr><th><img src="skin/resources/icon_upkeep.png" style="height: 14px;"></th><th>1 '+LD.hour+'</th><th>1 '+LD.day+'</th><th>1 '+LD.week+'</th><td style="text-align:center"><img src="skin/minimized/finances.png" style="height:20px"><img src="skin/resources/icon_gold.png" style="width:14px;height:10px;display:inline;margin-left:-5px;"><img src="skin/resources/icon_gold.png" style="width:14px;height:11.5px;display:inline;margin-left:-5px"><img src="skin/resources/icon_gold.png" style="width:14px;height:12.9px;display:inline;margin-left:-5px"><img src="skin/resources/icon_gold.png" style="width:14px;height:14px;display:inline;margin-left:-5px"><img src="skin/resources/icon_gold.png" style="width:14px;height:15.6px;display:inline;margin-left:-5px"><img src="skin/resources/icon_gold.png" style="width:14px;height:18px;display:inline;margin-left:-5px"></td></tr></thead><tbody>'+(database.getGlobalData.finance.armyCost>0?'<tr class="data"><td><b>-</b></td><td>'+Utils.FormatNumToStr(database.getGlobalData.finance.armyCost,false,0)+'</td><td>'+Utils.FormatNumToStr(database.getGlobalData.finance.armyCost*24,false,0)+'</td><td>'+Utils.FormatNumToStr(database.getGlobalData.finance.armyCost*24*7,false,0)+'</td><td class="left">« '+LD.army_cost+'</td></tr>':'')+(database.getGlobalData.finance.fleetCost>0?'<tr class="data"><td><b>-</b></td><td class="nolf">'+Utils.FormatNumToStr(database.getGlobalData.finance.fleetCost,false,0)+'</td><td>'+Utils.FormatNumToStr(database.getGlobalData.finance.fleetCost*24,false,0)+'</td><td>'+Utils.FormatNumToStr(database.getGlobalData.finance.fleetCost*24*7,false,0)+'</td><td class="left">« '+LD.fleet_cost+'</td></tr>':'')+(database.getGlobalData.finance.armySupply>0?'<tr class="data"><td><b>-</b></td><td class="nolf">'+Utils.FormatNumToStr(database.getGlobalData.finance.armySupply,false,0)+'</td><td>'+Utils.FormatNumToStr(database.getGlobalData.finance.armySupply*24,false,0)+'</td><td>'+Utils.FormatNumToStr(database.getGlobalData.finance.armySupply*24*7,false,0)+'</td><td class="left">« '+LD.army_supply+'</td></tr>':'')+(database.getGlobalData.finance.fleetSupply>0?'<tr class="data"><td><b>-</b></td><td class="nolf">'+Utils.FormatNumToStr(database.getGlobalData.finance.fleetSupply,false,0)+'</td><td>'+Utils.FormatNumToStr(database.getGlobalData.finance.fleetSupply*24,false,0)+'</td><td>'+Utils.FormatNumToStr(database.getGlobalData.finance.fleetSupply*24*7,false,0)+'</td><td class="left">« '+LD.fleet_supply+'</td></tr>':'')+(researchCost<0?'<tr class="data"><td><b>-</b></td><td class="nolf">'+Utils.FormatNumToStr(researchCost,false,0)+ '</td><td>'+Utils.FormatNumToStr(researchCost*24,false,0)+'</td><td>'+Utils.FormatNumToStr(researchCost*24*7,false,0)+'</td><td class="left">« '+LD.research_cost+'</td></tr>':'')+(expense>0?'<tr style="border-top:1px solid #FFE4B5"><td><b>-</b></td><td class="nolf">'+Utils.FormatNumToStr(expense,false,0)+'</td><td class="left">'+Utils.FormatNumToStr(expense*24,false,0)+'</td><td>'+Utils.FormatNumToStr(expense*24*7,false,0)+'</td><td>« '+LD.expenses+'</td></tr>':'')+(income>0?'<tr><td><b>+</b></td><td class="nolf">'+Utils.FormatNumToStr(income,false,0)+'</td><td>'+Utils.FormatNumToStr(income*24,false,0)+'</td><td>'+Utils.FormatNumToStr(income*24*7,false,0)+'</td><td class="left">« '+LD.income+'</td></tr>':'')+(bonus>0?'<tr><td><b>+</b></td><td class="nolf">'+Utils.FormatNumToStr(bonus,false,0)+'</td><td>'+Utils.FormatNumToStr(bonus*24,true,0)+'</td><td>'+Utils.FormatNumToStr(bonus*24*7,true,0)+'</td><td class="left">« '+LD.badtax+'</td></tr>':'')+'</tbody><tfoot><tr class="total"><th>Σ '+(sigmaIncome>0?'+':(sigmaIncome<0?'-':''))+'</th><td>'+Utils.FormatNumToStr(sigmaIncome,false,0)+'</td><td>'+Utils.FormatNumToStr(sigmaIncome*24,false,0)+'</td><td>'+Utils.FormatNumToStr(sigmaIncome*24*7,false,0)+'</td><td class="icon '+(sigmaIncome>0?'in':sigmaIncome<0?'out':'')+'comeIcon" style="background-position:73px +2px;background-size:16px">« '+LD.balances+' » '+(sigmaIncome==0?'⚖️':'')+'</td></tr></tfoot></table>';
				}
				function getArmyMovementTip(unit)
				{
					var total = 0;
					var table = '<table><thead><th colspan="3"><div align="center"><img src="{0}" style="height: 18px; float: left"></td><b>'+LD.training+'</b></div></th></thead><tbody>{1}</tbody><tfoot><tr class="big"><td><b>Σ +</b></td><td>{2}</td><td class="left">« '+LD.total_+'</td></tr></tfoot></table>';
					var rows = '';
					$.each(city.military.getTrainingForUnit(unit),function(index, data)
					{
						rows += Utils.format('<tr class="data"><td><img src="skin/resources/icon_time.png" style="height: 12px;float:left"><b>+</b></td><td>{0}</td><td>« {1}</td></tr>',[data.count,Utils.FormatTimeLengthToStr(data.time-$.now(),3)]);
						total += data.count;
					});
					return rows==='' ? '' : Utils.format(table,[getImage(unit),rows,total]);
				}
				function getPopulationTip()
				{
					var populationData = city.populationData;
					var popDiff = populationData.maxPop-populationData.currentPop;
					var dur = 50*Math.abs(Math.log(populationData.happiness/(populationData.happiness+(populationData.happiness>=popDiff?-popDiff:populationData.currentPop))))*3600000;
					var Tip = popDiff>0 && !isNaN(dur) ? '<tfoot><tr><td>&nbsp;</td><td>« <span style="color:#fe0002"><b>'+LD.time_to_full+'</td></tr><tr class="data"><td colspan="2" style="text-align:center">'+Utils.FormatFullTimeToDateString(moment()+dur,true)+'<br>('+Utils.FormatTimeLengthToStr(dur,4)+')</td></tr></tfoot>':'';
					var populationTip = '<table><thead><th colspan="2"><div align="center"><img src="skin/resources/icon_population.png" style="height:20px;float:left"><img src="skin/icons/livingspace_24x24.png" style="height:24px;float:right"><b>{0}</b></div></th></thead><tbody><tr class="data"><td>{1}</td><td>« {5}</td></tr><tr class="data"><td>{2}</td><td>« {0}</td></tr><tr class="data"><td>{3}</td><td>« {7}</td></tr><tr class="data"><td><span style="color:#195a39";><b>{4}</b></span></td><td>« {6}</td></tr></tbody>{8}</table>';
					return Utils.format(populationTip,[LD.citizens,Utils.FormatNumToStr(populationData.maxPop,false,0),Utils.FormatNumToStr(populationData.currentPop,false,0),Utils.FormatNumToStr(city._citizens,false,0),((popDiff===0)?LD.full:Utils.FormatNumToStr(popDiff,false,2)),LD.housing_space,LD.free_housing_space,LD.free_Citizens,Tip]);
				}
				function getGrowthTip()
				{
					var LD = Constant.LanguageData[database.settings.languageChange.value];
					console.log(city);
					var populationData = city.populationData;
					var popDiff = populationData.maxPop-populationData.currentPop;
					var Icon = 'skin/icons/growth_'+(populationData.happiness>=0?'positive':'negative')+'.png';
					var Tip = popDiff>0 ? '<table><thead><th><div align="center"><img src="'+Icon+'" style="height:14px;"></td><td><b>1 '+LD.hour+'</b></td><td><b>1 '+LD.day+'</b></td><td><b>1 '+LD.week+'</b></div><td></td></th></thead><tbody><tr><td><b>'+((populationData.growth>0)?'+':'-')+'</b></td><td>'+Utils.FormatNumToStr(populationData.currentPop,false,0)+'</td><td>'+Utils.FormatNumToStr(Math.floor(populationData.currentPop+populationData.happiness*(1-Math.exp(-24/50))),false,0)+'</td><td>'+Utils.FormatNumToStr(Math.floor(populationData.currentPop+populationData.happiness*(1-Math.exp(-24*7/50))),false,0)+'</td><td></td></tr></tbody></table>' : '';
					var sat = '';
					var img = '';
					if(populationData.growth<-1)
					{
						img = 'outraged';
						sat = '<span style="color:#dc0909"><b>'+LD.angry+'</b></span>';
					}
					else if(populationData.growth<0)
					{
						img = 'sad';
						sat = '<span style="color:#dc0909"><b>'+LD.unhappy+'</b></span>';
					}
					else if(populationData.growth<1)
					{
						img = 'neutral';
						sat = '<span style="color:#1482c4";><b>'+LD.neutral+'</b></span>';
					}
					else if(populationData.growth<6)
					{
						img = 'happy';
						sat = '<span style="color:#4fa253"><b>'+LD.happy+'</b></span>';
					}
					else
					{
						img = 'ecstatic';
						sat = '<span style="color:#4fa253"><b>'+LD.euphoric+'</b></span>';
					}
					var growthTip ='<table><thead><tr><th colspan="5" style="line-height:27px;text-align:center;background: url(\'cdn/all/ltr/premium/buerger_buergerin.png\') no-repeat left / auto 27px, url(\'skin/smilies/'+img+'_x25.png\') no-repeat right / auto 22px">{0}</th></tr></thead><tbody><tr class="data"><td colspan="3">{1}</td><td>«</td><td>{2}</td></tr><tr class="data"><td'+(city.CorruptionCity>0?' class="red"':'')+' colspan="3">{3}</td><td>«</td><td>{4}</td></tr>'+(city.isMuseum?'<tr class="data"><td style="color:#'+(city._culturalGoods!=city.maxculturalgood?'FF0000':'')+'">{5}</td><td>/</td><td>{6}</td><td>«</td><td>{7}</td></tr>':'')+(city.isTavern?'<tr class="data"><td>{8}</td><td>/</td><td>{9}</td><td>«</td><td>{10}</td></tr>':'')+'</tbody></table>{11}';
					return Utils.format(growthTip,[LD.satisfaction,Utils.FormatNumToStr(populationData.happiness,true,0),sat,city.CorruptionCity+' %',LD.corruption,Math.floor(city._culturalGoods),Math.floor(city.maxculturalgood),LD.cultural,Math.floor(city.tavernlevel),Math.floor(city.maxtavernlevel),LD.level_tavern,Tip]);
				}
				function getBonusTip()
				{
					var LD = Constant.LanguageData[database.settings.languageChange.value];
					var populationData = city.populationData;
					var img = populationData.growth > 1 ? (populationData.growth < 6 ? 'happy' : 'ecstatic') : populationData.growth < 0 ? (populationData.growth < -1 ? 'outraged' : 'sad') : 'neutral';
					var clr = populationData.happiness > 0 ? 'green' : (populationData.happiness < 0 ? 'red' : 'blue');
					var growthTip = '<table><thead><tr><th style="text-align:left"><img src="cdn/all/ltr/premium/buerger_buergerin.png" style="height: 27px; float: left"></th><th colspan="3" style="text-align:center"><img src="skin/resources/icon_population.png" style="height:23px; float: right">{1}</th></tr></thead><tbody>{2}<tr style="border-top:1px solid #FFE4B5"><td class="icon incomeIcon" style="line-height:20px;text-align:right"><b>=</b></td><td class="data icon citizenIcon" style="text-align:right;background-position:right;background-size:9px"><b>{3}</b>&nbsp;&nbsp;&nbsp;</td><td>«</td><td>'+LD.bonustiptxt[7]+'</td></tr></tbody><tfoot><tr><td class="icon" style="line-height:20px;text-align:right;background:url(\'skin/icons/livingspace_24x24.png\') no-repeat left / auto 16px"><b>Σ</b></td><td class="data icon citizenIcon" style="line-height:20px;text-align:right;background-position:right;background-size:9px">{4}&nbsp;&nbsp;&nbsp;</td><td>«</td><td>'+LD.bonustiptxt[8]+'</td></tr><tr><td style="text-align:left;color:'+clr+';background-position:right;background-size:9px"><img src="skin/smilies/{0}_x25.png" style="height:14px">&nbsp;<b>{5}</b></td><td class="data icon citizenIcon" style="text-align:right;background-position:right;background-size:9px"><b>{6}</b>&nbsp;&nbsp;&nbsp;</td><td>«</td><td>'+LD.bonustiptxt[9]+'</td></tr></tfoot></table>';
					var growthTr = '<tr class="data"><td class="icon {1}Icon" style="line-height:20px;text-align:right"><b>:</b></td><td class="icon citizenIcon" style="text-align:right;background-position:right;background-size:9px">{0}&nbsp;&nbsp;&nbsp;</td><td>«</td><td>{2}</td></tr>';
					var growthRows = '';
					var incomeSum = 0;
					var i = 0;
					$.each(populationData.satisfaction,function(key,value)
					{
						var total = 0;
						if(key === 'total') return true;
						if(typeof value === 'object')
						{
							for(var type in value)
							{
								total += value[type];
							}
						}
						else
						{
							total += value;
						}
						i++;
						incomeSum += total;
						growthRows += Utils.format(growthTr, [(key=='corruption' && total>0 ? '-':'')+Utils.FormatNumToStr(total,false,1), key, LD.bonustiptxt[i-1]]);
					});
					return Utils.format(growthTip, [img, LD.bonuses, growthRows, Utils.FormatNumToStr(incomeSum, false, 1), Utils.FormatNumToStr(populationData.currentPop, false, 0), '<img src="skin/icons/growth_'+(populationData.happiness >= 0 ? 'positive' : 'negative')+'.png"style="height: 14px; float:right">', Utils.FormatNumToStr(populationData.happiness,false,2)]);
				}
				function getDailyTasksTip()
				{
					var serverTimezoneOffset = unsafeWindow.dataSetForView.serverTimezoneOffset;
					var diff = -(moment().utcOffset()*60-serverTimezoneOffset)*1000;
					var d1 = moment(moment()+diff).add(1,'day').startOf('day')-diff;
					var d2 = moment(moment()+diff).add(1,'week').startOf('week')-diff;
					var test = Utils.FormatFullTimeToDateString(moment()+diff,false);
					var Tip = '<table><thead><tr><th colspan="3" style="line-height:30px;min-width:200px;text-align:center;background:url(\'skin/resources/favour.png\') no-repeat left / 25px 20px,url(\'skin/img/city/IK_stadt_daily_level5.jpg\') no-repeat right / auto 30px">{0}</th></tr></thead><tbody><tr class="data"><td style="text-align:right;color:'+(database._globalData._favour<150 ? 'red' : 'green')+'"><b>{1}</b></td><td>«</td><td>{2}</td></tr><tr><th colspan="3" style="text-align:center">{3}</th></tr><tr><td colspan="3" style="text-align:center">{4}<br>({5})</td></tr><tr><th colspan="3" style="text-align:center">{6}</th></tr><tr><td colspan="3" style="text-align:center">{7}<br>({8})</td></tr></tbody></table>';
					return Utils.format(Tip,[LD.dailytasks,Utils.FormatNumToStr(database._globalData._favour,false,0),LD.favours[database._globalData._favour==1?1:0],LD.renew,Utils.FormatFullTimeToDateString(d1,false),Utils.FormatTimeLengthToStr(d1-$.now(),3),LD.zeroingtasks,Utils.FormatFullTimeToDateString(d2,true),Utils.FormatTimeLengthToStr(d2-$.now(),4)]);
				}
				function getActionPointsTip()
				{
					var garrisonTip = '<table><thead><tr><th colspan="3" style="text-align:center">{0}</th></tr></thead><tbody><tr class="data"><td style="width:25px;line-height:25px;text-align:center;background: url(\'skin/advisors/military/bang_soldier.png\') no-repeat left / auto 25px">&nbsp;</td><td>{1} / {2}</td><td>« {3}</td></tr><tr class="data"><td style="width:25px;line-height:25px;text-align:center;background: url(\'skin/advisors/military/bang_ship.png\') no-repeat left / auto 25px">&nbsp;</td><td>{4} / {5}</td><td>« {6}</td></tr></tbody></table>';
					var units = {army:0,fleet:0};
					$.each(Constant.UnitData,function(id,info)
					{
						units[Constant.UnitData[id].type] += parseInt(city.military.getUnits.getUnit(id));
					});
					return Utils.format(garrisonTip,[LD.garrison,Utils.FormatNumToStr(units.army,false,0),Utils.FormatNumToStr(city.garrisonland,false,0),LD.Inland,Utils.FormatNumToStr(units.fleet,false,0),Utils.FormatNumToStr(city.garrisonsea,false,0),LD.Sea]);
				}
				function getSpyTip()
				{
					var LD = Constant.LanguageData[database.settings.languageChange.value];
					var s = [];
					s[0] = city.getSpies.ondefense;
					s[1] = city.getSpies.inmission;
					s[2] = s[0]+s[1];
					s[3] = city.isSafehouse ? city.getBuildingFromName(Constant.Buildings.SAFEHOUSE).getLevel-s[2] : 0;
					s[4] = city.isSafehouse ? city.getBuildingFromName(Constant.Buildings.SAFEHOUSE).getLevel : 0;
					var spyTip = '<table><thead><tr><th colspan="4" style="text-align:center">{0}</th></tr></thead><tbody><tr class="data"><td style="width:25px;line-height:25px;text-align:center;background:url(\'skin/img/city/safehouse_l.png\') no-repeat center / 44px 39px;background-position: -6px -10px">&nbsp;</td><td>{1}</td><td>({2} %)</td><td>« {3}</td></tr><tr class="data"><td style="width:25px;line-height:20px;text-align:center;background:url(\'skin/minimized/sendspy.png\') no-repeat center / auto 25px">&nbsp;</td><td>{4}</td><td>({5} %)</td><td>« {6}</td></tr><tr class="data" style="border-top:1px solid #bb8e48"><td style="width:25px;line-height:20px;text-align:center;background:url(\'skin/characters/military/120x100/spy_120x100.png\') no-repeat left / auto 23px">&nbsp;</td><td>{7}</td><td>({8} %)</td><td>« {9}</td></tr><tr class="data"><td style="width:25px;line-height:20px;text-align:center;background:url(\'skin/characters/spy_espionage.png\') no-repeat center / auto 18px">&nbsp;</td><td>{10}</td><td>({11} %)</td><td>« {12}</td></tr><tr class="data" style="border-top:1px solid #bb8e48"><td style="width:25px;line-height:20px;text-align:center"><b>&Sigma;</b></td><td>{13}</td><td>({14} %)</td><td>« {15}</td></tr></tbody></table>';
					return Utils.format(spyTip,[LD.spy,Utils.FormatNumToStr(s[0],false,0),Utils.FormatNumToStr(Math.round(s[0]*100/s[4],2),false,2),LD.spytiptxt[0],Utils.FormatNumToStr(s[1],false,0),Utils.FormatNumToStr(Math.round(s[1]*100/s[4],2),false,2),LD.spytiptxt[1],Utils.FormatNumToStr(s[2],false,0),Utils.FormatNumToStr(Math.round(s[2]*100/s[4],2),false,2),LD.spytiptxt[2],Utils.FormatNumToStr(s[3],false,0),Utils.FormatNumToStr(Math.round(s[3]*100/s[4],2),false,2),LD.spytiptxt[3],Utils.FormatNumToStr(s[4],false,0),Utils.FormatNumToStr(Math.round(s[4]*100/s[4],2),false,2),LD.spytiptxt[4]]);
				}
				function getGovTip()
				{
					var LD = Constant.LanguageData[database.settings.languageChange.value];
					var gov = database.getGlobalData.getGovernmentType;
					var Tip = '<table><thead><tr><th style="text-align:center">{0}</th></tr></thead><tbody><tr><td style="text-align:center">{1}<br><img src="skin/government/{2}_280.jpg"></td></tr></tbody></table>';
					return Utils.format(Tip,[LD.government,LD[gov],gov]);
				}
				function getTheaterTip()
				{
					var LD = Constant.LanguageData[database.settings.languageChange.value];
					var cine = database.getGlobalData.getTheaterData;
					var tp = [Constant.Premium.WOOD_BONUS[1],Constant.Premium.TRADEGOOD_BONUS];
					var serverTimezoneOffset = unsafeWindow.dataSetForView.serverTimezoneOffset;
					var diff = -(moment().utcOffset()*60-serverTimezoneOffset)*1000;
					var favsecs = (moment(moment()+diff).add(1,'day').startOf('day')-diff-$.now())/1000;
					// Utils.Format(LD.theatertxts.tip,[LD[ikariam.getCurrentCity.getTradeGood+'_']])
					var cineres = database.getGlobalData.getPremiumTimeRemaining(tp[0])>0 ? database.getGlobalData.hasPremiumFeature(tp[0])?Utils.FormatFullTimeToDateString(database.getGlobalData.getPremiumTimeRemaining(tp[0])+$.now(),false)+'<br>('+Utils.FormatTimeLengthToStr(database.getGlobalData.getPremiumTimeRemaining(tp[0]),3)+')':'' : Utils.format(LD.theatertxts.tip,[LD['wood_']]);
					var cinetrg = database.getGlobalData.getPremiumTimeRemaining(tp[1])>0 ? database.getGlobalData.hasPremiumFeature(tp[1])?Utils.FormatFullTimeToDateString(database.getGlobalData.getPremiumTimeRemaining(tp[1])+$.now(),false)+'<br>('+Utils.FormatTimeLengthToStr(database.getGlobalData.getPremiumTimeRemaining(tp[1]),3)+')':'' : Utils.format(LD.theatertxts.tip,[LD[ikariam.getCurrentCity.getTradeGood+'_']]);
					var cinefav = moment(moment()+diff).add(1,'day').startOf('day')-diff>0 ? Utils.FormatFullTimeToDateString(moment(moment()+diff).add(1,'day').startOf('day')-diff,false)+'<br>('+Utils.FormatTimeLengthToStr((favsecs)*1000,3)+')' : '';
					var Tip = '<table><thead><tr><th colspan="3" style="min-width:200px;text-align:center;background:url(skin/img/city/Kino_aktiv_no_anim.png) no-repeat right / 25px 25px,url(skin/img/city/Kino_inaktiv.png) no-repeat left / 25px 25px">{0}</th></tr></thead><tbody><tr class="data"><td style="text-align:right">{1}</td><td>«</td><td>{2}</td></tr><tr><th colspan="3" style="text-align:center">{3}</th></tr><tr><td colspan="3" style="text-align:center">{4}</td></tr><tr><th colspan="3" style="text-align:center">{5}</th></tr><tr><td colspan="3" style="text-align:center">{6}</td></tr><tr><th colspan="3" style="text-align:center">{7}</th></tr><tr><td colspan="3" style="text-align:center">{8}</td></tr></tbody></table>';
					return Utils.format(Tip,[LD.Cinetheatre,LD.theatertxts[cine.status],LD.theatertxts.status,LD.theatertxts.resource+(database.getGlobalData.getPremiumTimeCityId(tp[0])!==undefined && database.getCityFromId(database.getGlobalData.getPremiumTimeCityId(tp[0]))!==null ? ' | '+database.getCityFromId(database.getGlobalData.getPremiumTimeCityId(tp[0])).getName : ''),cineres,Utils.format(LD.theatertxts.tradegood+(database.getGlobalData.getPremiumTimeCityId(tp[1])!==undefined && database.getCityFromId(database.getGlobalData.getPremiumTimeCityId(tp[1]))!==null ? ' | '+database.getCityFromId(database.getGlobalData.getPremiumTimeCityId(tp[1])).getName : ''),[LD.theatertxts[database.getCityFromId(database.getGlobalData.getPremiumTimeCityId(tp[1]))!==null ? database.getCityFromId(database.getGlobalData.getPremiumTimeCityId(tp[1])).getTradeGood : 'luxury']]),cinetrg,LD.theatertxts.favour,cinefav]);
				}
				function getPiratesTip()
				{
					var LD = Constant.LanguageData[database.settings.languageChange.value];
					var duration = [150,450,900,1800,3600,7200,14400,28800,57600];
					var serverTimezoneOffset = unsafeWindow.dataSetForView.serverTimezoneOffset;
					var p = database.getGlobalData.getPirates;
					var b = 0;
					$.each(database.cities,function(i,city)
					{
						b += city.isPirateFortress?city.getBuildingFromName(Constant.Buildings.PIRATE_FORTRESS).getLevel*2:0;
					});
					var diff = serverTimezoneOffset-moment().utcOffset()*60;
					var dailyreset = moment().startOf('day').add({h:parseInt(p.dailyreset[0]),m:parseInt(p.dailyreset[1])}).subtract(diff,'s');
					var resetin = moment(p.resetin).startOf('day').add({h:18,m:0}).subtract(diff,'seconds');
					var dailyduration = dailyreset>$.now()?dailyreset-$.now():dailyreset.add(1,'day')-$.now();
					var mission = p.miss && $.now()<=p.mission.endtime ? Utils.format('<tr><th colspan="3" style="text-align:center">{0}</th></tr><tr class="data"><td colspan="3" style="margin:0px;padding:0px;height:20px;border-bottom:1px solid #bb8e48"><div style="height:20px;width:{1}%;background:url(\'skin/interface/progressbar_anim.gif\') 0px"></div><div style="display:table;margin:0px auto 0px auto;font-weight:bold;text-shadow: -1px -1px 0 #FFFFFF, 1px -1px 0 #FFFFFF, -1px 1px 0 #FFFFFF, 1px 1px 0 #FFFFFF;text-align:center;position:relative;top:-19px;margin-bottom:-18px">{2}</div></td></tr><tr><td colspan="3" style="text-align:center">{3}</td></tr>',['<u>'+LD.mission+' ('+LD[p.mission.type]+')</u>'+(p.mission.level==-1?'':'<br>'+LD.pirtxt[p.mission.level+18]),p.mission.type=='raid'?100:((duration[p.mission.level]*1000-(p.mission.endtime-$.now()))/(duration[p.mission.level]*1000)*100),(p.mission.type=='raid'?'&nbsp;':Utils.FormatNumToStr((duration[p.mission.level]*1000-(p.mission.endtime-$.now()))/(duration[p.mission.level]*1000)*100,false,2)+' %'),Utils.FormatFullTimeToDateString(p.mission.endtime,false)+'<br>('+Utils.FormatTimeLengthToStr(p.mission.endtime-$.now(),4)+')']) : '';
					var conversion = p.conv && $.now()<=p.conversion.endtime ? Utils.format('<tr><th colspan="3" style="text-align:center">{0}</th></tr><tr><td colspan="3" style="margin:0px;padding:0px;height:20px;border-bottom:1px solid #bb8e48"><div style="height:20px;width:{1}%;background:url(\'skin/interface/progressbar_anim.gif\') 0px"></div><div style="display:table;margin:0px auto 0px auto;font-weight:bold;text-shadow: -1px -1px 0 #FFFFFF, 1px -1px 0 #FFFFFF, -1px 1px 0 #FFFFFF, 1px 1px 0 #FFFFFF;text-align:center;position:relative;top:-19px;margin-bottom:-18px">{2} %</div></td></tr><tr><td colspan="3" style="text-align:center">{3}</td></tr>',[LD.convert,(((p.conversion.points*0.7+156)*1000-(p.conversion.endtime-$.now()))/((p.conversion.points*0.7+156)*1000)*100),Utils.FormatNumToStr(((p.conversion.points*0.7+156)*1000-(p.conversion.endtime-$.now()))/((p.conversion.points*0.7+156)*1000)*100,false,2),Utils.FormatFullTimeToDateString(p.conversion.endtime,false)+'<br>('+Utils.FormatTimeLengthToStr(p.conversion.endtime-$.now(),4)+')']) : '';
					var Tip = '<table><thead><tr><th colspan="3" style="min-width:210px;text-align:center;background:url(\'skin/resources/capturePoints.png\') no-repeat left / 30px 20px,url(\'skin/img/city/pirateFortress_l.png\') no-repeat right / auto 35px">{0}</th></tr></thead><tbody><tr class="data"><td style="text-align:right">{1}</td><td>«</td><td>{2}</td></tr><tr class="data"><td style="text-align:right">{3}</td><td>«</td><td>{4}</td></tr><tr class="data" style="border-top:1px solid #bb8e48"><td style="text-align:right"><b>{5}</b></td><td>«</td><td>{6}</td></tr><tr><td style="text-align:right">{7}</td><td>«</td><td>{8}</td></tr><tr class="data" style="border-top:1px solid #bb8e48"><td style="text-align:right"><b>{9}</b></td><td>«</td><td>{10}</td></tr><tr class="data" style="border-top:1px solid #bb8e48"><td style="text-align:right"><b>{11}</b></td><td>«</td><td>{12}</td></tr>'+(p.position>0?'<tr><td style="text-align:right"><b>{13}</b></td><td>«</td><td>{14} {20}</td></tr>':'')+'{15}'+(resetin-moment()>1800000?'<tr><th colspan="3" style="text-align:center">{16}</th></tr><tr><td colspan="3" style="text-align:center">{17}</td></tr>':'')+'<tr><th colspan="3" style="text-align:center">{18}</th></tr><tr><td colspan="3" style="text-align:center">{19}</td></tr></tbody></table>';
					var mul = Utils.mul(p.position);
					return Utils.format(Tip,
					[
						LD.pirates,
						Utils.FormatNumToStr(b,false,0),
						LD.pirtxt[5],
						Utils.FormatNumToStr(p.points,false,0),
						LD.pirtxt[2],
						Utils.FormatNumToStr(b+p.points,false,0),
						LD.subsum,
						Utils.FormatNumToStr(p.strength>=7000?1400:0,false,0),
						LD.pirtxt[6],
						Utils.FormatNumToStr(b+p.points+(p.strength>=7000?1400:0),false,0),
						LD.total_,
						Utils.FormatNumToStr(p.strength,false,0),
						LD.pirtxt[3],
						Utils.Nth(p.position),
						LD.classify,
						mission+conversion,
						LD.dailyreset,
						Utils.FormatFullTimeToDateString(dailyreset,true)+'<br>('+Utils.FormatTimeLengthToStr(dailyduration,3)+')',
						LD.finalevaluation,
						Utils.FormatFullTimeToDateString(resetin,true)+'<br>('+Utils.FormatTimeLengthToStr(resetin-$.now(),4)+')',
						p.position>0?'<span style="float:right"> ('+(mul>0?'<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAcAAAAJCAYAAAD+WDajAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAEFJREFUeNpi/P//PwMIhOrzQhhAsPriZ0YQzYQugcxnQhaE6YABxhA9HhRdyICJAQ/AayzxOtFdzYRuFLIVAAEGANwqFwuukYKqAAAAAElFTkSuQmCC"> &times; '+Utils.FormatNumToStr(mul,false,3).replace(/0+$/,'').replace(/[,.]$/,'')+' = <img src="skin/resources/icon_wood.png" style="width:auto;height:10px">+<img src="data:image/gif;base64,R0lGODlhGgAUAPZ9AA8KCScZFjY2FjslJFMzM0VAG3pIC0xzC15KNzNedXNIR2tWQnRgTXtoVYdUD5dlFaNyHIteK61+IolSUp5cXYFuW4VzYYh2Y415ZI58abRqasV4dlyJD2ibEHOtEnuPNHSlILeLLYWrN8qfNIfIFbuXXZOBbZmHdbGafMGWQdStQuG8Tc6sbd++YKHKT+3KU+/QbPXVY+zPefPWeEWGpV2TrE+Ut2ees2OrzmqszXqyzW2y1G+53ny20nK323a63Hu/4X/A4aCQgKqbi7mihbSnmIyoqZmuq5OytqWxpa2zpL+0pLu+q8qvidW4jNy+lMS7oMS5q7vHvePGi/XahejIl+XHnebInO/anv7kg9jEqNbKrM3Cs8LKvtPKvOzPpenRrfXlvYzA15TD2ITD4onH5o3J5pPK5JvN5ZXN6JbQ7qLQ5qTT667Z7bTa7Lrd7Lvh8s3QwcnUzc/YztvSxOXayenj2crg5s7p9tLr99bu+PXw6Pz37wAAAAAAAAAAACH5BAUAAH0ALAAAAAAaABQAAAf/gH2Cg3ZCKIOIfU4HHCBOiYhLdg0ZF02QHYwgLpCCWl51CxcNFZBEHIxEnWBeXEN2GA0NiU4EAQUHHR2QdEtFXnsNJhlPg04UAxMbAh0cHom9dkV7CycnJn1XA8kbEwAfzh0kglZ2UXVeXnYIGRXYVxrdAQEEJBwdHs9WdF4ZGSdR1jGoMMvJAAIEAGygkAvfLi+9KDGwQAcBAgYM+kwgoEyBggFONnAgsatTJydOFDwaRISECEhVXpQwSRMSFRgwSlQxuSVOzTAxwoSAEKHTER9l5pjkIwNLFhgPHjiYIojJGSlGyASpkQTSlykzZsQYkcLACgOCkKQx08MHkARyZhLxwTJjxIoXD1ZAkOBAkJI3QH6MoaFDDaK5VFqEqPtAxQoHDwbdYIMjjRs8QLoMwtIiRYgYKiQ8SPFCtCAoZ3LsgIMGTh4eg6pMqTLjRQoJLFjAUIFWkA0xevq0WdOmx52ayDsFAgA7" style="width:auto;height:10px">':LD.pirtxt[52])+')</span>':''
					]);
				}
				function getForestMineTip(c)
				{
					var LD = Constant.LanguageData[database.settings.languageChange.value];
					var serverTyp = 1;
					if(ikariam.Server()=='s201' || ikariam.Server()=='s202') serverTyp = 3;
					var o = {'islandwood':'resource','islandgood':'tradegood'};
					var v = Object.keys(o).indexOf(c)!=-1 ? o[c] : null;
					var fm = city['_'+(v && v=='resource' ? 'forest' : 'mine')]; // city['get'+(v && v=='resource' ? 'Forest' : 'Mine')];
					var uConst = fm.endUpgradeTime*1000 > $.now();
					var i = [Constant.Resources.WOOD,Constant.Resources.WINE,Constant.Resources.MARBLE,Constant.Resources.GLASS,Constant.Resources.SULFUR];
					var rid = i[v && v=='resource' ? 0 : city.getTradeGoodID];
					var gov = Constant.GovernmentData[database.getGlobalData.getGovernmentType].buildingTime;
					var t = (Math.round((v && v=='resource' ? 7200 : 14400)*Math.pow(1.1,fm.level+1)-(v && v=='resource' ? 7200 : 14400))*1000)*(1+gov);
					var time = '<tr class="total"><td colspan="3" style="text-align:center;background:url(\'skin/resources/icon_time.png\') no-repeat left / auto 20px">'+Utils.FormatFullTimeToDateString((uConst ? fm.endUpgradeTime*1000+(Math.round((v && v=='resource' ? 7200 : 14400)*Math.pow(1.1,fm.level+2)-(v && v=='resource' ? 7200 : 14400))*1000)*(1+gov)/serverTyp : ($.now()+t)/serverTyp),true)+'<br>('+Utils.FormatTimeLengthToStr((uConst ? (Math.round((v && v=='resource' ? 7200 : 14400)*Math.pow(1.1,fm.level+2)-(v && v=='resource' ? 7200 : 14400))*1000)*(1+gov) : t)/serverTyp,4)+')</td></tr>';
					var percent = ($.now()-(fm.endUpgradeTime*1000-t))*100/t;
					var Tip = '<table><thead><tr><th colspan="3" style="min-width:200px;line-height:'+(uConst?1:3)+'5px;text-align:center;background:url(\'skin/resources/icon_{0}.png\') no-repeat left / auto,url(\'skin/characters/y100_worker_{2}_faceleft.png\') no-repeat right / auto 30px">{1}</th></tr>'+(uConst ? Utils.format('<tr  class="data"><td colspan="3" style="margin:0px;padding:0px;height:20px"><div style="height:20px;width:{0}%;background: url(\'skin/interface/progressbar_anim.gif\') 0px"></div><div style="display:table;margin:0px auto 0px auto;text-shadow: -1px -1px 0 #FFFFFF, 1px -1px 0 #FFFFFF, -1px 1px 0 #FFFFFF, 1px 1px 0 #FFFFFF;height:20px;text-align:center;line-height: 20px;position:relative;top:-20px;margin-bottom:-20px;background-color:transparent;font-weight:bold">{1}</div></td></tr>',[percent,Utils.FormatNumToStr(percent,false,2)+' %']):'')+'</thead><tbody>'+(uConst ? Utils.format('<tr><td colspan="3" style="text-align:center;background:url(\'skin/upgrade/nextlevelarrow.png\') no-repeat left / auto 10px,url(\'skin/resources/icon_time.png\') no-repeat right / auto 15px">{0}<br><b>({1})</b></td></tr>',[Utils.FormatFullTimeToDateString(fm.endUpgradeTime*1000,true),Utils.FormatTimeLengthToStr(fm.endUpgradeTime*1000-$.now(),4)]) : '')+'<tr class="data" style="border-top:1px solid #FFE4B5"><td>{3}</td><td>«</td><td>{4}</td></tr><tr class="data"><td>{5}</td><td>«</td><td>{6}</td></tr><tr class="data"><td>{7}</td><td>«</td><td>{8}</td></tr><tr class="data"><td>{9}</td><td>«</td><td>{10}</td></tr><tr class="data"><td>{11}</td><td>«</td><td>{12}</td></tr><tr class="data" style="border-top:1px solid #FFE4B5"><td style="white-space:nowrap">{13}</td><td>«</td><td>{14}</td></tr><tr class="data"><td style="white-space:nowrap">{15} %</td><td>«</td><td>{16}</td></tr><tr class="data" style="border-top:1px solid #FFE4B5"><td style="white-space:nowrap;color:red">{17}</td><td>«</td><td>{18}</td></tr><tr class="data"><td style="white-space:nowrap">{19} %</td><td>«</td><td>{20}</td></tr></tbody><tfoot>{21}</tfoot></table>';
					var maxWorkers = Constant.IslandBuildings[v=='resource'?'forest':'mine'].workers[fm.level+(!uConst&&$.now()>(fm.endUpgradeTime*1000)&&fm.endUpgradeTime>0?1:0)];
					return Utils.format(Tip,[rid,LD.forminetitle[v=='resource'?0:city.getTradeGoodID]+(uConst?'<br><span style="color:green;font-weight:normal">'+LD.constructing_mine+'</span>':''),v&&v=='resource'?'wood':v,uConst?'<span style="color:green;font-weight:bold">'+fm.level+' > '+(fm.level+1)+'</span>' : fm.level+($.now()>(fm.endUpgradeTime*1000)&&fm.endUpgradeTime>0?1:0),LD[v+'level'],Utils.FormatNumToStr(fm.workers<=maxWorkers?fm.workers:maxWorkers,false,0)+' / '+Utils.FormatNumToStr(maxWorkers,false,0),LD.workers+' <span style="float:right">('+Utils.FormatNumToStr((fm.workers<=maxWorkers?fm.workers/maxWorkers:1)*100,false,0)+' %)</span>',Utils.FormatNumToStr(fm.workers>maxWorkers?fm.workers-maxWorkers:0,false,0)+' / '+Utils.FormatNumToStr(maxWorkers*0.5,false,0),LD.unskilled+' <span style="float:right">('+Utils.FormatNumToStr((fm.workers>maxWorkers?(fm.workers-maxWorkers)/(maxWorkers*0.5):0)*100,false,0)+' %)</span>',Utils.FormatNumToStr(fm.donatedResources,false,0),LD.wonderdonations,Utils.FormatNumToStr(uConst ? Constant.IslandBuildings[v=='resource'?'forest':'mine'].wood[fm.level+1] : (!uConst&&$.now()>(fm.endUpgradeTime*1000)&&fm.endUpgradeTime>0?Constant.IslandBuildings[v=='resource'?'forest':'mine'].wood[fm.level+1]:fm.maxwood),false,0),LD.maxwood,Utils.FormatNumToStr(uConst?0:fm.curwood,false,0),LD.curwood,Utils.FormatNumToStr((uConst?0:fm.curwood)*100/(uConst?Constant.IslandBuildings[v=='resource'?'forest':'mine'].wood[fm.level+1] : (!uConst&&$.now()>(fm.endUpgradeTime*1000)&&fm.endUpgradeTime>0?Constant.IslandBuildings[v=='resource'?'forest':'mine'].wood[fm.level+1]:fm.maxwood)),false,2),Utils.FormatQuantityToLoad(uConst?0:fm.curwood),Utils.FormatNumToStr(uConst ? Constant.IslandBuildings[v=='resource'?'forest':'mine'].wood[fm.level+1] : (!uConst&&$.now()>(fm.endUpgradeTime*1000)&&fm.endUpgradeTime>0?Constant.IslandBuildings[v=='resource'?'forest':'mine'].wood[fm.level+1]:fm.maxwood)-fm.curwood,false,0),LD.diffwood,Utils.FormatNumToStr(100-(uConst ? 0 : fm.curwood)*100/(uConst ? Constant.IslandBuildings[v=='resource'?'forest':'mine'].wood[fm.level+1] : (!uConst&&$.now()>(fm.endUpgradeTime*1000)&&fm.endUpgradeTime>0?Constant.IslandBuildings[v=='resource'?'forest':'mine'].wood[fm.level+1]:fm.maxwood)),false,2),Utils.FormatQuantityToLoad(uConst ? Constant.IslandBuildings[v=='resource'?'forest':'mine'].wood[fm.level+1] : (!uConst&&$.now()>(fm.endUpgradeTime*1000)&&fm.endUpgradeTime>0?Constant.IslandBuildings[v=='resource'?'forest':'mine'].wood[fm.level+1]:fm.maxwood)-fm.curwood),time]);
				}
				function getTempleTip()
				{
					var LD = Constant.LanguageData[database.settings.languageChange.value];
					var populationData = city.populationData;
					var w = city.getWonder;
					var wC = [604800,345600,777600,604800,86400,259200,86400,259200];
					var wD = [86400,57600,129600,86400,14400,43200,14402,0];
					if(w.submittime>0 && city.getBuildingFromName(Constant.Buildings.TEMPLE))
					{
						if($.now()<w.submittime+wD[w.id-1]*1000)
						{
							var cooltxt = LD.miraclecompletion;
							var cooltime = '<b>('+Utils.FormatTimeLengthToStr(w.submittime+wD[w.id-1]*1000-$.now(), 3)+'!)';
						}
						else if($.now()<w.submittime+(wD[w.id-1]+wC[w.id-1])*1000)
						{
							var cooltxt = LD.cooldowncompletion;
							var cooltime = Utils.FormatFullTimeToDateString(w.submittime+(wC[w.id-1])*1000)+'<br>('+Utils.FormatTimeLengthToStr(w.submittime+(wC[w.id-1])*1000-$.now(), 4)+')';
						}
					}
					var withTemple = city.getBuildingFromName(Constant.Buildings.TEMPLE) ? Utils.format('<tr class="data"><td>{0}</td><td>«</td><td colspan="2">{1}</td></tr><tr class="data"><td style="white-space:nowrap">{2}%</td><td>«</td><td colspan="2">{3}</td></tr><tr class="data"><td>{4}%</td><td>«</td><td colspan="2">{5}</td></tr>'+(w.submittime>0 ? '<tr class="data"><td style="white-space:nowrap">'+cooltime+'</td><td>«</td><td colspan="2">'+cooltxt+'</td></tr>' : ''),[city._priests,LD.priests,Utils.FormatNumToStr(city._priests*500/populationData.maxPop,false,2),LD.conversion,Utils.FormatNumToStr(w.islandshare*100,false,2),LD.islandshare]) : '';
					var barometer = '<div style="width:calc('+w.level+'12px * 0.3125);height:20px;background:url(\'skin/wonder/belief_bar2.png\') no-repeat center -22px / calc('+w.level+'12px * 0.3125) auto"><div style="width:'+(3.75+160*w.curislandfaith)+'px;height:20px;background:url(\'skin/wonder/belief_bar2.png\') no-repeat 0px -44px / calc('+w.level+'12px * 0.3125) auto;float:left"></div></div>';
					var Tip = '<table><thead><th colspan="2" style="width:40px;line-height:35px;text-align:center;'+(0<w.id&&w.id<9?'background: url(\'skin/wonder/w{0}.png\') no-repeat left / auto 35px':'')+'">&nbsp;</th><th style="text-align:center">{1}</th><th style="width:40px;background: url(\'skin/buildings/x40_y40/temple.png\') no-repeat right / auto 35px"></th></thead><tbody>'+withTemple+'<tr class="data" style="border-top:1px solid #FFE4B5"><td style="white-space:nowrap">{6} %</td><td>«</td><td colspan="2">{7}</td></tr><tr class="data"><td style="white-space:nowrap"></td><td></td><td colspan="2"></td></tr></tbody></table>';
					return Utils.format(Tip,[w.id,LD.wonders[w.id]+(city.getBuildingFromName(Constant.Buildings.TEMPLE)?'':'<br><span style="color:red">'+LD.wonders[0]+'</span>'),w.level,LD.wonderlevel,w.faithlevel,LD.faithlevel,Utils.FormatNumToStr(w.maxislandfaith*100,false,2),LD.maxislandfaith]);
				}
				function getWonderTip()
				{
					var LD = Constant.LanguageData[database.settings.languageChange.value];
					var populationData = city.populationData;
					var w = city.getWonder;
					var withTemple = city.getBuildingFromName(Constant.Buildings.TEMPLE) ? Utils.format('<tr class="data"><td style="white-space:nowrap">{0} %</td><td>«</td><td colspan="2">{1}</td></tr>',[Utils.FormatNumToStr(city._priests*500/populationData.maxPop,false,2),LD.conversion]) : '';
					var barometer = '<div style="width:calc('+w.level+'12px * 0.3125);height:18px;background:url(\'skin/wonder/belief_bar2.png\') no-repeat center -22px / calc('+w.level+'12px * 0.3125) auto"><div style="width:'+(1.75+160*w.curislandfaith)+'px;height:20px;background:url(\'skin/wonder/belief_bar2.png\') no-repeat 0px -44px / calc('+w.level+'12px * 0.3125) auto;float:left"></div></div>';
					var Tip = '<table><thead><th colspan="2" style="width:40px;line-height:35px;text-align:center;'+(0<w.id&&w.id<9?'background: url(\'skin/wonder/w{0}.png\') no-repeat left / auto 35px':'')+'">&nbsp;</th><th style="text-align:center">{1}</th><th style="width:40px;background: url(\'skin/buildings/x40_y40/temple.png\') no-repeat right / auto 35px"></th></thead><tbody>'+withTemple+'<tr class="data" style="border-top:1px solid #FFE4B5"><td>{2}</td><td>«</td><td colspan="2">{3}</td></tr><tr class="data"><td>{4}</td><td>«</td><td colspan="2">{5}</td></tr><tr class="data"><td>{6}</td><td>«</td><td colspan="2">{7}</td></tr><tr class="data"><td style="white-space:nowrap">{8} %</td><td>«</td><td colspan="2">'+barometer+'</td></tr><tr class="data"><td style="white-space:nowrap">{10} %</td><td>«</td><td colspan="2">{11}</td></tr></tbody></table>';
					return Utils.format(Tip,[w.id,LD.wonders[w.id]+(city.getBuildingFromName(Constant.Buildings.TEMPLE)?'':'<br><span style="color:red">'+LD.wonders[0]+'</span>'),w.level,LD.wonderlevel,w.faithlevel,LD.faithlevel,Utils.FormatNumToStr(w.donatedResources,false,0),LD.wonderdonations,Utils.FormatNumToStr(w.curislandfaith*100.41,false,2),LD.curislandfaith,Utils.FormatNumToStr(w.maxislandfaith*100,false,2),LD.maxislandfaith]);
				}
				function getFinanceTip()
				{
					var LD = Constant.LanguageData[database.settings.languageChange.value];
                    var b = database.getGlobalData.hasPremiumFeature(Constant.Premium.GOLD_BONUS)*Constant.PremiumData[Constant.Premium.GOLD_BONUS].bonus;
					var income = city.getIncome>0?Utils.format('<tr class="data"><td></td><td class="data">{0}</td><td class="data">{1}</td><td class="data">{2}</td>',[Utils.FormatNumToStr(city.getIncome,true,0),Utils.FormatNumToStr(city.getIncome*24,false,0),Utils.FormatNumToStr(city.getIncome*7*24,false,0)]):'';
					var bonus = b>0?Utils.format('<tr class="data"><td style="width:24px;height:25px;background:url(\''+Constant.PremiumData[Constant.Premium.GOLD_BONUS].icon+'\') no-repeat -600px;background-size: auto 25px"></td><td class="data" style="text-align:right">{0}</td><td class="data" style="text-align:right">{1}</td><td class="data" style="text-align:right">{2}</td>',[Utils.FormatNumToStr(city.getIncome*b,true,0),Utils.FormatNumToStr(city.getIncome*b*24,false,0),Utils.FormatNumToStr(city.getIncome*b*7*24,false,0)]):'';
					var expense = city.getExpenses<0?Utils.format('<tr class="data"><td></td><td style="text-align:right">{0}</td><td style="text-align:right">{1}</td><td style="text-align:right">{2}</td>',[Utils.FormatNumToStr(city.getExpenses,true,0),Utils.FormatNumToStr(city.getExpenses*24,false,0),Utils.FormatNumToStr(city.getExpenses*7*24,false,0)]):'';
					var tot = Math.floor(city.getIncome*(1+b)+city.getExpenses);
					var total = bonus!='' || expense!='' ? Utils.format('<tr class="total" style="border-top:1px solid #FFE4B5"><th style="text-align:left">Σ'+(tot>0?'+':(tot<0?'-':''))+'</th><td style="text-align:right">{0}</td><td style="text-align:right">{1}</td><td style="text-align:right">{2}</td>',[Utils.FormatNumToStr(tot,false,0),Utils.FormatNumToStr(tot*24,false,0),Utils.FormatNumToStr(tot*7*24,false,0)]) : '';
					var Tip = '<table><thead><tr><th style="text-align:center"><img src="skin/resources/icon_upkeep.png" style="height:14px"></th><th style="text-align:center">{0}</th><th style="text-align:center">{1}</th><th style="text-align:center">{2}</th></tr></thead><tbody>{3}</tbody><tfoot>{4}</tfoot></table>';
					return Utils.format(Tip,['1 '+LD.hour,'1 '+LD.day,'1 '+LD.week,income+bonus+expense,total]);
				}
				function getResearchTip()
				{
					var LD = Constant.LanguageData[database.settings.languageChange.value];
					var isAcademy = city.getBuildingFromName(Constant.Buildings.ACADEMY);
					var researchData = city.research.researchData;
					var cultural = researchData.culturalGoods + researchData.premiumCulturalGoodsBonus;
					var premium = researchData.premiumScientistBonus;
					var tr = '<tr class="data"><td>{0}</td><td>{1}</td><td>{2}</td><td colspan="3">« {3}</td></tr>';
					var gov = {'demokratie':[cultural,'cultural_r','museum/icon32_culturalgood.png','+'],'theokratie':[(researchData.scientists+researchData.researchBonus+premium)*0.05,'cultural_r','government/zepter_20.png','-'],'technokratie':[(researchData.scientists+researchData.researchBonus+premium)*0.05,'cultural_r','government/zepter_20.png','+'],'anarchie':[(researchData.scientists+researchData.researchBonus+premium)*0.25,'cultural_r','government/zepter_20.png','-']};
					var g = Object.keys(gov).indexOf(database.getGlobalData.getGovernmentType)!=-1 ? gov[database.getGlobalData.getGovernmentType] : '';
					var rows = g!=''?Utils.format(tr,['<img src="skin/'+g[2]+'" style="height:14px;">',g[3],Utils.FormatNumToStr(g[0],false,2),LD[g[1]]]):'';
					if(premium){rows += Utils.format(tr,['<img src="skin/premium/b_premium_research.jpg" style="width:15px;">','+',Utils.FormatNumToStr(premium,false,2),LD.potion]);}
					if(researchData.corruption){rows += Utils.format(tr,['<img src="skin/icons/corruption_24x24.png" style="height:14px;">','-',Utils.FormatNumToStr(researchData.corruption,false,2),LD.corruption]);}
					var tot = researchData.scientists+researchData.researchBonus+(database.getGlobalData.getGovernmentType==Constant.Government.THEOCRACY?-1:1)*(g!=''?g[0]:0)+premium-researchData.corruption;
					var tooltip = tot>0 ? '<table><thead><tr style="height:25px"><th colspan="5" style="line-height:25px;text-align:center;vertical-align:middle"><img src="skin/characters/40h/scientist_r.png" style="height:25px;float:left"><b>{0}</b><img src="skin/buildings/y50/y50_academy.png" style="height:25px;float:right"></th></tr></thead><tbody>'+(isAcademy!=null?'<tr class="data"><td colspan="2"><img src="skin/premium/details_premium_research_advisor.jpg" style="height:20px;"></td><td>{3}</td><td colspan="2">« {4}</td></tr><tr class="data" style="border-top:1px solid #bb8e48"><td><img src="skin/characters/40h/scientist_r.png" style="height:16px;"></td><td>+</td><td>{5}</td><td colspan="2">« {6}</td></tr><tr class="data"><td><img src="skin/icons/researchbonus_30x30.png" style="height: 16px;"></td><td>+</td><td>{7}</td><td colspan="2">« {8}</td></tr>':'')+'{1}<tr class="data" style="border-top:1px solid #bb8e48"><td><b>&Sigma;</b></td><td>+</td><td>{9}</td><td colspan="2">« '+LD.research_hp+'</td></tr></tbody><tfoot><tr><th colspan="2" style="text-align:center;vertical-align:middle"><img src="skin/resources/icon_research_time.png" style="height:19px;"></th><th style="text-align:center;vertical-align:middle">{10}</th><th style="text-align:center;vertical-align:middle">{11}</th><th conspan="2" style="text-align:center;vertical-align:middle">{12}</th></tr><tr class="data"><td colspan="2" style="text-align:center;vertical-align:middle"><img src="skin/layout/bulb-on.png" style="width:14px;height:12px;display:inline;margin-left:-7px;"><img src="skin/layout/bulb-on.png" style="width:14px;height:12px;display:inline;margin-left:-7px;"><img src="skin/layout/bulb-on.png" style="width:14px;height:12px;display:inline;margin-left:-7px;"></td><td style="text-align:center;vertical-align:middle">{13}</td><td style="text-align:center;vertical-align:middle">{14}</td><td style="text-align:center;vertical-align:middle">{15}</td></tr></tfoot></table>' : '';
					return Utils.format(tooltip,[LD[isAcademy!=null?'academy':'researchP'],rows,Utils.FormatNumToStr(researchData.total,false,2),Utils.FormatNumToStr(city.maxSci,false,0),LD.scientists_max,Utils.FormatNumToStr(researchData.scientists,false,0),LD.scientists_employed+(' ('+Utils.FormatNumToStr((researchData.scientists*100/city.maxSci),false,2)+' %)'),Utils.FormatNumToStr(researchData.researchBonus,false,2),LD.from_researchs,Utils.FormatNumToStr(tot,false,2),'1 '+LD.hour,'1 '+LD.day,'1 '+LD.week,Utils.FormatNumToStr(Math.round(tot),false,0),Utils.FormatNumToStr(Math.round(tot*24),false,0),Utils.FormatNumToStr(Math.round(tot*24*7),false,0)]);
				}
				function getIncomingTip()
				{
					var LD = Constant.LanguageData[database.settings.languageChange.value];
					var cRes = city.getResource(resourceName).getCurrent;
					if(resourceName===Constant.Resources.GOLD) { cRes = database.getGlobalData.finance.currentGold; }
					var rMov = database.getGlobalData.getResourceMovementsToCity(city.getId);
					var table = '<table><thead>{0}</thead><tbody>{1}</tbody><tfoot>{2}</tfoot></table>';
					var row = '<tr class="data" style="border-top:1px solid #FFE4B5"><td colspan="2"><div class="icon2 {0}Image" style="display:inline-block;float:left"></div>{1}</td><td>« <b>'+LD.from+' {2}</b></td></tr><td><img src="skin/img/icon_target2.png" style="height:16px;float:left;"></td><td>{3}</td><td class="small data">« ({4})</td></tr><td colspan="2"><b>{5}</b></td><td>« '+LD.arrival_time+'</td></tr>';
					var header = '<tr><th><div class="icon2 merchantImage"></div></th><th colspan="3"><span style="color:#071b67";><center><b>'+ LD.transport +'</b></center></span></th></tr>';
					var subtotal = '<tr class="total" style="border-top:1px solid #FFE4B5"><td><img src="skin/icons/portLoadingIcon.png" style="height:16.5px;float:left;"><img src="skin/icons/tradeAdvisorFilter/Icon_IkariamPlus_News_20x20.png" style="height:16px;float:left">=</td><td>{0}</td><td colspan="2">{1}</td></tr>';
					var footer = '<tr class="total"><td><img src="skin/icons/tradeAdvisorFilter/Icon_Warentransport_20x20.png" style="height:15px;float:left"><b>&Sigma;:</b></td><td>{0}</td><td>« <span style="color:#071b67";><b>'+LD.after_transport+'</b></td></tr>';
					if(rMov.length)
					{
						var trades = '';
						var transp = '';
						var plunder = '';
						var movTotal = 0;
						for(var movID in rMov)
						{
							if(!$.isNumeric(movID))
							{
								break;
							}
							if(rMov[movID].getResources[resourceName])
							{
								var origin = database.getCityFromId(rMov[movID].getOriginCityId);
								var tMov = Utils.format(row,[rMov[movID].getMission,'<span style="float:left;margin-left:5px">'+Utils.FormatQuantityToLoad(rMov[movID].getResources[resourceName],false,rMov[movID].getCapacityPerShip)+'</span> '+Utils.FormatNumToStr(rMov[movID].getResources[resourceName],false,0),origin?origin.getName:rMov[movID].getOriginCityId,Utils.FormatRemainingTime(rMov[movID].getArrivalTime-$.now()),rMov[movID].isLoading?LD.loading+': '+ Utils.FormatRemainingTime(rMov[movID].getLoadingTime,false):rMov[movID].getArrivalTime>$.now()?LD.en_route:LD.arrived,Utils.FormatFullTimeToDateString(rMov[movID].getArrivalTime)]);
								if(rMov[movID].getMission == "trade")
								{
									trades += tMov;
								}
								else if(rMov[movID].getMission == 'transport')
								{
									transp += tMov;
								}
								else if(rMov[movID].getMission == 'plunder')
								{
									plunder += tMov;
								}
								movTotal += rMov[movID].getResources[resourceName];
							}
						}
						if(trades==='' && transp==='' && plunder==='')
						{
							return '';
						}
						var body = trades+transp+plunder+Utils.format(subtotal,[Utils.FormatNumToStr(movTotal,false,0),'« '+LD.total_cargo+'']);
						var foot = Utils.format(footer,[Utils.FormatNumToStr((movTotal+cRes),false,0)]);
						var head = Utils.format(header, []);
						return Utils.format(table,[head,body,foot]);
					}
					return '';
				}
				function getCurrentResTip()
				{
					if(resourceName!==Constant.Resources.GOLD)
					{
						var max = city.maxResourceCapacities;
						var cap = city.getResource(resourceName).getCurrent;
						var hardcap = 2562500;
						var icon = '<img src="{0}" style="width:auto;height:20px;position:relative;top:5px;left:0px">';
						var icons = (max.buildings.warehouse.storage>0?Utils.format(icon,[Constant.BuildingData[Constant.Buildings.WAREHOUSE].icon])+'+':'')+(max.buildings.dump.storage>0?Utils.format(icon,[Constant.BuildingData[Constant.Buildings.DUMP].icon])+'<br>+':'')+Utils.format(icon,[Constant.BuildingData[Constant.Buildings.TOWN_HALL].icon]);
						var branch = max.branchOffice.storage>0?Utils.format(icon,[Constant.BuildingData[Constant.Buildings.TRADING_POST].icon]):'';
						var tip = '<table><thead><tr><th rowspan="2" style="text-align:center"><img src="skin/premium/safecapacity_small.png" style="height:30px"></th><th colspan="3" style="text-align:center"><img src="skin/resources/icon_{0}.png" style="height:20px"></th><th rowspan="2" style="text-align:center">{1}</th></tr><tr><th style="text-align:center">{2}</th><th style="text-align:center">{3}</th><th style="text-align:center">{4}</th></tr></thead><tbody><tr class="data"><td rowspan="3" style="text-align:center;white-space:nowrap;border-bottom:2px solid #faf3d7">{5}</td><td>{6}</td><td>{7}</td><td>{8}</td><td rowspan="3" style="border-bottom:2px solid #faf3d7">« {9}</td></tr><tr class="data"><td>{10} %</td><td>{11} %</td><td style="text-align:right">{12} %</td></tr><tr><td style="text-align:center;border-bottom:2px solid #faf3d7">{13}</td><td style="text-align:center;border-bottom:2px solid #faf3d7">{14}</td><td style="text-align:center;border-bottom:2px solid #faf3d7">{15}</td></tr><tr class="data"><td rowspan="3" style="text-align:center;border-bottom:1px solid #bb8e48">{16}</td><td>{17}</td><td>{18}</td><td>{19}</td><td rowspan="3" style="border-bottom:1px solid #bb8e48">« {20}</td></tr><tr class="data"><td>{21} %</td><td>{22} %</td><td style="text-align:right">{23} %</td></tr><tr class="data"><td style="text-align:center;border-bottom:1px solid #bb8e48">{24}</td><td style="text-align:center;border-bottom:1px solid #bb8e48">{25}</td><td style="text-align:center;border-bottom:1px solid #bb8e48">{26}</td></tr><tr class="data"><td rowspan="3" style="text-align:center">{27}</td><td>{28}</td><td>{29}</td><td>{30}</td><td rowspan="3">« {31}</td></tr><tr class="data"><td>{32} %</td><td>{33} %</td><td style="text-align:right">{34} %</td></tr><tr class="data"><td style="text-align:center">{35}</td><td style="text-align:center">{36}</td><td style="text-align:center">{37}</td></tr></tbody></table>';
						var notip = '<table><thead><th colspan="4" style="text-align:center"><img src="skin/resources/icon_{0}.png" style="height:20px"></th></thead><tbody><tr><td style="border-bottom:1px solid #bb8e48">{1}</td><td style="border-bottom:1px solid #bb8e48">{2}</td><td style="border-bottom:1px solid #bb8e48">«</td><td style="border-bottom:1px solid #bb8e48">{3}</td></tr><tr><td style="text-align:center;border-bottom:1px solid #faf3d7">{4}</td><td style="text-align:center;border-bottom:1px solid #faf3d7">{5}</td><td style="border-bottom:1px solid #faf3d7">«</td><td style="border-bottom:1px solid #faf3d7">{6}</td></tr><tr><td>{7}</td><td>{8}</td><td rowspan="3" style="border-bottom:1px solid #faf3d7">«</td><td rowspan="3" style="border-bottom:1px solid #faf3d7">{9}</td></tr><tr><td>{10} %</td><td style="text-align:right">{11} %</td></tr><tr><td style="text-align:center;border-bottom:1px solid #faf3d7">{12}</td><td style="text-align:center;border-bottom:1px solid #faf3d7">{13}</td></tr><tr><td>{14}</td><td>{15}</td><td rowspan="3" style="border-bottom:1px solid #faf3d7">«</td><td rowspan="3" style="border-bottom:1px solid #faf3d7">{16}</td></tr><tr><td>{17} %</td><td style="text-align:right">{18} %</td></tr><tr><td style="text-align:center;border-bottom:1px solid #faf3d7">{19}</td><td style="text-align:center;border-bottom:1px solid #faf3d7">{20}</td></tr></tbody></table>';
						return max.branchOffice.storage>0?Utils.format(tip,[resourceName,LD.capacity,LD.maximum,LD.missing,LD.current,icons,Utils.FormatNumToStr(max.capacity,false,0),Utils.FormatNumToStr(max.capacity-Math.min(max.capacity,cap),false,0),Utils.FormatNumToStr(Math.min(max.capacity,cap),false,0),LD.used,Utils.FormatNumToStr((max.capacity)*100/hardcap,false,2),Utils.FormatNumToStr((max.capacity-Math.min(max.capacity,cap))*100/max.capacity,false,2),Utils.FormatNumToStr((Math.min(max.capacity,cap))*100/max.capacity,false,2),Utils.FormatQuantityToLoad(max.capacity),Utils.FormatQuantityToLoad(max.capacity-Math.min(max.capacity,cap)),Utils.FormatQuantityToLoad(Math.min(max.capacity,cap)),branch,Utils.FormatNumToStr(max.branchOffice.storage,false,0),Utils.FormatNumToStr(max.branchOffice.storage-city.getResource(resourceName).branchOffice,false,0),Utils.FormatNumToStr(city.getResource(resourceName).branchOffice,false,0),LD.branchreserved,Utils.FormatNumToStr((max.branchOffice.storage)*100/max.capacity,false,2),Utils.FormatNumToStr((max.branchOffice.storage-city.getResource(resourceName).branchOffice)*100/max.branchOffice.storage,false,2),Utils.FormatNumToStr((city.getResource(resourceName).branchOffice)*100/max.branchOffice.storage,false,2),Utils.FormatQuantityToLoad(max.branchOffice.storage),Utils.FormatQuantityToLoad(max.branchOffice.storage-city.getResource(resourceName).branchOffice),Utils.FormatQuantityToLoad(city.getResource(resourceName).branchOffice),icons+'-'+branch,Utils.FormatNumToStr(max.capacity-max.branchOffice.storage,false,0),Utils.FormatNumToStr(max.capacity-Math.min(max.capacity,cap)-max.branchOffice.storage+city.getResource(resourceName).branchOffice,false,0),Utils.FormatNumToStr(Math.min(max.capacity,cap)-city.getResource(resourceName).branchOffice,false,0),LD.foruse,Utils.FormatNumToStr((max.capacity-max.branchOffice.storage)*100/max.capacity,false,2),Utils.FormatNumToStr((max.capacity-Math.min(max.capacity,cap)-max.branchOffice.storage+city.getResource(resourceName).branchOffice)*100/(max.capacity-max.branchOffice.storage),false,2),Utils.FormatNumToStr((Math.min(max.capacity,cap)-city.getResource(resourceName).branchOffice)*100/(max.capacity-max.branchOffice.storage),false,2),Utils.FormatQuantityToLoad(max.capacity-max.branchOffice.storage),Utils.FormatQuantityToLoad(max.capacity-Math.min(max.capacity,cap)-max.branchOffice.storage+city.getResource(resourceName).branchOffice),Utils.FormatQuantityToLoad(Math.min(max.capacity,cap)-city.getResource(resourceName).branchOffice)]):Utils.format(notip,[resourceName,Utils.FormatNumToStr(hardcap,false,0),Utils.FormatQuantityToLoad(hardcap),LD.maximum,LD.currentunits,LD.time_to_full,LD.units,Utils.FormatNumToStr(max.capacity,false,0),Utils.FormatNumToStr(hardcap-max.capacity,false,0),LD.currcap,Utils.FormatNumToStr(max.capacity*100/hardcap,false,2),Utils.FormatNumToStr((hardcap-max.capacity)*100/hardcap,false,2),Utils.FormatQuantityToLoad(max.capacity),Utils.FormatQuantityToLoad(hardcap-max.capacity),Utils.FormatNumToStr(cap,false,0),Utils.FormatNumToStr(max.capacity-cap,false,0),LD.currquant,Utils.FormatNumToStr(cap*100/max.capacity,false,2),Utils.FormatNumToStr((max.capacity-cap)*100/max.capacity,false,2),Utils.FormatQuantityToLoad(cap),Utils.FormatQuantityToLoad(max.capacity-cap)]);
					}
				}
				function getBuildingTooltip(building)
				{
					if(building)
					{
						var LD = Constant.LanguageData[database.settings.languageChange.value];
						var uConst = building.isUpgrading;
						var resourceCost = building.getUpgradeCost;
						var serverTyp = 1;
						if(ikariam.Server() == 's201' || ikariam.Server() == 's202') serverTyp = 3;
						var elem = '';
						var sum = 0;
						var dsum = [0,0];
						var time = 0;
						var ctime = 0;
						var needlevel = 0;
						var costlevel = 0;
						ctime = Constant.BuildingData[building.getName].time;
						ctime = (building.getName==Constant.Buildings.PIRATE_FORTRESS?ctime[building.getLevel]:Math.round(ctime.a/ctime.b*Math.pow(ctime.c,building.getLevel+1)-ctime.d))*1000;
						needlevel = building.getLevel+2;
						costlevel = building.getLevel+1;
						for(var key in resourceCost)
						{
							if(key=='time')
							{
								time = '<tr class="total"><td rowspan="2"><img src="skin/resources/icon_time.png" style="height:20px;float:left"></td><td colspan="2" style="text-align:center">'+Utils.FormatFullTimeToDateString(resourceCost[key]/serverTyp+(!uConst?$.now():building.getCompletionTime),true)+'<br>('+Utils.FormatTimeLengthToStr(resourceCost[key]/serverTyp,3,' ')+')</td></tr>';
								continue;
							}
							if(resourceCost[key])
							{
								var diff = building.city().getResource(key).getCurrent-resourceCost[key];
								sum += resourceCost[key];
								dsum[diff<0?0:1] += diff;
								elem += '<tr class="data" style="border-top:2px solid #faf3d7"><td><div class="icon '+key+'Image" style="float:left"></div></td><td>'+Utils.FormatNumToStr(resourceCost[key],false,0)+'<br><span style="color:black">'+Utils.FormatQuantityToLoad(resourceCost[key])+'</span></td><td class="'+(diff<0?'red':'green')+'" style="text-align:right">'+(diff<0?'':'<img src="skin/interface/check_mark_17px.png" style="height:12px">')+' ('+Utils.FormatNumToStr(diff,true,0)+')<br><span style="color:black">'+Utils.FormatQuantityToLoad(Math.abs(diff))+'</span></td></tr>';
							}
						}
						elem = (elem!=='') ? '<table><thead><tr><th align="center"><img src="skin/characters/y100_worker_tradegood_faceleft.png" style="height:30px;float:left"></th><th style="text-align:center;white-space:nowrap" colspan="2"><b>'+(uConst?LD.next_Level+' '+needlevel:LD.next_Level+' '+costlevel)+'</b></th></tr></thead><tbody>'+elem+'<tr class="data" style="border-top:1px solid #bb8e48"><td style="text-align:center"><b>&Sigma;:</b></td><td>'+Utils.FormatNumToStr(sum,false,0)+'<br><span style="color:black">'+Utils.FormatQuantityToLoad(sum)+'</span></td><td class="'+(dsum[0]<0?'red':'green')+'" style="text-align:right">('+Utils.FormatNumToStr(dsum[dsum[0]<0?0:1],true,0)+')<br><span style="color:black">'+Utils.FormatQuantityToLoad(Math.abs(dsum[dsum[0]<0?0:1]))+'</span></td></tr></tbody><tfoot>'+time+'</tfoot></table>':uConst?'':'<table><thead><tr><th colspan="3" align="center">'+LD.max_Level_complete+'</th></tr></thead></table>';
						if(uConst)
						{
							elem = '<table><thead><tr><th colspan="3" style="text-align:center"><img src="skin/img/island/city_green.png" style="height: 22px;"></th></tr><tr class="data"><td colspan="3" style="margin:0px;padding:0px;height:20px;border-bottom:1px solid #bb8e48"><div style="height:20px;width:'+(((ctime/serverTyp)-(building.getCompletionTime-$.now()))/(ctime/serverTyp)*100)+'%;background:url(\'skin/interface/progressbar_anim.gif\') 0px"></div><div style="display:table;margin:0px auto 0px auto;font-weight:bold;text-shadow: -1px -1px 0 #FFFFFF, 1px -1px 0 #FFFFFF, -1px 1px 0 #FFFFFF, 1px 1px 0 #FFFFFF;text-align:center;position:relative;top:-19px;margin-bottom:-18px">'+Utils.FormatNumToStr(((ctime/serverTyp)-(building.getCompletionTime-$.now()))/(ctime/serverTyp)*100,false,2)+' %</div></td></tr></thead><tbody><tr><td rowspan="2"><img src="skin/upgrade/buildingground_86x50.png" style="height:30px;float:left"><img src="skin/resources/icon_time.png" style="height:15px;display:inline-block;text-align:right;vertical-align:middle"></td><td style="text-align:center">'+Utils.FormatFullTimeToDateString(building.getCompletionTime,true)+'</td></tr><tr><td style="text-align:center">('+Utils.FormatTimeLengthToStr(building.getCompletionTime-$.now(),3)+')</td></tr></tbody></table>'+elem;
						}
						return elem;
					}
					else
					{
						return '';
					}
				}
				function getGrowthTotalTip()
				{
					var LD = Constant.LanguageData[database.settings.languageChange.value];
					var totals = ['',[],'',[],'',[],[],'',[],[],''];
					totals[0] = LD.satisfaction;
					totals[2] = LD.bonustiptxt[9];
					totals[4] = LD.bonustiptxt[10];;
					totals[7] = LD.cultural;
					totals[10] = LD.tavern_level;
					$.each(database.cities,function(k,city)
					{
						totals[1].push(parseInt(city.populationData.happiness));
						totals[3].push(parseInt(city.CorruptionCity));
						totals[5].push(parseInt(city._culturalGoods));
						totals[6].push(parseInt(city.maxculturalgood));
						totals[8].push(parseInt(city.tavernlevel));
						totals[9].push(parseInt(city.maxtavernlevel));
					});
					totals[1] = Utils.FormatNumToStr(totals[1].reduce(function(a,b){return a+b;},0),true,0);
					var corrsum = totals[3].reduce(function(a,b){return a+b;},0);
					totals[3] = Utils.FormatNumToStr(corrsum / totals[3].length,false,2);
					totals[5] = totals[5].reduce(function(a,b){return a+b;},0);
					totals[6] = totals[6].reduce(function(a,b){return a+b;},0);
					totals[8] = totals[8].reduce(function(a,b){return a+b;},0);
					totals[9] = totals[9].reduce(function(a,b){return a+b;},0);
					return Utils.format('<table><thead><th colspan="5" style="line-height:27px;text-align:center;background: url(\'cdn/all/ltr/premium/buerger_buergerin.png\') no-repeat left / auto 27px, url(\'skin/smilies/happy_x25.png\') no-repeat right / auto 22px">{0}</th></thead><tbody><tr><td colspan="3">{1}</td><td>«</td><td>{2}</td></tr><tr><td colspan="3" style="color:#'+(corrsum>0?'FF0000':'00FF00')+'">{3} %</td><td>«</td><td>{4}</td></tr>'+(totals[6]>0?'<tr><td>'+(totals[5]!=totals[6] ? '<span class="red">' : '')+'{5}'+(totals[5]!=totals[6] ? '</span>' : '')+'</td><td>/</td><td>{6}</td><td>«</td><td>{7}</td></tr>':'')+(totals[9]>0?'<tr><td>{8}</td><td>/</td><td>{9}</td><td>«</td><td>{10}</td></tr>':'')+'</tbody></table>',totals);
				}
				function getResearchTotalTip()
				{
					var LD = Constant.LanguageData[database.settings.languageChange.value];
					var scientists = 0;
					var bonus = 0;
					var premium = 0;
					var corruption = 0;
					var cultural = 0;
					$.each(database.cities,function(k,city)
					{
						var researchData = city.research.researchData;
						scientists += researchData.scientists;
						bonus += researchData.researchBonus;
						premium += researchData.premiumScientistBonus;
						cultural += researchData.culturalGoods+researchData.premiumCulturalGoodsBonus;
						corruption += researchData.corruption;
					});
					var gov = {'demokratie':[cultural,'cultural_r','museum/icon32_culturalgood.png','+',19],'theokratie':[(scientists+bonus+premium)*0.05,'cultural_r','government/zepter_20.png','-',16],'technokratie':[(scientists+bonus+premium)*0.05,'cultural_r','government/zepter_20.png','+',16],'anarchie':[(scientists+bonus+premium)*0.25,'cultural_r','government/zepter_20.png','-',16]};
					var g = Object.keys(gov).indexOf(database.getGlobalData.getGovernmentType)!=-1 ? gov[database.getGlobalData.getGovernmentType] : '';
					var total = scientists+bonus+premium+(database.getGlobalData.getGovernmentType==Constant.Government.THEOCRACY?-1:1)*(g!=''?g[0]:0)-corruption;
					var tip = '<table><thead><tr><th colspan="2" style="text-align:center"><img src="skin/resources/icon_research_time.png" style="height:23px"></th><th style="text-align:center">{0}</th><th style="text-align:center">{1}</th><th style="text-align:center">{2}</th></tr></thead><tbody>{3}</tbody>{4}</table>';
					return Utils.format(tip,['1 '+LD.hour,'1 '+LD.day,'1 '+LD.week,(scientists>0?Utils.format('<tr class="data"><td><img src="skin/resources/icon_scientist.png" style="height:18px"></td><td style="text-align:right">+</td><td style="text-align:right">{0}</td><td style="text-align:right">{1}</td><td style="text-align:right">{2}</td></tr>',[Utils.FormatNumToStr(Math.round(scientists),false,0),Utils.FormatNumToStr(Math.round(scientists)*24,false,0),Utils.FormatNumToStr(Math.round(scientists)*24*7,false,0)]):'')+(bonus>0?Utils.format('<tr class="data"><td><img src="skin/icons/researchbonus_30x30.png" style="height:18px"></td><td>+</td><td style="text-align:right">{0}</td><td style="text-align:right">{1}</td><td style="text-align:right">{2}</td></tr>',[Utils.FormatNumToStr(Math.round(bonus),false,0),Utils.FormatNumToStr(Math.round(bonus)*24,false,0),Utils.FormatNumToStr(Math.round(bonus)*24*7,false,0)]):'')+(g!=''?Utils.format('<tr class="data"><td><img src="skin/{0}" style="height:{1}px"></td><td>+</td><td style="text-align:right">{2}</td><td style="text-align:right">{3}</td><td style="text-align:right">{4}</td></tr>',[g[2],g[4],g[0],Utils.FormatNumToStr(Math.round(g[0]),false,0),Utils.FormatNumToStr(Math.round(g[0])*24,false,0),Utils.FormatNumToStr(Math.round(g[0])*24*7,false,0)]):'')+('')+(premium>0?Utils.format('<tr class="data"><td><img src="skin/premium/b_premium_research.png" style="height:16px"></td><td>+</td><td style="text-align:right">{0}</td><td style="text-align:right">{1}</td><td style="text-align:right">{2}</td></tr>',[Utils.FormatNumToStr(Math.round(premium),false,0),Utils.FormatNumToStr(Math.round(premium*24),false,0),Utils.FormatNumToStr(Math.round(premium*24*7),false,0)]):'')+(corruption>0?Utils.format('<tr class="data"><td><img src="skin/icons/corruption_24x24.png" style="height:18px"></td><td>-</td><td style="text-align:right">{0}</td><td style="text-align:right">{1}</td><td style="text-align:right">{2}</td></tr>',[Utils.FormatNumToStr(Math.round(corruption),false,0),Utils.FormatNumToStr(Math.round(corruption*24),false,0),Utils.FormatNumToStr(Math.round(corruption*24*7),false,0)]):'')+(total>0?Utils.format('<tfoot><tr><th style="text-align:center">&Sigma;</th><th>+</th><th style="text-align:right">{0}</th><th style="text-align:right">{1}</th><th style="text-align:right">{2}</th></tr></tfoot>',[Utils.FormatNumToStr(Math.round(total),false,0),Utils.FormatNumToStr(Math.round(total*24),false,0),Utils.FormatNumToStr(Math.round(total*24*7),false,0)]):'')]);
				}
				function getResourceTotalTip()
				{
					var totals = {};
					var res;
					$.each(database.cities,function(cityId,city)
					{
						$.each(Constant.Resources,function(key,resourceName)
						{
							res = city.getResource(resourceName);
							if(!totals[resourceName])
							{
								totals[resourceName] = {};
							}
							totals[resourceName].total = totals[resourceName].total ? totals[resourceName].total + res.getCurrent : res.getCurrent;
							totals[resourceName].income = totals[resourceName].income ? totals[resourceName].income + res.getProduction * 3600 - res.getConsumption : res.getProduction * 3600 - res.getConsumption;
							if(resourceName === Constant.Resources.GOLD)
							{
								var bonus = (1+(database.getGlobalData.hasPremiumFeature(Constant.Premium.GOLD_BONUS)*Constant.PremiumData[Constant.Premium.GOLD_BONUS].bonus));
								var researchCost = 0, expense = 0, inGold = 3;
								res = 0;
								res += Math.floor(city.getIncome*bonus + city.getExpenses);
								researchCost += Math.floor(city.getExpenses);
								expense = (database.getGlobalData.finance.armyCost + database.getGlobalData.finance.armySupply + database.getGlobalData.finance.fleetCost + database.getGlobalData.finance.fleetSupply) / database.getCityCount;
								inGold = database.getGlobalData.finance.currentGold / database.getCityCount;
								totals[resourceName].total = totals[resourceName].total ? totals[resourceName].total + inGold : inGold;
								totals[resourceName].income = totals[resourceName].income ? totals[resourceName].income + res - expense : res - expense;
							}
						});
					});
					var r = '';
					var finalSums = {income: 0, total: 0, day: 0, week: 0};
					$.each(totals, function(resourceName, data)
					{
						var day = data.total + data.income * 24;
						var week = data.total + data.income * 168;
						r += Utils.format('<tr class="data"><td><div class="icon {0}Image"></div></td><td style="text-align:right">{1}</td><td style="text-align:right">{2}</td><td style="text-align:right">{3}</td><td style="text-align:right">{4}</td></tr>',[resourceName,Utils.FormatNumToStr(data.income,true,0),Utils.FormatNumToStr(data.total,true,0),Utils.FormatNumToStr(day,true,0),Utils.FormatNumToStr(week,true,0)]);
						finalSums.income += data.income;
						finalSums.total += data.total;
						finalSums.day += day;
						finalSums.week += week;
					});
					return r==='' ? '' : Utils.format('<table><thead><tr><td><img src="skin/img/icon_arrival.png" style="height:20px;float:left"></td><td style="text-align:center"><b>'+LD.per_+'<br>{5}</b></td><td style="text-align:center"><b>{6}</b></td><td style="text-align:center"><b>Σ '+LD.in_+' 1<br>{7}</b></td><td style="text-align:center"><b>Σ '+LD.in_+' 1<br>{8}</b></td></tr></thead><tbody>{0}</tbody></td></table>',[r,Utils.FormatNumToStr(finalSums.income,true,0),Utils.FormatNumToStr(finalSums.total,true,0),Utils.FormatNumToStr(finalSums.day,true,0),Utils.FormatNumToStr(finalSums.week,true,0),LD.hour_long,LD.currenttotal_,LD.day_long,LD.week_long]);
				}
				function getProgressTip()
				{
					if(resourceName == 'population' || resourceName =='ui-corner-all'){return '';}
					var storage = city.maxResourceCapacities;
					var current = city.getResource(resourceName).getCurrent;
					var fulltime = (city.getResource(resourceName).getFullTime || -city.getResource(resourceName).getEmptyTime)*3600000;
					moment.locale(database.settings.languageChange.value);
					var dur = moment().add(Math.abs(fulltime),'ms');
					var serverTyp = 1;
					if (ikariam.Server() == 's201' || ikariam.Server() == 's202') serverTyp = 3;
					var gold = city.plundergold>0 && serverTyp!=1 ? '<tr><td><img src="skin/resources/icon_gold.png" style="height:12px;"></td><td>'+Utils.FormatNumToStr(city.plundergold)+'</td><td>\u221E</td><td> « '+LD.plundergold +'</td></tr>' : '';
					var progTip = '<table><thead><tr><th><img src="skin/premium/safecapacity_small.png" style="height: 30px;"></th><th>{12}<th><img src="skin/resources/icon_{21}.png" style="height:20px"></th><th colspan="2">{13}</th></tr></thead><tbody>{0}{11}<tr class="total" style="border-top:1px solid #daa520"><td>{9}</td><td>{1}</td><td>{2}</td><td>« <span style="color:#dc0909;"><b>{14}</b></span></td></tr><tr class="total"><td></td><td>{16}</td><td>{17}</td><td>« {18}</td></tr><tr><td></td><td>{19}</td><td>{20}</td><td>{22}</td></tr><tr class="total" style="border-top:1px solid #daa520"><td>{10}</td><td>{3}</td><td>{4}</td><td>« {15}</td></tr><tr><td></td><td>{5}</td><td>{6}</td><td>{23}</td></tr></tbody><tfoot><tr><td><img src="skin/resources/icon_time.png" style="height: 18px;"></td><td colspan="2" style="text-align:center">{7}</td><td>« <span style="color:#dc0909;"><b>{8}</b></span></td></tr></tfoot></table>';
					var progTr = '<tr class="data"><td style="width:10px;background:url(\'{0}\');background-size:auto 26px; background-position:+5px -5px;background-repeat:no-repeat;"></td><td>{1}</td><td>{2}</td><td>« {3}</td></tr>';
					var rows = '';
					$.each(storage.buildings,function(buildingName,data) { rows += Utils.format(progTr,[Constant.BuildingData[buildingName].icon,Utils.FormatNumToStr(data.safe,false,0),Utils.FormatNumToStr(data.storage,false,0),data.lang]); });
//					console.log([rows,Utils.FormatNumToStr(storage.safe,false,0),Utils.FormatNumToStr(storage.capacity,false,0),Utils.FormatNumToStr(Math.min(storage.safe,current),false,0),Utils.FormatNumToStr(Math.min(storage.capacity,current),false,0),Utils.FormatNumToStr(Math.min(1,current/storage.safe)*100,false,2)+' %',Utils.FormatNumToStr(Math.min(1,current/storage.capacity)*100,false,2)+' %',Utils.FormatFullTimeToDateString(dur)==''?' \u221E ':Utils.FormatFullTimeToDateString(dur,true)+'<br>('+Utils.FormatTimeLengthToStr(fulltime,4)+')',fulltime<0?LD.time_to_empty:LD.time_to_full,database.getGlobalData.hasPremiumFeature(Constant.Premium.STORAGECAPACITY_BONUS)?'<img src="skin/premium/b_premium_storagecapacity.jpg" style="width:21px">':'',database.getGlobalData.hasPremiumFeature(Constant.Premium.SAFECAPACITY_BONUS)?'<img src="skin/premium/b_premium_safecapacity.jpg" style="width:21px">':'',gold,LD.safe,LD.capacity,LD.maximum,LD.used,Utils.FormatNumToStr(storage.safe-Math.min(storage.safe,current),false,0),Utils.FormatNumToStr(storage.capacity-Math.min(storage.capacity,current),false,0),LD.missing,Utils.FormatNumToStr(100-(Math.min(1,current/storage.safe)*100),false,2===0)?Utils.FormatNumToStr(100-(Math.min(1,current/storage.safe)*100),false,2)+' %':Utils.FormatNumToStr(100-(Math.min(1,current/storage.safe)*100),false,2)+' %',Utils.FormatNumToStr(100-(Math.min(1,current/storage.capacity)*100),false,2===0)?Utils.FormatNumToStr(100-(Math.min(1,current/storage.capacity)*100),false,2)+' %':Utils.FormatNumToStr(100-(Math.min(1,current/storage.capacity)*100),false,2)+' %',resourceName,Utils.FormatQuantityToLoad(storage.capacity-Math.min(storage.capacity,current)),Utils.FormatQuantityToLoad(Math.min(storage.capacity,current))]);
					return Utils.format(progTip,[rows,Utils.FormatNumToStr(storage.safe,false,0),Utils.FormatNumToStr(storage.capacity,false,0),Utils.FormatNumToStr(Math.min(storage.safe,current),false,0),Utils.FormatNumToStr(Math.min(storage.capacity,current),false,0),Utils.FormatNumToStr(Math.min(1,current/storage.safe)*100,false,2)+' %',Utils.FormatNumToStr(Math.min(1,current/storage.capacity)*100,false,2)+' %',Utils.FormatFullTimeToDateString(dur)==''?' \u221E ':Utils.FormatFullTimeToDateString(dur,true)+'<br>('+Utils.FormatTimeLengthToStr(fulltime,4)+')',fulltime<0?LD.time_to_empty:LD.time_to_full,database.getGlobalData.hasPremiumFeature(Constant.Premium.STORAGECAPACITY_BONUS)?'<img src="skin/premium/b_premium_storagecapacity.jpg" style="width:21px">':'',database.getGlobalData.hasPremiumFeature(Constant.Premium.SAFECAPACITY_BONUS)?'<img src="skin/premium/b_premium_safecapacity.jpg" style="width:21px">':'',gold,LD.safe,LD.capacity,LD.maximum,LD.used,Utils.FormatNumToStr(storage.safe-Math.min(storage.safe,current),false,0),Utils.FormatNumToStr(storage.capacity-Math.min(storage.capacity,current),false,0),LD.missing,Utils.FormatNumToStr(100-(Math.min(1,current/storage.safe)*100),false,2===0)?Utils.FormatNumToStr(100-(Math.min(1,current/storage.safe)*100),false,2)+' %':Utils.FormatNumToStr(100-(Math.min(1,current/storage.safe)*100),false,2)+' %',Utils.FormatNumToStr(100-(Math.min(1,current/storage.capacity)*100),false,2===0)?Utils.FormatNumToStr(100-(Math.min(1,current/storage.capacity)*100),false,2)+' %':Utils.FormatNumToStr(100-(Math.min(1,current/storage.capacity)*100),false,2)+' %',resourceName,Utils.FormatQuantityToLoad(storage.capacity-Math.min(storage.capacity,current)),Utils.FormatQuantityToLoad(Math.min(storage.capacity,current))]);
				}
				function getConsumptionTooltip(consumption,force)
				{
					var warehouse = 0;
					var dump = 0;
					$.each(database.cities,function(k,c)
					{
						warehouse += c.isWarehouse ? 1 : 0;
						dump += c.isDump ? 1 : 0;
					});
					warehouse = city!=null ? city.isWarehouse : warehouse;
					dump = city!=null ? city.isDump : dump;
					var maxc = parseInt($('#js_GlobalMenu_maxTransporters').text())*500;
					return (consumption===0 && !force) || resourceName!==Constant.Resources.WINE ? '' : Utils.format('<table><thead><tr><th><img src="skin/resources/icon_{0}.png" style="height:14px"></th><th style="text-align:center">{1}</th><th style="text-align:center">{2}</th><th style="text-align:center">{3}</th></tr></thead><tbody><tr class="data"><td></td><td style="text-align:center">{4}</td><td style="text-align:center">{5}</td><td style="text-align:center">{6}</td></tr><tr class="data"><td></td><td style="text-align:center">{7}</td><td style="text-align:center">{8}</td><td style="text-align:center">{9}</td></tr><tr><th colspan="3" style="text-align:center">'+LD.cargo+'</th><th style="text-align:center">'+LD.duration+'</th></tr><tr><td colspan="3" style="text-align:center">100 <img src="skin/icons/portLoadingIcon.png"></td><td style="text-align:center">'+Utils.FormatTimeLengthToStr(100*3600000/consumption,3)+'</td></tr><tr><td colspan="3" style="text-align:center">200 <img src="skin/icons/portLoadingIcon.png"></td><td style="text-align:center">'+Utils.FormatTimeLengthToStr(200*3600000/consumption,3)+'</td></tr><tr><td colspan="3" style="text-align:center">300 <img src="skin/icons/portLoadingIcon.png"></td><td style="text-align:center">'+Utils.FormatTimeLengthToStr(300*3600000/consumption,3)+'</td></tr><tr><td colspan="3" style="text-align:center">400 <img src="skin/icons/portLoadingIcon.png"></td><td style="text-align:center">'+Utils.FormatTimeLengthToStr(400*3600000/consumption,3)+'</td></tr><tr><td colspan="3" style="text-align:center">1 &nbsp;<img src="skin/relatedCities/trade_ship_20.png" style="width:auto;height:10px;display:inline;margin-left:-3px;"></td><td style="text-align:center">'+Utils.FormatTimeLengthToStr(500*3600000/consumption,3)+'</td></tr>'+(warehouse>0 && maxc>=8000?'<tr><td colspan="3" style="text-align:center">1 &nbsp;<img src="'+Constant.BuildingData[Constant.Buildings.WAREHOUSE].icon+'" style="width:auto;height:12px;display:inline;margin-left:-3px;"></td><td style="text-align:center">'+Utils.FormatTimeLengthToStr(8000*3600000/consumption,3)+'</td></tr>':'')+(dump>0 && maxc>=32000?'<tr><td colspan="3" style="text-align:center">1 &nbsp;<img src="'+Constant.BuildingData[Constant.Buildings.DUMP].icon+'" style="width:auto;height:12px;display:inline;margin-left:-3px;"></td><td style="text-align:center">'+Utils.FormatTimeLengthToStr(32000*3600000/consumption,3)+'</td></tr>':'')+'<tr><td colspan="3" style="text-align:center">1 &nbsp;<img src="skin/relatedCities/trade_ship_20.png" style="width:auto;height:10px;display:inline;margin-left:-3px;"><img src="skin/relatedCities/trade_ship_20.png" style="width:auto;height:10px;display:inline;margin-left:-3px;"><img src="skin/relatedCities/trade_ship_20.png" style="width:auto;height:10px;display:inline;margin-left:-3px;"></td><td style="text-align:center">'+Utils.FormatTimeLengthToStr(maxc*3600000/consumption,3)+'</td></tr>'+(warehouse>0 && maxc<8000?'<tr><td colspan="3" style="text-align:center">1 &nbsp;<img src="'+Constant.BuildingData[Constant.Buildings.WAREHOUSE].icon+'" style="width:auto;height:12px;display:inline;margin-left:-3px;"></td><td style="text-align:center">'+Utils.FormatTimeLengthToStr(8000*3600000/consumption,3)+'</td></tr>':'')+(dump>0 && maxc<32000?'<tr><td colspan="3" style="text-align:center">1 &nbsp;<img src="'+Constant.BuildingData[Constant.Buildings.DUMP].icon+'" style="width:auto;height:12px;display:inline;margin-left:-3px;"></td><td style="text-align:center">'+Utils.FormatTimeLengthToStr(32000*3600000/consumption,3)+'</td></tr>':'')+'</tbody></table>',[Constant.Resources.WINE,'1 '+LD.hour,'1 '+LD.day,'1 '+LD.week,Utils.FormatNumToStr(-consumption,true,0),Utils.FormatNumToStr(-consumption*24,true,0),Utils.FormatNumToStr(-consumption*24*7,true,0),Utils.FormatQuantityToLoad(consumption),Utils.FormatQuantityToLoad(consumption*24),Utils.FormatQuantityToLoad(consumption*24*7)]);
				}
				function getProductionTip(income,force)
				{
					var warehouse = 0;
					var dump = 0;
					$.each(database.cities,function(k,c)
					{
						warehouse += c.isWarehouse ? 1 : 0;
						dump += c.isDump ? 1 : 0;
					});
					warehouse = city!=null ? city.isWarehouse : warehouse;
					dump = city!=null ? city.isDump : dump;
					var resName = resourceName=='glass' ? 'crystal' : resourceName;
					var resBonus = database.getGlobalData.hasPremiumFeature(Constant.Premium[resourceName.toUpperCase()+'_BONUS']);
					var maxc = parseInt($('#js_GlobalMenu_maxTransporters').text())*500;
					return income===0 && !force ? '' : Utils.format('<table><thead><tr><th><img src="skin/resources/icon_{0}.png" style="height:14px"></th><th style="text-align:center">{1}</th><th style="text-align:center">{2}</th><th style="text-align:center">{3}</th></tr></thead><tbody><tr class="data"><td>{7}</td><td style="text-align:center">{4}</td><td style="text-align:center">{5}</td><td style="text-align:center">{6}</td></tr><tr class="data"><td></td><td style="text-align:center">{8}</td><td style="text-align:center">{9}</td><td style="text-align:center">{10}</td></tr><tr><th colspan="3" style="text-align:center">'+LD.cargo+'</th><th style="text-align:center">'+LD.duration+'</th></tr><tr><td colspan="3" style="text-align:center">100 <img src="skin/icons/portLoadingIcon.png"></td><td style="text-align:center">'+Utils.FormatTimeLengthToStr(100*3600000/income,3)+'</td></tr><tr><td colspan="3" style="text-align:center">200 <img src="skin/icons/portLoadingIcon.png"></td><td style="text-align:center">'+Utils.FormatTimeLengthToStr(200*3600000/income,3)+'</td></tr><tr><td colspan="3" style="text-align:center">300 <img src="skin/icons/portLoadingIcon.png"></td><td style="text-align:center">'+Utils.FormatTimeLengthToStr(300*3600000/income,3)+'</td></tr><tr><td colspan="3" style="text-align:center">400 <img src="skin/icons/portLoadingIcon.png"></td><td style="text-align:center">'+Utils.FormatTimeLengthToStr(400*3600000/income,3)+'</td></tr><tr><td colspan="3" style="text-align:center">1 &nbsp;<img src="skin/relatedCities/trade_ship_20.png" style="width:auto;height:10px;display:inline;margin-left:-3px;"></td><td style="text-align:center">'+Utils.FormatTimeLengthToStr(500*3600000/income,3)+'</td></tr>'+(warehouse>0 && maxc>=8000?'<tr><td colspan="3" style="text-align:center">1 &nbsp;<img src="'+Constant.BuildingData[Constant.Buildings.WAREHOUSE].icon+'" style="width:auto;height:12px;display:inline;margin-left:-3px;"></td><td style="text-align:center">'+Utils.FormatTimeLengthToStr(8000*3600000/income,3)+'</td></tr>':'')+(dump>0 && maxc>=32000?'<tr><td colspan="3" style="text-align:center">1 &nbsp;<img src="'+Constant.BuildingData[Constant.Buildings.DUMP].icon+'" style="width:auto;height:12px;display:inline;margin-left:-3px;"></td><td style="text-align:center">'+Utils.FormatTimeLengthToStr(32000*3600000/income,3)+'</td></tr>':'')+'<tr><td colspan="3" style="text-align:center">1 &nbsp;<img src="skin/relatedCities/trade_ship_20.png" style="width:auto;height:10px;display:inline;margin-left:-3px;"><img src="skin/relatedCities/trade_ship_20.png" style="width:auto;height:10px;display:inline;margin-left:-3px;"><img src="skin/relatedCities/trade_ship_20.png" style="width:auto;height:10px;display:inline;margin-left:-3px;"></td><td style="text-align:center">'+Utils.FormatTimeLengthToStr(parseInt($('#js_GlobalMenu_maxTransporters').text())*500*3600000/income,3)+'</td></tr>'+(warehouse>0 && maxc<8000?'<tr><td colspan="3" style="text-align:center">1 &nbsp;<img src="'+Constant.BuildingData[Constant.Buildings.WAREHOUSE].icon+'" style="width:auto;height:12px;display:inline;margin-left:-3px;"></td><td style="text-align:center">'+Utils.FormatTimeLengthToStr(8000*3600000/income,3)+'</td></tr>':'')+(dump>0 && maxc<32000?'<tr><td colspan="3" style="text-align:center">1 &nbsp;<img src="'+Constant.BuildingData[Constant.Buildings.DUMP].icon+'" style="width:auto;height:12px;display:inline;margin-left:-3px;"></td><td style="text-align:center">'+Utils.FormatTimeLengthToStr(32000*3600000/income,3)+'</td></tr>':'')+'</tbody></table>',[resourceName,'1 '+LD.hour,'1 '+LD.day,'1 '+LD.week,Utils.FormatNumToStr(income,true,0),Utils.FormatNumToStr(income*24,false,0),Utils.FormatNumToStr(income*24*7,false,0),resBonus?'<img src="skin/premium/b_premium_'+resName+'.jpg" style="width:18px">':'',Utils.FormatQuantityToLoad(income),Utils.FormatQuantityToLoad(income*24),Utils.FormatQuantityToLoad(income*24*7)]);
				}
				function getProductionConsumptionSubSumTip(income,consumption,force)
				{
					var warehouse = 0;
					var dump = 0;
					$.each(database.cities,function(k,c)
					{
						warehouse += c.isWarehouse ? 1 : 0;
						dump += c.isDump ? 1 : 0;
					});
					warehouse = city!=null ? city.isWarehouse : warehouse;
					dump = city!=null ? city.isDump : dump;
					var maxc = parseInt($('#js_GlobalMenu_maxTransporters').text())*500;
					if(income===0 && consumption===0 && !force)
					{
						return '';
					}
					else if(resourceName!==Constant.Resources.WINE)
					{
						return getProductionTip(income,force);
					}
					else if(income===0)
					{
						return getConsumptionTooltip(consumption,force);
					}
					else
					{
						return Utils.format('<table><thead><tr><th><img src="skin/resources/icon_{0}.png" style="height:14px"></th><th style="text-align:center">{1}</th><th style="text-align:center">{2}</th><th style="text-align:center">{3}</th></tr></thead><tbody><tr class="data"><td>{14}</td><td style="text-align:right">{4}</td><td style="text-align:right">{5}</td><td style="text-align:right">{6}</td></tr><tr class="data"><td></td><td style="text-align:right">{7}</td><td style="text-align:right">{8}</td><td style="text-align:right">{9}</td></tr><tr class="total" style="border-top:1px solid #daa520"><td>{10}</td><td style="text-align:right">{11}</td><td style="text-align:right">{12}</td><td style="text-align:right">{13}</td></tr><tr class="total"><td></td><td style="text-align:center">{15}</td><td style="text-align:center">{16}</td><td style="text-align:center">{17}</td></tr><tr><th colspan="3" style="text-align:center">'+LD.cargo+'</th><th style="text-align:center">'+LD.duration+'</th></tr><tr><td colspan="3" style="text-align:center">100 <img src="skin/icons/portLoadingIcon.png"></td><td style="text-align:center">'+Utils.FormatTimeLengthToStr(100*3600000/(income-consumption),3)+'</td></tr><tr><td colspan="3" style="text-align:center">200 <img src="skin/icons/portLoadingIcon.png"></td><td style="text-align:center">'+Utils.FormatTimeLengthToStr(200*3600000/(income-consumption),3)+'</td></tr><tr><td colspan="3" style="text-align:center">300 <img src="skin/icons/portLoadingIcon.png"></td><td style="text-align:center">'+Utils.FormatTimeLengthToStr(300*3600000/(income-consumption),3)+'</td></tr><tr><td colspan="3" style="text-align:center">400 <img src="skin/icons/portLoadingIcon.png"></td><td style="text-align:center">'+Utils.FormatTimeLengthToStr(400*3600000/(income-consumption),3)+'</td></tr><tr><td colspan="3" style="text-align:center">1 &nbsp;<img src="skin/relatedCities/trade_ship_20.png" style="width:auto;height:10px;display:inline;margin-left:-3px;"></td><td style="text-align:center">'+Utils.FormatTimeLengthToStr(500*3600000/(income-consumption),3)+'</td></tr>'+(warehouse>0 && maxc>=8000?'<tr><td colspan="3" style="text-align:center">1 &nbsp;<img src="'+Constant.BuildingData[Constant.Buildings.WAREHOUSE].icon+'" style="width:auto;height:12px;display:inline;margin-left:-3px;"></td><td style="text-align:center">'+Utils.FormatTimeLengthToStr(8000*3600000/(income-consumption),3)+'</td></tr>':'')+(dump>0 && maxc>=32000?'<tr><td colspan="3" style="text-align:center">1 &nbsp;<img src="'+Constant.BuildingData[Constant.Buildings.DUMP].icon+'" style="width:auto;height:12px;display:inline;margin-left:-3px;"></td><td style="text-align:center">'+Utils.FormatTimeLengthToStr(32000*3600000/(income-consumption),3)+'</td></tr>':'')+'<tr><td colspan="3" style="text-align:center">1 &nbsp;<img src="skin/relatedCities/trade_ship_20.png" style="width:auto;height:10px;display:inline;margin-left:-3px;"><img src="skin/relatedCities/trade_ship_20.png" style="width:auto;height:10px;display:inline;margin-left:-3px;"><img src="skin/relatedCities/trade_ship_20.png" style="width:auto;height:10px;display:inline;margin-left:-3px;"></td><td style="text-align:center">'+Utils.FormatTimeLengthToStr(parseInt($('#js_GlobalMenu_maxTransporters').text())*500*3600000/(income-consumption),3)+'</td></tr>'+(warehouse>0 && maxc<8000?'<tr><td colspan="3" style="text-align:center">1 &nbsp;<img src="'+Constant.BuildingData[Constant.Buildings.WAREHOUSE].icon+'" style="width:auto;height:12px;display:inline;margin-left:-3px;"></td><td style="text-align:center">'+Utils.FormatTimeLengthToStr(8000*3600000/(income-consumption),3)+'</td></tr>':'')+(dump>0 && maxc<32000?'<tr><td colspan="3" style="text-align:center">1 &nbsp;<img src="'+Constant.BuildingData[Constant.Buildings.DUMP].icon+'" style="width:auto;height:12px;display:inline;margin-left:-3px;"></td><td style="text-align:center">'+Utils.FormatTimeLengthToStr(32000*3600000/(income-consumption),3)+'</td></tr>':'')+'</tbody></table>',[resourceName,'1 '+LD.hour,'1 '+LD.day,'1 '+LD.week,Utils.FormatNumToStr(income,true,0),Utils.FormatNumToStr(income*24,false,0),Utils.FormatNumToStr(income*24*7,false,0),Utils.FormatNumToStr(-consumption,true,0),Utils.FormatNumToStr(-consumption*24,true,0),Utils.FormatNumToStr(-consumption*24*7,true,0),(income>consumption?'\u03A3 +&nbsp;':'\u03A3 -&nbsp;'),Utils.FormatNumToStr((income-consumption),false,0),Utils.FormatNumToStr((income-consumption)*24,false,0),Utils.FormatNumToStr((income-consumption)*24*7,false,0),database.getGlobalData.hasPremiumFeature(Constant.Premium.WINE_BONUS)?'<img src="skin/premium/b_premium_wine.jpg" style="width:18px">':'',Utils.FormatQuantityToLoad(income-consumption),Utils.FormatQuantityToLoad((income-consumption)*24),Utils.FormatQuantityToLoad((income-consumption)*24*7)]);
					}
				}
				function getImage(unitID)
				{
					return (Constant.UnitData[unitID].type == 'fleet') ? 'skin/characters/fleet/60x60/' + unitID + '_faceright.png' : 'skin/characters/military/x60_y60/y60_' + unitID + '_faceright.png';
				}
			}
		},
		cssResLoaded: function()
		{
			var ret = this._cssResLoaded;
			this._cssResLoaded = true;
			return ret;
		},
		Init: function()
		{
			this.SidePanelButton();
			events(Constant.Events.DATABASE_LOADED).sub(function(){ this.LoadCSS(); this.DrawContentBox(); }.bind(render));
			events(Constant.Events.MODEL_AVAILABLE).sub(function(){ this.DrawTables(); this.setCommonData(); this.RestoreDisplayOptions(); this.startMonitoringChanges(); this.cityChange(ikariam.CurrentCityId); }.bind(render));
		},
		startMonitoringChanges: function()
		{
			events(Constant.Events.TAB_CHANGED).sub(function(tab)
			{
				this.stopResourceCounters();
				switch(tab)
				{
					case 0:
						this.startResourceCounters();
						break;
					case 1:
						this.updateCitiesBuildingData();
						break;
					case 2:
						this.updateCitiesArmyData();
						break;
					case 3:
						this.redrawSettings();
						break;
				}
			}.bind(render));
			events(Constant.Events.TAB_CHANGED).pub(database.settings.window.activeTab);
			events('cityChanged').sub(this.cityChange.bind(render));
			events(Constant.Events.BUILDINGS_UPDATED).sub(this.updateChangesForCityBuilding.bind(render));
			events(Constant.Events.GLOBAL_UPDATED).sub(this.updateGlobalData.bind(render));
			events(Constant.Events.MOVEMENTS_UPDATED).sub(this.updateMovementsForCity.bind(render));
			events(Constant.Events.RESOURCES_UPDATED).sub(this.updateResourcesForCity.bind(render));
			events(Constant.Events.CITY_UPDATED).sub(this.updateCityDataForCity.bind(render));
			events(Constant.Events.MILITARY_UPDATED).sub(this.updateChangesForCityMilitary.bind(render));
			events(Constant.Events.PREMIUM_UPDATED).sub(this.updateGlobalData.bind(render));
		},
		cityChange: function(cid)
		{
			if(typeof(bUpinterv)!='undefined') { clearInterval(bUpinterv); }
			var LD = Constant.LanguageData[database.settings.languageChange.value];
			var city = database.getCityFromId(cid);
			var pir = 0;
			$.each(database.cities,function(k,c){pir+=c.isPirateFortress?1:0;});
			$('#empire_Tabs > ul > div.pirates').css({'display':pir>0?'inline-block':'none','opacity':city.isPirateFortress?'1.0':'0.5'});
			$('#empireBoard tr.current,#empireBoard tr.selected').removeClass('selected current');
			if(city)
			{
				this.getAllRowsForCity(city).addClass('selected').addClass((isChrome) ? 'current' : 'selected');
			}
			$.each(Constant.Resources,function(r)
			{
				if(r!='GOLD')
				{
					var res = r.toLowerCase();
					var p = Math.floor(city._resources[res].getProduction*3600);
					p = '<span style="color:'+(p==0?'blue':(p>0?'green':'red'))+'">'+Utils.FormatNumToStr(p,p==0?false:true,p==0?2:0)+'</span>';
					
					var c = Math.floor(city._resources[res].getConsumption);
					c = '<span style="position:absolute;top:10px;right:0px;color:'+(c==0?'blue':(c<0?'green':'red'))+'">'+Utils.FormatNumToStr(-c,c==0?false:true,c==0?2:0)+'</span>';
					$('#resources_'+res+' > span.resourceProduction').remove();
					$('#resources_'+res+' > span[id^=js_GlobalMenu_]').after('<span class="resourceProduction"></span>');
					$('#resources_'+res).find('span.resourceProduction').html(p+(res=='wine'?c:''));
				}
			});
			if($('#tradegoodImage').attr('src')!=undefined)
			{
				$('#tradegoodTicket').text(Utils.format(LD.cinetheatretxt[11],[LD.cinetheatretxt[12][city.getTradeGood=='glass'?'crystal':city.getTradeGood]]));
//				console.log(Utils.format(LD.cinetheatretxt[11],[LD.cinetheatretxt[12][city.getTradeGood=='glass'?'crystal':city.getTradeGood]]));
			}
			setTimeout(function()
			{
				$('#js_MilitaryMovementsFleetMovementsTable > table > tbody > tr:not(:first)').each(function(k,tr)
				{
					$(tr).find('td:nth-child(4)').attr('colspan','2').css({'width':'240px','text-align':'center'}).empty();
					$(tr).find('td:nth-child(5) > div.infoTip > div').css('display','inline-block').find('div:not(:first)').each(function(k,div)
					{
						$(div).text(Utils.FormatNumToStr(parseInt($(div).text().replace(/(\d+)[,.](?=\d{3}(\D|$))/g,'$1')),false,0));
					});
					$(tr).find('td:nth-child(4)').html($(tr).find('td:nth-child(5) > div.infoTip').html());
					$(tr).find('td:nth-child(5), td:nth-child(4) > a, td:nth-child(4) > h5').remove();
				});
			},100);
		},
		getWorldmapTable: function() { },
		getHelpTable : function()
		{
			var LD = Constant.LanguageData[database.settings.languageChange.value];
			var hlptxt = ['Re_Order_Towns','On_any_tab','Reset_Position','Right_click','Hotkeys','Navigate','Navigate_to_City','Navigate_to','Navigate_to_World','Spacebar','Initialize_Board'];
			var hlptrans = [];
			for(var i=0;i<hlptxt.length;i++) { hlptrans.push(LD[hlptxt[i]]); }
			var elems = Utils.format('<div id="HelpTab"><div><div class="options"><span class="categories">{0}</span> {1}<hr style="margin-top:5px;margin-bottom:5px"><span class="categories">{2}</span> {3}<hr style="margin-top:5px;margin-bottom:5px"><span class="categories">{4}</span>{5}<br>{6}<br>{7}<br>{8}<br>{9}<hr style="margin-top:5px;margin-bottom:5px"><span class="categories">{10}</span>',hlptrans);
			var hlpSteps = ['Townhall','Research','Palace','Museum','CTs','AllyMembers','Finance','Inventory','Military'];
			for(var i=0;i<hlpSteps.length;i++) { elems += Utils.format(' '+(i+1)+'. <span id="help'+hlpSteps[i]+'" class="clickable"><b>&gt; {0} &lt;</b></span> {1}{2}',[LD.click_,LD.helpSteps[i],i==hlpSteps.length-1 ? '' : '<br>']); }
			elems += '</div><div style="clear:left"></div></div></div>';
			return elems;
		},
		getSettingsTable: function()
		{
			var LD = Constant.LanguageData[database.settings.languageChange.value];
			var wineOut = '';
			var server = ikariam.Nationality();
			if(server == 'de')
			{
				wineOut = ' <span><label for="empire_wineOut"><input type="checkbox" id="empire_wineOut" ' + (database.settings.wineOut.value ? 'checked="checked"' : '') + '/><nobr data-tooltip="'+LD.wineOut_description+'"> '+LD.wineOut +'</nobr></label></span>';
			}
			var piracy = '';
			if(database.getGlobalData.getResearchTopicLevel(Constant.Research.Seafaring.PIRACY))
			{
				piracy = ' <span><label for="empire_noPiracy"><input type="checkbox" id="empire_noPiracy" '+(database.settings.noPiracy.value ? 'checked="checked"' : '')+'/><nobr data-tooltip="'+LD.noPiracy_description+'"> '+LD.noPiracy +'</nobr></label></span>';
			}
			var elems = '<div id="SettingsTab"><div>';
			var order = 0;
			var inits = '<div class="options" style="clear:right"><span class="categories">'+LD.building_category+'</span> <span><label for="empire_defaultBuildingList"><input type="radio" name="BuildingList" id="empire_defaultBuildingList" '+(database.settings.defaultBuildingList.value || (!database.settings.alternativeBuildingList.value && !database.settings.compressedBuildingList.value) ? 'checked="checked"' : '')+'/><nobr data-tooltip="'+LD.defaultBuildingList_description+'"> '+LD.defaultBuildingList+'</nobr></label></span> <span><label for="empire_alternativeBuildingList"><input type="radio" name="BuildingList" id="empire_alternativeBuildingList" '+(database.settings.alternativeBuildingList.value || (!database.settings.defaultBuildingList.value && !database.settings.compressedBuildingList.value) ? 'checked="checked"' : '')+'/><nobr data-tooltip="'+LD.alternativeBuildingList_description+'"> '+LD.alternativeBuildingList+'</nobr></label></span> <span><label for="empire_compressedBuildingList"><input type="radio" name="BuildingList" id="empire_compressedBuildingList" '+(database.settings.compressedBuildingList.value || (!database.settings.alternativeBuildingList.value && !database.settings.defaultBuildingList.value) ? 'checked="checked"' : '')+'/><nobr data-tooltip="'+LD.compressedBuildingList_description+'"> '+LD.compressedBuildingList+'</nobr></label></span><hr style="margin-top:5px;margin-bottom:5px"><span class="categories">'+LD.resource_category+'</span> <span><label for="empire_hourlyRess"><input type="checkbox" id="empire_hourlyRess" '+(database.settings.hourlyRess.value ? 'checked="checked"' : '')+'/><nobr data-tooltip="'+LD.hourlyRes_description+'"> '+LD.hourlyRes+'</nobr></label></span> '+wineOut+' <span><label for="empire_dailyBonus"><input type="checkbox" id="empire_dailyBonus" '+(database.settings.dailyBonus.value ? 'checked="checked"' : '')+(database.settings.logInPopup.value ? 'disabled="disabled"' : '')+'/><nobr data-tooltip="'+LD.dailyBonus_description+'"> '+LD.dailyBonus+'</nobr></label></span> <span><label for="empire_wineWarning"><input type="checkbox" id="empire_wineWarning" '+(database.settings.wineWarning.value ? 'checked="checked"' : '')+'/><nobr data-tooltip="'+LD.wineWarning_description+'"> '+LD.wineWarning+'</nobr></label></span> <span><label for="empire_wineWarningTime"><select id="empire_wineWarningTime"><option value="0"'+(database.settings.wineWarningTime.value === 0 ? 'selected=selected' : '' )+'> '+LD.off+'</option><option value="12"'+(database.settings.wineWarningTime.value == 12 ? 'selected=selected' : '' )+'> 12'+LD.hour+'</option><option value="24"'+(database.settings.wineWarningTime.value== 24 ? 'selected=selected' : '' )+'> 24'+LD.hour+'</option><option value="36"' + (database.settings.wineWarningTime.value== 36 ? 'selected=selected' : '' )+'> 36'+LD.hour+'</option><option value="48"'+(database.settings.wineWarningTime.value== 48 ? 'selected=selected' : '' )+'> 48'+LD.hour+'</option><option value="96"'+(database.settings.wineWarningTime.value== 96 ? 'selected=selected' : '' )+'> 96'+LD.hour+'</option></select><nobr data-tooltip="'+LD.wineWarningTime_description+'"> '+LD.wineWarningTime+'</nobr></label></span><hr style="margin-top:5px;margin-bottom:5px"><span class="categories">'+LD.language_category+'</span> <span><label for="empire_languageChange"><select id="empire_languageChange"><option value="en"'+(database.settings.languageChange.value == 'en' ? 'selected=selected' : '' )+'> '+LD.en+'</option><option value="el"'+(database.settings.languageChange.value == 'el' ? 'selected=selected' : '' )+'> '+LD.el+'</option></select><nobr data-tooltip="'+LD.languageChange_description+'"> '+LD.languageChange+'</nobr></label></span></div>';
			var features = '<div class="options"> <span class="categories">'+LD.visibility_category+'</span> <span><label for="empire_hideOnWorldView"><input type="checkbox" id="empire_hideOnWorldView" '+(database.settings.hideOnWorldView.value ? 'checked="checked"' : '')+'/><nobr data-tooltip="'+LD.hideOnWorldView_description+'"> '+LD.hideOnWorldView+'</nobr></label></span> <span><label for="empire_hideOnIslandView"><input type="checkbox" id="empire_hideOnIslandView" '+(database.settings.hideOnIslandView.value ? 'checked="checked"' : '')+'/><nobr data-tooltip="'+LD.hideOnIslandView_description+'"> '+LD.hideOnIslandView+'</nobr></label></span> <span><label for="empire_hideOnCityView"><input type="checkbox" id="empire_hideOnCityView" '+(database.settings.hideOnCityView.value ? 'checked="checked"' : '')+'/><nobr data-tooltip="'+LD.hideOnCityView_description+'"> '+LD.hideOnCityView+'</nobr></label></span><hr style="margin-top:5px;margin-bottom:5px"><span class="categories">'+LD.army_category+'</span> <span><label for="empire_fullArmyTable"><input type="checkbox" id="empire_fullArmyTable" '+(database.settings.fullArmyTable.value ? 'checked="checked"' : '')+'/><nobr data-tooltip="'+LD.fullArmyTable_description+'"> '+LD.fullArmyTable+'</nobr></span>'+
			//+' <span><label for="empire_playerInfo"><input type="checkbox" id="empire_playerInfo" '+(database.settings.playerInfo.value ? 'checked="checked"' : '')+'/><nobr data-tooltip="'+LD.playerInfo_description+'"> '+LD.playerInfo+'</nobr></label></span>+
			'<hr style="margin-top:5px;margin-bottom:5px"><span class="categories">'+LD.global_category+'</span> <span><label for="empire_autoUpdates"><input type="checkbox" id="empire_autoUpdates" '+(database.settings.autoUpdates.value ? 'checked="checked"' : '')+'/><nobr data-tooltip="'+LD.autoUpdates_description+'"> '+LD.autoUpdates+'</nobr></label></span><hr style="margin-top:5px;margin-bottom:5px"><span class="categories">'+LD.tweaks_category+'</span> <span><label for="empire_donationButtons"><input type="checkbox" id="empire_donationButtons" '+(database.settings.donationButtons.value ? 'checked="checked"' : '')+'/><nobr data-tooltip="'+LD.donationButtons_description+'"> '+LD.donationButtons+'</nobr></label></span> <span><label for="empire_ctfinder"><input type="checkbox" id="empire_ctfinder" '+(database.settings.ctfinder.value ? 'checked="checked"' : '')+'/><nobr data-tooltip="'+LD.ctfinder_description+'"> '+LD.ctfinder+'</nobr></label></span> <span><label for="empire_ΧΥshow"><input type="checkbox" id="empire_ΧΥshow" '+(database.settings.ΧΥshow.value ? 'checked="checked"' : '')+'/><nobr data-tooltip="'+LD.ΧΥshow_description+'"> '+LD.ΧΥshow+'</nobr></label></span></div>';
			var display = '<div class="options"> <span class="categories">'+LD.display_category+'</span> <span><label for="empire_onTop"><input type="checkbox" id="empire_onTop" ' + (database.settings.onTop.value ? 'checked="checked"' : '') + '/><nobr data-tooltip="'+LD.onTop_description+'"> '+LD.onTop+'</nobr></label></span> <span><label for="empire_windowTennis"><input type="checkbox" id="empire_windowTennis" ' + (database.settings.windowTennis.value ? 'checked="checked"' : '') + '/><nobr data-tooltip="'+LD.windowTennis_description+'"> '+LD.windowTennis+'</nobr></label></span> <span><label for="empire_quantityLoads"><input type="checkbox" id="empire_quantityLoads" ' + (database.settings.quantityLoads.value ? 'checked="checked"' : '') + '/><nobr data-tooltip="'+LD.quantityLoads_description+'"> '+LD.quantityLoads+'</nobr></label></span> <span><label for="empire_smallFont"><input type="checkbox" id="empire_smallFont" ' + (database.settings.smallFont.value ? 'checked="checked"' : '') + '/><nobr data-tooltip="'+LD.smallFont_description+'"> '+LD.smallFont+'</nobr></label></span> <span><label for="empire_GoldShort"><input type="checkbox" id="empire_GoldShort" ' + (database.settings.GoldShort.value ? 'checked="checked"' : '') + '/><nobr data-tooltip="'+LD.goldShort_description+'"> '+LD.goldShort+'</nobr></label></span> <span><label for="empire_newsTicker"><input type="checkbox" id="empire_newsTicker" ' + (database.settings.newsTicker.value ? 'checked="checked"' : '') + '/><nobr data-tooltip="'+LD.newsticker_description+'"> '+LD.newsticker+'</nobr></label></span> <span><label for="empire_event"><input type="checkbox" id="empire_event" ' + (database.settings.event.value ? 'checked="checked"' : '') + '/><nobr data-tooltip="'+LD.event_description+'"> '+LD.event+'</nobr></label></span> <span><label for="empire_logInPopup"><input type="checkbox" id="empire_logInPopup" ' + (database.settings.logInPopup.value ? 'checked="checked"' : '') + ' onchange="document.getElementById(\'empire_dailyBonus\').checked = this.checked ? true : document.getElementById(\'empire_dailyBonus\').checked;document.getElementById(\'empire_dailyBonus\').disabled = this.checked ? true : false"/><nobr data-tooltip="'+LD.logInPopup_description+'"> '+LD.logInPopup+'</nobr></label></span> <span><label for="empire_birdSwarm"><input type="checkbox" id="empire_birdSwarm" ' + (database.settings.birdSwarm.value ? 'checked="checked"' : '') + '/><nobr data-tooltip="'+LD.birdswarm_description+'"> '+LD.birdswarm+'</nobr></label></span> <span><label for="empire_walkers"><input type="checkbox" id="empire_walkers" ' + (database.settings.walkers.value ? 'checked="checked"' : '') + '/><nobr data-tooltip="'+LD.walkers_description+'"> '+LD.walkers+'</nobr></label></span> '+piracy+' <span><label for="empire_noTheater"><input type="checkbox" id="empire_noTheater" '+(database.settings.noTheater.value ? 'checked="checked"' : '')+'/><nobr data-tooltip="'+LD.noTheater_description+'"> '+LD.noTheater +'</nobr></label></span> <span><label for="empire_controlCenter"><input type="checkbox" id="empire_controlCenter" ' + (database.settings.controlCenter.value ? 'checked="checked"' : '') + '/><nobr data-tooltip="'+LD.control_description+'"> '+LD.control+'</nobr></label></span> <span><label for="empire_withoutFable"><input type="checkbox" id="empire_withoutFable" ' + (database.settings.withoutFable.value ? 'checked="checked"' : '') + '/><nobr data-tooltip="'+LD.unnecessaryTexts_description+'"> '+LD.unnecessaryTexts+'</nobr></span> <span><label for="empire_ambrosiaPay"><input type="checkbox" id="empire_ambrosiaPay" ' + (database.settings.ambrosiaPay.value ? 'checked="checked"' : '') + '/><nobr data-tooltip="'+LD.ambrosiaPay_description+'"> '+LD.ambrosiaPay+'</nobr></label></span></div>';
			elems += features+inits+display+'<div style="clear:left"><hr style="margin-top:5px;margin-bottom:5px"><p>&nbsp; '+LD.current_Version+' <b>'+empire.version+'</b></p><p>&nbsp; '+LD.ikariam_Version+' <b style="cursor:pointer" onclick="ajaxHandlerCall(\'?view=version\')">'+ikariam.GameVersion()+'</b></p></div><div class="buttons"><button data-tooltip="'+LD.reset+'" id="empire_Reset_Button">'+LD.resetbtn+'</button><button data-tooltip="'+LD.goto_website+'" id="empire_Website_Button">'+LD.website+'</button><button data-tooltip="'+LD.Check_for_updates+'" id="empire_Update_Button">'+LD.check+'</button><button data-tooltip="'+LD.Report_bug+'" id="empire_Bug_Button">'+LD.report+'</button><button data-tooltip="'+LD.save_settings+'" id="empire_Save_Button" onclick="ajaxHandlerCall(\'?view=city&oldBackgroundView\')">'+LD.save+'</button>';
			return elems;
		},
		DrawHelp: function()
		{
			var LD = Constant.LanguageData[database.settings.languageChange.value];
			$('#HelpTab').html(this.getHelpTable())
			.on("click", "#helpTownhall",function(){ikariam.loadUrl(ikariam.viewIsCity,'city', ikariam.getCurrentCity.getBuildingFromName(Constant.Buildings.TOWN_HALL).getUrlParams);})
			.on("click", "#helpResearch",function(){ikariam.loadUrl(ikariam.viewIsCity,'city', {view:'researchAdvisor'});})
			.on("click", "#helpPalace",function()
			{
				var capital = ikariam.getCapital;
				if(capital) { ikariam.loadUrl(ikariam.viewIsCity,'city',capital.getBuildingFromName(Constant.Buildings.PALACE).getUrlParams); } else { alert(LD.alert_palace); }
			})
			.on("click", "#helpMuseum",function(){ikariam.loadUrl(ikariam.viewIsCity, "city", {view:'museum',activeTab:'tab_museum'});})
			.on("click", "#helpCTs",function(){ikariam.loadUrl(ikariam.viewIsCity, "city", {view:'museumTreaties',activeTab:'tab_museumTreaties'});})
			.on("click", "#helpAllyMembers",function()
			{
				var embassy = ikariam.getEmbassy;
				if(embassy) {ikariam.loadUrl(ikariam.viewIsCity,'city', $.extend(embassy.getBuildingFromName(Constant.Buildings.EMBASSY).getUrlParams,{view:'embassy',activeTab:'tabEmbassyMembers'}));}})
			.on("click", "#helpFinance",function(){ikariam.loadUrl(ikariam.viewIsCity, "city", {view:'finances'});})
			.on("click", "#helpInventory",function(){ikariam.loadUrl(ikariam.viewIsCity, "city", {view:'inventory'});})
			.on("click", "#helpMilitary",function()
			{
				var capital = ikariam.getCapital;
				if(capital) {ikariam.loadUrl(ikariam.viewIsCity,'city', $.extend(capital.getBuildingFromName(Constant.Buildings.PALACE).getUrlParams,{view:'cityMilitary',activeTab:'tabUnits'}));}
			});
		},
		DrawSettings: function()
		{
			var LD = Constant.LanguageData[database.settings.languageChange.value];
			$('#SettingsTab').html(this.getSettingsTable())
			.on("change", "#empire_onTop", function()
			{
				database.settings.onTop.value = this.checked;
				render.mainContentBox.css('z-index', this.checked ? 65112 : 61);
			})
			.on("change", "#empire_windowTennis", function()
			{
				database.settings.windowTennis.value = this.checked;
				if(!this.checked)
				{
					render.mainContentBox.css('z-index', database.settings.onTop.value ? 65112 : 61);
				}
				else
				{
					render.mainContentBox.trigger('mouseenter');
				}
			})
			.on("change", "#empire_fullArmyTable", function()
			{
				database.settings.fullArmyTable.value = this.checked;
				render.updateCitiesArmyData();
			})
			.on("change", "#empire_playerInfo", function(){database.settings.playerInfo.value = this.checked;})
			.on("change", "#empire_donationButtons", function(){database.settings.donationButtons.value = this.checked;})
			.on("change", "#empire_ctfinder", function(){database.settings.ctfinder.value = this.checked;})
			.on("change", "#empire_ΧΥshow", function() { database.settings.ΧΥshow.value = this.checked; })
			.on("change", "#empire_controlCenter", function(){database.settings.controlCenter.value = this.checked;})
			.on("change", "#empire_withoutFable", function(){database.settings.withoutFable.value = this.checked;})
			.on("change", "#empire_ambrosiaPay", function(){database.settings.ambrosiaPay.value = this.checked;})
			.on("change", "#empire_quantityLoads", function(){database.settings.quantityLoads.value = this.checked;})
			.on("change", "#empire_hideOnWorldView", function(){database.settings.hideOnWorldView.value = this.checked;})
			.on("change", "#empire_hideOnIslandView", function(){database.settings.hideOnIslandView.value = this.checked;})
			.on("change", "#empire_hideOnCityView", function(){database.settings.hideOnCityView.value = this.checked;})
			.on("change", "#empire_autoUpdates", function(){database.settings.autoUpdates.value = this.checked;})
			.on("change", "#empire_smallFont", function()
			{
				database.settings.smallFont.value = this.checked;
				if(this.checked) {GM_addStyle("#empireBoard {font-size:8pt}");} else {GM_addStyle("#empireBoard {font-size:inherit}");}
			})
			.on("change", "#empire_GoldShort", function(){database.settings.GoldShort.value = this.checked;})
			.on("change", "#empire_newsTicker", function(){database.settings.newsTicker.value = this.checked;})
			.on("change", "#empire_event", function(){database.settings.event.value = this.checked;})
			.on("change", "#empire_birdSwarm", function(){database.settings.birdSwarm.value = this.checked;})
			.on("change", "#empire_walkers", function(){database.settings.walkers.value = this.checked;})
			.on("change", "#empire_noPiracy", function(){database.settings.noPiracy.value = this.checked;})
			.on("change", "#empire_noTheater", function(){database.settings.noTheater.value = this.checked;})
			.on("change", "#empire_hourlyRess", function(){database.settings.hourlyRess.value = this.checked;})
			.on("change", "#empire_wineWarning", function(){database.settings.wineWarning.value = this.checked;})
			.on("change", "#empire_wineOut", function(){database.settings.wineOut.value = this.checked;})
			.on("change", "#empire_dailyBonus", function(){database.settings.dailyBonus.value = this.checked;})
			.on("change", "#empire_logInPopup", function()
			{
				database.settings.logInPopup.value = this.checked;
				if(this.checked && !database.settings.dailyBonus.value)
				{
					database.settings.dailyBonus.value = true;
					$("#empire_dailyBonus").attr("disabled", this.checked ? true : false);
				}
			})
			.on("change", "#empire_defaultBuildingList", function()
			{
				database.settings.defaultBuildingList.value = this.checked;
				database.settings.alternativeBuildingList.value = false;
				database.settings.compressedBuildingList.value = false;
				render.cityRows.building = {};
				$('table.buildings').html(render.getBuildingTable());
				render.updateCitiesBuildingData();
				$.each(database.cities, function(cityId, city)
				{
					render.setCityName(city);
					render.setActionPoints(city);
					$.each(database.settings[Constant.Settings.CITY_ORDER].value, function (idx, val)
					{
						$('#' + 'building' + '_' + val).appendTo($('#' + 'building' + '_' + val).parent());
					});
				});
			})
			.on("change", "#empire_alternativeBuildingList", function()
			{
				database.settings.alternativeBuildingList.value = this.checked;
				database.settings.defaultBuildingList.value = false;
				database.settings.compressedBuildingList.value = false;
				render.cityRows.building = {};
				$('table.buildings').html(render.getBuildingTable());
				render.updateCitiesBuildingData();
				$.each(database.cities, function(cityId, city)
				{
					render.setCityName(city);
					render.setActionPoints(city);
					$.each(database.settings[Constant.Settings.CITY_ORDER].value, function (idx, val)
					{
						$('#' + 'building' + '_' + val).appendTo($('#' + 'building' + '_' + val).parent());
					});
				});
			})
			.on("change", "#empire_compressedBuildingList", function()
			{
				database.settings.compressedBuildingList.value = this.checked;
				database.settings.defaultBuildingList.value = false;
				database.settings.alternativeBuildingList.value = false;
				render.cityRows.building = {};
				$('table.buildings').html(render.getBuildingTable());
				render.updateCitiesBuildingData();
				$.each(database.cities, function(cityId, city)
				{
					render.setCityName(city);
					render.setActionPoints(city);
					$.each(database.settings[Constant.Settings.CITY_ORDER].value, function (idx, val)
					{
						$('#' + 'building' + '_' + val).appendTo($('#' + 'building' + '_' + val).parent());
					});
				});
			})
			.on('change',"#empire_wineWarningTime", function(){database.settings.wineWarningTime.value = this.value;})
			.on('change',"#empire_languageChange", function(){database.settings.languageChange.value = this.value;})
			.on("click", "#empire_Website_Button", function(){GM_openInTab('https://greasyfork.org/scripts/764-empire-overview');})
			.on("click", "#empire_Reset_Button",function(){empire.HardReset();})
			.on("click","#empire_Update_Button", function(){empire.CheckForUpdates.call(empire, true);})
			.on("click","#empire_Bug_Button", function(){GM_openInTab('https://greasyfork.org/scripts/764-empire-overview/feedback');})
			.on("change", "input[type='checkbox']", function(){this.blur();});
			$(document).ready(function()
			{ //todo
				if($('#empire_dailyBonus').attr('checked') && $('#dailyActivityBonus form'))
				{
					$('#dailyActivityBonus form').submit();
				}
				if ($('#empire_logInPopup').attr('checked'))
				{
					GM_addStyle('#multiPopup {display: none;}');
				}
				if ($('#empire_dailyBonus').attr('checked') && $('#empire_logInPopup').attr('checked'))
				{
					GM_addStyle('#multiPopup {display: none;}');
				}
				if($('#accept_btn, #cookie_container').length>0)
				{
					$('#accept_btn').trigger('click');
					$('#cookie_container').remove();
					ikariam.loadUrl(true,'city',{cityId:ikariam.CurrentCityId});
				}
				GM_addStyle('#js_worldBread{margin-left:10px !important;}#loadingPreview{transform:scale(0.5);-webkit-transform:scale(0.5);left:35px !important;top:141px !important;}');
			});
			$("#empire_Reset_Button").button({icons: {primary: "ui-icon-alert"}, text: true});
			$("#empire_Website_Button").button({icons: {primary: "ui-icon-home"}, text: true});
			$("#empire_Update_Button").button({icons: {primary: "ui-icon-info"}, text: true});
			$("#empire_Bug_Button").button({icons: {primary: "ui-icon-notice"}, text: true});
			$("#empire_Save_Button").button({icons: {primary: "ui-icon-check"}, text: true});
			$("#empire_Allianz").button({text: true});
			$("#empire_Allianz_einlesen").button({text: true});
		},
		toast: function(sMessage)
		{
			$('<div>').addClass("ui-tooltip-content ui-widget-content").html(sMessage).appendTo($(document.createElement("div")).addClass("ui-helper-reset ui-tooltip ui-tooltip-pos-bc ui-widget").css({position: 'relative', display: 'inline-block', left: 'auto', top: 'auto'}).show().appendTo($(document.createElement("div")).addClass("toast").appendTo(document.body).delay(100).fadeIn("slow", function(){$(this).delay(2000).fadeOut("slow", function() {$(this).remove();});})));
		},
		toastAlert: function(sMessage)
		{
			$('<div class="red">').addClass("ui-tooltip-content ui-widget-content").text(sMessage).appendTo($(document.createElement("div")).addClass("ui-helper-reset ui-tooltip ui-tooltip-pos-bc ui-widget").css({position: 'relative', display: 'inline-block', left: 'auto', top: '-20px'}).show().appendTo($(document.createElement("div")).addClass("toastAlert").appendTo(document.body).delay(100).fadeIn("slow", function() {$(this).delay(3000).fadeOut("slow", function() {$(this).remove();});})));
		},
		RestoreDisplayOptions: function()
		{
			render.mainContentBox.css('left', database.settings.window.left);
			render.mainContentBox.css('top', database.settings.window.top);
			this.$tabs.tabs('select', database.settings.window.activeTab);
			if(!(ikariam.viewIsWorld && database.settings.hideOnWorldView.value || ikariam.viewIsIsland && database.settings.hideOnIslandView.value || ikariam.viewIsCity && database.settings.hideOnCityView.value) && database.settings.window.visible) {this.mainContentBox.fadeToggle('slow');}
		},
		SaveDisplayOptions: function() { if(database.settings) { try {database.settings.addOptions({window:{left:render.mainContentBox.css('left'),top:render.mainContentBox.css('top'),visible:(ikariam.viewIsWorld && database.settings.hideOnWorldView.value || ikariam.viewIsIsland && database.settings.hideOnIslandView.value || ikariam.viewIsCity && database.settings.hideOnCityView.value) ? database.settings.window.visible : (render.mainContentBox.css('display') != 'none'),activeTab:render.$tabs.tabs('option', 'active')}}); } catch(e) { empire.error('SaveDisplayOptions', e); } }
		},
		SidePanelButton: function()
		{
			$('#js_viewCityMenu').find('li.empire_Menu')
			.on("click", function(event) {render.ToggleMainBox();})
			.on("contextmenu", function(event)
			{
				event.preventDefault();
				database.settings.window.left = 110;
				database.settings.window.top = 200;
				render.mainContentBox.css('left', database.settings.window.left);
				render.mainContentBox.css('top', database.settings.window.top);
			});
			$(document).on('keydown',function(event)
			{
//				console.log('Key: ',event);
				var index = -1;
				var type = event.target.nodeName.toLowerCase();
				if(type === 'input' || type === 'textarea' || type === 'select')
					return true;
				if(event.which === 32)
				{
					event.stopImmediatePropagation();
					render.ToggleMainBox();
					return false;
				}
				else if(event.which === 27)
				{
					return false;
				}
				if(event.originalEvent.shiftKey)
				{
					index = [49, 50, 51, 52, 53].indexOf(event.which);
					if(index !== -1)
					{
						render.$tabs.tabs('option', 'active', index);
						return false;
					}
					else
					{
						switch(event.which)
						{
							case 81:
								$('#js_worldMapLink').find('a').click();
								break;
							case 87:
								$('#js_islandLink').find('a').click();
								break;
							case 69:
								$('#js_cityLink').find('a').click();
								break;
						}
					}
				}
				else
				{
					var keycodes = '';
					var codeTyp = ikariam.Nationality();
					switch(codeTyp)
					{
						case 'en':
						case 'gr':
						case 'us':
							keycodes = [49, 50, 51, 52, 53, 54, 55, 56, 57, 48, 173, 61]; //EN - =
							if (isChrome)
								keycodes = [49, 50, 51, 52, 53, 54, 55, 56, 57, 48, 189, 187]; //US - =
							break;
					}
					index = keycodes.indexOf(event.which);
					if(index !== -1)
					{
						if(index < database.settings.cityOrder.value.length)
						{
							$('#resource_' + database.settings.cityOrder.value[index] +' .city_name .clickable').trigger('click');
							return false;
						}
					}
					else
					{
						switch(event.which)
						{
							case 81:
								$('#js_GlobalMenu_cities').click();
								break;
							case 87:
								$('#js_GlobalMenu_military').click();
								break;
							case 69:
								$('#js_GlobalMenu_research').click();
								break;
							case 82:
								$('#js_GlobalMenu_diplomacy').click();
								break;
						}
					}
				}
			});
		},
		ToggleMainBox: function()
		{
			database.settings.window.visible = (this.mainContentBox.css('display') == 'none');
			this.mainContentBox.fadeToggle("slow");
		},
		DrawTables: function()
		{
			if($(this.mainContentBox))
			{
				$('#ArmyTab').html(this.getArmyTable());
				$('#ResTab').html(this.getResourceTable());
				$('#BuildTab').html(this.getBuildingTable());
				$('#WorldmapTab').html(this.getWorldmapTable());
				this.DrawSettings();
				this.DrawHelp();
				this.toolTip.init();
				$('#ResTab, #BuildTab, #ArmyTab').each(function()
				{
					$(this).sortable({
						helper:function(e,ui)
						{
							ui.children('td').each(function ()
							{
								$(this).width(Math.round($(this).width()));
								$(this).hasClass('building'); if ($(this).css('border', '1px solid transparent'));
							});
							ui.parents('div[role=tabpanel]').each(function ()
							{
								$(this).width(Math.round($(this).width()));
							});
							return ui;
						},
						handle:'.city_name .icon',
						cursor:"move",
						axis:'y',
						items:'tbody tr',
						container:'tbody',
						revert:200,
						stop:function(event,ui)
						{
							ui.item.parents("div[role=tabpanel]").css("width", "");
							ui.item.children("td").css("width", "").css("border", "");
							database.settings[Constant.Settings.CITY_ORDER].value = ui.item.parents('.ui-sortable').sortable('toArray').map(function (item)
							{
								return parseInt(item.split('_').pop());
							});
							$.each(['building','resource','army'], function (idx, type)
							{
								if ($(this).parents('.ui-sortable').attr('id') !== type)
								{
									$.each(database.settings[Constant.Settings.CITY_ORDER].value,function(idx,val)
									{
										$(document).ready(function()
										{
											$('#'+type+'_'+val+' .city_name .clickable').text((idx+1)+' '+database.cities[val].getName);
											$('#' + type + '_' + val).appendTo($('#' + type + '_' + val).parent());
										});
									});
								}
							});
						}
					});
				});
				$.each(['building','resource','army'], function (idx, type)
				{
					$.each(database.settings[Constant.Settings.CITY_ORDER].value, function (idx, val)
					{
						$(document).ready(function()
						{
							$('#'+type+'_'+val+' .city_name .clickable').text((idx+1)+' '+database.cities[val].getName);
							$('#'+type+'_'+val+' .city_name .coords').css('display',database.settings.ΧΥshow.value?'inline':'none').text('['+database.cities[val].getCoordinates.join(':')+']');
							$('#' + type + '_' + val).appendTo($('#' + type + '_' + val).parent());
						});
					});
				});
			}
			this.AttachClickHandlers();
		},
		getResourceTable: function()
		{
			var LD = Constant.LanguageData[database.settings.languageChange.value];
			var inAlliance = unsafeWindow.hasAlly;
			var header = '<colgroup span="2"/><colgroup span="1"/><colgroup span="1"/><colgroup span="1"/><colgroup span="1"/><colgroup span="2"/><colgroup span="2"/><colgroup span="2"/><colgroup span="2"/><colgroup span="2"/><colgroup span="2"/><thead><tr class="header_row"><th class="city_name" data-tooltip="dynamic" style="cursor:pointer;" onclick="ajaxHandlerCall(\'?view=ikipedia&helpId=18\')">{0}</th><th class="action_points icon actionpointImage" data-tooltip="{1}"></th><th class="empireactions"><div class="trading" data-tooltip="'+LD.transport+'" style="cursor:pointer" onclick="ajaxHandlerCall(\'?view=merchantNavy\')"></div><div class="member" data-tooltip="'+LD.friendlist+'" style="cursor:pointer;" onclick="ajaxHandlerCall(\'?view=friendListEdit2\');return false;"></div><div class="agora" data-tooltip="'+LD.agora+'" style="cursor:pointer;float:left" onclick="ajaxHandlerCall(\'?view=diplomacyIslandBoard&amp=&islandId\')"></div><div class="contracts" data-tooltip="'+LD.contracts+'" style="cursor:pointer;float:right" onclick="ajaxHandlerCall(\'?view=diplomacyTreaty\')"></div></th><th class="citizen_header icon populationImage" data-tooltip="{2}" style="cursor:pointer;" onclick="ajaxHandlerCall(\'?view=ikipedia&subHelpId=1\');return false;"></th><th class="growth_header icon growthImage" data-tooltip="'+LD.satisfaction+'" style="cursor:pointer" onclick="ajaxHandlerCall(\'?view=ikipedia&helpId=3\');return false;"></th><th class="research_header icon researchImage" data-tooltip="{3}" style="cursor:pointer" onclick="ajaxHandlerCall(\'?view=researchAdvisor\');return false;"></th><th class="gold_header icon goldImage" colspan="2" data-tooltip="{4}" style="cursor:pointer" onclick="ajaxHandlerCall(\'?view=finances\');return false;"></th><th class="wood_header icon woodImage" colspan="2" data-tooltip="{5}" style="cursor:pointer" onclick="ajaxHandlerCall(\'?view=ikipedia&helpId=5\');return false;"></th><th class="wine_header icon wineImage" colspan="2" data-tooltip="{6}" style="cursor:pointer" onclick="ajaxHandlerCall(\'?view=ikipedia&helpId=6\');return false;"></th><th class="marble_header icon marbleImage" colspan="2" data-tooltip="{7}" style="cursor:pointer" onclick="ajaxHandlerCall(\'?view=ikipedia&helpId=6\');return false;"></th><th class="glass_header icon glassImage" colspan="2" data-tooltip="{8}" style="cursor:pointer" onclick="ajaxHandlerCall(\'?view=ikipedia&helpId=6\');return false;"></th><th class="sulfur_header icon sulfurImage" colspan="2" data-tooltip="{9}" style="cursor:pointer" onclick="ajaxHandlerCall(\'?view=ikipedia&helpId=6\');return false;"></th></tr></thead>';
			var table = '<table class="resources" style="display:inline-block">{0}<tbody>{1}</tbody><tfoot>{2}</tfoot></table>';
			var resourceRow = '<tr id="resource_{0}"><td class="city_name" style="width:160px"><span></span> <span class="clickable"></span> <sub></sub> <span class="Red" data-tooltip="{6}">&nbsp;&nbsp;<b>{5}</b>&nbsp;&nbsp;</span><span class="coords" style="float:right;font-size:80%;display:block"></span></td><td class="action_points"><span class="ap"></span>&nbsp;<br><span class="garrisonlimit" data-tooltip="dynamic" style="cursor:pointer"><img height="18" hspace="5"></span></td><td class="empireactions"><div class="wonder" data-tooltip="dynamic" style="background: url(skin/wonder/w{7}.png) no-repeat right / 18px 20px;cursor:pointer;float:left"></div><div class="city" data-tooltip="{2}" style="cursor:pointer;float:right"></div><div class="island" data-tooltip="'+LD.to_island+'" style="cursor:pointer;float:right"></div><div class="worldmap" data-tooltip="'+LD.to_world+'" style="cursor:pointer;float:right"></div><br></div></div><div class="transport" data-tooltip="{10}" style="cursor:pointer;float:right"></div><div class="islandgood" style="background: url(skin/resources/icon_{3}.png) no-repeat center / 18px auto;cursor:pointer;float:right" data-tooltip="dynamic"></div><div class="islandwood" data-tooltip="dynamic" style="cursor:pointer;float:right"></div><div class="temple" data-tooltip="dynamic" style="opacity:{14}"><div class="temple"  style="background:url(skin/buildings/x40_y40/temple.png) no-repeat center center; background-size: 20px 18px; background-position: +5px 1px;"></div></div></td><td class="population" data-tooltip="dynamic"><span class="pop" data-tooltip="dynamic"></span> <span></span> <div class="progressbarPop ui-progressbar ui-widget ui-widget-content ui-corner-all" data-tooltip="dynamic"><div class="ui-progressbar-value ui-widget-header ui-corner-left" style="width: 95%"></div></div></td><td class="population_happiness"><span class="happy" data-tooltip="dynamic"><img align=right height="18" hspace="8" vspace="2"></span><br><span class="growth clickbar" data-tooltip="dynamic"></span></td><td class="research" data-tooltip="dynamic"><span class="scientists" data-tooltip="dynamic"></span> <span></span>{4}</div></td>{1}</tr>';
			var resourceCell = '<td class="resource {0}"><span class="icon safeImage"></span> <span class="current" data-tooltip="dynamic"></span> <span class="incoming" data-tooltip="dynamic"></span> <div class="progressbar ui-progressbar ui-widget ui-widget-content ui-corner-all" data-tooltip="dynamic"><div class="ui-progressbar-value ui-widget-header ui-corner-left" style="width: 95%"></div></div></td><td class="resource {0}"><span class="prodconssubsum production Green" data-tooltip="dynamic"></span> <span class="prodconssubsum consumption Red" data-tooltip="dynamic"></span> <span class="emptytime Red"></span></td>';
			var footer = '<tr><td colspan="2"></td><td id="t_sigma" class="total" data-tooltip="dynamic"><img src="skin/icons/tradeAdvisorFilter/Icon_Alle_20x20.png" style="height: 17px; float: left"><img src="skin/icons/tradeAdvisorFilter/Icon_Warentransport_20x20.png" style="height: 18px; float: left"><img src="skin/icons/tradeAdvisorFilter/Icon_IkariamPlus_News_20x20.png" style="height: 17px; float: left">Σ :</td><td id="t_population" class="total"></td><td id="t_growth" class="total" data-tooltip="dynamic"></td><td id="t_researchpoints" class="total" data-tooltip="dynamic"></td><td id="t_currentgold" class="total"></td><td id="t_goldincome" class="total" data-tooltip="dynamic"><span class="Green"></span> <span class="Red"></span> <td id="t_currentwood" class="total" data-tooltip="dynamic"></td><td id="t_woodincome" class="total" data-tooltip="dynamic"><span class="Green"></span> <span class="Red"></span></td><td id="t_currentwine" class="total" data-tooltip="dynamic"></td><td id="t_wineincome" class="total" data-tooltip="dynamic"><span class="Green"></span> <span class="Red"></span></td><td id="t_currentmarble" class="total" data-tooltip="dynamic"></td><td id="t_marbleincome" class="total" data-tooltip="dynamic"><span class="Green"></span> <span class="Red"></span></td><td id="t_currentglass" class="total" data-tooltip="dynamic"></td><td id="t_glassincome" class="total" data-tooltip="dynamic"><span class="Green"></span> <span class="Red"></span></td><td id="t_currentsulfur" class="total" data-tooltip="dynamic"></td><td id="t_sulfurincome" class="total" data-tooltip="dynamic"><span class="Green"></span> <span class="Red"></span></td></tr>';
			return Utils.format(table,[getHead(),getBody(),getFooter()]);
			function getHead()
			{
				return Utils.format(header,[LD.towns,LD.actionP,LD.population,LD.researchP,LD.finances_,LD.wood_,LD.wine_,LD.marble_,LD.crystal_,LD.sulphur_,LD.government+': '+LD[database.getGlobalData.getGovernmentType]]);
			}
			function getBody()
			{
				var rows = '';
				$.each(database.cities,function(cityId,city)
				{
					var resourceCells = '';
					var info = city.isUpgrading === true ? '!' : '';
					var progSci = this.getBuildingFromName(Constant.Buildings.ACADEMY) ? '<div class="progressbarSci ui-progressbar ui-widget ui-widget-content ui-corner-all" data-tooltip="dynamic"><div class="ui-progressbar-value ui-widget-header ui-corner-left" style="width:95%"></div></div>' : '';
					var wonder_size = city.getWonder == 7 || 1 ? 25 : 20;
					$.each(Constant.Resources,function(key,resourceName) { resourceCells += Utils.format(resourceCell,[resourceName]); });
					var a = [LD[city.isCapital ? 'capital' : 'colony'],city._name];
					var transtip = !city.isCurrentCity ? Utils.format(LD.transporting,a) : LD.transtip;
					rows += Utils.format(resourceRow,[city.getId,resourceCells,Utils.format(LD.to_town_hall,a),city.getTradeGood,progSci,info,info?LD.constructing:'',city.getWonder.id,wonder_size,city.getIslandID,transtip,Utils.format(LD.to_saw_mill,a),Utils.format(LD.to_mine,a),(city._culturalGoods<city.maxculturalgood?' style="background-color: red"':''),(city.getBuildingFromName(Constant.Buildings.TEMPLE)?'1.0;cursor:pointer':'0.5')]);
				});
				return rows;
			}
			function getFooter() { return footer; }
		},
		getArmyTable: function()
		{
			var LD = Constant.LanguageData[database.settings.languageChange.value];
			var inAlliance = unsafeWindow.hasAlly;
			var table = '<table class="army" style="display:inline-block">{0}<tbody>{1}</tbody><tfoot>{2}</tfoot></table>';
			var headerRow = '<thead><tr class="header_row"><th class="city_name" data-tooltip="dynamic" style="cursor:pointer" onclick="ajaxHandlerCall(\'?view=ikipedia&helpId=18\')">{0}</th><th data-tooltip="{1}" class="action_points3 icon actionpointImage3"><th class="empireactions" colspan="4" style="width:100px"><div class="spio" data-tooltip="'+LD.espionage +'" style="{3}"></div><div class="combat" data-tooltip="'+LD.combat+'" style="cursor:pointer"></div><div class="generalee" data-tooltip="'+(inAlliance?LD.altreat:'')+'" style="opacity:'+(inAlliance?'1.0;cursor:pointer':'0.5')+'"></div><div class="generalEdit" data-tooltip="'+LD.generalAllyView[database.getGlobalData.getEmbassyData.ranks[2].id==unsafeWindow.dataSetForView.avatarId?1:0]+'" style="opacity:'+(database.getGlobalData.getEmbassyData.ranks[2].id==unsafeWindow.dataSetForView.avatarId?'1.0;cursor:pointer':'0.5')+'"></div></th><th></th><th class="expenses_header icon expensesImage" data-tooltip="'+LD.expenses+'"></th>{2}</tr></thead>';
			var headerCell = '<th data-tooltip="{0}" style="background:url(\'{1}\') no-repeat center center;background-size: 23px 25px; cursor:pointer" colspan="2" class="army unit icon {2}" onclick="ajaxHandlerCall(\'?view=unitdescription&{5}Id={3}&helpId={4}\');return false;">&nbsp;</th>';
			var bodyRow = '<tr id="army_{0}"><td class="city_name" style="width:200px;white-space:nowrap"><img><span class="clickable"></span><sub></sub><span class="coords" style="float:right;font-size:80%;display:block"></span></td><td class="action_points" style="width:1px;white-space:nowrap"><span class="ap"></span><br><span class="garrisonlimit" data-tooltip="dynamic" style="cursor:pointer;"><img height="18" hspace="5"></span></td><td class="empireactions" style="width:1px;white-space:nowrap"><div class="spies icon spypointImage" data-tooltip="dynamic" style="opacity:{8}"></div></td><td class="empireactions" style="width:1px;white-space:nowrap"><div class="deploymentarmy"data-tooltip="{6}" style="cursor:pointer;"></div><br><div class="deploymentfleet"data-tooltip="{7}" style="cursor:pointer"></div></td><td class="empireactions" style="width:1px;white-space:nowrap"><div class="garrisonEdita" data-tooltip="'+LD.dismiss_unit+'" style="cursor:pointer"></div><br><div class="garrisonEditb" data-tooltip="'+LD.dismiss_fleet+'" style="cursor:pointer"></div></td><td colspan="2" class="empireactions" style="width:1px;white-space:nowrap">{3} <br> {4}</td><td class="expenses" style="width:1px;white-space:nowrap">{5}</td>{1}</tr>';
			var bodyCell = '<td class="army unit {0}" style="width:1px;white-space:nowrap"><span>{1}</span></td><td class="army movement {0}" data-tooltip="dynamic" style="width:1px;white-space:nowrap"><span class="More Green {0}">{2}</span><br><span class="More Blue {0}">{3}</span></td>';
			var costCell = '';
			var footerRow = '<tr class="totals_row"><td class="city_name"></td><td></td><td class="sigma" colspan="5" style="width:100px"> <img src="skin/icons/tradeAdvisorFilter/Icon_Spionage_20x20.png" style="height:20px;float:left"> <img src="skin/icons/tradeAdvisorFilter/Icon_Militaer_20x20.png" style="height:20px;float:right"> Σ :</td><td>&nbsp;{1}&nbsp;</td>{0}</tr>';
			var footerCell = '<td class="army total {0} unit"></td><td class="army total {0} movement"><span class="More Green"></span> <span class="More Blue"></span></td>';
			return Utils.format(table,[getHead(),getBody(),getFooter()]);
			function getHead()
			{
				var headerCells = '';
				var cols = '<colgroup span=7/><colgroup></colgroup>';
				var safehouse = 0;
				$.each(database.cities,function(cityId,city){if(city.getBuildingFromName(Constant.Buildings.SAFEHOUSE)){safehouse++;}});
				for(var category in Constant.unitOrder)
				{
					cols += '<colgroup>';
					$.each(Constant.unitOrder[category],function(index,value)
					{
						var helpId = 9;
						var unit = 'unit';
						if(Constant.UnitData[value].id < 300)
						{
							helpId = 10;
							unit = 'ship';
						}
						headerCells += Utils.format(headerCell,[LD[value],getImage(value),value,Constant.UnitData[value].id,helpId,unit]);
						cols += '<col><col>';
					});
					cols += '</colgroup>';
				}
				return cols+Utils.format(headerRow,[LD.towns,LD.actionP,headerCells,'opacity:'+(safehouse>0?'1.0;cursor:pointer':'0.5'),LD.government+': '+LD[database.getGlobalData.getGovernmentType]]);
			}
			function getBody()
			{
				var body = '';
				$.each(database.cities,function(cityId, city)
				{
					var rowCells = '';
					var a = [LD[city.isCapital ? 'capital' : 'colony'],city._name];
					var divbarracks = this.getBuildingFromName(Constant.Buildings.BARRACKS) ? '<div class="barracks" data-tooltip="'+Utils.format(LD.to_barracks,a)+'" style="cursor:pointer;"></div>' : '';
					var divshipyard = this.getBuildingFromName(Constant.Buildings.SHIPYARD) ? '<div class="shipyard" data-tooltip="'+Utils.format(LD.to_shipyard,a)+'" style="cursor:pointer;"></div>' : '&nbsp;';
					var spyopacity = this.getBuildingFromName(Constant.Buildings.SAFEHOUSE) ? '1.0;cursor:pointer' : '0.5';
					var cost = 0; //city.military.getUnits.getUnit('phalanx')*Constant.UnitData.phalanx.baseCost;
					for(var category in Constant.unitOrder)
					{
						$.each(Constant.unitOrder[category],function(index,value)
						{
							var res = Constant.UnitData[value].id < 300 ? 'Seafaring' : 'Military';
							var r = {'Seafaring':['SHIP_MAINTENANCE','PITCH','SEA_MAPS','SEAFARING_FUTURE'],'Military':['MAPS','CODE_OF_HONOR','LOGISTICS','MILITARISTIC_FUTURE']};
							var builds = city.getUnitBuildsByUnit(value);
							cost += city.military.getUnits.getUnit(value)*Constant.UnitData[value].baseCost*(1-database.getGlobalData.getResearchTopicLevel(Constant.Research[res][r[res][0]])*0.02-database.getGlobalData.getResearchTopicLevel(Constant.Research[res][r[res][1]])*0.04-database.getGlobalData.getResearchTopicLevel(Constant.Research[res][r[res][2]])*0.08-database.getGlobalData.getResearchTopicLevel(Constant.Research[res][r[res][3]])*0.02);
							rowCells += Utils.format(bodyCell,[value,city.military.getUnits.getUnit(value)>0?Utils.FormatNumToStr(city.military.getUnits.getUnit(value)):'',builds[value]!=undefined?Utils.FormatNumToStr(builds[value],true):'','']);
						});
					}
					body += Utils.format(bodyRow,[city.getId,rowCells,city._name,divbarracks,divshipyard,Utils.FormatNumToStr(cost,false,2),Utils.format(LD.transporting_units,a),Utils.format(LD.transporting_fleets,a),spyopacity]);
				});
				return body;
			}
			function getFooter()
			{
				var footerCells = '';
				var expense = Utils.FormatNumToStr(database.getGlobalData.finance.armyCost+database.getGlobalData.finance.fleetCost);
				for(var category in Constant.unitOrder)
				{
					$.each(Constant.unitOrder[category],function(index,value)
					{
						footerCells += Utils.format(footerCell,[value]);
					});
				}
				return Utils.format(footerRow,[footerCells,expense]);
			}
			function getImage(unitID)
			{
				return (Constant.UnitData[unitID].type == 'fleet') ? 'skin/characters/fleet/60x60/'+unitID+'_faceright.png' : 'skin/characters/military/x60_y60/y60_'+unitID+'_faceright.png';
			}
		},
		getBuildingTable: function()
		{
			var LD = Constant.LanguageData[database.settings.languageChange.value];
			var city = database.getCityFromId(ikariam.CurrentCityId);
			// || ikariam.getBranchOffice.getBuildingFromName(Constant.Buildings.TRADING_POST)
			var table = '<table class="buildings" style="display:inline-block">{0}<tbody>{1}</tbody></table>';
			var headerCell = '<th data-tooltip="{0}" style="background-color:transparent;background-image:url(\'{1}\');background-repeat:no-repeat;background-attachment:scroll;background-position:center center;background-clip:border-box;background-origin:padding-box;background-size:45px auto;cursor:pointer" colspan="{2}" class="icon" onclick="ajaxHandlerCall(\'?view=buildingDetail&helpId=1&buildingId={3}\');return false;">&nbsp;</th>';
			var headerRow = '<thead><tr class="header_row"><th class="city_name" data-tooltip="dynamic" style="cursor:pointer" onclick="ajaxHandlerCall(\'?view=ikipedia&helpId=18\')">{0}</th><th data-tooltip="{1}" class="action_points icon actionpointImage"></th><th class="empireactions" colspan="1"><div class="trapart" data-tooltip="'+LD.trpart +'" style="opacity:'+(city.getBuildingFromName(Constant.Buildings.TRADING_POST) || ikariam.getBranchOffice ? '1.0;cursor:pointer' : '0.5')+'"></div></th>{2}</tr></thead>';
			var buildingCell = '<td class="building {0}" data-tooltip="dynamic"></td>';
			var buildingRow = '<tr id="building_{0}"><td class="city_name" style="width:200px"><img><span class="clickable"></span><sub></sub><span class="coords" style="float:right;font-size:80%;display:block"></span></td><td class="action_points"><span class="ap"></span>&nbsp;<br><span class="garrisonlimit" data-tooltip="dynamic" style="cursor:pointer"><img height="18" hspace="5"></span></td><td class="empireactions"><div class="eroute" data-tooltip="'+LD.edit_route+'" style="cursor:pointer"></div><br><div class="transport" data-tooltip="{3}" style="cursor:pointer"></div></td>{1}</tr>';
			var counts = database.getBuildingCounts;
			var buildingOrder = (database.settings.alternativeBuildingList.value ? Constant.altBuildingOrder : database.settings.compressedBuildingList.value ? Constant.compBuildingOrder : Constant.buildingOrder);
			return Utils.format(table,[getHead(),getBody()]);
			function getHead()
			{
				var headerCells = '';
				var colgroup = '<colgroup span="3"></colgroup>';
				for(var category in buildingOrder)
				{
					var cols = '';
					$.each(buildingOrder[category], function(index, value)
					{
						if(value == 'colonyBuilding')
						{
							if(!database.settings.compressedBuildingList.value || !counts[value])
							{
								return true;
							}
							cols += '<col span="' + counts[value] + '">';
							headerCells += Utils.format(headerCell, [LD.palace + '/' + LD.palaceColony, Constant.BuildingData[Constant.Buildings.PALACE].icon, counts[value], "?view=buildingDetail&helpId=1&buildingId=" + Constant.BuildingData.palace.buildingId]);
						}
						else if(value == 'productionBuilding')
						{
							if(!database.settings.compressedBuildingList.value || !counts[value])
							{
								return true;
							}
							cols += '<col span="'+counts[value]+'">';
							headerCells += Utils.format(headerCell,[LD.stonemason+'/'+LD.winegrower+'/'+LD.alchemist+'/'+LD.glassblowing, 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABoAAAAUCAMAAACknt2MAAABelBMVEUAAADp49mgkICxmnzVuIxMcwtciQ90pSC/tKR7aFWOfGmIdmPKr4lomxChyk/YxKjTyrzl2slrVkKBblu5ooXp0a3NwrOqm4uNeWRTMzMnGRZFQBvb0sS0p5j18OiTgW3cvpSeXF07JSSJUlLFeHY2NhZzrRKZh3XmyJwPCgl7jzSHyBXlx53EuateSje0amp0YE2Fc2FzSEeFqzfoyJftylO7l1312oXv0GzWyqzN0MH15b311WO3iy2jchyLXiuZrqtyt9uJx+bP2M789+/sz3nv2p7+5IOXZRWHVA/jxou7vquTyuS7x72MqKmEw+J/wOFdk6ylsaXsz6Xz1njKnzTBlkF6SAvhvE2TsraVzeiNyeZ8ttJ7v+EzXnXJ1M2tfiKts6S63ex2utyUw9hFhqV6ss2W0O7fvmDUrUJnnrOk0+tjq8602uzO6fbCyr7Eu6BqrM1tstS74fKbzeXS6/dvud7OrG1PlLeMwNfW7viu2e2i0ObK4OYudx14AAAAAXRSTlMAQObYZgAAAAFiS0dEAIgFHUgAAAAJcEhZcwAAAEgAAABIAEbJaz4AAAFfSURBVCgVBcFLTlNhGADQ8/29t/e/reVhChWkUDFRE0hM1IlxYiIzhy5EN+ASTNyBO3DoIpw7VBNAiga0QFKsPK7nBBARV4AiIq4ukUBWVd0bQI0OJJjPC3VcV0AVTdOGhKVot//0TEFR9pebWQ8J1d9qNjxZjhGKYV3XI7N7JLDfU+dh48HmekrKcjYab0m2Y7GeP9tb2ztCL5meT8J45UJre5KOrlZv/hr0TyeXk3p6sdBqfc96439p399GXdx2Pbxv47zTreeiGcxKAABF8aiA/tZjAZ5EfAYA0ALDFKsrB4Cn63sgwbOyVeYu4HnOL0BgJyJOFkR88jIiIiI+ouDVecfhMCIa5iLix1oEJDtnnShmZ2mcT8k5VXdzzpB20kn/8HJkcfVnw4c8V09znr5GSpsbX5qlruOvA7zZbbdXqvJWhfR799tgduzhnVY9z/vtnN9VdfvgLQAAAPgPmQZaHvndsJEAAAAASUVORK5CYII=',counts[value], "?view=buildingDetail&helpId=1&buildingId=21"]).replace('50px auto','38px 28px');
						}
						else if(counts[value])
						{
							cols += '<col span="'+counts[value]+'">';
							headerCells += Utils.format(headerCell,[LD[value],Constant.BuildingData[value].icon,counts[value],"?view=buildingDetail&helpId=1&buildingId="+Constant.BuildingData[value].buildingId]);
						}
					});
					if(cols!=='')
					{
						colgroup += '<colgroup>'+cols+'</colgroup>';
					}
				}
				return colgroup+Utils.format(headerRow,[LD.towns,LD.actionP,headerCells,LD.government+': '+LD[database.getGlobalData.getGovernmentType]]);
			}
			function getBody()
			{
				var body = '';
				$.each(database.cities, function(cityId,city)
				{
					var rowCells = '';
					for(var category in buildingOrder)
					{
						$.each(buildingOrder[category], function(index, value)
						{
							if((value == 'productionBuilding' || value == 'colonyBuilding' ) && !database.settings.compressedBuildingList.value) return false;
							var i = 0;
							while(i < counts[value])
							{
								var cssClass = '';
								if(value == 'colonyBuilding')
								{
									cssClass = city.isCapital ? Constant.Buildings.PALACE : Constant.Buildings.GOVERNORS_RESIDENCE;
								}
								else if(value == 'productionBuilding')
								{
									switch(city.getTradeGoodID)
									{
										case 1:
											cssClass = Constant.Buildings.WINERY;
											break;
										case 2:
											cssClass = Constant.Buildings.STONEMASON;
											break;
										case 3:
											cssClass = Constant.Buildings.GLASSBLOWER;
											break;
										case 4:
											cssClass = Constant.Buildings.ALCHEMISTS_TOWER;
											break;
									}
								}
								else
								{
									cssClass = value;
								}
								cssClass += +i;
								rowCells += Utils.format(buildingCell, [cssClass]);
								i++;
							}
						});
					}
					var a = [LD[city.isCapital?'capital':'colony'],city._name];
					body += Utils.format(buildingRow,[city.getId,rowCells,Utils.format(LD.transporting_fleets,a),Utils.format(LD.transporting,a)]);
				});
				return body;
			}
		},
		AddCityCSS: function()
		{
			if(!(/.*view=city.*/.test(window.document.location)))
				if(!this.cssResLoaded()) Utils.addStyleSheet('@import "https://' + ikariam.Host() + '/skin/compiled-' + ikariam.Nationality() + '-city.css";');
		},
		AddIslandCSS: function()
		{
			if(!(/.*view=island.*/.test(window.document.location)))
				if(!this.cssResLoaded()) Utils.addStyleSheet('@import "https://' + ikariam.Host() + '/skin/compiled-' + ikariam.Nationality() + '-island.css";');
		},
		updateCityArmyCell: function(cityId,type,$node)
		{
			var $row;
			var celllevel = !$node;
			try
			{
				if(celllevel)
				{
					$row = this.getArmyRow(cityId);
					$node = Utils.getClone($row);
				}
				var city = database.getCityFromId(cityId);
				var data1 = city.military.getUnits.getUnit(type) || 0;
				var data2 = city.military.getIncomingTotals[type] || 0;
				var data3 = city.military.getTrainingTotals[type] || 0;
				var cells = $node.find('td.' + type);
				cells.get(0).textContent = Utils.FormatNumToStr(data1,false) || '';
				cells = cells.eq(1).children('span');
				cells.get(0).textContent = Utils.FormatNumToStr(data2,true) || '';
				cells.get(1).textContent = Utils.FormatNumToStr(data3,true) || '';
				delete this.cityRows.army[cityId];
				if (celllevel)
				{
					Utils.setClone($row, $node);
					this.setArmyTotals(undefined, type);
				}
			} catch(e) { empire.error('updateCityArmyCell', e); 
			} finally { }
		},
		updateCityArmyRow: function(cityId,$node)
		{
			var $row;
			var rowLevel = !$node;
			if(rowLevel)
			{
				$row = this.getArmyRow(cityId);
				$node = Utils.getClone($row);
			}
			for(var armyId in Constant.UnitData)
			{
				this.updateCityArmyCell(cityId, armyId, $node);
			}
			if(rowLevel)
			{
				Utils.setClone($row, $node);
				this.setArmyTotals();
				delete this.cityRows.army[cityId];
			}
		},
		updateCitiesArmyData:function()
		{
			var $node = $('#ArmyTab').find('table.army');
			var $clone = Utils.getClone($node);
			for (var cityId in database.cities)
			{
				empire.time(this.updateCityArmyRow.bind(this, cityId, $clone.find('#army_' + cityId)), 'updateArmyRow');
			}
			this.setArmyTotals($clone);
			Utils.setClone($node, $clone);
			this.cityRows.army = {};
		},
		updateChangesForCityMilitary: function(cityId, changes)
		{
			if (changes && changes.length < 5)
			{
				$.each(changes, function(index, unit)
				{
					this.updateCityArmyCell(cityId,unit);
				}.bind(render));
				this.setArmyTotals();
			}
			else
			{
				this.updateCityArmyRow(cityId);
			}
		},
		updateGlobalData: function(changes)
		{
			this.setAllResourceData();
			return true;
		},
		updateMovementsForCity: function(changedCityIds)
		{
			if(changedCityIds.length)
				$.each(changedCityIds, function(index, id)
				{
					var city = database.getCityFromId(id);
					if(city)
					{
						this.setMovementDataForCity(city);
					}
				}.bind(render));
		},
		updateResourcesForCity: function(cityId, changes)
		{
			var city = database.getCityFromId(cityId);
			if(city)
			{
				events.scheduleAction(this.updateResourceCounters.bind(render,true));
			}
		},
		updateCityDataForCity: function(cityId, changes)
		{
			var city = database.getCityFromId(cityId);
			if(city)
			{
				var research = 0, population = 0, finance = 0;
				for(var key in changes)
				{
					switch(key)
					{
						case 'research':
							research += changes[key];
							break;
						case 'priests':
							if(Constant.Government.THEOCRACY === database.getGovernmentType)
							{
								population += changes[key];
								finance += changes[key];
							}
							break;
						case 'culturalGoods':
							research += changes[key];
							population += changes[key];
							break;
						case 'citizens':
						case 'population':
							population += changes[key];
							finance += changes[key];
							break;
						case 'name':
							this.setCityName(city);
							break;
						case 'islandId':
							break;
						case 'coordinates':
							break;
						case 'finance':
							finance += changes[key];
					}
				}
				if(!!population)
				{
					this.setPopulationData(city);
				}
				if(!!research)
				{
					this.setResearchData(city);
				}
				if(!!finance)
				{
					this.setFinanceData(city);
				}
			}
		},
		setArmyTotals: function($node, unitId)
		{
			var data = database.getArmyTotals;
			if(!$node)
			{
				$node = $('#ArmyTab');
			}
			if(unitId)
			{
				$node.find('td.total.' + unitId).eq(0).text(Utils.FormatNumToStr(data[unitId].total,false) ||'' ).next().children('span').eq(0).text(Utils.FormatNumToStr(data[unitId].incoming,true) ||'' ).next().text(Utils.FormatNumToStr(data[unitId].training,true) || '' );
				if(data[unitId].training || data[unitId].incoming || data[unitId].total || database.settings.fullArmyTable.value)
				{
					$node.find('td.' + unitId+' ,th.' + unitId).show();
				}
				else
				{
					$node.find('td.' + unitId+' ,th.' + unitId).hide();
				}
			}
			else
			{
				$.each(Constant.UnitData, function(unit, info)
				{
					$node.find('td.total.' + unit).eq(0).text(Utils.FormatNumToStr(data[unit].total,false) ||'' ).next().children('span').eq(0).text(Utils.FormatNumToStr(data[unit].incoming,true) ||'' ).next().text(Utils.FormatNumToStr(data[unit].training,true) || '' );
					if(data[unit].training || data[unit].incoming || data[unit].total || database.settings.fullArmyTable.value)
					{
						$node.find('td.' + unit+' ,th.' + unit).show();
					}
					else
					{
						$node.find('td.' + unit+' ,th.' + unit).hide();
					}
				});
			}
		},
		updateChangesForCityBuilding: function(cityID, changes)
		{
			try
			{
				var city = database.getCityFromId(cityID);
				if(city)
				{
					if(changes.length)
					{
						$.each(changes, function(key, data)
						{
							var building = city.getBuildingFromPosition(data.position);
							if(building.getName === data.name)
							{
								this.updateCityBuildingPosition(city, data.position);
							}
							else
							{
								this.updateCityBuildingRow(city);
								return false;
							}
						}.bind(render));
					}
				}
			} catch(e) { empire.error('updateChangesForCityBuilding', e);
			} finally { }
		},
		updateCityBuildingPosition: function(city, position, $node)
		{
			var LD = Constant.LanguageData[database.settings.languageChange.value];
			var building = city.getBuildingFromPosition(position);
			var idx = 0;
			var cellOnly = ($node === undefined);
			$.each(city.getBuildingsFromName(building.getName), function (index, b)
			{
				if (b.getPosition == building.getPosition)
				{
					idx = index;
					return false;
				}
			});
			var cell;
			if (cellOnly)
			{
				$node = render.getBuildingsRow(city);
				cell = $node.find('td.building.' + building.getName + idx);
			}
			else
			{
				cell = $node.find('td.building.' + building.getName + idx);
			}
			if(!building.isEmpty)
			{
				if(cell.length)
				{
					cell.html('<span>'+building.getLevel+'</span><br><div class="speedup" style="display:none;width:14px;height:14px;cursor:pointer" title="'+LD.shortbuildingtime[0]+'">&nbsp;</div>').find('span').removeClass('upgrading upgradable upgradable maxLevel').addClass('clickable').addClass((building.isUpgrading ? ' upgrading' : (building.isMaxLevel ? 'maxLevel' : '')) + (building.isUpgradable ? (city.isUpgrading ? (building.getLevel<Constant.BuildingData[building.getName].maxLevel ? ' upgradableSoon' : '') : ' upgradable') : ''));
					if(building.isUpgrading)
					{
						var bonTime = 1+Constant.GovernmentData[database.getGlobalData.getGovernmentType].buildingTime;
						var time = Constant.BuildingData[building.getName].time;
						var dur = ((building.getName==Constant.Buildings.PIRATE_FORTRESS?time[building.getLevel]:Math.round(time.a/time.b*Math.pow(time.c,building.getLevel+1)-time.d))*1000*bonTime);
						setInterval(function x()
						{
							if($('#buildingSpeedup').length==1 && $('#buildingSpeedup').css('top')!='20px') { $('#buildingSpeedup').css('top','20px'); }
							cell.find('div.speedup').css({'background':'url(skin/buttons/'+(building.getCompletionTime-moment()>(dur/2)?'fast_fordward':'fertigstellen')+'_14_'+(building.getCompletionTime-moment()>300000?'normal':'blue_orange')+'.png) no-repeat center top','display':building.getCompletionTime>moment()?'inline-block':'none'});
							return x;
						},1000);
						if($('#buildingSpeedup').length==1 && $('#buildingSpeedup').css('top')!='20px') { $('#buildingSpeedup').css('top','20px'); }
						cell.find('div.speedup').css({'background':'url(skin/buttons/'+(building.getCompletionTime-moment()>(dur/2)?'fast_fordward':'fertigstellen')+'_14_'+(building.getCompletionTime-moment()>300000?'normal':'blue_orange')+'.png) no-repeat center top','display':building.getCompletionTime>moment()?'inline-block':'none'});
					}
				}
				else
				{
					return false;
				}
			}
			return true;
		},
		updateCityBuildingRow: function(city, $node)
		{
			try
			{
				var $row;
				var cellLevel = !$node;
				if(cellLevel)
				{
					$row = this.getBuildingsRow(city);
					$node = Utils.getClone($row);
				}
				var success = true;
				$.each(city.getBuildings, function(position, building)
				{
					success = this.updateCityBuildingPosition(city, position, $node);
					return success;
				}.bind(render));
				if (cellLevel)
				{
					render.cityRows.building[city.getId] = undefined;
					$node.find('table.buildings').html(render.getBuildingTable);
					if (!success)
					{
						render.updateCitiesBuildingData();
						$.each(database.cities, function (cityId, city)
						{
							render.setCityName(city);
							render.setActionPoints(city);
							render.setSpies(city);  
						});
						return success;
					}
					Utils.setClone($row, $node);
				}
				return success;
			} catch(e) { empire.error('updateCityBuildingRow', e);
			} finally { }
		},
		updateCitiesBuildingData: function($redraw)
		{
			try
			{
				var success = true;
				var i = 0;
				var $node = $('#BuildTab').find('table.buildings');
				var $clone = $redraw || Utils.getClone($node);
				$.each(database.cities, function(cityId, city)
				{
					success = empire.time(this.updateCityBuildingRow.bind(this, city, $clone.find('#building_' + city.getId)), 'updateBuildingRow');
					return success;
				}.bind(render));
				if (!success)
				{
					$clone.html(render.getBuildingTable);
					if (!$redraw)
					{
						render.updateCitiesBuildingData($clone);
					}
				}
				if (!$redraw)
				{
					this.cityRows.building = {};
					Utils.setClone($node, $clone);
				}
				else
				{
					$.each(database.cities, function (cityId, city)
					{
						render.setCityName(city);
						render.setActionPoints(city);
						render.setSpies(city);
					});
				}
			} catch(e) { empire.error('updateCitiesBuildingData', e);
			} finally { }
		},
		redrawSettings:function ()
		{
			$('#SettingsTab').html(render.getSettingsTable());
			$("#empire_Reset_Button").button({icons: {primary: "ui-icon-alert"}, text: true});
			$("#empire_Website_Button").button({icons: {primary: "ui-icon-home"}, text: true});
			$("#empire_Update_Button").button({icons: {primary: "ui-icon-info"}, text: true});
			$("#empire_Bug_Button").button({icons: {primary: "ui-icon-notice"}, text: true});
			$("#empire_Save_Button").button({icons: {primary: "ui-icon-check"}, text: true});
		},
		DrawContentBox: function()
		{
			var LD = Constant.LanguageData[database.settings.languageChange.value];
			var city = database.getCityFromId(ikariam.CurrentCityId);
			if(!this.mainContentBox)
			{ //<li><a href="#WorldmapTab" data-tooltip="Not yet implemented">Worldmap</a></li>
				var inAlliance = unsafeWindow.hasAlly;
				var Allyicons = '<div style="text-align:right;margin:0 auto">';
				var Icons = ['mayor_premium','mayor','general_premium','diplomat_premium'];
				for(var r=0;r<4;r++)
				{
					var s;
					switch(database.getGlobalData.getEmbassyData.ranks[r].status)
					{
						case 'online':
							s = 25;
							break;
						case 'offline':
							s = 75;
							break;
					}
					var tip = LD.allyranks[r]+' '+LD.leftquot+database.getGlobalData.getEmbassyData.ranks[r].name+LD.rightquot;
					var msg = "ajaxHandlerCall('?view=sendIKMessage&amp;receiverId="+database.getGlobalData.getEmbassyData.ranks[r].id+"')";
					Allyicons += Utils.format('<div style="display:inline-block;cursor:pointer;width:24px;height:21px;background:url(\'skin/layout/advisors/{0}.png\') no-repeat center; background-size: 25px 27px; background-position: -3px +1px;" data-tooltip="{1}" onclick="{2}"><div style="background:url(\'skin/friends/activity.png\') no-repeat 50% {3}% / 8px 40px;width:8px;height:8px;position:relative;overflow:hidden;top:13px;left:14px"></div></div>',[Icons[r],tip,msg,s]);
				}
				Allyicons += '</div>';
				Allyicons = inAlliance ? Allyicons : '';
				var pir = 0, capital = 0;
				$.each(database.cities,function(k,c){pir+=c.isPirateFortress?1:0;capital+=c.getBuildingFromName(Constant.Buildings.PALACE)!==null?1:0;});
//				console.log($('#cityCinema').attr('class'));
				$("#container").after('<div id="empireBoard" class="ui-widget" style="display:none;z-index:'+(database.settings.onTop.value?65112:61)+';position:absolute; left:70px;top:180px"><div id="empire_Tabs"><ul><li><a href="#ResTab"><img src="skin/layout/crown.png" style="height: 16px; margin-top:-1px; float: left">&nbsp;&nbsp;'+LD.economy+'</a></li><li><a href="#BuildTab"><img src="skin/icons/city_30x30.png" style="height: 18px; margin-top:-3px; float: left">&nbsp;&nbsp;'+LD.buildings+'</a></li><li><a href="#ArmyTab"><img src="skin/layout/shield-icon1.png" style="height: 12px; float: right"><img src="skin/layout/sword-icon1.png" style="height: 12px; float: left">&nbsp;&nbsp;'+LD.military+'&nbsp;&nbsp;</a></li><li><a href="#SettingsTab" data-tooltip="'+LD.options+'"><span class="ui-icon ui-icon-gear"/></a></li><li><a href="#HelpTab" data-tooltip="'+LD.help+'"><span class="ui-icon ui-icon-help"/></a></li>'+(database.settings.noPiracy.value==false && database.getGlobalData.getResearchTopicLevel(Constant.Research.Seafaring.PIRACY)==1 ? '<div class="pirates" style="display:'+(pir>0?'inline-block':'none')+';float:right;cursor:pointer;font-size:14pt;opacity:'+(city.isPirateFortress?'1.0':'0.5')+'" data-tooltip="dynamic">☠</div>':'')+(database.settings.noTheater.value==false?'<div id="cinelink" class="cinetheater icon '+$('#cityCinema').attr('class')+'cineIcon" style="width:25px;height:25px;display:inline-block;float:right;cursor:pointer" data-tooltip="dynamic"></div>':'')+(capital>0?'<div class="dailytasks" style="width:24px;height:22px;float:right;background: url(\'skin/resources/favour.png\') no-repeat center / 25px 20px;cursor:pointer" data-tooltip="dynamic"></div>':'')+(inAlliance?'<div style="width:25px;height:25px;float:right;background:url(\'skin/board/schriftrolle_offen2.png\') no-repeat center / auto 19px;cursor:pointer" data-tooltip="'+LD.member+'" onclick="ajaxHandlerCall(\'?view=diplomacyAllyMemberlist\')"></div>':'')+'<div style="width:'+(inAlliance?205:104)+'px;height:24px;display:table;margin:auto;background: url(\'//gf3.geo.gfsrv.net/cdnb0/894886c1294a01514b9e1b31abe197.png\') no-repeat left / 104px 18px;">'+Allyicons+'</div>'+'</ul><div id="ResTab"></div><div id="BuildTab"></div><div id="ArmyTab"></div><div id="WorldmapTab"></div><div id="SettingsTab"></div><div id="HelpTab"></div></div></div>');
				setInterval(function()
				{
					database._globalData._theater.status = $('#cityCinema').attr('class')!==undefined ? $('#cityCinema').attr('class') : database._globalData._theater.status;
					$("#cinelink").removeClass(function(k,c){ return c.match(/\w*cineIcon$/)[0]; }).addClass(database.getGlobalData.getTheaterData.status+'cineIcon');
				},1000);
				this.mainContentBox = $("#empireBoard");
				this.$tabs = $("#empire_Tabs").tabs({collapsible: true, show: null, selected: -1 });
				this.mainContentBox.draggable({handle:'#empire_Tabs > ul',cancel:'div.ui-tabs-panel',stop: function() {render.SaveDisplayOptions();}});
				this.$tabs.find('ul li a').on('click', function() { events(Constant.Events.TAB_CHANGED).pub(render.$tabs.tabs('option', 'active')); render.SaveDisplayOptions(); });
				render.mainContentBox
				.on('mouseenter',function() { if(database.settings.windowTennis.value) { render.mainContentBox.css('z-index', "65112"); }})
				.on('mouseleave', function() { if(database.settings.windowTennis.value) { render.mainContentBox.css('z-index', "2");}});
			}
			if(database.settings.ctfinder.value)
			{
				$('#js_viewFriends > ul > li').each(function()
				{
					if($(this).find('div.name').length)
					{
						$(this).find('div.name > span.CTicon').remove();
						$(this).find('div.name').css('width','105px').find('a').after('<span class="CTicon" style="float:right"></span>');
						var fid = $(this).find('div.name > a').attr('href').split('=')[2];
						if(Object.keys(database.getGlobalData.getMuseumTreaties).indexOf(fid)!=-1)
						{
							$(this).find('div.name > span.CTicon').html('<img src="skin/museum/icon32_culturalgood.png" style="width:15px;height:auto;float:right" title="'+LD.ctenabled+'">');
						}
						else if(Object.keys(database.getGlobalData.getPotMuseumTreaties).indexOf(fid)!=-1)
						{
							$(this).find('div.name > span.CTicon').html('<img src="skin/museum/icon32_culturalgood.png" style="width:15px;height:auto;opacity:0.5" title="'+LD.ctrequested[database.getGlobalData.getPotMuseumTreaties[fid].type*0.5-39]+'">');
						}
					}
				});
				$('#js_viewFriends').find('a.pageup, a.pagedown').on('click',function()
				{
					$('#js_viewFriends > ul > li').each(function()
					{
						if($(this).find('div.name').length)
						{
							$(this).find('div.name > span.CTicon').remove();
							$(this).find('div.name').css('width','105px').find('a').after('<span class="CTicon" style="float:right"></span>');
							var fid = $(this).find('div.name > a').attr('href').split('=')[2];
							if(Object.keys(database.getGlobalData.getMuseumTreaties).indexOf(fid)!=-1)
							{
								$(this).find('div.name > span.CTicon').html('<img src="skin/museum/icon32_culturalgood.png" style="width:15px;height:auto;" title="'+LD.ctenabled+'">');
							}
							else if(Object.keys(database.getGlobalData.getPotMuseumTreaties).indexOf(fid)!=-1)
							{
								$(this).find('div.name > span.CTicon').html('<img src="skin/museum/icon32_culturalgood.png" style="width:15px;height:auto;opacity:0.5" title="'+LD.ctrequested[database.getGlobalData.getPotMuseumTreaties[fid].type*0.5-39]+'">');
							}
						}
					});
				});
			}
			else
			{
				$('li[id^="js_friendlistSlot"] > div.name > a').next('span').remove();
			}
		},
		AttachClickHandlers:function()
		{
			$('body').on('click','#js_buildingUpgradeButton',function(e)
			{
				var upgradeSuccessCheck;
				var href = this.getAttribute('href');
				if(href !== '#')
				{
					var params = $.decodeUrlParam(href);
					if(params['function'] === "upgradeBuilding")
					{
						upgradeSuccessCheck = (function upgradeSuccess()
						{
							var p = params;
							return function(response)
							{
								var len = response.length;
								var feedback = 0;
								while(len--)
								{
									if(response[len][0] == 'provideFeedback')
									{
										feedback = response[len][1][0].type;
										break;
	1								}
								}
								if(feedback == 10)
								{ //success
									render.updateChangesForCityBuilding(p.cityId || ikariam.getCurrentCity, []);
								}
								events('ajaxResponse').unsub(upgradeSuccessCheck);
							};
						})();
					}
					events('ajaxResponse').sub(upgradeSuccessCheck);
				}
			});
			render.mainContentBox.on('click','td.city_name span.clickable',function(event)
			{
				var target = $(event.target);
				var city = database.getCityFromId(target.parents('tr').attr('id').split('_').pop());
				var classes = target.parents('td').attr('class');
				var params = {cityId: city.getId};
				if(!city.isCurrentCity)
				{
					$("#js_cityIdOnChange").val(city.getId);
					if(unsafeWindow.ikariam.templateView)
					{
						if(unsafeWindow.ikariam.templateView.id === 'tradegood' || unsafeWindow.ikariam.templateView.id === 'resource')
						{
							params.templateView = unsafeWindow.ikariam.templateView.id;
							if(ikariam.viewIsCity)
							{
								params.islandId = city.getIslandID;
								params.view = unsafeWindow.ikariam.templateView.id;
								params.type = unsafeWindow.ikariam.templateView.id=='resource'?'resource':city.getTradeGoodID;
							}
							else
							{
								params.currentIslandId = ikariam.getCurrentCity.getIslandID;
							}
						}
					}
					ikariam.loadUrl(true, ikariam.mainView, params);
				}
				return false;
			})
			.on('click','td.empireactions div.spypointImage',function(event)
			{
				var target = $(event.target);
				var className = target.parents('td').attr('class').split('_').pop();
				var city = database.getCityFromId(target.parents('tr').attr('id').split('_').pop());
				if(city.isSafehouse)
				{
					var building = city.getBuildingFromName(Constant.Buildings.SAFEHOUSE);
					var params = building.getUrlParams;
					params.activeTab = 'tabSafehouse';
					if(building)
					{
						ikariam.loadUrl(true,'city',params);
					}
					else if(ikariam.viewIsIsland)
					{
						params.currentIslandId = ikariam.getCurrentCity.getIslandID;
					}
					ikariam.loadUrl(true,ikariam.mainView, params);
					render.AddCityCSS();
				}
				return false;
			})
			.on('click', 'td.empireactions div.transport',function(event)
			{
				var target = $(event.target);
				var city = database.getCityFromId(target.parents('td').parents('tr').attr('id').split('_').pop());
				if(!city.isCurrentCity && ikariam.getCurrentCity)
				{
					ikariam.loadUrl(true, ikariam.mainView, {view: 'transport', destinationCityId: city.getId, templateView: Constant.Buildings.TRADING_PORT});
				}
				return false;
			})
			.on('click', 'td.empireactions div[class*=deployment]', function(event)
			{
				var target = $(event.target);
				var city = database.getCityFromId(target.parents('tr').attr('id').split('_').pop());
				var type = target.attr('class').split(' ').pop().split('deployment').pop();
				if(ikariam.currentCityId === city.getId)
				{
					return false;
				}
				var params = {
					cityId: ikariam.CurrentCityId,
					view: 'deployment',
					deploymentType: type,
					destinationCityId: city.getId
				};
				ikariam.loadUrl(true, null, params);
			});
			$('#empire_Tabs')
			.on('click', 'td.empireactions div.worldmap', function(event)
			{
				var target = $(event.target);
				var className = target.parents('td').attr('class').split(' ').pop();
				var city = database.getCityFromId(target.parents('tr').attr('id').split('_').pop());
				var params = {
					cityId: city.getId,
					view: 'worldmap_iso'
				};
				ikariam.loadUrl(true, 'city', params);
				return false;
			})
			.on('click', 'td.empireactions div.island', function(event)
			{
				var target = $(event.target);
				var className = target.parents('td').attr('class').split(' ').pop();
				var city = database.getCityFromId(target.parents('tr').attr('id').split('_').pop());
				var params = {
					cityId: city.getId,
					view: 'island'
				};
				ikariam.loadUrl(true, null, params);
				return false;
			})
			.on('click', 'td.empireactions div.eroute', function(event)
			{
				var target = $(event.target);
				var className = target.parents('td').attr('class').split(' ').pop();
				var city = database.getCityFromId(target.parents('tr').attr('id').split('_').pop());
				var params = {
					cityId: city.getId,
					view:'tradeRoutes',
					newTradeRoute:'1',
					activeTab:'tradeRoutes',
					page:'0',
				};
				ikariam.loadUrl(true, null, params);
				return false;
			})
			.on('click','td.empireactions div.garrisonEdita',function(event)
			{
				var target = $(event.target);
				var className = target.parents('td').attr('class').split(' ').pop();
				var city = database.getCityFromId(target.parents('tr').attr('id').split('_').pop());
				var params = {
					cityId: city.getId,
					view: 'garrisonEdit',
					activeTab:'unit'
				};
				ikariam.loadUrl(true, "city", params);
				if(unsafeWindow.ikariam.templateView)unsafeWindow.ikariam.templateView.id = null;
				if(ikariam.viewIsIsland)
				{
					params.currentIslandId = ikariam.getCurrentCity.getIslandID;
				}
				ikariam.loadUrl(true, ikariam.mainView, params);
				render.AddCityCSS();
				return false;
			})
			.on('click', 'td.empireactions div.garrisonEditb',function(event)
			{
				var target = $(event.target);
				var className = target.parents('td').attr('class').split(' ').pop();
				var city = database.getCityFromId(target.parents('tr').attr('id').split('_').pop());
				var params = {
					cityId: city.getId,
					view: 'garrisonEdit',
					activeTab:'fleet'
				};
				ikariam.loadUrl(true, "city", params);
				if(unsafeWindow.ikariam.templateView)unsafeWindow.ikariam.templateView.id = null;
				if(ikariam.viewIsIsland)
				{
					params.currentIslandId = ikariam.getCurrentCity.getIslandID;
				}
				ikariam.loadUrl(true, ikariam.mainView, params);
				render.AddCityCSS();
				return false;
			})
			.on('click', 'td.action_points span.garrisonlimit',function(event)
			{
				var target = $(event.target);
				var className = target.parents('td').attr('class').split(' ').pop();
				var city = database.getCityFromId(target.parents('tr').attr('id').split('_').pop());
				var params = {
					cityId: city.getId,
					view: 'cityMilitary',
					activeTab:'tabUnits'
				};
				ikariam.loadUrl(true, "city", params);
				if(unsafeWindow.ikariam.templateView)unsafeWindow.ikariam.templateView.id = null;
				if(ikariam.viewIsIsland)
				{
					params.currentIslandId = ikariam.getCurrentCity.getIslandID;
				}
				ikariam.loadUrl(true, ikariam.mainView, params);
				render.AddCityCSS();
				return false;
			}).on('click', 'td.empireactions div.city',function(event)
			{
				var target = $(event.target);
				var city = database.getCityFromId(target.parents('tr').attr('id').split('_').pop());
				var building = city.getBuildingFromName(Constant.Buildings.TOWN_HALL);
				var params = building.getUrlParams;
				if(unsafeWindow.ikariam.templateView)unsafeWindow.ikariam.templateView.id = null;
				ikariam.loadUrl(true, 'city', params);
				return false;
			})
			.on('click', 'td.population_happiness span.growth', function(event)
			{
				var target = $(event.target);
				var city = database.getCityFromId(target.parents('tr').attr('id').split('_').pop());
				var className = target.parents('td').attr('class').split(' ').pop();
				var building = city.getBuildingFromName(Constant.Buildings.TAVERN);
				if(building!=null)
				{
					var params = building.getUrlParams;
					if(unsafeWindow.ikariam.templateView)unsafeWindow.ikariam.templateView.id = null;
					ikariam.loadUrl(true,'city',params);
				}
				return false;
			})
			.on('click', 'td.population_happiness span.happy', function(event)
			{
				var target = $(event.target);
				var city = database.getCityFromId(target.parents('tr').attr('id').split('_').pop());
				var className = target.parents('td').attr('class').split(' ').pop();
				var building = city.getBuildingFromName(Constant.Buildings.MUSEUM);
				if(building!=null)
				{
					var params = building.getUrlParams;
					if(unsafeWindow.ikariam.templateView)unsafeWindow.ikariam.templateView.id = null;
					ikariam.loadUrl(true,'city',params);
				}
				return false;
			})
			.on('click', 'td.research span',function(event)
			{
				var target = $(event.target);
				var city = database.getCityFromId(target.parents('tr').attr('id').split('_').pop());
				var className = target.parents('td').attr('class').split(' ').pop();
				var building = city.getBuildingFromName(Constant.Buildings.ACADEMY);
				if(building!=null)
				{
					var params = building.getUrlParams;
					if(unsafeWindow.ikariam.templateView)unsafeWindow.ikariam.templateView.id = null;
					ikariam.loadUrl(true, 'city', params);
				}
				return false;
			})
			.on('click', 'td.empireactions div.barracks',function(event)
			{
				var target = $(event.target);
				var city = database.getCityFromId(target.parents('tr').attr('id').split('_').pop());
				var className = target.parents('td').attr('class').split(' ').pop();
				var building = city.getBuildingFromName(Constant.Buildings.BARRACKS);
				var params = building.getUrlParams;
				ikariam.loadUrl(true, 'city', params);
				if(unsafeWindow.ikariam.templateView)unsafeWindow.ikariam.templateView.id = null;
				if(building)
				{
					ikariam.loadUrl(true,'city',params);
				}
				else if(ikariam.viewIsIsland)
				{
					params.currentIslandId = ikariam.getCurrentCity.getIslandID;
				}
				ikariam.loadUrl(true, ikariam.mainView, params);
				render.AddCityCSS();
				return false;
			})
			.on('click', 'td.empireactions div.shipyard',function(event)
			{
				var target = $(event.target);
				var city = database.getCityFromId(target.parents('tr').attr('id').split('_').pop());
				var className = target.parents('td').attr('class').split(' ').pop();
				var building = city.getBuildingFromName(Constant.Buildings.SHIPYARD);
				var params = building.getUrlParams;
				ikariam.loadUrl(true, 'city', params);
				if(unsafeWindow.ikariam.templateView)unsafeWindow.ikariam.templateView.id = null;
				if(building)
				{
					ikariam.loadUrl(true,'city',params);
				}
				else if(ikariam.viewIsIsland)
				{
					params.currentIslandId = ikariam.getCurrentCity.getIslandID;
				}
				ikariam.loadUrl(true, ikariam.mainView, params);
				render.AddCityCSS();
				return false;
			})
			.on('click', 'td.empireactions div.temple',function(event)
			{
				var target = $(event.target);
				var city = database.getCityFromId(target.parents('tr').attr('id').split('_').pop());
				var className = target.parents('td').attr('class').split(' ').pop();
				var building = city.getBuildingFromName(Constant.Buildings.TEMPLE) || false;
				var params = building.getUrlParams;
				if(unsafeWindow.ikariam.templateView)unsafeWindow.ikariam.templateView.id = null;
				if(building)
				{
					ikariam.loadUrl(true,'city',params);
				}
				else if(ikariam.viewIsIsland)
				{
					params.currentIslandId = ikariam.getCurrentCity.getIslandID;
				}
				ikariam.loadUrl(true, ikariam.mainView, params);
				render.AddCityCSS();
				return false;
			})
			.on('click', 'td.empireactions div.wonder',function(event)
			{
				var target = $(event.target);
				var city = database.getCityFromId(target.parents('tr').attr('id').split('_').pop());
				var className = target.parents('td').attr('class').split(' ').pop();
				var building = city.getBuildingFromName(Constant.Buildings.WONDER) || false;
				var params = building.getUrlParams;
				if(unsafeWindow.ikariam.templateView)unsafeWindow.ikariam.templateView.id = null;
				if(building)
				{
					ikariam.loadUrl(true,'city',params);
				}
				else
				{
					ikariam.loadUrl(true,null,{view:'island',cityId:city.getId,dialog:'wonder',islandId:city.getIslandID});
				}
				return false;
			})
			.on('click','th.empireactions div.spio',function()
			{
				var city = database.getCityFromId(ikariam.CurrentCityId);
				var params = {cityId:city.getId,activeTab:'tabReports'};
				if(ikariam.CurrentCityId==city.getId || !ikariam.viewIsIsland)
				{
					params.view = 'safehouse';
					params.islandId = city.getIslandID;
				}
				else if(ikariam.viewIsIsland)
				{
					params.templateView = 'safehouse';
					if(unsafeWindow.ikariam.templateView)unsafeWindow.ikariam.templateView.id = null;
				}
				if(ikariam.viewIsIsland)
				{
					params.currentIslandId = ikariam.getCurrentCity.getIslandID;
				}
				ikariam.loadUrl(true,ikariam.mainView,params);
				render.AddCityCSS();
				return false;
			})
			.on('click', 'th.empireactions div.combat',function()
			{
				var city = database.getCityFromId(ikariam.CurrentCityId);
				var params = {cityId:city.getId};
				if(ikariam.CurrentCityId == city.getId || !ikariam.viewIsIsland)
				{
					params.view = 'militaryAdvisorCombatList';
					params.visit = 1;
					params.islandId = city.getIslandID;
				}
				else if(ikariam.viewIsIsland)
				{
					params.templateView = 'militaryAdvisorCombatList';
					if(unsafeWindow.ikariam.templateView)unsafeWindow.ikariam.templateView.id = null;
				}
				if(ikariam.viewIsIsland)
				{
					params.currentIslandId = ikariam.getCurrentCity.getIslandID;
				}
				ikariam.loadUrl(true, ikariam.mainView, params);
				render.AddCityCSS();
				return false;
			})
			.on('click','th.empireactions div.trapart',function()
			{
				var branchOffice = ikariam.getBranchOffice;
				if(branchOffice)
				{
					ikariam.loadUrl(ikariam.viewIsCity,'city',$.extend(branchOffice.getBuildingFromName(Constant.Buildings.TRADING_POST).getUrlParams,{view:'branchOfficeTradePartners',activeTab:'tabBranchOfficeTradePartners'}));
				};
			})
			.on('click','th.expenses_header',function()
			{
				var branchOffice = ikariam.getBranchOffice;
				if(branchOffice)
				{
					ikariam.loadUrl(ikariam.viewIsCity,'city',$.extend(branchOffice.getBuildingFromName(Constant.Buildings.TRADING_POST).getUrlParams,{view:'branchOfficeSoldier',activeTab:'tabBranchOfficeSoldier'}));
				};
			})
			.on('click','th.action_points3',function()
			{
				var embassy = ikariam.getEmbassy;
				if(embassy)
				{
					ikariam.loadUrl(ikariam.viewIsCity,'city',$.extend(embassy.getBuildingFromName(Constant.Buildings.EMBASSY).getUrlParams,{view:'embassyGeneralAttacksToAlly&amp'}));
				};
			})
			.on('click', 'th.empireactions div.generalEdit',function()
			{
				var embassy = ikariam.getEmbassy;
				if(embassy && database.getGlobalData.getEmbassyData.ranks[2].id==unsafeWindow.dataSetForView.avatarId)
				{
					ikariam.loadUrl(ikariam.viewIsCity, "city", $.extend(embassy.getBuildingFromName(Constant.Buildings.EMBASSY).getUrlParams,{view:'embassyGeneralAttacksFromAlly&amp'}));
				};
			})
			.on('click', 'th.empireactions div.generalee',function()
			{
				var embassy = ikariam.getEmbassy;
				var inAlliance = unsafeWindow.hasAlly;
				if(embassy && inAlliance)
				{
					ikariam.loadUrl(ikariam.viewIsCity, "city", $.extend(embassy.getBuildingFromName(Constant.Buildings.EMBASSY).getUrlParams,{view:'embassyTreaties&amp'}));
				};
			})
			.on('click', 'span.production.clickable',function(event)
			{
				var target = $(event.target);
				var city = database.getCityFromId(target.parents('tr').attr('id').split('_').pop());
				var resource = target.parents('td').attr('class').split(' ').pop();
				var params = { cityId: city.getId };
				if(ikariam.CurrentCityId == city.getId || !ikariam.viewIsIsland)
				{
					params.type = resource == Constant.Resources.WOOD ? 'resource' : city.getTradeGoodID;
					params.view = resource == Constant.Resources.WOOD ? 'resource' : 'tradegood';
					params.islandId = city.getIslandID;
				}
				else if(ikariam.viewIsIsland)
				{
					params.templateView = resource == Constant.Resources.WOOD ? 'resource' : 'tradegood';
					if(unsafeWindow.ikariam.templateView)unsafeWindow.ikariam.templateView.id = null;
				}
				if(ikariam.viewIsIsland)
				{
					params.currentIslandId = ikariam.getCurrentCity.getIslandID;
				}
				ikariam.loadUrl(true, ikariam.mainView, params);
				render.AddIslandCSS();
				return false;
			})
			.on('click', 'td.empireactions div.islandgood', function(event)
			{
				var target = $(event.target);
				var city = database.getCityFromId(target.parents('tr').attr('id').split('_').pop());
				var resource = target.parents('td').attr('class').split(' ').pop();
				var params = { cityId: city.getId };
				if(ikariam.CurrentCityId == city.getId || !ikariam.viewIsIsland)
				{
					params.type = resource == Constant.Resources.WOOD ? 'resource' : city.getTradeGoodID;
					params.view = resource == Constant.Resources.WOOD ? 'resource' : 'tradegood';
					params.islandId = city.getIslandID;
				}
				else if(ikariam.viewIsIsland)
				{
					params.templateView = resource == Constant.Resources.WOOD ? 'resource' : 'tradegood';
					if(unsafeWindow.ikariam.templateView)unsafeWindow.ikariam.templateView.id = null;
				}
				if(ikariam.viewIsIsland)
				{
					params.currentIslandId = ikariam.getCurrentCity.getIslandID;
				}
				ikariam.loadUrl(true, ikariam.mainView, params);
				render.AddIslandCSS();
				return false;
			})
			.on('click', 'td.empireactions div.islandwood', function(event)
			{
				var target = $(event.target);
				var city = database.getCityFromId(target.parents('tr').attr('id').split('_').pop());
				var resource = target.parents('td').attr('class').split(' ').pop();
				var params = { cityId: city.getId };
				if(ikariam.CurrentCityId == city.getId || !ikariam.viewIsIsland)
				{
					params.type = resource == Constant.Resources.WOOD ? city.getTradeGoodID : 'resource';
					params.view = resource == Constant.Resources.WOOD ? 'tradegood' : 'resource';
					params.islandId = city.getIslandID;
				}
				else if(ikariam.viewIsIsland)
				{
					params.templateView = resource == Constant.Resources.WOOD ? 'resource' : 'tradegood';
					if(unsafeWindow.ikariam.templateView)unsafeWindow.ikariam.templateView.id = null;
				}
				if(ikariam.viewIsIsland)
				{
					params.currentIslandId = ikariam.getCurrentCity.getIslandID;
				}
				ikariam.loadUrl(true, ikariam.mainView, params);
				render.AddIslandCSS();
				return false;
			});
			$('#empire_Tabs')
			.on('click', 'td.building span.clickable', function(event)
			{
				var target = $(event.target);
				var city = database.getCityFromId(target.parents('tr').attr('id').split('_').pop());
				var className = target.parents('td').attr('class').split(' ').pop();
				var building = city.getBuildingsFromName(className.slice(0, -1))[className.charAt(className.length - 1)];
				var params = building.getUrlParams;
				if(unsafeWindow.ikariam.templateView)unsafeWindow.ikariam.templateView.id = null;
				ikariam.loadUrl(true, 'city', params);
				return false;
			})
			.on('click','td.building div',function(event)
			{
				var target = $(event.target);
				var city = database.getCityFromId(target.parents('tr').attr('id').split('_').pop());
				var className = target.parents('td').attr('class').split(' ').pop();
				var building = city.getBuildingsFromName(className.slice(0, -1))[className.charAt(className.length - 1)];
				var params = {cityId: city.getId};
				ikariam.closePopup();
				if(!city.isCurrentCity)
				{
					$("#js_cityIdOnChange").val(city.getId);
					if(unsafeWindow.ikariam.templateView)
					{
						if(unsafeWindow.ikariam.templateView.id === 'tradegood' || unsafeWindow.ikariam.templateView.id === 'resource')
						{
							params.templateView = unsafeWindow.ikariam.templateView.id;
							if(ikariam.viewIsCity)
							{
								params.islandId = city.getIslandID;
								params.view = unsafeWindow.ikariam.templateView.id;
								params.type = unsafeWindow.ikariam.templateView.id=='resource'?'resource':city.getTradeGoodID;
							}
							else
							{
								params.currentIslandId = ikariam.getCurrentCity.getIslandID;
							}
						}
					}
					ikariam.loadUrl(true,ikariam.mainView, params);
				}
				else
				{
					ikariam.loadUrl(true, ikariam.mainView, {view:'buildingSpeedup',cityId:city.getId,position:parseInt(building.getUrlParams.position)});
				}
				return false;
			})
			.on('click', 'div#cinelink', function(event)
			{
				var target = $(event.target);
				var city = database.getCityFromId(ikariam.CurrentCityId);
				var params = { cityId: city.getId };
				if(ikariam.CurrentCityId == city.getId || !ikariam.viewIsIsland)
				{
					params.view = 'cinema';
					params.visit = 1;
					params.islandId = city.getIslandID;
				}
				else if(ikariam.viewIsIsland)
				{
					params.templateView = 'cinema';
					if(unsafeWindow.ikariam.templateView)unsafeWindow.ikariam.templateView.id = null;
				}
				if(ikariam.viewIsIsland)
				{
					params.currentIslandId = ikariam.getCurrentCity.getIslandID;
				}
				ikariam.loadUrl(true, ikariam.mainView, params);
				render.AddCityCSS();
				return false;
			})
			.on('click', 'div.dailytasks', function(event)
			{
				var city = database.getCityFromId(ikariam.CurrentCityId);
				var params = {};
				params.view = 'dailyTasks';
				ikariam.loadUrl(true,ikariam.mainView,params);
				render.AddCityCSS();
				return false;
			})
			.on('click', 'div.pirates', function(event)
			{
				var cid = 0;
				for(var c in database.settings.cityOrder.value) { if(database.getCityFromId(database.settings.cityOrder.value[c]).isPirateFortress) { cid = database.settings.cityOrder.value[c]; break; } }
				cid = database.getCityFromId(ikariam.CurrentCityId).isPirateFortress ? ikariam.CurrentCityId : cid;
				var city = database.getCityFromId(cid);
				var building = city.getBuildingFromName(Constant.Buildings.PIRATE_FORTRESS);
				if(building!=null)
				{
					var params = building.getUrlParams;
					params.activeTab = 'tabBootyQuest';
					params.cityId = city.getId;
					params.position = 17;
					if(ikariam.viewIsIsland)
					{
						params.currentIslandId = ikariam.getCurrentCity.getIslandID;
					}
					ikariam.loadUrl(true,ikariam.mainView,params);
					render.AddCityCSS();
				}
				return false;
			});
		},
		startResourceCounters: function()
		{
			this.stopResourceCounters();
			this.resUpd = events.scheduleActionAtInterval(render.updateResourceCounters.bind(render),5000);
			this.updateResourceCounters(true);
		},
		stopResourceCounters: function()
		{
			if(this.resUpd)
			{
				this.resUpd();
				this.resUpd = null;
			}
		},
		getResourceRow: function(city) { return this._getRow(city, "resource"); },
		getBuildingsRow: function(city) { return this._getRow(city, "building"); },
		getArmyRow: function(city) { return this._getRow(city, "army"); },
		_getRow:function(city, type)
		{
			city = typeof city == 'object'? city : database.getCityFromId(city);
			if(!this.cityRows[type][city.getId])
				this.cityRows[type][city.getId] = $("#" + type + "_" + city.getId);
			return this.cityRows[type][city.getId];
		},
		getAllRowsForCity: function(city) { return this.getResourceRow(city).add(this.getBuildingsRow(city)).add(this.getArmyRow(city)); },
		setCityName: function(city, rows)
		{
			if(!rows)
			{
				rows = this.getAllRowsForCity(city);
			}
			var LD = Constant.LanguageData[database.settings.languageChange.value];
			var order = database.settings.cityOrder.value.indexOf(city.getId);
			rows.find('td.city_name').each(function(index, elem)
			{
				elem.children[0].outerHTML = '<span class="icon ' + city.getTradeGood + 'Image"></span>';
				elem.children[1].textContent = (order+1)+' '+city.getName;
				elem.children[2].textContent = ' ' + (city.getAvailableBuildings || '') + ' ';
				elem.children[2].setAttribute('data-tooltip', LD.free_ground);
			});
		},
		setActionPoints: function(city, rows)
		{
			if(!rows)
			{
				rows = this.getAllRowsForCity(city);
			}
			rows.find('span.ap').text(city.getAvailableActions + '/' + city.maxAP);
			rows.find('span.garrisonlimit img').attr('src', 'skin/advisors/military/bang_soldier.png');
		},
		setFinanceData: function(city, row)
		{
			if(!row)
			{
				row = this.getResourceRow(city);
			}
		},
		setPopulationData: function(city, row)
		{
			if(!row)
			{
				row = this.getResourceRow(city);
			}
			var LD = Constant.LanguageData[database.settings.languageChange.value];
			var populationData = city.populationData;
			var popSpace = Math.floor(populationData.currentPop-populationData.maxPop);
			var popDiff = populationData.maxPop-populationData.currentPop;
			row.find('td.population span').get(0).textContent = Utils.FormatNumToStr(populationData.currentPop, false, 0) + '/' + Utils.FormatNumToStr(populationData.maxPop, false, 0);
			row.find('td.population span').get(1).textContent = (popSpace!== 0 ? Utils.FormatNumToStr(popSpace, true, 0):'');
			var fillperc = 100 / populationData.maxPop * populationData.currentPop ;
			row.find('td.population div.progressbarPop').find('div.ui-progressbar-value').width(fillperc + "%").removeClass("normal, warning, full").addClass((populationData.currentPop / populationData.maxPop == 1) ? "full" : (city._citizens < 300) ? "warning" : "normal");
			var img = '';
			if(populationData.growth < -1)
			{
			img = 'outraged';
			}
			else if(populationData.growth < 0)
			{
				img = 'sad';
			}
			else if(populationData.growth < 1)
			{
				img = 'neutral';
			}
			else if(populationData.growth < 6)
			{
				img = 'happy';
			}
			else
			{
				img = 'ecstatic';
			}
			row.find('td.population_happiness span img').attr('src','skin/smilies/'+img+'_x25.png');
			row.find('span.growth').text(Utils.FormatNumToStr(popDiff==0?0:populationData.growth,popDiff==0?false:true,2));
			row.find('span.growth').removeClass('Red Blue').addClass(populationData.happiness > 50 && popDiff === 0 ? 'Green' : populationData.happiness > 0 && populationData.happiness <= 50 && popDiff > -1 ? 'Blue' : 'Red');
		},
		setResearchData: function(city,row)
		{
			if(!row)
			{
				row = this.getResourceRow(city);
			}
			var researchData = researchData || city.research.researchData;
			var isAcademy = city.getBuildingFromName(Constant.Buildings.ACADEMY);
			row.find('td.research span').addClass(isAcademy?'clickbar':'').get(0).textContent = Utils.FormatNumToStr(Math.round(city.research.getResearch > 0 ? city.research.getResearch : city.iSci),true,0);
			var fillperc = (100 * researchData.scientists) / city.maxSci;
			row.find('td.research div.progressbarSci').find('div.ui-progressbar-value').width(fillperc + "%").removeClass('normal, full').addClass(researchData.scientists === 0 ? '' : city.maxSci - researchData.scientists > 0 ? 'normal' : 'full' );
		},
		setMovementDataForCity: function(city, row)
		{
			if(!row)
			{
				row = this.getResourceRow(city);
			}
			var totalIncoming = {wood: 0, wine: 0, marble: 0, glass: 0, sulfur: 0, gold: 0};
			$.each(city.getIncomingResources, function(index, element)
			{
				for(var resourceName in Constant.Resources)
				{
					totalIncoming[Constant.Resources[resourceName]] += element.getResource(Constant.Resources[resourceName]);
				}
			});
			row.find('td.resource.wood').find('span.incoming').get(0).textContent = Utils.FormatNumToStr(totalIncoming[Constant.Resources.WOOD]) || '';
			row.find('td.resource.wine').find('span.incoming').get(0).textContent = Utils.FormatNumToStr(totalIncoming[Constant.Resources.WINE]) || '';
			row.find('td.resource.marble').find('span.incoming').get(0).textContent = Utils.FormatNumToStr(totalIncoming[Constant.Resources.MARBLE]) || '';
			row.find('td.resource.glass').find('span.incoming').get(0).textContent = Utils.FormatNumToStr(totalIncoming[Constant.Resources.GLASS]) || '';
			row.find('td.resource.sulfur').find('span.incoming').get(0).textContent = Utils.FormatNumToStr(totalIncoming[Constant.Resources.SULFUR]) || '';
			row.find('td.resource.gold').find('span.incoming').get(0).textContent = Utils.FormatNumToStr(totalIncoming[Constant.Resources.GOLD]) || '';
		},
		setAllResourceData: function() { this.startResourceCounters(); },
		setCommonData: function()
		{
			$.each(database.cities, function(cityId, city)
			{
				this.setCityName(city);
				this.setActionPoints(city);
			}.bind(render));
		},
		updateResourceCounters: function(force)
		{
//			console.log(Utils.FormatFullTimeToDateString($.now()));
			var LD = Constant.LanguageData[database.settings.languageChange.value];
			if((this.$tabs.tabs('option', 'active') === 0 ) || force)
			{
				var tot = {wood: 0, wine: 0, marble: 0, glass: 0, sulfur: 0};
				var inc = {wood: 0, wine: 0, marble: 0, glass: 0, sulfur: 0};
				var conWine = 0;
				var income = 0;
				var researchCost = 0;
				var researchTot = 0;
				var populationTot = 0;
				var populationMaxTot = 0;
				var	growthTot = 0;
				var	citygrowth = 0;
				var popDiffTot = 0;
				$.each(database.cities, function(cityId, city)
				{
					var $row = Utils.getClone(this.getResourceRow(city));
					if(force)
					{
						this.setFinanceData(city,$row);
						this.setPopulationData(city,$row);
						this.setResearchData(city,$row);
						this.setActionPoints(city,$row);
						this.setMovementDataForCity(city,$row);
					}
					income += Math.floor(city.getIncome);
					researchTot += city.research.getResearch;
					researchCost += Math.floor(city.getExpenses);
					populationTot += city._population;
					populationMaxTot += city.populationData.maxPop;
					citygrowth = Math.floor(city.populationData.maxPop-city._population)>0 ? city.populationData.growth : 0;
					growthTot += citygrowth;
					popDiffTot = Math.floor(populationMaxTot-populationTot);
					var storage = city.maxResourceCapacities;
					var incB = {'WOOD':'FORESTER','WINE':'WINERY','MARBLE':'STONEMASON','GLASS':'GLASSBLOWER','SULFUR':'ALCHEMISTS_TOWER'};
					$.each(Constant.Resources,function(key,resourceName)
					{
						var LD = Constant.LanguageData[database.settings.languageChange.value];
						var currentResource = city.getResource(resourceName);
						var F = (city.getBuildingFromName(Constant.Buildings[incB[resourceName.toUpperCase()]])?city.getBuildingFromName(Constant.Buildings[incB[resourceName.toUpperCase()]]).getLevel:0)*0.02;
						var resName = resourceName!==Constant.Resources.GLASS ? resourceName : 'CRYSTAL';
						var B = 0;
						if(resourceName == Constant.Resources.WOOD && database.getGlobalData.hasPremiumFeature(Constant.Premium.WOOD_BONUS[0]) && database.getGlobalData.hasPremiumFeature(Constant.Premium.WOOD_BONUS[1]) && database.getGlobalData.premium[Constant.Premium['WOOD_BONUS'][1]].cityid==0)
						{
							B += parseFloat(Constant.PremiumData[Constant.Premium['WOOD_BONUS'][0]].bonus);
						}
						else if(resourceName == Constant.Resources.WOOD && database.getGlobalData.hasPremiumFeature(Constant.Premium.WOOD_BONUS[1]) && city.getId==database.getGlobalData.premium[Constant.Premium['WOOD_BONUS'][1]].cityid)
						{
							B += parseFloat(Constant.PremiumData[Constant.Premium['WOOD_BONUS'][1]].bonus);
						}
						else if(resourceName != Constant.Resources.WOOD && database.getGlobalData.hasPremiumFeature(Constant.Premium.TRADEGOOD_BONUS) && city.getId==database.getGlobalData.premium[Constant.Premium.TRADEGOOD_BONUS].cityid && city.getTradeGood == resourceName)
						{
							B += parseFloat(Constant.PremiumData[Constant.Premium.TRADEGOOD_BONUS].bonus);
						}
						else if(resourceName != Constant.Resources.WOOD && database.getGlobalData.hasPremiumFeature(Constant.Premium[resName.toUpperCase()+'_BONUS']) && database.getGlobalData.premium[Constant.Premium[resName.toUpperCase()+'_BONUS']].cityid==0 && city.getTradeGood == resourceName)
						{
							B += parseFloat(Constant.PremiumData[Constant.Premium[resName.toUpperCase()+'_BONUS']].bonus);
						}
						var rwrk = Math.round(currentResource.getProduction*3600/(1+F+B));
						//Math.round(currentResource.getProduction*3600/(1+F+B));
						var production = Math.floor(rwrk*(1+F+B));
						var current = currentResource.getCurrent;
						var consumption = resourceName == Constant.Resources.WINE ? currentResource.getConsumption : 0;
						inc[resourceName] += production;
						tot[resourceName] += current;
						conWine += consumption;
						var rescells = $row.find('td.resource.'+resourceName);
						rescells.find('span.current').addClass(resourceName == Constant.Resources.WOOD || city.getTradeGood == resourceName).get(0).textContent = Utils.FormatNumToStr(current?current:0,false,current?0:2);
						if(resourceName !== Constant.Resources.GOLD)
						{
							rescells.find('span.production').addClass(resourceName == Constant.Resources.WOOD || resourceName == city.getTradeGood ? 'clickable' : '').get(0).textContent = (resourceName == Constant.Resources.WOOD || city.getTradeGood == resourceName ? Utils.FormatNumToStr(production>0?production:0,production>0?true:false,production>0?0:2) : '');
						}
						if(resourceName === Constant.Resources.WINE)
						{
							rescells.find('span.consumption').get(0).textContent = (consumption ? Utils.FormatNumToStr(0 - consumption, true, 0) : '');
							var time = currentResource.getEmptyTime;
							time = time > 1? Math.floor(time) + (60 - new Date().getMinutes())/60 : 0;
							time *= 3600000;
							rescells.find('span.emptytime').removeClass('Red Green').addClass(time > database.settings.wineWarningTime.value * 3600000 ? 'Green' : 'Red').get(0).textContent = database.settings.wineWarningTime.value > 0 ? (Utils.FormatTimeLengthToStr(time, 2)) : '';
							if (time < database.settings.wineWarningTime.value * 3600000 && database.settings.wineWarning.value != 1)
								render.toastAlert('!!! ' + LD.alert_wine + city._name +' !!!');
						}
						if(resourceName === Constant.Resources.GOLD)
						{
							var bonus = (1+(database.getGlobalData.hasPremiumFeature(Constant.Premium.GOLD_BONUS)*Constant.PremiumData[Constant.Premium.GOLD_BONUS].bonus));
							rescells.find('span.current').get(0).textContent = Utils.FormatNumToStr(city.getIncome*bonus+city.getExpenses,!(city.getIncome*bonus+city.getExpenses>=0),0);
							rescells.find('span.production').get(0).textContent = Utils.FormatNumToStr(city.getIncome*bonus,true,0);
							rescells.find('span.consumption').get(0).textContent = city.getExpenses !== 0 ? Utils.FormatNumToStr(city.getExpenses,true,0) : '';
						}
						var fillperc = (current / storage.capacity) * 100;
						rescells.find('div.progressbar').find('div.ui-progressbar-value').width(fillperc + "%").removeClass("normal warning almostfull full").addClass(fillperc > 90 ? fillperc > 96 ? "full" : "almostfull" : fillperc > 70 ? "warning" : "normal");
						var diffGold = Math.floor(city.getIncome+bonus+city.getExpenses);
						var fillpercG = 100 / (city.populationData.maxPop * 3) * diffGold;
						if(resourceName === Constant.Resources.GOLD)
						{
							rescells.find('div.progressbar').find('div.ui-progressbar-value').width(fillpercG + "%").removeClass("normal almostfull full fullGold").addClass(fillpercG > 50 ? fillpercG == 100 ? "fullGold" : "normal" : fillpercG > 25 ? "almostfull" : "full");
						}
						if(storage.safe > current)
						{
							rescells.find('span.safeImage').show();
						}
						else
						{
							rescells.find('span.safeImage').hide();
						}
						if(resourceName === Constant.Resources.GOLD)
						{
							rescells.find('span.safeImage').hide();
						}
					}.bind(render));
//					console.log(income);
					Utils.setClone(this.getResourceRow(city),$row);
					this.cityRows.resource[city.getId] = null;
				}.bind(render));
				var LD = Constant.LanguageData[database.settings.languageChange.value];
				var bonus = (1+(database.getGlobalData.hasPremiumFeature(Constant.Premium.GOLD_BONUS)*Constant.PremiumData[Constant.Premium.GOLD_BONUS].bonus));
				var expense = database.getGlobalData.finance.armyCost + database.getGlobalData.finance.armySupply + database.getGlobalData.finance.fleetCost + database.getGlobalData.finance.fleetSupply - researchCost;
				var sigmaIncome = income*bonus-expense;
//				console.log(income,bonus,expense,sigmaIncome);
				var currentGold = 0;
				currentGold = Utils.FormatNumToStr(database.getGlobalData.finance.currentGold);
				if((database.settings.GoldShort.value == 1) && (database.getGlobalData.finance.currentGold > 10000))
					currentGold = Utils.FormatNumToStr(database.getGlobalData.finance.currentGold/1000) +'k';
				$("#t_currentgold").get(0).textContent = currentGold;
				$("#t_currentwood").get(0).textContent = Utils.FormatNumToStr(Math.round(tot[Constant.Resources.WOOD]), false);
				$("#t_currentwine").get(0).textContent = Utils.FormatNumToStr(Math.round(tot[Constant.Resources.WINE]), false);
				$("#t_currentmarble").get(0).textContent = Utils.FormatNumToStr(Math.round(tot[Constant.Resources.MARBLE]), false);
				$("#t_currentglass").get(0).textContent = Utils.FormatNumToStr(Math.round(tot[Constant.Resources.GLASS]), false);
				$("#t_currentsulfur").get(0).textContent = Utils.FormatNumToStr(Math.round(tot[Constant.Resources.SULFUR]), false);
				$("#t_goldincome").children('span').removeClass('Red Green').addClass(sigmaIncome >= 0 ? 'Green' : 'Red').eq(0).text(Utils.FormatNumToStr(sigmaIncome, true, 0)).siblings('span').eq(0).text(sigmaIncome > 0 ? '\u221E' : Utils.FormatTimeLengthToStr((database.getGlobalData.finance.currentGold / sigmaIncome) * 60 * 60 * 1000, true, 0));
				$("#t_woodincome").find('span').get(0).textContent = Utils.FormatNumToStr(Math.round(inc[Constant.Resources.WOOD]), true);
				$("#t_wineincome").children('span').eq(0).text(Utils.FormatNumToStr(Math.round(inc[Constant.Resources.WINE]), true)).siblings('span').eq(0).text( '-' + Utils.FormatNumToStr(Math.round(conWine), false));
				$("#t_marbleincome").find('span').get(0).textContent = Utils.FormatNumToStr(Math.round(inc[Constant.Resources.MARBLE]), true);
				$("#t_glassincome").find('span').get(0).textContent = Utils.FormatNumToStr(Math.round(inc[Constant.Resources.GLASS]), true);
				$("#t_sulfurincome").find('span').get(0).textContent = Utils.FormatNumToStr(Math.round(inc[Constant.Resources.SULFUR]), true);
				$("#t_population").get(0).textContent = Utils.FormatNumToStr(Math.round(populationTot), false) + '(' + Utils.FormatNumToStr(Math.round(populationMaxTot), false) + ')';
				$("#t_growth").get(0).textContent = Utils.FormatNumToStr(popDiffTot>0?growthTot:0,popDiffTot>0?true:false,2);
				$("#t_researchpoints").get(0).textContent = Utils.FormatNumToStr(researchTot?researchTot:0,researchTot?true:false,2);
				tot = inc = null;
			}
		}
	};
	function getCityNameFromID(originCity, city)
	{
		var ret = '';
		try
		{
			ret = database.cities[parseInt(originCity)].getName;
		} catch(e) { ret = originCity; }
		return ret;
	}
	render.LoadCSS = function()
	{
		GM_addStyle('/* Global board styles */ #js_GlobalMenu_wood, #js_GlobalMenu_wine, #js_GlobalMenu_marble, #js_GlobalMenu_crystal, #js_GlobalMenu_sulfur {font-size:100%; position:absolute; top:-15px; left:40px} span.resourceProduction {font-size:86%;position:absolute;right:5px;top:-3px} #empireBoard .clickable { color: #542c0f; font-weight: 650; }#empireBoard .clickable:hover, #empireBoard .clickbar:hover { cursor: pointer; text-decoration: underline; }#empireBoard span.happy:hover {cursor: pointer;}#empireBoard .Bold, #empireBoard .Red, #empireBoard .Blue, #empireBoard .Green { font-weight: bold; }#empireBoard .Green { color: green !important; }#empireBoard .Red { color: red !important; }#empireBoard .Blue { color: blue !important; }#empireBoard .icon { background-clip: border-box; background-repeat: no-repeat; background-position: center; background-color: transparent; background-size: auto 14px; }#empireBoard .safeImage { background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAcAAAAJCAYAAAD+WDajAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAEFJREFUeNpi/P//PwMIhOrzQhhAsPriZ0YQzYQugcxnQhaE6YABxhA9HhRdyICJAQ/AayzxOtFdzYRuFLIVAAEGANwqFwuukYKqAAAAAElFTkSuQmCC"); background-size: auto auto !important; }#empireBoard .transportImage { background-image: url(skin/actions/transport.jpg); }#empireBoard .tradeImage { background-image: url(skin/actions/trade.jpg); }#empireBoard .plunderImage { background-image: url(skin/actions/plunder.jpg); }#empireBoard .merchantImage { background-image: url(skin/minimized/merchantNavy.png); background-position: 0 -5px; }#empireBoard .woodImage { background-image: url(skin/resources/icon_wood.png) ;}#empireBoard .wineImage { background-image: url(skin/resources/icon_wine.png); }#empireBoard .marbleImage { background-image: url(skin/resources/icon_marble.png); }#empireBoard .sulfurImage { background-image: url(skin/resources/icon_sulfur.png); }#empireBoard .goldImage { background-image: url(skin/resources/icon_gold.png); }#empireBoard .glassImage { background-image: url(skin/resources/icon_glass.png); }#empireBoard .sawMillImage { background-image: url(skin/characters/y100_worker_wood_faceleft.png); }#empireBoard .mineImage { background-image: url(skin/characters/y100_worker_tradegood_faceleft.png); }#empireBoard .researchImage { background-image: url(skin/resources/icon_research_time.png); }#empireBoard .populationImage { background-image: url(skin/resources/icon_population.png); }#empireBoard .goldImage { background-image: url(skin/resources/icon_gold.png); }#empireBoard #empire_Tabs table thead tr th.empireactions div.trapart { background-image:url(skin/layout/icon-kiste.png);background-size:auto 14px;background-repeat:no-repeat;background-position:center center;float:left;}#empireBoard #empire_Tabs table thead tr th.empireactions div.ilios { background-image: url(skin/world/heliostower.png); background-size: auto 40px; background-repeat: no-repeat; background-position: center center; float: left; cursor: pointer;}#empireBoard #empire_Tabs table thead tr th.empireactions div.spot { background-image: url(skin/img/city/flag_red.png); background-size: auto 16px; background-repeat: no-repeat; background-position: center center; float: left;}#empireBoard #empire_Tabs table thead tr th.empireactions .spio { background-image: url("skin/characters/military/120x100/spy_120x100.png"); background-size: auto 25px; background-repeat: no-repeat; background-position: center center; float: left;}#empireBoard #empire_Tabs table thead tr th.empireactions .generalEdit { background-image: url("skin/minimized/militaryAdvisor.png"); background-size: auto 27px; background-repeat: no-repeat; background-position: center +2px; float: left;}#empireBoard #empire_Tabs table thead tr th.empireactions .general { background-image: url("skin/minimized/citymilitary.png"); background-size: auto 30px; background-repeat: no-repeat; background-position: center -1px; float: right;}#empireBoard #empire_Tabs table thead tr th.empireactions .generalee { background-image: url("skin/img/island/noobschutz.png"); background-size: auto 26px; background-repeat: no-repeat; background-position: center -1px; float: left;}#empireBoard #empire_Tabs table thead tr th.empireactions .combat { background-image: url("skin/unitdesc/unit_attack.png"); background-size: 25px 23px; background-repeat: no-repeat; background-position: center center; float: left;}#empireBoard .expensesImage { background-image: url(skin/resources/icon_upkeep.png); }#empireBoard .happyImage { background-image: url(skin/smilies/happy.png); }#empireBoard .actionpointImage { background-image: url(skin/resources/icon_actionpoints.png); }#empireBoard .actionpointImage3 { background-image: url(skin/resources/icon_actionpoints.png); }#empireBoard .spotImage { background-image: url(skin/img/city/flag_red.png);}#empireBoard .wonderImage { background-image: url(skin/achievements/IK_Achievements_wunder_ausloesen.png); background-position: center; background-repeat: no-repeat; background-size: 45px 41px; }#empireBoard .naosImage { background-image: url(skin/achievements/IK_Achievements_Gebaeude_tempel.png); background-position: center; background-repeat: no-repeat; background-size: 44px 39px; }#empireBoard .growthImage { background-image: url(skin/icons/growth_positive.png); }#empireBoard .scientistImage { background-image: url(skin/characters/40h/scientist_r.png); }#empireBoard .activecineIcon { background: url(skin/img/city/Kino_aktiv_no_anim.png) no-repeat center / 25px 25px; }#empireBoard .inactivecineIcon { background: url(skin/img/city/Kino_inaktiv.png) no-repeat center / 25px 25px; }#empireBoard .evnoiaIcon { background: url(skin/img/city/IK_stadt_daily_level5_glow.jpg) no-repeat center / 15px 15px; }#empireBoard .priestIcon { background: url(skin/characters/40h/templer_r.png) no-repeat center / 16px 25px; }#empireBoard .citizenIcon { background-image: url(skin/characters/40h/citizen_r.png); }#empireBoard .cityIcon { background-image: url(skin/icons/city_30x30.png); }#empireBoard .researchIcon { background-image: url(skin/icons/researchbonus_30x30.png); }#empireBoard .tavernIcon { background-image: url(skin/buildings/tavern_30x30.png); }#empireBoard .culturalIcon { background-image: url(skin/interface/icon_message_write.png); }#empireBoard .museumIcon { background-image: url(skin/buildings/museum_30x30.png); }#empireBoard .governmentIcon { background-image: url(skin/government/zepter_20.png); }#empireBoard .incomeIcon { background-image: url(skin/icons/income_positive.png); }#empireBoard .outcomeIcon { background-image: url(skin/icons/income_negative.png); }#empireBoard .crownIcon { background-image: url(skin/layout/crown.png); }#empireBoard .corruptionIcon { background-image: url(skin/icons/corruption_24x24.png); }#empireBoard #empireTip { display: none; position: absolute; top: 0; left: 0; z-index: 99999999; }#empireBoard #empireTip .icon { background-clip: border-box; background-repeat: no-repeat; background-position: 0; background-color: transparent; background-attachment: scroll; background-size: 16px auto; height: 17px; min-width: 34px; width: 34px; }#empireBoard #empireTip .icon2 { background-clip: border-box; background-repeat: no-repeat; background-position: 0; background-color: transparent; background-attachment: scroll; background-size: 24px auto; height: 17px; min-width: 24px; width: 24px; }#empireBoard #empireTip .content, .tooltip-div, .info-div { background-color: #fae0ae; border: 1px solid #e4b873; position: relative; overflow: hidden; text-align: left; word-wrap: break-word; }#empireBoard #empireTip .content table, .tooltip-div table, .info-div table { width: 100%; }#empireBoard #empireTip .content table tr.data, .tooltip-div table tr.data, .info-div table tr.data { background-color: 	#FFFAF0; }#empireBoard #empireTip .content table tr.total, .tooltip-div table tr.total, .info-div table tr.total { background: #E7C680 url(skin/input/button.png) repeat-x scroll 0 0; }#empireBoard #empireTip .content table td, .tooltip-div table td, .info-div table td { padding: 2px; height: auto !important; text-align: right; }#empireBoard #empireTip .content table th, .tooltip-div table th, .info-div table th { padding: 2px; height: auto !important; text-align: right; font-weight: bold; background: #F8E7B3 url(skin/input/button.png) repeat-x scroll 0 bottom;}#empireBoard #empireTip .content table tbody td, .tooltip-div table tbody td, .info-div table tbody td { background-color: #fdfdfd;}#empireBoard #empireTip .content table tbody td:last-child, .tooltip-div table tbody td:last-child, .info-div table tbody td:last-child { text-align: left; white-space: nowrap; font-style: italic; }#empireBoard #empireTip .content table tfoot, .tooltip-div table tfoot, .info-div table tfoot { line-height: 15px !important; border-top: 3px solid #fdf7dd; }#empireBoard #empireTip .content table tfoot td:last-child, .tooltip-div table tfoot td:last-child, .info-div table tfoot td:last-child { text-align: left; white-space: nowrap; font-style: italic; }#empireBoard #empireTip .content table thead, .tooltip-div table thead { background: #F8E7B3 url(skin/input/button.png) repeat-x scroll 0 bottom;}#empireBoard #empireTip .content table thead th.lf, .tooltip-div table thead th.lf, .info-div table thead th.lf { border-left: 2px solid #e4b873; }#empireBoard #empireTip .content table tbody td.lf, .tooltip-div table tbody td.lf, .info-div table tbody td.lf { border-left: 2px solid #e4b873; }#empireBoard #empireTip .content table th.nolf, .tooltip-div table th.nolf, .info-div table th.nolf, #empireBoard #empireTip .content table td.nolf, .tooltip-div table td.nolf, .info-div table td.nolf { border-left: none; }#empireBoard #empireTip .content th.lfdash, .tooltip-div th.lfdash, .info-div th.lfdash, #empireBoard #empireTip .content td.lfdash, .tooltip-div td.lfdash, .info-div td.lfdash { border-left: 1px dashed #e4b873; }#empireBoard #empireTip .content table tr.small td, .tooltip-div table tr.small td, .info-div table tr.small td { height: auto !important; padding-top: 1px; font-size: 10px !important; line-height: 15px !important; }#empireBoard #empire_Tabs table { width: 100% !important; text-align: center; border: 1.1px solid #fff1e5; }#empireBoard #empire_Tabs table colgroup { border-left: 1.4px solid #e4b873; }#empireBoard #empire_Tabs table colgroup:first-child { border: none !important; }#empireBoard #empire_Tabs table colgroup col { border-left: 1px dashed #e4b873; }#empireBoard #empire_Tabs table thead { background: #f8e7b3 url(skin/input/button.png) repeat-x scroll 0 bottom; }#empireBoard #empire_Tabs table thead tr { height: 30px; }#empireBoard #empire_Tabs table thead tr th { text-align: center; font-weight: bold; overflow: hidden; white-space: nowrap; }#empireBoard #ArmyTab table thead tr th.empireactions { min-width: 77px; width: 77px; height: 29px;}#empireBoard #empire_Tabs table thead tr th.icon { min-width: 29px; background-size: auto 18px; }#empireBoard #empire_Tabs table tbody tr { border-top: 1.1px solid #e4b873;}#empireBoard #empire_Tabs table tbody tr:nth-child(even) { background-color: #FDF1D4; }#empireBoard #empire_Tabs table tbody tr.selected { background-color: #f7d6ac; box-shadow: 0 0 1em #CB9B6A inset; }#empireBoard #empire_Tabs table tbody tr:hover { background-color: #fff; box-shadow: 0 0 1em #CB9B6A; }#empireBoard #empire_Tabs table tbody tr td.city_name { min-width: 140px; max-width: 165px; padding-left: 0px; text-align: left; padding-right: 0px; }#empireBoard #empire_Tabs table tbody tr td.city_name span.icon { background-repeat: no-repeat; float: left; width: 20px; background-size: 15px auto; margin: 0 2px 0 -1px; height: 16px; cursor: move; } #empireBoard #empire_Tabs table tbody tr td.action_points { text-align: center;} #empireBoard #empire_Tabs table tbody tr td.spy_points { text-align: center;} #empireBoard #empire_Tabs table tbody tr td.population { text-align: center;}#empireBoard #empire_Tabs table tbody tr td.sawmill { border-left: 1.5px solid #e4b873; } #empireBoard #empire_Tabs table tbody tr td.sawmillprog { text-align: center;} #empireBoard #empire_Tabs table tbody tr td.mineprog { text-align: center;} #empireBoard #empire_Tabs table tbody tr td.empireactions div { background-clip: border-box; background: transparent repeat scroll 0 0; background-size: 25px auto; height: 16px; min-width: 25px; width: 25px;} #empireBoard #empire_Tabs table tbody tr td.wonder div { background-clip: border-box; background: transparent repeat scroll 0 0; background-size: auto 40px; height: 36px; min-width: 30px; width: 30px; }	#empireBoard #empire_Tabs table tbody tr td.temple div { background-clip: border-box; background: transparent repeat scroll 0 0; background-size: auto 40px; height: 36px; min-width: 30px; width: 30px; } #empireBoard #empire_Tabs table thead tr th.empireactions div { background-clip: border-box; background: transparent repeat scroll 0 0; background-size: 25px auto; height: 25px; min-width: 25px; width: 25px; }#empireBoard #empire_Tabs table tbody tr td.empireactions div.eroute { background-image: url("skin/interface/mission_trade.png"); height: 16px; float: left;}#empireBoard #empire_Tabs table tbody tr td.empireactions div.varvaroi { background-image: url("skin/actions/frieden_schliessen_button_sprite.jpg"); height: 16px; float: left;}#empireBoard #empire_Tabs table tbody tr td.empireactions div.spypointImage { background-image: url(skin/layout/icon-status-small.png); height: 18px; float: left;}#empireBoard #empire_Tabs table tbody tr td.empireactions div.transport { background-image: url("skin/actions/transport.jpg"); background-position: 0 -17px; float: left;}#empireBoard #empire_Tabs table tbody tr td.empireactions div.worldmap { background-image: url("skin/layout/icon-world.png"); background-size: 18px 18px; background-repeat: no-repeat; background-position: center center; float: left;}#empireBoard #empire_Tabs table tbody tr td.empireactions div.island { background-image: url("skin/layout/icon-island.png"); background-size: 23px 20px; background-repeat: no-repeat; background-position: center center; float: left;}#empireBoard #empire_Tabs table tbody tr td.empireactions div.islandwood { background-image: url("skin/resources/icon_wood.png"); background-size: 17px auto; background-repeat: no-repeat; background-position: center center; float: left;}#empireBoard #empire_Tabs table tbody tr td.empireactions div.islandgood { float: left;}#empireBoard #empire_Tabs table tbody tr td.empireactions div.city { background-image: url("skin/img/city/townhall_l.png"); background-size: auto 23px; background-repeat: no-repeat; background-position: center center; float: right;}#empireBoard #empire_Tabs table thead tr th.empireactions div.member { background-image: url("skin/friends/player_icon_blue_20.png"); background-size: auto 22px; background-repeat: no-repeat; background-position: center center; float: left;}#empireBoard #empire_Tabs table thead tr th.empireactions div.agora { background-image: url("skin/img/island/agora.png"); background-size: 34px 26px; background-repeat: no-repeat; background-position: center center; float: right;}#empireBoard #empire_Tabs table thead tr th.empireactions div.trading2 { background-image: url("skin/achievements/IK_Achievements_Forschungen_abgeschlossen.png"); background-position: center; background-repeat: no-repeat; background-size: 35px 30px; float: left;}#empireBoard #empire_Tabs table thead tr th.empireactions div.trading { background-image: url("skin/characters/fleet/40x40/ship_transport_r_40x40.png"); background-size: 23px 21px; background-repeat: no-repeat; background-position: center center; float: left;}#empireBoard #empire_Tabs table thead tr th.empireactions div.contracts { background-image: url("skin/museum/icon32_culturalgood.png"); background-size: auto 22px; background-repeat: no-repeat; background-position: center center; float:right;margin-right:0px;}#empireBoard #empire_Tabs table tbody tr td.empireactions div.garrisonEdita{ background-image: url("skin/minimized/garrisonEdit.png"); background-size: 25px 17px; background-position: center center; float: left; background-repeat: no-repeat;}#empireBoard #empire_Tabs table tbody tr td.empireactions div.garrisonEditb { background-image: url("skin/pirateFortress/2012-11-09_IK_Kaperfahrt_Diplomatenschiff_inaktiv.png"); background-size: 21px 13px; background-position: center center; background-repeat: no-repeat;}#empireBoard #empire_Tabs table tbody tr td.empireactions div.barracks { background-image: url("skin/buildings/y50/y50_barracks.png"); background-size: 27px 16px; background-position: center center; float: left; background-repeat: no-repeat;}#empireBoard #empire_Tabs table tbody tr td.empireactions div.shipyard { background-image: url("skin/buildings/y50/y50_shipyard.png"); background-size: 26px 15px; background-position: center center; background-repeat: no-repeat;}#empireBoard #empire_Tabs table tbody tr td.empireactions div.deploymentarmy { background-image: url("skin/actions/move_army.jpg"); height: 16px; background-position: 0 -17px; float: left;}#empireBoard #empire_Tabs table tbody tr td.empireactions div.deploymentfleet { background-image: url("skin/actions/move_fleet.jpg"); height: 16px; background-position: 0 -17px;}#empireBoard #empire_WorldmapTab table tbody tr td.worldmap div.worldmap{ width:829px; height:829px; background-image: url("skin/actions/move_fleet.jpg"); float: left; }#empireBoard #empire_Tabs table tbody tr:not(.selected) td.empireactions div.transport:hover { background-position: 0 -17px;cursor:pointer }#empireBoard #empire_Tabs table tbody tr td.empireactions div.deploymentfleet:hover { background-position: 0 -17px; }#empireBoard #empire_Tabs table tbody tr td.empireactions div.deploymentarmy:hover { background-position: 0 -17px; }#empireBoard #empire_Tabs table tbody tr.selected .empireactions div.transport, #empireBoard #empire_Tabs table tbody tr.selected .empireactions div.deploymentarmy, #empireBoard #empire_Tabs table tbody tr.selected .empireactions div.deploymentfleet{ background-position: 0 17px; }#empireBoard #empire_Tabs table tbody tr.current .empireactions div.transport { background-position: 0 px;cursor:default }#empireBoard #empire_Tabs table tfoot { background: #fae0ae; background: #e7c680 url(skin/input/button.png) repeat-x scroll 0 0; border-top: 2px solid #e4b873; }#empireBoard #empire_Tabs table tfoot tr td { text-align: center; font-weight: bold;}#empireBoard #empire_Tabs table tfoot tr #t_researchpoints.total { text-align: center; }#empireBoard #empire_Tabs table tfoot tr #t_growth.total { text-align: center; }#empireBoard #empire_Tabs table tfoot tr td.total span { line-height: 1em; height: 1em; font-size: 0.8em; display: block; }#empireBoard #empire_Tabs table tfoot tr td#t_sigma, #empireBoard #empire_Tabs table tfoot tr td.sigma { font-weight: 800; text-align: center; }#empireBoard #ResTab div.progressbar .normal { background: #73443E; }#empireBoard #ResTab div.progressbar .warning { background: #8F1D1A; }#empireBoard #ResTab div.progressbar .almostfull { background: #B42521; }#empireBoard #ResTab div.progressbar .full { background: #ff0000; }#empireBoard #ResTab div.progressbar .fullGold { background: #185A39; }#empireBoard #ResTab div.progressbarPop .normal { background: #73443E; }#empireBoard #ResTab div.progressbarPop .warning { background: #CC3300; }#empireBoard #ResTab div.progressbarPop .full { background: #185A39; }#empireBoard #ResTab div.progressbarSci .normal { background: #73443E; }#empireBoard #ResTab div.progressbarSci .full { background: #185A39; }#empireBoard #ResTab table tr td.gold_income, #empireBoard #ResTab table tr td.resource, #empireBoard #ResTab table tr td.army:nth-child(even) { text-align: center; }#empireBoard #ResTab table tr td.gold_income span.incoming, #empireBoard #ResTab table tr td.resource span.incoming { color: blue; }#empireBoard #ResTab table tr td.gold_unkeep span, #empireBoard #ResTab table tr td.resource span, #empireBoard #ResTab table tr td.army:nth-child(even) span { line-height: 1em; height: 1em; font-size: 0.8em; display: block; }#empireBoard #ResTab table tr td.gold_income span.icon, #empireBoard #ResTab table tr td.resource span.icon, #empireBoard #ResTab table tr td.army:nth-child(even) span.icon { background-repeat: no-repeat; float: left; width: 25px; height: 9px; padding: 5px 4px 0 0; }#empireBoard #ResTab table tr td.gold_income span.current, #empireBoard #ResTab table tr td.resource span.current, #empireBoard #ResTab table tr td.army:nth-child(even) span.current { font-size: 1em; display: inline; }#empireBoard #ResTab table tr td.population { text-align: center; }#empireBoard #ResTab table tr td.gold_income span:nth-child(2), #empireBoard #ResTab table tr td.population span:nth-child(2) { line-height: 1em; height: 1em; font-size: 0.8em; display: block; }#empireBoard #BuildTab table tbody tr td { background-clip: border-box; background-repeat: no-repeat; background-position: center; background-color: transparent; background-size: auto 20px; }#empireBoard #BuildTab table tbody tr td span.maxLevel { color: rgba(0, 0, 0, 0.29); }#empireBoard #BuildTab table tbody tr td span.upgradableSoon { color: #4169e1; font-style: italic; }#empireBoard #BuildTab table tbody tr td span.upgradableSoon:after { content: "+"; }#empireBoard #BuildTab table tbody tr td span.upgradable { color: green; font-style: italic; }#empireBoard #BuildTab table tbody tr td span.upgradable:after { content: "+"; }#empireBoard #BuildTab table tbody tr td span.upgrading { background: url("/skin/icons/arrow_upgrade.png") no-repeat scroll 1px 1px transparent; border-radius: 4px 4px 4px 4px; box-shadow: 0 0 3px rgba(0, 0, 0, 0.8); display: inline-block; padding: 1px 1px 1px 15px; margin: 2px; }#empireBoard #ArmyTab table colgroup col:nth-child(even) { border-left: none; }#empireBoard #SettingsTab .options, #empireBoard #HelpTab .options { float: left; padding: 10px; }#empireBoard #SettingsTab .options span.categories, #empireBoard #HelpTab .options span.categories { margin-left: -3px; font-weight: 500; }#empireBoard #SettingsTab .options span.categories:not(:first-child), #empireBoard #HelpTab .options span.categories:not(:first-child) { margin-top: 5px; }#empireBoard #SettingsTab .options span:not(.clickable), #empireBoard #HelpTab .options span:not(.clickable) { display: block; }#empireBoard #SettingsTab .options span label, #empireBoard #HelpTab .options span label { vertical-align: top; padding-left: 5px; }#empireBoard #SettingsTab .buttons, #empireBoard #HelpTab .buttons { clear: left; padding: 3px; }#empireBoard #SettingsTab .buttons button, #empireBoard #HelpTab .buttons button { margin-left: 3px; }.toast, .toastAlert { display: none; position: fixed; z-index: 99999; width: 100%; text-align: center; top: 11em; }.toast .message, .toastAlert .message { display: inline-block; color: #4C3000; padding: 5px; border-radius: 5px; box-shadow: 3px 0px 15px 0 #542C0F; -webkit-box-shadow: 3px 0px 15px 0 #542C0F; font-family: Arial, Helvetica, sans-serif; font-size: 11px; background: #faf3d7; background-image: -webkit-gradient(linear, left top, left bottom, color-stop(0, #faf3d7), color-stop(1, #e1b06d)); }div.prog:after { -webkit-animation: move 2s linear infinite; -moz-animation: move 2s linear infinite; }.prog { display: block; width: 100%; height: 100%; background: #fcf938 -moz-linear-gradient(center bottom, #fcf938 37%, #fcf938 69%); position: relative; overflow: hidden; }.prog:after { content: ""; position: absolute; top: 0; left: 0; bottom: 0; right: 0; background: -moz-linear-gradient(-45deg, rgba(10, 10, 10, 0.6) 25%, transparent 25%, transparent 50%, rgba(10, 10, 10, 0.6) 50%, rgba(10, 10, 10, 0.6) 75%, transparent 75%, transparent); z-index: 1; -webkit-background-size: 50px 50px; -moz-background-size: 50px 50px; background-size: 50px 50px; -webkit-animation: move 5s linear infinite; -moz-animation: move 5s linear infinite; overflow: hidden; }.animate > .prog:after { display: none; }@-webkit-keyframes move { 0% { background-position: 0 0; } 100% { background-position: 50px 50px; } }@-moz-keyframes move { 0% { background-position: 0 0; } 100% { background-position: 50px 50px; } }[id^="registrationGiftDay"]{display:none}.speedup:hover{background-position:0px -14px !important}.speedup:active{background-position:0px -28px !important}#city #cityRegistrationGifts {z-index:310;}.empiretooltip {position:static} .empiretooltip div.tooltip-div {display:none !important}.empiretooltip:hover div.tooltip-div {position:fixed !important;z-index:2147483647;display:block !important;white-space:nowrap;}.pirateHighscoreNextCalc .indicator {cursor: pointer;display:inline-block;width:18px;height:16px;background:url(skin/interface/window_control_sprite.png) no-repeat scroll transparent;position:relative;background-position:-72px -1px}.pirateHighscoreNextCalc .indicator:hover {background-position:-72px -20px}.pirateHighscoreNextCalc.active .indicator {background-position:-54px -1px}.pirateHighscoreNextCalc.active .indicator:hover {background-position:-54px -20px}#city #cityRegistrationGifts {z-index:310;}');
		if(database.settings.compressedBuildingList.value) GM_addStyle('#empireBoard #BuildTab table tbody tr td.building.forester0:not(:empty) {background-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABkAAAAUCAMAAABPqWaPAAAKN2lDQ1BzUkdCIElFQzYxOTY2LTIuMQAAeJydlndUU9kWh8+9N71QkhCKlNBraFICSA29SJEuKjEJEErAkAAiNkRUcERRkaYIMijggKNDkbEiioUBUbHrBBlE1HFwFBuWSWStGd+8ee/Nm98f935rn73P3Wfvfda6AJD8gwXCTFgJgAyhWBTh58WIjYtnYAcBDPAAA2wA4HCzs0IW+EYCmQJ82IxsmRP4F726DiD5+yrTP4zBAP+flLlZIjEAUJiM5/L42VwZF8k4PVecJbdPyZi2NE3OMErOIlmCMlaTc/IsW3z2mWUPOfMyhDwZy3PO4mXw5Nwn4405Er6MkWAZF+cI+LkyviZjg3RJhkDGb+SxGXxONgAoktwu5nNTZGwtY5IoMoIt43kA4EjJX/DSL1jMzxPLD8XOzFouEiSniBkmXFOGjZMTi+HPz03ni8XMMA43jSPiMdiZGVkc4XIAZs/8WRR5bRmyIjvYODk4MG0tbb4o1H9d/JuS93aWXoR/7hlEH/jD9ld+mQ0AsKZltdn6h21pFQBd6wFQu/2HzWAvAIqyvnUOfXEeunxeUsTiLGcrq9zcXEsBn2spL+jv+p8Of0NffM9Svt3v5WF485M4knQxQ143bmZ6pkTEyM7icPkM5p+H+B8H/nUeFhH8JL6IL5RFRMumTCBMlrVbyBOIBZlChkD4n5r4D8P+pNm5lona+BHQllgCpSEaQH4eACgqESAJe2Qr0O99C8ZHA/nNi9GZmJ37z4L+fVe4TP7IFiR/jmNHRDK4ElHO7Jr8WgI0IABFQAPqQBvoAxPABLbAEbgAD+ADAkEoiARxYDHgghSQAUQgFxSAtaAYlIKtYCeoBnWgETSDNnAYdIFj4DQ4By6By2AE3AFSMA6egCnwCsxAEISFyBAVUod0IEPIHLKFWJAb5AMFQxFQHJQIJUNCSAIVQOugUqgcqobqoWboW+godBq6AA1Dt6BRaBL6FXoHIzAJpsFasBFsBbNgTzgIjoQXwcnwMjgfLoK3wJVwA3wQ7oRPw5fgEVgKP4GnEYAQETqiizARFsJGQpF4JAkRIauQEqQCaUDakB6kH7mKSJGnyFsUBkVFMVBMlAvKHxWF4qKWoVahNqOqUQdQnag+1FXUKGoK9RFNRmuizdHO6AB0LDoZnYsuRlegm9Ad6LPoEfQ4+hUGg6FjjDGOGH9MHCYVswKzGbMb0445hRnGjGGmsVisOtYc64oNxXKwYmwxtgp7EHsSewU7jn2DI+J0cLY4X1w8TogrxFXgWnAncFdwE7gZvBLeEO+MD8Xz8MvxZfhGfA9+CD+OnyEoE4wJroRIQiphLaGS0EY4S7hLeEEkEvWITsRwooC4hlhJPEQ8TxwlviVRSGYkNimBJCFtIe0nnSLdIr0gk8lGZA9yPFlM3kJuJp8h3ye/UaAqWCoEKPAUVivUKHQqXFF4pohXNFT0VFysmK9YoXhEcUjxqRJeyUiJrcRRWqVUo3RU6YbStDJV2UY5VDlDebNyi/IF5UcULMWI4kPhUYoo+yhnKGNUhKpPZVO51HXURupZ6jgNQzOmBdBSaaW0b2iDtCkVioqdSrRKnkqNynEVKR2hG9ED6On0Mvph+nX6O1UtVU9Vvuom1TbVK6qv1eaoeajx1UrU2tVG1N6pM9R91NPUt6l3qd/TQGmYaYRr5Grs0Tir8XQObY7LHO6ckjmH59zWhDXNNCM0V2ju0xzQnNbS1vLTytKq0jqj9VSbru2hnaq9Q/uE9qQOVcdNR6CzQ+ekzmOGCsOTkc6oZPQxpnQ1df11Jbr1uoO6M3rGelF6hXrtevf0Cfos/ST9Hfq9+lMGOgYhBgUGrQa3DfGGLMMUw12G/YavjYyNYow2GHUZPTJWMw4wzjduNb5rQjZxN1lm0mByzRRjyjJNM91tetkMNrM3SzGrMRsyh80dzAXmu82HLdAWThZCiwaLG0wS05OZw2xljlrSLYMtCy27LJ9ZGVjFW22z6rf6aG1vnW7daH3HhmITaFNo02Pzq62ZLde2xvbaXPJc37mr53bPfW5nbse322N3055qH2K/wb7X/oODo4PIoc1h0tHAMdGx1vEGi8YKY21mnXdCO3k5rXY65vTW2cFZ7HzY+RcXpkuaS4vLo3nG8/jzGueNueq5clzrXaVuDLdEt71uUnddd457g/sDD30PnkeTx4SnqWeq50HPZ17WXiKvDq/XbGf2SvYpb8Tbz7vEe9CH4hPlU+1z31fPN9m31XfKz95vhd8pf7R/kP82/xsBWgHcgOaAqUDHwJWBfUGkoAVB1UEPgs2CRcE9IXBIYMj2kLvzDecL53eFgtCA0O2h98KMw5aFfR+OCQ8Lrwl/GGETURDRv4C6YMmClgWvIr0iyyLvRJlESaJ6oxWjE6Kbo1/HeMeUx0hjrWJXxl6K04gTxHXHY+Oj45vipxf6LNy5cDzBPqE44foi40V5iy4s1licvvj4EsUlnCVHEtGJMYktie85oZwGzvTSgKW1S6e4bO4u7hOeB28Hb5Lvyi/nTyS5JpUnPUp2Td6ePJninlKR8lTAFlQLnqf6p9alvk4LTduf9ik9Jr09A5eRmHFUSBGmCfsytTPzMoezzLOKs6TLnJftXDYlChI1ZUPZi7K7xTTZz9SAxESyXjKa45ZTk/MmNzr3SJ5ynjBvYLnZ8k3LJ/J9879egVrBXdFboFuwtmB0pefK+lXQqqWrelfrry5aPb7Gb82BtYS1aWt/KLQuLC98uS5mXU+RVtGaorH1futbixWKRcU3NrhsqNuI2ijYOLhp7qaqTR9LeCUXS61LK0rfb+ZuvviVzVeVX33akrRlsMyhbM9WzFbh1uvb3LcdKFcuzy8f2x6yvXMHY0fJjpc7l+y8UGFXUbeLsEuyS1oZXNldZVC1tep9dUr1SI1XTXutZu2m2te7ebuv7PHY01anVVda926vYO/Ner/6zgajhop9mH05+x42Rjf2f836urlJo6m06cN+4X7pgYgDfc2Ozc0tmi1lrXCrpHXyYMLBy994f9Pdxmyrb6e3lx4ChySHHn+b+O31w0GHe4+wjrR9Z/hdbQe1o6QT6lzeOdWV0iXtjusePhp4tLfHpafje8vv9x/TPVZzXOV42QnCiaITn07mn5w+lXXq6enk02O9S3rvnIk9c60vvG/wbNDZ8+d8z53p9+w/ed71/LELzheOXmRd7LrkcKlzwH6g4wf7HzoGHQY7hxyHui87Xe4Znjd84or7ldNXva+euxZw7dLI/JHh61HXb95IuCG9ybv56Fb6ree3c27P3FlzF3235J7SvYr7mvcbfjT9sV3qID0+6j068GDBgztj3LEnP2X/9H686CH5YcWEzkTzI9tHxyZ9Jy8/Xvh4/EnWk5mnxT8r/1z7zOTZd794/DIwFTs1/lz0/NOvm1+ov9j/0u5l73TY9P1XGa9mXpe8UX9z4C3rbf+7mHcTM7nvse8rP5h+6PkY9PHup4xPn34D94Tz+49wZioAAABjUExURf////fetffelO/Wre/WjN7OpebOhN7OhN7Oe97Fe9a9hNa9c9athM61a8WtjNacWsWca86UWrWUa72UUs6MSrWEUq17UqV7Wox7a5xzUoxrUnNra3NrWntjUmNaUlJKSgAAAIa/w40AAAAhdFJOU///////////////////////////////////////////AJ/B0CEAAAAJcEhZcwAACxIAAAsSAdLdfvwAAAEsSURBVHicXZDNjtswDISHP4ost8Ve9lYYu+//VoGxtwDtJfU6EsnSCdCmJQTw8IkzQ+o7jjozNbn6gr+lj8YRe53t/PY/WSPQZWJ9QneyyiB2QCrW5R8SXnd2Dyo6Pr4/E348IR2lXF6fiJjCWFWCHHLZlj9EbTC7SP6IEVO5K97JrTAckwyAeId+O3IkOYNnmDT6vBWizOf65ZhZ0QQ4KfvPK9eJnDTk4UMGGin2a0MqtW7KdCe5fTib37bWRcYoCGPODMqZGX4ij714wE41Ri8vl01RXPhYlHyvluvAp921saabAS7axXpRMerz1zh8alft2ctgdStpk5PSlfU6HTeeWXse24uapMaIDL+sldrMoJcf4NZIc4/Usq5YPhoGG3H9hOynkkmTbP4beIqL5HGYwHAAAAAASUVORK5CYII=);text-shadow: -1px -1px 0 #FDF1D4, 1px -1px 0 #FDF1D4, -1px 1px 0 #FDF1D4, 1px 1px 0 #FDF1D4; background-size: 21px 18px}#empireBoard #BuildTab table tbody tr td.building.winegrower0:not(:empty) {background-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABkAAAAUCAYAAAB4d5a9AAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAAASAAAAEgARslrPgAABQRJREFUOMuV1MuOHFcBxvH/OXWqurqqu6vdM56LZ3wZC5w4G8OCBSAQCCkSEjs2bBBSFlGMxIKd90hIvACWeAUktjwCQjFJhBNMhtie8fSkZ3r6Xvc6dc5hwYaFjcj3AP/f7lO8YcX8BZ7qPFxMP//9p+MPeTb7J23jcyMZcf/GPRbFnLTc8M2b32V3/8EvTVs97m4dvbal3oQ4Y0E6yqJgPJ+xTgvAMtMNx7mmcRW+ryhNhjY1ranelHo9orMrVJiE6fLkrXU9Z1VO0brGU4Lalqz0DOEbnIpZBjOGXkrj8q+GGF2CtT/J8vEHJ/VTTKdE1gLnBNZYdFPTESFeENDQoJ1Gu+arIQAOZz3p235vSCeaUBYtrXaUmcE5h0g0XQFN5jAJtJr/H6mzKSAinIkDf+c0zPbfDuRzgm6FaR1VZslmDnEA/X5Ar7NF38Tf34v2F222+rNzduP3R/8bsbpEeP6Pi+X4D+cnZ+EXH51xpS11CBZBMQe77lBHIVVkSasLzk7/9rNef/jT/tbtx73B4W+yzXTWG+y8HtHVHNXph+V8/L3F+UX49Mkzzk5mrCtBGA8JE0FgHG3XIFSJ2mk4LRd8/I9P2D3o+/f51q9uCRcn/VuP/htSALZZAiK2unq3Xpz/oLw4f3/xfMrkyyV5VXM9HvLO3j7KF1hhSW3Gy3RMXhSEMZioJfVrxuavgjnvHToYJbceZel01uvvoNpq0W/q8kdllv8wnZ+/v766CrPTBek8w5eSuNNh1OshBMSqg5CS5TKnsgIuQOxCnChMBWmz5ovqL8K04j3hBMng8FG6uZypJlv9bjOb/OL5i9Po2dPPOT27gFbwnaO7PDg4YFmWSCkpm5rxZkleN8yKDYO3fAZJRKsrZGCoU0e2dqhww8v6Q6E8+Z7viYvR8P5vVXH16uHl30/47NNjpqsNurZEgU/aVCRxxG6SsCoK5nXDvyaXTLOMOFHc3tlChYa8AuEE0RZIKTCNI+/MuXRPxG69++uoGh4rXaaIquXta9e5k4xY1TWx73OZbfjo7BWDTkimNfM0RbcGTwqGOz7Jnseq0hhjUYCnBEKAaaCtHZldMTHHUccd7KvWWPKmBiEY9npsDQbgHKuy4HhxSVZVaGsZdEMOt0cYYQj2S9pgTZs34AALtgYZgghA55AWFavehEqsUFmRc3w55eJqxXaSsNfr4Xsem7phWZZsioLtfp+v7e1xmAzRXsM8uSTfrDDWISRY45BW4EmwgBeAtQ6DxmJQSsO1KOKlvuLldEpRlgSeR9223EgSpIDr/T5HW1sMOiHnm5qrVxXCaKItiW4N64VjuC/oh5JaO6x1oAVSd5BOobJXOZFQxN0O803KYZIw6vWojUGbluPZlHVecjKf0REeZ4slxD637t4gcHA5zsgmGVHcIg8EnudopcOrQ5LikG4zQk1WCybrDUXdUOmWQmv2g4BICBZ5ThxGSF8hQ8WqLImSLl8/usm9u4coKZisJnySPcepKZ7X0lUS3Vh8EXBNbhOLHurmN45IP3vOnue4di1Gh4JxmaK0wzhLMuryzt277OxsIX0fKSRR3C97w93HUgj6vd2Hnduj7lg8xbhzrKyRQhJ4IUr6CCFQRw++TRh1qPP1fw4SwXxZMXkxI4ljbt4bsXPrwA227/wxCKMngOfgS+EFf0IIBt3ux3eS7Z+7sXl3nBeY3hQhwPdCpJDg4N+FYbSjpEdluAAAAABJRU5ErkJggg==);text-shadow: -1px -1px 0 #FDF1D4, 1px -1px 0 #FDF1D4, -1px 1px 0 #FDF1D4, 1px 1px 0 #FDF1D4; background-size: 20px 20px}#empireBoard #BuildTab table tbody tr td.building.stonemason0:not(:empty) {background-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABkAAAAUCAMAAABPqWaPAAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAAAGBQTFRFAAAA8d/I6N/WzcS26NG27Nq68ezjv7Gotq2fyLqk1s3EqJqRraSWsaSW2sit0c2/pJaIrZ+Rn5GDqJqN49bE39rR7Ojaloh639bIxLqtsZ+R+vXxsaia39HEjX9xsaSaTMajHAAAAAF0Uk5TAEDm2GYAAAAJcEhZcwAAAEgAAABIAEbJaz4AAADqSURBVChTpdDRboMwDAVQcBoTEqgDrkMAk/7/XzZM2tpufdt99NGVZTfNf9OCudhPYBE6138g69GHYeyvf4AAKYYhTL/Mkgf0M08hcnijmxFJZolVIvevlUwisHKc47u0IpT9Skhb7cSntAAnGNxFtdpTEmTyhiTtnlXHsb+8islIaTfzKcrXH/EkCCbt3aLOOVX9llSPSfkA1BLU6aTuHNsWs5cE4gXwXnjbmL86FjA7t66GThnKzMxx2yrcAKXuHIPr/ClLpfqgxh6ShOKkyjG6nO6lLHwe2xz1J55inIYwL+EALqXMNcsD5M0SNKvkKqsAAAAASUVORK5CYII=);text-shadow: -1px -1px 0 #FDF1D4, 1px -1px 0 #FDF1D4, -1px 1px 0 #FDF1D4, 1px 1px 0 #FDF1D4; background-size: 21px 20px}#empireBoard #BuildTab table tbody tr td.building.glassblowing0:not(:empty) {background-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABkAAAAUCAYAAAB4d5a9AAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAAASAAAAEgARslrPgAABJxJREFUOBG9wcuKZGcBwPH/dz3n1DlVXdXVPe3ETHomMQaSjYLEUYgv4CZP4VpGwQjZZOvChxDyFBJcBATNQjfiIgbNMEmc7uq6nfv5bjJCgwxMsvP3g/8DwTdw3RYQ8zg1b4cQTKMqTIrkTE4Z+2egttUdvo7ma4Rui9Sm7Jvtz7tm9+s2SH1QkozAWg1jWc7fTYmP+AaaF/DtBill2da7R9vD7v0ntbNHc8EkC3IZiJnUImXvrBYnH3ddPc1mc15E8wLj2CGFfLg97N77y5Wz2zTHFBmZkURheDJpoTr/y0Ttk+8/6XZPfGbzTxIcdXnG/9KuvTlxU/+DPkg7qgxFYiGGKa+qP17dHO0XjTePW4nMFGVISJmAQKsE/x5U2Q37D1y7Cy/Nzbhart+NKX3Ec7Sfuneaev/h08kUo52jCTgx+NLzGyPiaYjJxCiwUqGVJCZwISGFZDvBv652srm5kt9/sNb5ib4/jAPP04Pz+VXrsn8MpRG5RYrERmhzMbXvr0SDjgNSFCgh0BLGEEhSEBP0XcfjL27wfct07zTFRJsQPE8HNXurS40dMcgoUVJQY5icVrUuaBNEEiklIhGXIkSQDrabaw6HIzPpyYUXWRrfPFuflq69aU255paMQp4GlMiNpLAKKUAIGDHsYklnzojSMsXI6CISiUqCpm7Yba4JbsLmOcJkwo3tr/p2/0gIWU7NNbfkFCWNlygSF5Uh15KU+K+QQNkCYwuUtrgUiSnhXGCz3dLUNcUs5/LBJdXFA3pV2rE7vueG+mGYOm7JTPjrLA3ppm5IMbDMNTEmfIj4GBl8ososhVaYFOndwM1+R725QmnNnW/f4+TsLk6XRDsnRm9SnGwKjlvSCv+301x2wnV8frVDi0hhBD4mXEgMPoFULHPNMtcI5/BDQzXLeOXykrOLu3zZeD7bdAwBktQkNFFobslqNv/9+uTkt/fnKe0Oe77at5RWIgU4nxh9oO5HpFLkNsM7h02OV1/5Fm+9dsnd1YIgYNP1NF7Sy4UOMvtxWVala655Ro79oVnl+g+vLnV7nk082R459hMzq4gkfIhMIbDvHTElTnLNd++/zJuv3eflszmnpeW8LMi0YoySYzCia/ePur7/0Tj2PCONLRYIOV/Ol399YynB9zzd1xQ6oUWiGXq0jLTTQDNFLs9P+d7lXc4XM5QUOB+5t8z4zqpi8oLHTeTLLszGwE/L+bKcmg3ST/1PDofN7z7ftw8HNWc+K+nHkWPbU1lJZiTCGJQ1LErLS+uKKCW9S8gkaKeA1ZJ1Zeh85HpM1Mky9Yefjc3+h37qkM45u+/H/NMa/dlYYYqKRVVQT5HCaF6/s+SsynnjbMHr64Jn/rkdeFo7YoRMSVICAeQK+gBfdZpt54suqreL1T2ljbXjIjNTVTfZ3w+JrFqwynMW1rAqDOvS0IWc89wiBXx6M+JCZF1KaufZ947cS0QUrGaa4iA4tp62sKJP5heyH/4k89ni46xaf5iJhNtfMY0Dwzgx+QEjA1oLVoWhMBJSYpo8uRIYJRhcwihBTInBB6wSnGWK09JgZwsm7NxHsfoPqKt+g05SC1UAAAAASUVORK5CYII=);text-shadow: -1px -1px 0 #FDF1D4, 1px -1px 0 #FDF1D4, -1px 1px 0 #FDF1D4, 1px 1px 0 #FDF1D4; background-size: 22px 18px}#empireBoard #BuildTab table tbody tr td.building.alchemist0:not(:empty) {background-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABkAAAAUCAMAAABPqWaPAAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAAAGBQTFRFAAAA8d+/9d+W1rZ638Sa8dq29ei69dqD48h60baN9eOf+uzR+uio7NatupZs8d+f+uOR6NGRza1sv5pfrY1oyKRj7Naa//G6/+yftpFa//r1/+yopH9RrYhW2rpx7NGDIqezSAAAAAF0Uk5TAEDm2GYAAAAJcEhZcwAAAEgAAABIAEbJaz4AAAD4SURBVCiRpY/ZcsMwCEUdLQZL3iQZO8RC+v+/jJpMm2mat/IGZw4Xuu6fdVHafAS2BxzsJ9IrcGawf5kfQVllBvOGrPdKTQa1nt82Wr+svQ8xprTRr7Muu3L+uGLiVvPLutz8ovrjvCrizFG26Sf9tjt3nOsKJYkUnTfzrUzVja42gJozVcr5MW+vVKeqrg4JMQqXwvICheoJkUvFJETCTxDGE1N0KxLrClqYRJ7GeASKu6uFOCJUlsRfOX1Qrn1Yr7XExKkAlCwtx/chBB0jroCRmFNbB5R57pYQzDCYHdaHwk0GQMlzZ+00Tda61upE0exmV4CUtztm+xM5HuXJowAAAABJRU5ErkJggg==);text-shadow: -1px -1px 0 #FDF1D4, 1px -1px 0 #FDF1D4, -1px 1px 0 #FDF1D4, 1px 1px 0 #FDF1D4; background-size: 22px 19px}#empireBoard #BuildTab table tbody tr td.building.palace0:not(:empty) {background-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABIAAAASCAYAAABWzo5XAAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAAASAAAAEgARslrPgAAA2BJREFUOBEFwU1rXVUUgOF3rb3P1725yU3TWJWohEJxUJ1aOlBQiujQiQNnIo6c+gsExwqCv8BB/0HFoQNxoKK2tIJtKNUYaz5u7kfuOWefvZbPw4M7n/rRwY9/zufnbw/u4u5yPjt55+jJL48e3r3tR38/OJ7N5u9fXKzicrHg8PHPzM/Pbx49+f23+z994wd//JDPTo8/12ZjjuV/r1ruvhra7mbq2tdy7r/ou9P9jY0Gd3bykL4U93erKk6fffH6xOz8s747fGU6XrPVLDVo+kQWhx+6FLcg3nDr7VhD9lDqZfessaxxxljGh3Z1lrI+kEJ/jfHoA8nHm1EL8ICWLyEHd95zqZ/HR9dwNmmaRF2tqEYVcWMPimdoVwOr0wUXXcBCJPhDtptjoOFiLkx2XiW2s4RUh3jbos0lRhFUM+Rt3LbAJoRYE8uBsHhEoSvq8pjg0KVMu4QYz4giEBgIPiNKopKGGDYgNECJSCQUI4oyoN0B2ClVdKJMGcTAhdSuiQioOJGBJhplFQgFuGTAgICIEDwj7SmpOyYVNbFsEHrcA9kyigACIGgo0FihwRDJOAEn4gQEJ4ihPmBpwIeMqCFqSFAigAiIAAhgCAkk41IAEQccQzAcMHfAUUkEBRHQdQd5ANxx67HUkrPiFgFFUBRDLGPmZAN3MAfLjpARG4iHJ7CbYVOcInV4rsm2jdAQyIgouIKDO5hBGpzVGlJf0vZCEyGC899caLOjVSZURgiBUAZ8GNAwYK503cC6c1Zr6DGiDEgTaXulrJW4u1Ox7hLuznIlSOWU0qG0xGGFlHOMmvVizcnS6NewWQujQiE4rSgSIlruvMxkc8JkLNS1EgslFIbIgHuHWwIMCU4ZYdzAqFY8G4uTGX2XCGVF1MuvM+gYWd4je09OiZg6irKlKnukMnJOWDCq6LQ9LBaZfrai65Vm+hyxHhF3965/N2/Gb3G+pXn9F4MM5LZFfU4rJdovsWTkQdDRCKxlnXaRsMX0yh7TK/uMp1eQ+XK1N3SLj3SYXfXh4qkW+aZz94bqE0S3Qd4AuwQ+x/P35PyYlG89tbR9Oyj36o2tF8qqOhJ3BxDA2y69ebE8/Xpxdv/aOM4QE8ymuAfAwM/I3tGynyY7+99uTLY+tpz/GY8b/geGd+pmTCUDLQAAAABJRU5ErkJggg==);text-shadow: -1px -1px 0 #FDF1D4, 1px -1px 0 #FDF1D4, -1px 1px 0 #FDF1D4, 1px 1px 0 #FDF1D4; background-size: 19px 19px}');
		if(database.settings.smallFont.value) GM_addStyle('#empireBoard {font-size:11px}');
		if(database.settings.hourlyRess.value) GM_addStyle('span.resourceProduction {display: none;} #js_GlobalMenu_wood, #js_GlobalMenu_wine, #js_GlobalMenu_marble, #js_GlobalMenu_crystal, #js_GlobalMenu_sulfur {position:absolute; top:0px; left:31px}');
		if(database.settings.wineOut.value) GM_addStyle('#wineOutTable { display: none;}');
		if(database.settings.newsTicker.value) GM_addStyle('#GF_toolbar #mmoNewsticker {visibility: hidden !important;}');
		if(database.settings.event.value) GM_addStyle('#eventDiv, #genericPopup{display: none;}#redVsBlueInfo, #redVsBlueInfo_c {visibility: hidden !important;}');
		if(database.settings.birdSwarm.value) GM_addStyle('.bird_swarm {visibility: hidden !important;}');
		if(database.settings.walkers.value) GM_addStyle('#walkers {visibility:hidden !important;}');
		if(database.settings.controlCenter.value) GM_addStyle('#js_toggleControlsOn, #mapControls, div.footerleft, div.footerright {display: none;}');
		if(database.settings.withoutFable.value) GM_addStyle('#buildUnits li.unit > div > p, div.buildingimg > p, div.buildingDescription > p:nth-child(2), #tavernDesc > p:nth-child(1), .content_left > p:nth-child(3), .ad_banner, #premiumOffers p:first-child {display: none;}#buildUnits li.unit > div img {transform:scale(0.7);}ul#buildings div.buildinginfo img {transform: scale(0.7);}');
		if(isChrome && database.settings.withoutFable.value) GM_addStyle('ul#buildings div.buildinginfo img {-webkit-transform: scale(0.7);}#buildUnits li.unit > div img {-webkit-transform: scale(0.8);}');
		if(database.settings.ambrosiaPay.value) GM_addStyle('#confirmResourcePremiumBuy, #confirmResourcePremiumBuy_c, #premiumResourceShop, #premiumResourceShop_c, #premiumOffers tr.resourceShop, a.plus_button.plusteaser, div.resourceShopButton, #individualOfferBuildingSpeedup, #premium_btn, div.premiumOfferBox.twoCols, div.actionButton:nth-child(3), .premiumOffer, #cityFlyingShopContainer, #tab_tradeAdvisor > div:nth-child(2), #tab_diplomacyAdvisor > div:nth-child(3), #militaryMovements + div, #tab_researchAdvisor + div, div.premium_research_link, div.bd.mainContentScroll > div.mainContent.minimizableContent > div.center, #setPremiumTransports, [id^="js_offerButton"], [id^="js_orderAvailable"], #mmoNewsticker, #setPremiumJetPropulsion, #setPremiumJetPropulsion + hr { display: none !important;}li.order {visibility: hidden !important;}#js_viewCityMenu ul.menu_slots li[onclick*="view=premiumResourceShop"] { position:absolute; top:-1000px; left:-1000px;}');
		if(database.settings.noPiracy.value) GM_addStyle('#position17, #pirateFortressShip {display: none;}');
		if(database.settings.noTheater.value) GM_addStyle('#cityCinema {display: none;}');
		if(Constant.Buildings.PIRATE_FORTRESS !== 0) GM_addStyle('#pirateFortressBackground{visibility: hidden !important;}');
		if(database.settings.donationButtons.value) GM_addStyle('#donateFormInput.textField {' + 'margin-bottom: 6px;' + ';}');
		GM_addStyle("/*!* jQuery UI CSS Framework 1.8.21** Copyright 2012, AUTHORS.txt (http://jqueryui.com/about)* Dual licensed under the MIT or GPL Version 2 licenses.* http://jquery.org/license** http://docs.jquery.com/UI/Theming/API*//* Layout helpers----------------------------------*/.ui-helper-hidden { display: none;}.ui-helper-hidden-accessible { position: absolute !important; clip: rect(1px, 1px, 1px, 1px); clip: rect(1px, 1px, 1px, 1px);}.ui-helper-reset { margin: 0; padding: 0; border: 0; outline: 0; line-height: 1.3; text-decoration: none; font-size: 100%; list-style: none;}.ui-helper-clearfix:before, .ui-helper-clearfix:after { content: \"\"; display: table;}.ui-helper-clearfix:after { clear: both;}.ui-helper-clearfix { zoom: 1;}.ui-helper-zfix { width: 100%; height: 100%; top: 0; left: 0; position: absolute; opacity: 0; filter: Alpha(Opacity = 0);}/* Interaction Cues----------------------------------*/.ui-state-disabled { cursor: default !important;}/* Icons----------------------------------*//* states and images */.ui-icon { display: block; text-indent: -99999px; overflow: hidden; background-repeat: no-repeat;}/* Misc visuals----------------------------------*//* Overlays */.ui-widget-overlay { position: absolute; top: 0; left: 0; width: 100%; height: 100%;}/*!* jQuery UI CSS Framework 1.8.21** Copyright 2012, AUTHORS.txt (http://jqueryui.com/about)* Dual licensed under the MIT or GPL Version 2 licenses.* http://jquery.org/license** http://docs.jquery.com/UI/Theming/API** To view and modify this theme, visit http://jqueryui.com/themeroller/?ffDefault=Verdana,Arial,sans-serif&fwDefault=bold&fsDefault=1em&cornerRadius=4px&bgColorHeader=F8E7B3&bgTextureHeader=03_highlight_soft.png&bgImgOpacityHeader=75&borderColorHeader=ffffff&fcHeader=542c0f&iconColorHeader=542C0F&bgColorContent=f6ebba&bgTextureContent=01_flat.png&bgImgOpacityContent=75&borderColorContent=eccf8e&fcContent=542c0f&iconColorContent=542c0f&bgColorDefault=eccf8e&bgTextureDefault=02_glass.png&bgImgOpacityDefault=75&borderColorDefault=eccf8e&fcDefault=542c0f&iconColorDefault=542c0f&bgColorHover=f6ebba&bgTextureHover=02_glass.png&bgImgOpacityHover=75&borderColorHover=eccf8e&fcHover=542c0f&iconColorHover=542c0f&bgColorActive=f6ebba&bgTextureActive=02_glass.png&bgImgOpacityActive=65&borderColorActive=eccf8e&fcActive=542c0f&iconColorActive=542c0f&bgColorHighlight=f6ebba&bgTextureHighlight=07_diagonals_medium.png&bgImgOpacityHighlight=100&borderColorHighlight=eccf8e&fcHighlight=542c0f&iconColorHighlight=542c0f&bgColorError=f6ebba&bgTextureError=05_inset_soft.png&bgImgOpacityError=95&borderColorError=cd0a0a&fcError=cd0a0a&iconColorError=cd0a0a&bgColorOverlay=aaaaaa&bgTextureOverlay=07_diagonals_medium.png&bgImgOpacityOverlay=75&opacityOverlay=30&bgColorShadow=aaaaaa&bgTextureShadow=01_flat.png&bgImgOpacityShadow=0&opacityShadow=30&thicknessShadow=8px&offsetTopShadow=-8px&offsetLeftShadow=-8px&cornerRadiusShadow=8px*//* Component containers----------------------------------*/.ui-widget { font-family: Arial, Helvetica, sans-serif; font-size: 1em;}.ui-widget .ui-widget { font-size: 1em; }.ui-widget input, .ui-widget select, .ui-widget textarea, .ui-widget button { font-family: Arial, Helvetica, sans-serif; font-size: 1em;}.ui-widget-content { border: 1px solid #eccf8e; background: #f6ebba url(\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAABkCAYAAAD0ZHJ6AAAAfUlEQVRoge3OMQGAIAAAQaR/Iiq5u0oEhht0+Etw13Ovd/zY/DpwUlAVVAVVQVVQFVQFVUFVUBVUBVVBVVAVVAVVQVVQFVQFVUFVUBVUBVVBVVAVVAVVQVVQFVQFVUFVUBVUBVVBVVAVVAVVQVVQFVQFVUFVUBVUBVVBVVBtVtsEYluRKCAAAAAASUVORK5CYII=\") 50% 50% repeat-x; color: #542c0f;}.ui-widget-content a { color: #542c0f;}.ui-widget-header { border: 1px solid #ffffff; background: #f8e7b3 url(\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAABkCAYAAAEwK2r2AAAAY0lEQVQYlaWPMQ6DQAwER/v/7+UhQTRH7N00QEESiUAzki17vOb1fEQAR8QDpSaUmhHkYwSAb4LEKD2vAryc3/2JpFC8IDzWfHgg0qcEd47/haT3VEZxbWUKQW89GhFffeEi3kGvSQXcQU8oAAAAAElFTkSuQmCC\") 50% 50% repeat-x; color: #542c0f; font-weight: bold;}.ui-widget-header a { color: #542c0f;}/* Interaction states----------------------------------*/.ui-state-default, .ui-widget-content .ui-state-default, .ui-widget-header .ui-state-default { border: 1px solid #eccf8e; background: #eccf8e url(\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAGQCAYAAABvWArbAAAASklEQVQ4je3Puw2EABAD0fGw9F8KFSFqgJTgCPhEFHBCmzxN4sCs8/QToGmaz7JvC5JgMiAnhbEwjoiFPpXUXda1SPyHM03TvHEAd0QJtjgD5PAAAAAASUVORK5CYII=\") 50% 50% repeat-x; font-weight: bold; color: #542c0f;}.ui-state-default a, .ui-state-default a:link, .ui-state-default a:visited { color: #542c0f; text-decoration: none;}.ui-state-hover, .ui-widget-content .ui-state-hover, .ui-widget-header .ui-state-hover, .ui-state-focus, .ui-widget-content .ui-state-focus, .ui-widget-header .ui-state-focus { border: 1px solid #eccf8e; background: #f6ebba url(\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAGQCAYAAABvWArbAAAAR0lEQVQ4je3PMQrAIABD0Z/o/Y/Wk3RwLBSqg0KXHkBKlkeGv4SrHd0AIYTf8twnBmEkDF5IBTMxlupaM1HB0ht7hzMhhC8GEiwJ5YKag9EAAAAASUVORK5CYII=\") 50% 50% repeat-x; font-weight: bold; color: #542c0f;}.ui-state-hover a, .ui-state-hover a:hover { color: #542c0f; text-decoration: none;}.ui-state-active, .ui-widget-content .ui-state-active, .ui-widget-header .ui-state-active { border: 1px solid #eccf8e; background: #f6ebba url(\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAGQCAYAAABvWArbAAAARklEQVQ4je3PsQnAMBBD0S9l/8kyTFIaDDkXBkMgA5ig5iEdXCHafZYBQgi/5ekXrlmFpQNLxmDMTOv2rrU+kHYYE0L4YgB9ewvfYTVHjwAAAABJRU5ErkJggg==\") 50% 50% repeat-x; font-weight: bold; color: #542c0f;}.ui-state-active a, .ui-state-active a:link, .ui-state-active a:visited { color: #542c0f; text-decoration: none;}.ui-widget :active { outline: none;}/* Interaction Cues----------------------------------*/.ui-state-highlight, .ui-widget-content .ui-state-highlight, .ui-widget-header .ui-state-highlight { border: 1px solid #eccf8e; background: #f6ebba url(\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAoCAYAAACM/rhtAAAAjElEQVRYhe2UOwqAMBAFx2DlMbz/kSS3MIUIWij4aZ/gK952YZohu0y3zNPGOWur3Kcfxsf7D16c5YBD0FUOoDjLAdeKHeXWVi9BRzk4f9BVDqA4y8HrBt3k0sEveDqo8nRQ5emgytNBlaeDKk8HVZ4OqjwdVHk6qPJ0UOXpoMrTQZWngypPB1Vu38EdG7NcOPXFHAMAAAAASUVORK5CYII=\") 50% 50% repeat; color: #542c0f;}.ui-state-highlight a, .ui-widget-content .ui-state-highlight a, .ui-widget-header .ui-state-highlight a { color: #542c0f;}.ui-state-error, .ui-widget-content .ui-state-error, .ui-widget-header .ui-state-error { border: 1px solid #cd0a0a; background: #f6ebba url(\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAABkCAYAAABHLFpgAAAASElEQVQYld2PMQ6DUBTDbP/7X4grde/6GACpjN0QS+QkyhC+n20CeI3MQChJJ4GEka7LEtkiRsJF2llw0G02SP5k0oxPOP2P7E3MCpW4kdm7AAAAAElFTkSuQmCC\") 50% bottom repeat-x; color: #cd0a0a;}.ui-state-error a, .ui-widget-content .ui-state-error a, .ui-widget-header .ui-state-error a { color: #cd0a0a;}.ui-state-error-text, .ui-widget-content .ui-state-error-text, .ui-widget-header .ui-state-error-text { color: #cd0a0a;}.ui-priority-primary, .ui-widget-content .ui-priority-primary, .ui-widget-header .ui-priority-primary { font-weight: bold;}.ui-priority-secondary, .ui-widget-content .ui-priority-secondary, .ui-widget-header .ui-priority-secondary { opacity: .7; filter: Alpha(Opacity = 70); font-weight: normal;}.ui-state-disabled, .ui-widget-content .ui-state-disabled, .ui-widget-header .ui-state-disabled { opacity: .35; filter: Alpha(Opacity = 35); background-image: none;}/* Icons----------------------------------*//* states and images */.ui-icon { width: 16px; height: 16px;}.ui-state-error .ui-icon, .ui-state-error-text .ui-icon { background-image: url(\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQAAAADwCAMAAADYSUr5AAAA7VBMVEXMCgzMCgzMCgzMCgzMCgzMCgzMCgzMCgzMCgzMCgzMCgzMCgzMCgzMCgzMCgzMCgzMCgzMCgzMCgzMCgzMCgzMCgzMCgzMCgzMCgzMCgzMCgzMCgzMCgzMCgzMCgzMCgzMCgzMCgzMCgzMCgzMCgzMCgzMCgzMCgzMCgzMCgzMCgzMCgzMCgzMCgzMCgzMCgzMCgzMCgzMCgzMCgzMCgzMCgzMCgzMCgzMCgzMCgzMCgzMCgzMCgzMCgzMCgzMCgzMCgzMCgzMCgzMCgzMCgzMCgzMCgzMCgzMCgzMCgzMCgzMCgzMCgzMCgzMCgzrDkZjAAAATnRSTlMAGBAyBAhQv4OZLiJUcEBmYBoSzQwgPBZCSEoeWiYwUiyFNIeBw2rJz8c4RBy9uXyrtaWNqa2zKP2fJO8KBgKPo2KVoa9s351GPm5+kWho0kj9AAAPhUlEQVR4nO1djWLbthEGyUiq5YSSLXtp7FpLOmfzkmxr126tmi2p03RJ1/Xe/3EGgARxPyAgRbIk2/hkSz4CJO4+HsE7AJSVysjI2AMUUOxahZ2iANhzBtZWr4BoIRSYAVN5u4QwDwQDRbcwfUi5KS3wFuDmFnQLa4Dtb//cqktwD5QEFFwfUs7PoCCA7y4bEJVFizcIob8KmhAplwwqVjt+9FBl3uINQniwEiryEyw9JHqGpQdEFNi+B4QQ7QOiHhysIPoAxUqxvdvvA9K42bsAv4S2fxfYOe57IJSRkZGRkZGxx7jxSHDHcRBXQMTyIjInBgHwBJ/bEx8PEANC+uhbpSSggCBAVODVabpI1S/k4WLZpTn6NpMhoX9Y40hxYERFpMcqUs4AloCtDQdID1YhnyXZ2hLjAYWiO9Dy1PDB7tPhIqLx+uMB8grZaR+Qxl2/C2RkZGRkZGRk7A7rBf7J0DR5/LUTjzUPIPSPGvQJiVJiB7kcQCiUOJrcFNtDZIf2xarQ3aGvLNxAVIFAabz90BFiBIlycTBhgWwOWCH0FLYHlPqwHaCvcIn2ZbosCevfPTRiFFcgvHukCjWwrc3GrGh1fsAof8EaUReKXkCB4/MzFNo97qLpFiKFYv/kNR5YQxQbQEofkZ2OuEOHqqT6gFTpru8CN7x/+jaZkZGRkZGRcV+x/rLUNcMMqUAscgnFocmpqkTzqymwVAPxfJ5PnIUUQOUKT04tEdWZyv3JCQSn96WS4pD97QfyW25A7NhSAbyhmVj0FEltA4vdiygBibXhoUYgykCUP7HwPTDeEqAIcHVMkZg7Zx4k0uFANs63hPQXCoRLAwdgGsr9Az7Qv7sgQGgg1aPl/BJLExBWgG4RFRLFImGmIquPC/klEGyCG0AuAXaJJC+B8FVe9NYQDEcXB8g6AQcjYJ1goJIggHWCrFR0S6kRHN5+4BzFi8NaoN35NRxUvL+JJdZr7PV4wK6fj8nIyMjIyNhr3OxdXAYq7FHZwB6bDSzSh4sF0utChqo0NAvaT1hLzXwFinmCzmeDucEQK18TTaQoFgP7bNC+RZ4OT4T6gQogDFYk+1QxQlj19QGSAWKiLYp8P0Ag1Gbz1ULfWHLg9iUnQNK5QQJcukm04blKLH2GgEJCY+HzXAZWCvHKco3Bp6MIaCjSXXRJyOxeqhnzEaF93MfFGW/O16ZvDL5TM4MJIjujz/cHypkQuuzRwWJ93BKdIt+wCRAPl9kpe2Ikkb2mFgGlxh/i40d3EHfdvoyMjIyMu43ylt/IAmGHnN5iIt7wKfbv01RAcJqFRl9lcjYQSnbQqKgC4fYOwSJt6N6trE0twZ9kN/PqNpTQeICvr4TLsDYC06U7BMjshS+v1/aT7IwQYD5LcgRQXMT2FrBfBLjZ6151jDElk9tPFfpUgk2yregusX25BJbwAFEfM+YI6vGAti4bTtizB+TjfQCrERyhKb2X8D6A9wX75P4t4neBYJeP6pdhg/gQl8MWvytzeSTjgOQBynQdh/iXKdxOrGJ/RkZGRsb9QmXihGr5+g8GGg9uTh+KoVZuNIzV+CwRucFBEyr1mVjx4irOxwM1BhirB6Q+2eNQi4eqR+aF6mELtoMzCR7V9RAFe/ZvQogNiyY8FPSUTFsLp8TeTmMui5mtw7bcaT0Yw2AA4wFRQIlkgq+1DQrNhkmoxS5Jq+u6bMAIGRECEANgXHTgWzwgBOhDH2l0oTQ4D8D5NMktBgNywAEMjo8rwATMZrPY7JGxBoJCkIBDQiAY09EGTUiBCWkUpISfGPR5AAwBfZiG2z7Ayc1yeKTxid39xBNwfHr4O0LA48ePFTvhYrF1r4tyAoz9n2MCqEuBtp/6GDR0oAYfG/R6wJExHYZHfhygsv7fEWCOj4bYmsP5A+pL4MkTfAnMlD4F+r3bobKvTyTA2P/w7PN+Agq2QW8piqMCpTBwenoKvX0AHGkGtP2YAPvTEWA7QUTAudn7/NxtOG46wWNmDtpBEkBzN7rBEvAFHp+YTB/q97qPAN4gHFqgBi8uLsC7qPCA6mg41G/+ErByPwEXDdoNxRhOx+M5jPEzQugS0ht+b1/Y3gEnYMAIAOIBE29/hIDucE8tmMsNOgK4B1RHFu4UCRlMHzv0xzcajcfdXWDs2h8TArBCkoDUJYDLmz6w7ip3BFS0ve5wTRwAn6keMA9I3QYbfSZ0DKbyt+7OXjGI1idPcfNyAyfAMlCrzaGqphYrxHocLHRJVycnfGUcbtT+jIyMjIw9x7Nn8fJSzG0TmFtO8rZT+XT3S3ub+tKJbbLd5diTVp50+zahyeHSslJ/YPrU0fuazrZO2CZ92/ZCCVXlGRiZKPJyPPRxyIFWeXLQBXJBKiq/3divEAN6ZwM200Qjm7EJBZeWm/PRWVCbYK7s7u2l4XaCz+lzgOfMfhMonXr7TWzeZb98dbgIzBT8Ub8eYYUqfZ4rVJ/MDbIDgPqTulJ/xvntWAtjIisqnwxOkGz0n077FARoY79GdA6HPE4rOy196NiMWHTZlSSApcOgXpy/fHV2joaNKu3ffsAnRcBf4K/6NcIG6tIxk3HyoXPjASqfUgXbYN5PzpL2njkR9QMjeDTVHDTCgRuxOegjoO0FvKzP/t/gmVdI24+G7NIe8JX6Wv3dDyldMA+4YB5wwTygtd+dwRqaTqrLb1l73zTSN52CNpnHuQOYPsDblybgxfkXh/oVtr+N1DEBJdhRJyd/Bd/q1z+cbNrD17iVKyajcnv9arhOkRPgsruuD6DmNPwpDNrLw2CoTgHni4yALr0L29+tiKAEIPn868ejx//8rpWP3OEOl5On9OwpcQm0MhafP/ey8f1uvDNIgGLQG8z4YO99ENgg95etwv4uYJYY8fUGHYH6j6fscHFZMftlAl9i+9XL73X3N/n+ZStOzfVfRvYXhrbdKOpEgVQTg/wsDuDD3kwOfQNMTJ5y+/ltUDWLunyxnRF46IqlBzGMY4X7inggREFioIyMjIyMHWCIB6ZNKAcXseo3vLTQTkVE7348dlwJJSz0+wLfmi8BhZqfw3D4ww/wHVLnEd5/fgYvXsDZ3MlsvYUbbnDjDZ3MN3TJG4+bxjAaDl8TBri9qxEw1ccao2wTNAMLHo2f+sjrXwb/9qHoYqgPMBXJTVfOpmrZH23y6uvo0LHSyY6fHGwKfHJlAuMFvObjDYrIqxBgQi20h7Hd/nYVLmno+eaNUm/eeH2GCuopntnhBJAlI2AHo9CCh1I1QxUdAbqqGY9BBLwyc3W4wYVhvY8A4BoIc1l5M7vnPWphZW9/Ses3n37y9a0uGqFwFQZsQQbd386DogpgEk+dzynsAZMJXq8+ns9NeukJ0PYrNATGGefJQlhkLo7DTXr+y3bNiOsDvrXTz/C2q1DXZH84iRNwrP88Nj+u2DjYEE6RBxD9Knj16ujVHC67A7422o02RwD3gB+t7EblWvu9geOFxSnd3ROmT+nJyQkhoPlsxVONc/3TEdBos+jtA+ZzcwHgTvD1cDjaYCcItA8w9i88A8b+mqSjc6Pvqd998QguEQPmQMeo23ODN86+p0/bn1buBkT6+oBhNZ/PYY4ZAHYb3PRd4LkZmPX68NRtMZn4ASvdA+qf0jMA5MP9eeg28Nug9QiLnj5A33U1MAES6xHAUNpz/9zFAYE1gqQDMT3G6xI9pwdw/aIgKoHCS1YGlRnSq9yCjdXjgN3j+N27YyROHxmuNAeNKPpYuXIyIyMjYy0M8eros59MF/PT2c602T7eA7zvhJ9dr/vzDjXaLp4Yc5+0wllzxzHv3gdmMMM7/CcQzKgVBqYTmFn+Z+mKm8J7k0A5F/jgCfjQ1WBhQyiOqD0lYuqBb+AyzMw9Ha2G3m6c8qQx+AlqnIceQp+Sb6i9UyQWbhr54+AjnZ0VzW2TAN0DmBT6PWmc6jDBE2PK2u+nF43dyP7Q0t1pOcX2fdRvH0mF2Q4JqN35rnHjVIeaXfIAVyUuw/aHCCiJy9iF5l1621zweI8KZrPZ9iJdb7DXJ3US0OSrtZ10imt7wHY7QesAzUMz1oZ3noB3qFJ/H18j97FYuw8QDN4oeKf30osvcSW2ExLo+VcbuAuo/sUIm8fMG9xocO3Ea19J9gFYivnHJ2KnyfovZlgW3v6ySx32abQiIyMjIyPjhlFDTLxpwIgFMnTp6A3g4IDKNY+stkwAMAoIAbasxBXqUWneSAWTMjt50lTqT29rFjvXohjsDNm2YPXDFlICmrJOZ3t6tHm8AiEAl0sCeLIIorIRt+cFbew/QRsoAXb4o1XSfoywzm0FTMAoYBNvLyFu8v8HpLBtD1iKgC17wHb7AI6d9wFbvguAIGTHd4E9wG7jgIyMjIyM+434c2R3HeV/Ffx6jtZu6ijl8h59T655jhR+rdHzDOP6beABCheb8O8/WFXeOyzgf5oAhVYnKxP7CwaAf1afJu8bSrhS6tdaXeGnrRenOqOlz9d6QwYnA/3TLd+GE7qe3chA5YF5DfY0vK3adfOX/gyNp2BW25MHdxAB9qvRiiP3/XpQQFGYDU4+Mi///XumXG8pjvaUAOsBGlf4jJt+YYEzeEzAdw06F19R3juM7D1wita86GR0CKfDHgLuXCc4Bri6vMLdfjMc4VNSUNsdodo2xu/1+Xl/K5+az8jIyMhYG/z5gJTMF1GtKq/a3rpyCvz5gJTMl9GtKq/a3rpyCmfQ4WwZmS+kXFVetb115ST48wEf/AGcfG1iw+tWbpbS2vJ3nQxcVr3lH3z5h972FUTLzYpOVk7l5hD+eYcYwDcAnewOotrZ4OtrPDucqi/LRX0/RR4qx7Nn4U8g+qjffvuN6Gf+nC85vwauHjaYyubqvWYKY4VEfSUMitdnBCT1Ue63R5439m+OgCn6DroAAaHPVQxKth/wkJgHmG8bmQMsT0D6EjDfvhVRKO3ywOQUgRA7nmL1uawZmHf1k+DPBwQ6NdcJ+k6Md1LA5f5ONdhJ8vZ5J0vLHT99srkGOjmJbd/G1r2Nriqnse1AZt1AalU5jW2HsuuG0qvKGRkZGRkZGRG0gcONyXsP9v8D0/IdJADiBNiXl3327WRGgOL/9HC/0XwlIURkRhC4tz6Z/fu7fUf2gHvfB9z3u0BGRkZGRkbGplHcnkgguQoSqtUXuhbs/wPtMwqV0HUJAvj5vk32b8IDuL23yn7qAXZ5u32hbRX7d3o82Df1FZXvbh9QOfhyxldr/+3xgXU9oKmvsHyr7F/XA269/eveBXrsv7N9QALe/tvjA0kPWAXGbvebkbHn+D/J5nMcHzx1UAAAAABJRU5ErkJggg==\");}.ui-icon, .ui-widget-content .ui-icon, .ui-widget-header .ui-icon, .ui-state-default .ui-icon, .ui-state-hover .ui-icon, .ui-state-focus .ui-icon, .ui-state-active .ui-icon, .ui-state-highlight .ui-icon { background-image: url(\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQAAAADwCAMAAAGvTnpvAAAA7VBMVEVULgxULgxULgxULgxULgxULgxULgxULgxULgxULgxULgxULgxULgxULgxULgxULgxULgxULgxULgxULgxULgxULgxULgxULgxULgxULgxULgxULgxULgxULgxULgxULgxULgxULgxULgxULgxULgxULgxULgxULgxULgxULgxULgxULgxULgxULgxULgxULgxULgxULgxULgxULgxULgxULgxULgxULgxULgxULgxULgxULgxULgxULgxULgxULgxULgxULgxULgxULgxULgxULgxULgxULgxULgxULgxULgxULgxULgxULgxULgxwjo40AAAATnRSTlMAGBAyBAhQv4OZLiJUcEBmYBoSzQwgPBZCSEoeWiYwUiyFNIeBw2rJz8c4RBy9uXyrtaWNqa2zKP2fJO8KBgKPo2KVoa9s351GPm5+kWho0kj9AAATX0lEQVR4nO1dC2PbthEGyUpaqJii/JgbZ3bTLNmyJns/Oi1bM7vp0q7r/f+fM+JxwOEAkNTTSoxPlqHD83AE7gAQBIUYBHSfQv0XnbsJgH02A3g5ibVzDFNtlkPI1VjIuOUa8eMclOLS1uRSPBETURnOrkbmID9T9fuPyu+cSGYYKya5efeddN9TRS1H8eD4kDjrPutBpptt2apkiqX57A4gfloj7ua9AXMQ3dWvNs8n7NCwZk6bqYSg1CgNsaCBHDAluMQjcihEWBNYSxamUYNMs15KmwMUKhm0S5UBwMQFjcqxelSYskHBtLC26X7/eWQtVB1MaWXzF1OrUyhLgOrFiBwalDwg6+tigfzbnNbM40UlTrrO3clTftcuX7jyY9gkv81RVWI9K0OxNa8Hruw+EFctu6xaqDhCGkjQ2hyMitiXKyR+7xSqx6u6AitlpI3wrBj5OSo5xv8ZShoq5VZE+p/hb/OVzuPHyHGXQLoug9b4af/OzArAqtlvq8PidqZSflOYigVIpTZ33192wQ1jHVXLgjWWeZdAfhn3UteqH43NI9EGSjns7CJ//g8h6o6++UrLBTrOZJUkhy4NxDNAblZld53kJZl34z4jE5cB0HbA5RHnzg9Txud28wwG4aS1pwzKH7t/IyxlEvW2XVQLcf0vyeCWfL9j39vk95iA1alinhtmcHDr34tiSDECRgCXwFMgynMfrB0PlAxMhdUoPyKDo7qq2yNZHa+Li9BQoynz/I9DNkNcFCQSVi2aQbTOJA7S1tIXYpwM9t+PgBYzwFI0mNdt9JjxuGBHXJuwuJO+fq8KYzpDLtDll1XoYZ6k53P9dUNdNzwQZTcsvLw0Cafa0snfyq/WGVUVDo/VxBxXF5ynLZn6zUO/FvTIdjeiw3VUeyUqv7Q5+dIiz+W/VoTs03r+4U/ERpyHVbkIFAU44dGMKQBZfrwrGeAl4litNO9TVGFXRN1TDlfTyGVqdQaVEV7T0ZNJGO/NTQ9nL18aDk29b2Ui2SaqfhltIIMn4gpz+k+TiNNXkjf0LYWzf+DXO4UzHuF49WYS9pIIN3mjcoga1CNDuZ3kKzlja00XXS71OHFZjBhkI1K98WCQ/QC/r9n3qudrYVVea6aE9iP8L1A/KnWuJMZ+jwiyz+P3SFkcguW26os1MoON1p+35uAIgB3fXnzm2hscgvkD0PBi23t8YcEsP2u+gEUvdsXAg4VrA0y2zD/ZBgCjbz07ZNd4bBvYHQMPFcBFznsTv/hBOj9hkE0yvyRHcYZCK5VoEwGHQwU+dJBlX08BOMGx8MBk+I2oMHdQbLZFkGDADfVBQcmCx8Nb6S6fwJqRehFktWEAVsSA0yNP5DQm8wcW6tNr9D/T6PzGVgS2gP3iCoyPB/L4YF2A2ZICUKoZI06GSjdZYhdlxzeOLANIWxfoGkaofzK2BDRlWaq76VMAuRDbiXyhQiYTtV1L7hBS64vLpRJ/xbYMQRcPVPRT4802P5ruaHvrAv3BtDmzxwz3IsFcru92uL4GysByOVV7H4Rx7Xaqax2xvqiNEQId74svvjAcglfgwis/o+vnFdpxsCJHV8uomprlYHfNpPvrV79B4+G75+dG5i3NEGBh0+urAGWrXZ1uItAYmWJNQl28cCs1pd6/AX+c/Q0znEddU8OOLjEDWWF4qcsp8d7DgweI1Vv85bs8or6kK+g+8scLc22/Ed/oVI3WF9iGKrNzybSd8sQsS9u2sFyqiPXbaWpgH2Xg3x0Dclm+whsRABfKOXlh2tCpCqhMo3wGz54pBkxbsAxUN0ejCKbq/xXAt/dS/BPA9VC+EFC6jiTkrS8w3Raj+Sp2U/vcdFdGprxDRcPbAOa7LwYyOtEZlWh08EyUjdA/GtU4Gjs+bDxRN0bi6HbezUEZQGzNwIMHiB+NDMugG1UD7o4YwLne9MIbbEYGKNT9dIA2gLs/ALzrc1PphlwOAO/BC/n7Vk/DuL+lE67wdleAuQEH8sEik0/U0KMNuDMF3XWkvO3+wdDEFZQm6Vh6pAX47qfXeHYGMwcMXHc/wHc/PQYyAslWXNUPjNf3xEAlocNxqJjbQEYcW6sHO6bEH/6+VSgKf75S2AReOLiEa5Y/dEuF3/yKd0ootu+mvgQCzYt04TNUmPsNG0tga4ze+ZSRkYK3DiJCPYDdAb2ZHiiA78JZt/yge6XcIk67fLbVA1jASD1QILmlBDIy9o7Bxsn1APMeG5/b6SB9cHc9sO9sApTgPNXfXbJUuC2AxWPjjUiOzI3Hc8UmphFJCWQ8eAwehjEYbs2338j4cD+Vn4vgNfOwURsvXhxPDzwDay39+UVkOhCsiHrhwPovDyfxPIXC0xVJPeBqWlCPgvVzJ0FWgPEtyGZUxuCe9MB9zUcydgZ7BdksfFhBGKTM8tg2BkGHTlnJuEKx/d56r9m6gRXF7+ByBiJW11NAm8AoCKvj9HyfP7SfkkAwkjq0nc/jio8frDsFw+P0cYU7uvrh4NWz53avCrHwyOAuOAhvZiV6HVMIUk/uyA6GEwJGl0bReIzu8CZc0AY44o0gd/9PBvIcKObhX91HzAPMHrUK2L0tqD/T/oAbEAVx56B3qorHj9VZBNJHBTSN2lQrThpbkD4EC/RmWWQAhN78BuA2yanYE9x9e1pp9+yMdWug0QXeRJ+b8krTnxr80fGjU1xeegxMBSx1Rrr8EnS8y0t5aIIQ9RN9auPZZHJmJOXNM9w8QTEwh8efewwUGHE+n+uI1zpDZKCaLpfGVcGV2b173UGlr29qUk6EgQml57CQG4QcA5TRn1EJGgbsFlOMv4AFnbEALxBdvgfNVlSXn3EMAF/XRwaVyuM5wHNFJFp3uM8A82HXGs7NjxbbRlWKSCMSv/rVCWUgCEfU5jH8Whh3ot1WNz6WbmHTT1vbzSvKgBXBye+/NByKSEYSqpteGwauDQPXhoGW9PvGT69OZr2wvcNUcHph+gXwGgvGgFZATy8vvxby0FPtz11Tf93Pjat3eL9UbtvagQ+qWkfjIwhO/iLZBsC/zWFdc4G1itWc6Lb2WDcKy2DG/aMO1vH6R3t27PjCtIXpP75Wrum0V1/Bjc5GWc2paSvKVSeR8940C1az4gykFNA34hvQJXkPVGDrh6py4wHtoY1Y+WapTwOfBt3Ob+WkQI9BG28+V/sLG+N/bgYypUt/Kt0XZsemTffmjcloOqs3kACgNcVN+ivQjx24eYRO9uwZPMOKUAlMb27YyT4DDJBoOh/HmXbeGkl+hTnp55W6SyA1ZroNZJjnG8S3AGPO9t89njijpTk4Mw+ruUs0avB2BrDuEf+mHHnAE2mlfBlAdjBjThWFg8z2++/ZAw+btanGdivMqTEVhlea0uW7ckrbzTw9UZ2dbbTjWz3h0RgG7igDlkEzTBiQwKbdStXgTB7hhRlYCQiPzMhIAxvLpsnBNjrVrRqhH3ppSv1jpg8nlP9mJoGJj+lM2910mZzNBwDMdn0xw+410wzMfIXDxiWb27aNJeAy0PHvb0PAlm0g497xX3iqXIDt3mO0KVb/A2FGszM8bg9GfHcGm2EN+KCVHh8sl4V+mL7Qy3MAS/NwPezy9UJi1op2pjkxi7ZuJWPR4+4O7+H9TvPLWBs4H+DuO4Af+txUuiGXQ40JrxLu6wE3la7HjTCgmz3OC9TDdhDxd0/Tob+I+/PvTz9h/JuYAjFzAueCHHjHMjIF8PhheogycCPiT9vjfEBVVLq3nced8f9g/FPuHU3PXAG+Czdm3sGA8wHufjfgptINuRkZIfD+YOCyWe/eGlFQEDIg/P1B+2PgviWQkREg3dYO9FRZwACWe6in2gwD+NBtV26B7kElgAwcvPxEGyiKw3GQ8QBRHPv+9K35692kXajXyBZe5INKRO5gouVBMPIoIHi4koV6Ebge4cnDAoLIQYl7hCyKn8naK4CYgHorGAqgh4HDC2AE9tsFeBM8eBfIyMjI6MfeleD9qjw+DnBbmxGRCDy6byf9ChVhdn1mtVBLnIeTCUB05MOieGZqxDigEH4CP3xo2HBQAYzAJ94FMjIyHjq2XnbfMoNgdtx7J2CD2wT9CfANgl4ZfTlAkCNwisfvzz3yLCewQEgEmgxDflgCSAXGyh8Rg1UwfMtiT+KIgHwGY8n7r9BwCT2BkfRrY9sM9pu+dwUqIyPjoaPgkzfRf0s+EhCJ3G/HvdAEAyRc0PnYCIXGz0blRotPziJ2mZcCvQyEwwaP/3CUMzDskBGARqd6HDgHTIAmMnAPR4c+veMwVn5Yg1HBwQKDT7L4rH6CryEERfAKFLQFsJsMMHQbJNrIe4oPCgiCw/wYf/wKRhIwjnsFEEbO44CMjI8ae+3BgZliWiksXKYoPLsSYIDjwDDz6W+wjN4XviWMlUrewFZBPff/I0rWn9+GDPeZBUwLNACCiLuUAJ5sTwsBL9yrYsSqhwz1iShYgIm0ACaAsIXs3K75A5lgnZ7dGBlYxx9a8hkad/QPmzIyMo4O4bvWPipEZxa+4imDCRuf//HnMIcV3bHcEYXYKrJvdUooPbPk2U3pll4OIDhJBVYgfSytZoQAgvj+AoU+rSshAL4+gZU/mgYghrpAtL2T+GX8akLkl0Q48v4EcE/PYWdkfBxQx1SucfLOZ/Ik0c/2x48POGmaKdFz9jAsF0N+F1wLOlXWVpo2h+dVuApcxelg8jc34eZgVjGp5QOE9cRjQARmhE4vg8mqx79mnpeIHlDKg1ZdKmiaotTADLrr4Zd3LpESAOiXooN7N7ppAUjrdX3C8blKbjOcwOnF/OdABSCPdmX15fUP7BSxYr4AZPU/d+FQ+hKFgnnIV+EVy4KsAMHFxUW6BcBy2bWiqXlJvCq4Un9WADJ+RQTwVKZ++hQ9TuXpf7U4ZdUhCSp76CxG8C2576EE8As6Llm0j8EdZxMIICjvmQKT+MReIS6AaqmAHAY0yF42Be+K1LXtAjWWbw8YCRj6Qn18fvpbAA3XXa4RO0NVtQpbvFLaKYCR0WGr0VQ+8zfjoeHLL3uDS3kmqR3Nz6TNe1FPnc551CmRxSOrw6K9r3L+z40Sfo7pYSHBJle+Havreg1az9Tsob2NVOSl7delPHZoQdcnXgK89NmVZyK3F5iZttOWv4LxB3pUQNYDvnr6+s3VUzJaqrqhEzl9VAsgVWH4Lfyu+8xIBaXmrxlNzU43KpqQ8NZn0NgxO27xy/sSSdIKZnDSQmslBLIFuPoFAtAC9wTwi3n3IdWnI11ACVi6BDXYQvoP8Jfu81e3QOJfYUVXjCbh6up1QMPRqKKcZUO7Turntbc2sCEAZPYfWbvSR0Yn7Q6wgf5zw4DrAnJBia8vWCbkxWbZ9dOCn1gddKmSVl+8/vtCiMXfXxuylVe/b/pe94QdLdY5DbRt85HfGfeOKR2MSy0G133R97uMWMNsOn0LtO/3bxsbQtvlVTtNBfI48BXXwxdOKf5T4l9OC6+mXQatm67FzHJkyZXO76nhli9OkYev2/J0gDOrnQ1fyUK9Cvu1Z1rWAwThej7nBLpS9MrSpR9fu3Ob/F0XNAMiwIkCEYBvReTAjUSQ50F3VboQVADdOIxIqr65kXbV0m8lc25cEkiceSTItAD+rWgci5V64OU0cb1SuPCTO3l1NTo/P/cEQASnVicunnZ/bIFjlWwBNzfd7Jxez9rnV+y+C7yUo1Fn97nNWi0WfyaFNd1f6UQAnoM/5+gxRfmbkakSiEKiBcBUAqLnDN4TTu/uTgnZnshxSokvAgt7oF6B2WL9ISPDx3sg58x+h03uu3vk6LB4Ly0HSuCD7m7y/wcbgynBmFFsnGprPSUf8eA0qBcWuNc29BjdfaC7/tJ0vvcK93lYsJONu+gzS8iKN0S3Bzqrq23Z0vWN77t/33sRzrwUhxWAqzAtvJ8HMttUVfdM29YCUMSG7/FYH0Ag6deOfE0jsUSE8KsvdtAFehYfDoEf5FgU3v1wnzwc0SAlI+PTB8zY7MRfJd0DHj3y6cYvrTnkKEAYQ0CF4AnAhFlNr7hrZsAj2C0UcsxAw0Obyq1kOAiQ5GFHAocUQKrGjDygAA7cBfhA6d67QEbGg8eDfj9s2c1s4ceG3C+sm3dskVQC9dLCTJUWG9LHhlK+bvHHRryit5NXF2Lm30Eli6qT80n3Z9ep4RzO6cK9pMGnJ/IzOVLNXur3TVIB6Fax8tahiQC+1sBV2XXpo0MN8OrFK9rm1TCgacg9p8hZUxkZGZ8I+H2AIfoW6dvN6HXL25YeAr8P8AEskFYvQrs19J2Kr8LvLA2cFsnwDy78Q7J8Ab3hcvmUhfu0zsLd1+gDkLu2CVpeO/vSMHAFJuOTaCLiBvHBjz/Ij8BvgpY3fm9swmEBcAYsbLlyX1Wa4WHaz89GSAgIXKy0gHpo/Y67sQLg9wGG6CtHX21Cr1vetvQI8PsAQ/TVt5L+9mpTet3ytqUzMjIGYHTG3uijh5yr0+k6+PvyhJ7PexUU/QIQ9LnA40cWwEPvAhkZGftA/3tFjgqFGDocrRpc0+XV/ahenOIJAAr8ED8qADvbojmAL4BCvUFvX/zuHNsKQMcXlP6IW0AM/V0gUf2PtQVsC3UAp/lmHDv+D/qKcxyg6AblAAAAAElFTkSuQmCC\");}/* positioning */.ui-icon-carat-1-n { background-position: 0 0;}.ui-icon-carat-1-ne { background-position: -16px 0;}.ui-icon-carat-1-e { background-position: -32px 0;}.ui-icon-carat-1-se { background-position: -48px 0;}.ui-icon-carat-1-s { background-position: -64px 0;}.ui-icon-carat-1-sw { background-position: -80px 0;}.ui-icon-carat-1-w { background-position: -96px 0;}.ui-icon-carat-1-nw { background-position: -112px 0;}.ui-icon-carat-2-n-s { background-position: -128px 0;}.ui-icon-carat-2-e-w { background-position: -144px 0;}.ui-icon-triangle-1-n { background-position: 0 -16px;}.ui-icon-triangle-1-ne { background-position: -16px -16px;}.ui-icon-triangle-1-e { background-position: -32px -16px;}.ui-icon-triangle-1-se { background-position: -48px -16px;}.ui-icon-triangle-1-s { background-position: -64px -16px;}.ui-icon-triangle-1-sw { background-position: -80px -16px;}.ui-icon-triangle-1-w { background-position: -96px -16px;}.ui-icon-triangle-1-nw { background-position: -112px -16px;}.ui-icon-triangle-2-n-s { background-position: -128px -16px;}.ui-icon-triangle-2-e-w { background-position: -144px -16px;}.ui-icon-arrow-1-n { background-position: 0 -32px;}.ui-icon-arrow-1-ne { background-position: -16px -32px;}.ui-icon-arrow-1-e { background-position: -32px -32px;}.ui-icon-arrow-1-se { background-position: -48px -32px;}.ui-icon-arrow-1-s { background-position: -64px -32px;}.ui-icon-arrow-1-sw { background-position: -80px -32px;}.ui-icon-arrow-1-w { background-position: -96px -32px;}.ui-icon-arrow-1-nw { background-position: -112px -32px;}.ui-icon-arrow-2-n-s { background-position: -128px -32px;}.ui-icon-arrow-2-ne-sw { background-position: -144px -32px;}.ui-icon-arrow-2-e-w { background-position: -160px -32px;}.ui-icon-arrow-2-se-nw { background-position: -176px -32px;}.ui-icon-arrowstop-1-n { background-position: -192px -32px;}.ui-icon-arrowstop-1-e { background-position: -208px -32px;}.ui-icon-arrowstop-1-s { background-position: -224px -32px;}.ui-icon-arrowstop-1-w { background-position: -240px -32px;}.ui-icon-arrowthick-1-n { background-position: 0 -48px;}.ui-icon-arrowthick-1-ne { background-position: -16px -48px;}.ui-icon-arrowthick-1-e { background-position: -32px -48px;}.ui-icon-arrowthick-1-se { background-position: -48px -48px;}.ui-icon-arrowthick-1-s { background-position: -64px -48px;}.ui-icon-arrowthick-1-sw { background-position: -80px -48px;}.ui-icon-arrowthick-1-w { background-position: -96px -48px;}.ui-icon-arrowthick-1-nw { background-position: -112px -48px;}.ui-icon-arrowthick-2-n-s { background-position: -128px -48px;}.ui-icon-arrowthick-2-ne-sw { background-position: -144px -48px;}.ui-icon-arrowthick-2-e-w { background-position: -160px -48px;}.ui-icon-arrowthick-2-se-nw { background-position: -176px -48px;}.ui-icon-arrowthickstop-1-n { background-position: -192px -48px;}.ui-icon-arrowthickstop-1-e { background-position: -208px -48px;}.ui-icon-arrowthickstop-1-s { background-position: -224px -48px;}.ui-icon-arrowthickstop-1-w { background-position: -240px -48px;}.ui-icon-arrowreturnthick-1-w { background-position: 0 -64px;}.ui-icon-arrowreturnthick-1-n { background-position: -16px -64px;}.ui-icon-arrowreturnthick-1-e { background-position: -32px -64px;}.ui-icon-arrowreturnthick-1-s { background-position: -48px -64px;}.ui-icon-arrowreturn-1-w { background-position: -64px -64px;}.ui-icon-arrowreturn-1-n { background-position: -80px -64px;}.ui-icon-arrowreturn-1-e { background-position: -96px -64px;}.ui-icon-arrowreturn-1-s { background-position: -112px -64px;}.ui-icon-arrowrefresh-1-w { background-position: -128px -64px;}.ui-icon-arrowrefresh-1-n { background-position: -144px -64px;}.ui-icon-arrowrefresh-1-e { background-position: -160px -64px;}.ui-icon-arrowrefresh-1-s { background-position: -176px -64px;}.ui-icon-arrow-4 { background-position: 0 -80px;}.ui-icon-arrow-4-diag { background-position: -16px -80px;}.ui-icon-extlink { background-position: -32px -80px;}.ui-icon-newwin { background-position: -48px -80px;}.ui-icon-refresh { background-position: -64px -80px;}.ui-icon-shuffle { background-position: -80px -80px;}.ui-icon-transfer-e-w { background-position: -96px -80px;}.ui-icon-transferthick-e-w { background-position: -112px -80px;}.ui-icon-folder-collapsed { background-position: 0 -96px;}.ui-icon-folder-open { background-position: -16px -96px;}.ui-icon-document { background-position: -32px -96px;}.ui-icon-document-b { background-position: -48px -96px;}.ui-icon-note { background-position: -64px -96px;}.ui-icon-mail-closed { background-position: -80px -96px;}.ui-icon-mail-open { background-position: -96px -96px;}.ui-icon-suitcase { background-position: -112px -96px;}.ui-icon-comment { background-position: -128px -96px;}.ui-icon-person { background-position: -144px -96px;}.ui-icon-print { background-position: -160px -96px;}.ui-icon-trash { background-position: -176px -96px;}.ui-icon-locked { background-position: -192px -96px;}.ui-icon-unlocked { background-position: -208px -96px;}.ui-icon-bookmark { background-position: -224px -96px;}.ui-icon-tag { background-position: -240px -96px;}.ui-icon-home { background-position: 0 -112px;}.ui-icon-flag { background-position: -16px -112px;}.ui-icon-calendar { background-position: -32px -112px;}.ui-icon-cart { background-position: -48px -112px;}.ui-icon-pencil { background-position: -64px -112px;}.ui-icon-clock { background-position: -80px -112px;}.ui-icon-disk { background-position: -96px -112px;}.ui-icon-calculator { background-position: -112px -112px;}.ui-icon-zoomin { background-position: -128px -112px;}.ui-icon-zoomout { background-position: -144px -112px;}.ui-icon-search { background-position: -160px -112px;}.ui-icon-wrench { background-position: -176px -112px;}.ui-icon-gear { background-position: -192px -112px;}.ui-icon-heart { background-position: -208px -112px;}.ui-icon-star { background-position: -224px -112px;}.ui-icon-link { background-position: -240px -112px;}.ui-icon-cancel { background-position: 0 -128px;}.ui-icon-plus { background-position: -16px -128px;}.ui-icon-plusthick { background-position: -32px -128px;}.ui-icon-minus { background-position: -48px -128px;}.ui-icon-minusthick { background-position: -64px -128px;}.ui-icon-close { background-position: -80px -128px;}.ui-icon-closethick { background-position: -96px -128px;}.ui-icon-key { background-position: -112px -128px;}.ui-icon-lightbulb { background-position: -128px -128px;}.ui-icon-scissors { background-position: -144px -128px;}.ui-icon-clipboard { background-position: -160px -128px;}.ui-icon-copy { background-position: -176px -128px;}.ui-icon-contact { background-position: -192px -128px;}.ui-icon-image { background-position: -208px -128px;}.ui-icon-video { background-position: -224px -128px;}.ui-icon-script { background-position: -240px -128px;}.ui-icon-alert { background-position: 0 -144px;}.ui-icon-info { background-position: -16px -144px;}.ui-icon-notice { background-position: -32px -144px;}.ui-icon-help { background-position: -48px -144px;}.ui-icon-check { background-position: -64px -144px;}.ui-icon-bullet { background-position: -80px -144px;}.ui-icon-radio-off { background-position: -96px -144px;}.ui-icon-radio-on { background-position: -112px -144px;}.ui-icon-pin-w { background-position: -128px -144px;}.ui-icon-pin-s { background-position: -144px -144px;}.ui-icon-play { background-position: 0 -160px;}.ui-icon-pause { background-position: -16px -160px;}.ui-icon-seek-next { background-position: -32px -160px;}.ui-icon-seek-prev { background-position: -48px -160px;}.ui-icon-seek-end { background-position: -64px -160px;}.ui-icon-seek-start { background-position: -80px -160px;}/* ui-icon-seek-first is deprecated, use ui-icon-seek-start instead */.ui-icon-seek-first { background-position: -80px -160px;}.ui-icon-stop { background-position: -96px -160px;}.ui-icon-eject { background-position: -112px -160px;}.ui-icon-volume-off { background-position: -128px -160px;}.ui-icon-volume-on { background-position: -144px -160px;}.ui-icon-power { background-position: 0 -176px;}.ui-icon-signal-diag { background-position: -16px -176px;}.ui-icon-signal { background-position: -32px -176px;}.ui-icon-battery-0 { background-position: -48px -176px;}.ui-icon-battery-1 { background-position: -64px -176px;}.ui-icon-battery-2 { background-position: -80px -176px;}.ui-icon-battery-3 { background-position: -96px -176px;}.ui-icon-circle-plus { background-position: 0 -192px;}.ui-icon-circle-minus { background-position: -16px -192px;}.ui-icon-circle-close { background-position: -32px -192px;}.ui-icon-circle-triangle-e { background-position: -48px -192px;}.ui-icon-circle-triangle-s { background-position: -64px -192px;}.ui-icon-circle-triangle-w { background-position: -80px -192px;}.ui-icon-circle-triangle-n { background-position: -96px -192px;}.ui-icon-circle-arrow-e { background-position: -112px -192px;}.ui-icon-circle-arrow-s { background-position: -128px -192px;}.ui-icon-circle-arrow-w { background-position: -144px -192px;}.ui-icon-circle-arrow-n { background-position: -160px -192px;}.ui-icon-circle-zoomin { background-position: -176px -192px;}.ui-icon-circle-zoomout { background-position: -192px -192px;}.ui-icon-circle-check { background-position: -208px -192px;}.ui-icon-circlesmall-plus { background-position: 0 -208px;}.ui-icon-circlesmall-minus { background-position: -16px -208px;}.ui-icon-circlesmall-close { background-position: -32px -208px;}.ui-icon-squaresmall-plus { background-position: -48px -208px;}.ui-icon-squaresmall-minus { background-position: -64px -208px;}.ui-icon-squaresmall-close { background-position: -80px -208px;}.ui-icon-grip-dotted-vertical { background-position: 0 -224px;}.ui-icon-grip-dotted-horizontal { background-position: -16px -224px;}.ui-icon-grip-solid-vertical { background-position: -32px -224px;}.ui-icon-grip-solid-horizontal { background-position: -48px -224px;}.ui-icon-gripsmall-diagonal-se { background-position: -64px -224px;}.ui-icon-grip-diagonal-se { background-position: -80px -224px;}/* Misc visuals----------------------------------*//* Corner radius */.ui-corner-all, .ui-corner-top, .ui-corner-left, .ui-corner-tl { -moz-border-radius-topleft: 0px; -webkit-border-top-left-radius: 0px; -khtml-border-top-left-radius: 0px; border-top-left-radius: 0px;}.ui-corner-all, .ui-corner-top, .ui-corner-right, .ui-corner-tr { -moz-border-radius-topright: 0px; -webkit-border-top-right-radius: 0px; -khtml-border-top-right-radius: 0px; border-top-right-radius: 0px;}.ui-corner-all, .ui-corner-bottom, .ui-corner-left, .ui-corner-bl { -moz-border-radius-bottomleft: 0px; -webkit-border-bottom-left-radius: 0px; -khtml-border-bottom-left-radius: 0px; border-bottom-left-radius: 0px;}.ui-corner-all, .ui-corner-bottom, .ui-corner-right, .ui-corner-br { -moz-border-radius-bottomright: 0px; -webkit-border-bottom-right-radius: 0px; -khtml-border-bottom-right-radius: 0px; border-bottom-right-radius: 0px;}/* Overlays */.ui-widget-overlay { background: #aaaaaa url(\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAoCAYAAACM/rhtAAAAh0lEQVRYhe2UsQ3AIAwEL0zC/qMwhTdJiiCRpH2kfPHu0DUnbN0xxjiZU1U8p/f+ev/Bm7MccAu6ygE0ZzlgrdhRrqqWoKMczB90lQNoznLwuUE3uXRwB08HVZ4OqjwdVHk6qPJ0UOXpoMrTQZWngypPB1WeDqo8HVR5OqjydFDl6aDK7Tt4AWXCW8vnTP6PAAAAAElFTkSuQmCC\") 50% 50% repeat; opacity: .30; filter: Alpha(Opacity = 30);}.ui-widget-shadow { margin: -8px 0 0 -8px; padding: 8px; background: #aaaaaa url(\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAABkCAYAAAD0ZHJ6AAAAe0lEQVRoge3OMQHAIBAAMcC/kjdZJHTI0A4XBdkz86wfO18H3hRUBVVBVVAVVAVVQVVQFVQFVUFVUBVUBVVBVVAVVAVVQVVQFVQFVUFVUBVUBVVBVVAVVAVVQVVQFVQFVUFVUBVUBVVBVVAVVAVVQVVQFVQFVUFVUBVUF8O8A8WdY6opAAAAAElFTkSuQmCC\") 50% 50% repeat-x; opacity: .30; filter: Alpha(Opacity = 30); -moz-border-radius: 8px; -khtml-border-radius: 8px; -webkit-border-radius: 8px; border-radius: 8px;}/*!* jQuery UI Resizable 1.8.21** Copyright 2012, AUTHORS.txt (http://jqueryui.com/about)* Dual licensed under the MIT or GPL Version 2 licenses.* http://jquery.org/license** http://docs.jquery.com/UI/Resizable#theming*/.ui-resizable { position: relative;}.ui-resizable-handle { position: absolute; font-size: 0.1px; display: block;}.ui-resizable-disabled .ui-resizable-handle, .ui-resizable-autohide .ui-resizable-handle { display: none;}.ui-resizable-n { cursor: n-resize; height: 7px; width: 100%; top: -5px; left: 0;}.ui-resizable-s { cursor: s-resize; height: 7px; width: 100%; bottom: -5px; left: 0;}.ui-resizable-e { cursor: e-resize; width: 7px; right: -5px; top: 0; height: 100%;}.ui-resizable-w { cursor: w-resize; width: 7px; left: -5px; top: 0; height: 100%;}.ui-resizable-se { cursor: se-resize; width: 12px; height: 12px; right: 1px; bottom: 1px;}.ui-resizable-sw { cursor: sw-resize; width: 9px; height: 9px; left: -5px; bottom: -5px;}.ui-resizable-nw { cursor: nw-resize; width: 9px; height: 9px; left: -5px; top: -5px;}.ui-resizable-ne { cursor: ne-resize; width: 9px; height: 9px; right: -5px; top: -5px;}/*!* jQuery UI Button 1.8.21** Copyright 2012, AUTHORS.txt (http://jqueryui.com/about)* Dual licensed under the MIT or GPL Version 2 licenses.* http://jquery.org/license** http://docs.jquery.com/UI/Button#theming*/.ui-button { display: inline-block; position: relative; padding: 0; margin-right: .1em; text-decoration: none !important; cursor: pointer; text-align: center; zoom: 1; overflow: visible;}/* the overflow property removes extra width in IE */.ui-button-icon-only { width: 2.2em;}/* to make room for the icon, a width needs to be set here */button.ui-button-icon-only { width: 2.4em;}/* button elements seem to need a little more width */.ui-button-icons-only { width: 3.4em;}button.ui-button-icons-only { width: 3.7em;}/*button text element */.ui-button .ui-button-text { display: block; line-height: 1.4;}.ui-button-text-only .ui-button-text { padding: .4em 1em;}.ui-button-icon-only .ui-button-text, .ui-button-icons-only .ui-button-text { padding: .4em; text-indent: -9999999px; }.ui-button-text-icon-primary .ui-button-text, .ui-button-text-icons .ui-button-text { padding: .4em 1em .4em 2.1em;}.ui-button-text-icon-secondary .ui-button-text, .ui-button-text-icons .ui-button-text { padding: .4em 2.1em .4em 1em;}.ui-button-text-icons .ui-button-text { padding-left: 2.1em; padding-right: 2.1em;}/* no icon support for input elements, provide padding by default */input.ui-button { padding: .4em 1em;}/*button icon element(s) */.ui-button-icon-only .ui-icon, .ui-button-text-icon-primary .ui-icon, .ui-button-text-icon-secondary .ui-icon, .ui-button-text-icons .ui-icon, .ui-button-icons-only .ui-icon { position: absolute; top: 50%; margin-top: -8px;}.ui-button-icon-only .ui-icon { left: 50%; margin-left: -8px;}.ui-button-text-icon-primary .ui-button-icon-primary, .ui-button-text-icons .ui-button-icon-primary, .ui-button-icons-only .ui-button-icon-primary { left: .5em;}.ui-button-text-icon-secondary .ui-button-icon-secondary, .ui-button-text-icons .ui-button-icon-secondary, .ui-button-icons-only .ui-button-icon-secondary { right: .5em;}.ui-button-text-icons .ui-button-icon-secondary, .ui-button-icons-only .ui-button-icon-secondary { right: .5em;}/*button sets*/.ui-buttonset { margin-right: 7px;}.ui-buttonset .ui-button { margin-left: 0; margin-right: -.3em;}/* workarounds */button.ui-button::-moz-focus-inner { border: 0; padding: 0;}/* reset extra padding in Firefox *//*! * jQuery UI Dialog 1.8.21 * * Copyright 2012, AUTHORS.txt (http://jqueryui.com/about) * Dual licensed under the MIT or GPL Version 2 licenses. * http://jquery.org/license * * http://docs.jquery.com/UI/Dialog#theming */.ui-dialog { position: absolute; padding: .2em; width: 300px; overflow: hidden;}.ui-dialog .ui-dialog-titlebar { padding: .4em 1em; position: relative;}.ui-dialog .ui-dialog-title { float: left; margin: .1em 16px .1em 0;}.ui-dialog .ui-dialog-titlebar-close { position: absolute; right: .3em; top: 50%; width: 19px; margin: -10px 0 0 0; padding: 1px; height: 18px;}.ui-dialog .ui-dialog-titlebar-close span { display: block; margin: 1px;}.ui-dialog .ui-dialog-titlebar-close:hover, .ui-dialog .ui-dialog-titlebar-close:focus { padding: 0;}.ui-dialog .ui-dialog-content { position: relative; border: 0; padding: .5em; background: none; overflow: auto; zoom: 1;}.ui-dialog .ui-dialog-buttonpane { text-align: left; border-width: 1px 0 0 0; background-image: none; margin: .5em 0 0 0; padding: .3em 1em .5em .4em;}.ui-dialog .ui-dialog-buttonpane .ui-dialog-buttonset { float: right;}.ui-dialog .ui-dialog-buttonpane button { margin: .5em .4em .5em 0; cursor: pointer;}.ui-dialog .ui-resizable-se { width: 14px; height: 14px; right: 3px; bottom: 3px;}.ui-draggable .ui-dialog-titlebar { cursor: move;}/*!* jQuery UI Tabs 1.8.21** Copyright 2012, AUTHORS.txt (http://jqueryui.com/about)* Dual licensed under the MIT or GPL Version 2 licenses.* http://jquery.org/license** http://docs.jquery.com/UI/Tabs#theming*/.ui-tabs { position: relative; padding: 0em; zoom: 1;}/* position: relative prevents IE scroll bug (element with position: relative inside container with overflow: auto appear as \"fixed\") */.ui-tabs .ui-tabs-nav { margin: 0; padding: .2em .2em 0;}.ui-tabs .ui-tabs-nav li { list-style: none; float: left; position: relative; top: 1px; margin: 0 .2em 1px 0; border-bottom: 0 !important; padding: 0; white-space: nowrap;}.ui-tabs .ui-tabs-nav li a { float: left; padding: .2em 1em; text-decoration: none;}.ui-tabs .ui-tabs-nav li.ui-tabs-active { margin-bottom: 0; padding-bottom: 1px;}.ui-tabs .ui-tabs-nav li.ui-tabs-active a, .ui-tabs .ui-tabs-nav li.ui-state-disabled a, .ui-tabs .ui-tabs-nav li.ui-tabs-loading a { cursor: text;}.ui-tabs .ui-tabs-nav li a, .ui-tabs.ui-tabs-collapsible .ui-tabs-nav li.ui-tabs-active a { cursor: pointer;}/* first selector in group seems obsolete, but required to overcome bug in Opera applying cursor: text overall if defined elsewhere... */.ui-tabs .ui-tabs-panel { display: block; border-width: 0; padding: 0em 0.1em; background: none;}/*!* jQuery UI Progressbar 1.8.21** Copyright 2012, AUTHORS.txt (http://jqueryui.com/about)* Dual licensed under the MIT or GPL Version 2 licenses.* http://jquery.org/license** http://docs.jquery.com/UI/Progressbar#theming*/.ui-progressbar { height: 4px; text-align: left; overflow: hidden;}.ui-progressbar .ui-progressbar-value { margin: -1px; height: 100%;}.textLineThrough {text-decoration: line-through;color:darkgreen}[id^=registrationGiftDay]{display:none}.speedup:hover{background-position:0px -14px !important}.speedup:active{background-position:0px -28px !important}#city #cityRegistrationGifts {z-index:310;}.empiretooltip {position:static} .empiretooltip div.tooltip-div {display:none !important}.empiretooltip:hover div.tooltip-div {position:fixed !important;z-index:2147483647;display:block !important;white-space:nowrap;}.pirateHighscoreNextCalc .indicator {cursor: pointer;display:inline-block;width:18px;height:16px;background:url(skin/interface/window_control_sprite.png) no-repeat scroll transparent;position:relative;background-position:-72px -1px}.pirateHighscoreNextCalc .indicator:hover {background-position:-72px -20px}.pirateHighscoreNextCalc.active .indicator {background-position:-54px -1px}.pirateHighscoreNextCalc.active .indicator:hover {background-position:-54px -20px}#city #cityRegistrationGifts {z-index:310;}");
	};
/************************************************
******************** ikariam ********************
************************************************/
	var ikariam = {
			_View: null,
			_Host: null,
			_ActionRequest: null,
			_Units: null,
			_BuildingsList: null,
			_AltBuildingsList: null,
			_Nationality: null,
			_GameVersion: null,
			_TemplateView: null,
			_currentCity: null,
			closePopup: function(c) { if (c!==undefined&&c!==null&&c!=='popupMessage') { $('#'+c).remove(); } else { $('#popupMessage').children().remove(); } },
			url: function() { return 'http://' + this.Host() + '/index.php'; },
			get mainView() { return unsafeWindow.ikariam.backgroundView.id; },
			get boxViewParams()
			{
				if(unsafeWindow.ikariam.mainbox_x || unsafeWindow.ikariam.mainbox_y || unsafeWindow.ikariam.mainbox_z)
				{
					return {mainbox_x:unsafeWindow.ikariam.mainbox_x,mainbox_y: unsafeWindow.ikariam.mainbox_y,mainbox_z: unsafeWindow.ikariam.mainbox_z};
				}
				return {};
			},
			loadUrl: function(ajax, mainView, params)
			{
				mainView = mainView || ikariam.mainView;
				var paramList = {cityId: ikariam.CurrentCityId};
				if(ikariam.CurrentCityId !== params.cityId)
				{
					paramList.action = 'header';
					paramList.function = 'changeCurrentCity';
					paramList.actionRequest = unsafeWindow.ikariam.model.actionRequest;
					paramList.currentCityId = ikariam.CurrentCityId;
					paramList.oldView = ikariam.mainView;
				}
				if(mainView !== undefined && mainView !== ikariam.mainView)
				{
					paramList.oldBackgroundView = ikariam.mainView;
					paramList.backgroundView = mainView;
					ajax = false;
				}
				$.extend(paramList, params);
				if(ajax)
				{
					gotoAjaxURL('?'+$.map(paramList,function(value,key){return key+'='+value;}).join('&'));
				}
				else
				{
					gotoURL(ikariam.url()+'?'+$.map(paramList,function(value, key){return key+'='+value;}).join('&'));
				}
				function gotoURL(url)
				{
					window.location.assign(url);
				}
				function gotoAjaxURL(url)
				{
					document.location = 'javascript:ajaxHandlerCall(' + JSON.stringify(url) + '); void(0);';
				}
			},
			Host: function()
			{
				if(this._Host == null)
				{
					this._Host = '';
					this._Host = document.location.host;
				}
				return this._Host;
			},
			Server: function(host)
			{
				if(this._Server == null)
				{
					if(host == undefined)
					{
						host = this.Host();
					}
					this._Server = '';
					var parts = host.split('.');
					this._Server = parts[0].split('-')[0];
				}
				return this._Server;
			},
			Language: function(host)
			{
				if(this._Language == null)
				{
					if(host == undefined)
					{
						host = this.Host();
					}
					this._Language = '';
					var parts = host.split('.');
					this._Language = parts[0].split('-')[1];
				}
				if ((this._Language == 'us') || (this._Language == 'de') || (this._Language == 'dk')) { this._Language = 'en'; }
				if (this._Language == 'gr') { this._Language = 'el'; GM_addStyle('#js_worldMapLink > a {white-space: nowrap;font-size:85%');}
				return this._Language;
			},
			Nationality: function(host)
			{
				if(this._Nationality == null)
				{
					if(host == undefined)
					{
						host = this.Host();
					}
					this._Nationality = '';
					var parts = host.split('.');
					this._Nationality = parts[0].split('-')[1];
				}
				return this._Nationality;
			},
			GameVersion: function()
			{
				if(this._GameVersion == null)
				{
					this._GameVersion = $.trim($('.version').text().split('v')[1]);
				}
				return this._GameVersion;
			},
			get CurrentCityId() { return unsafeWindow.ikariam.backgroundView && unsafeWindow.ikariam.backgroundView.id === 'city' ? ikariam._currentCity || unsafeWindow.ikariam.model.relatedCityData[unsafeWindow.ikariam.model.relatedCityData.selectedCity].id : unsafeWindow.ikariam.model.relatedCityData[unsafeWindow.ikariam.model.relatedCityData.selectedCity].id; },
			get viewIsCity() { return unsafeWindow.ikariam.backgroundView && unsafeWindow.ikariam.backgroundView.id==='city';},
			get viewIsIsland() { return unsafeWindow.ikariam.backgroundView && unsafeWindow.ikariam.backgroundView.id==='island';},
			get viewIsWorld() {return unsafeWindow.ikariam.backgroundView && unsafeWindow.ikariam.backgroundView.id==='worldmap_iso';},
			get getCurrentCity() { return database.cities[ikariam.CurrentCityId]; },
			get getCapital()
			{
				for(var c in database.cities)
				{
					if(database.cities[c].isCapital)
					{
						return database.cities[c];
					}
				}
				return false;
			},
			get getEmbassy()
			{
				for(var c in database.cities)
				{
					if(database.cities[c].isEmbassy)
					{
						return database.cities[c];
					}
				}
				return false;
			},
			get getSafehouse()
			{
				for(var c in database.cities)
				{
					if(database.cities[c].isSafehouse)
					{
						return database.cities[c];
					}
				}
				return false;
			},
			get getBranchOffice()
			{
				for(var c in database.cities)
				{
					if(database.cities[c].isBranchOffice)
					{
						return database.cities[c];
					}
				}
				return false;
			},
			get CurrentTemplateView()
			{
				try { this._CurrentTemplateView = unsafeWindow.ikariam.templateView.id; } catch(e) { this._CurrentTemplateView = null; }
				return this._CurrentTemplateView;
			},
			getLocalizationStrings: function()
			{
				var localStrings = unsafeWindow.LocalizationStrings;
				if(!localStrings)
				{
					$('script').each(function(index, script)
					{
						var match = /LocalizationStrings = JSON.parse\('(.*)'\);/.exec(script.innerHTML);
						if(match)
						{
							localStrings = JSON.parse(match[1]);
							return false;
						}
					});
				}
				var durshorts = {};
				$.extend(durshorts,localStrings.timeunits.short);
				$.each(durshorts,function(name,value)
				{
					database.getGlobalData.addLocalisedString(name.toLowerCase(),value);
				});
				durshorts = null;
			},
			setupEventHandlers: function()
			{
				events('ajaxResponse').sub(function(response)
				{
/*					clearInterval(autocpinterv);
					clearInterval(bUpinterv);
					clearInterval(conversionTimer);
					clearInterval(coolinterv);
					clearInterval(durinterv);
					clearInterval(evtinterv);
					clearInterval(expinterv);
					clearInterval(exptxts);
					clearInterval(foresterinterv);
					clearInterval(foundationinterv);
					clearInterval(giftsinterv);
					clearInterval(interv);
					clearInterval(missionTimer);
					clearInterval(palaceinterv);
					clearInterval(piratesTimer);
					clearInterval(rPointTimer);
					clearInterval(theaterinterv);
					clearInterval(toolinterv);
					clearInterval(upgradeinterv);
					clearInterval(warehouseinterv);
					clearInterval(wonderinterv);
					clearInterval(workshopinterv);
					clearInterval(ytplayerinterv);
*/
					var view, html, data, template;
					var len = response.length;
					var oldCity = this._currentCity;
					while(len)
					{
						len--;
						switch(response[len][0])
						{
							case 'updateGlobalData':
								this._currentCity = parseInt(response[len][1].backgroundData.id);
								var cityData = $.extend({}, response[len][1].backgroundData, response[len][1].headerData);
								var friendData = response[len][1].friends;
								events('updateCityData').pub(this.CurrentCityId, $.extend({}, cityData));
								events('updateBuildingData').pub(this.CurrentCityId, cityData.position);
								break;
							case 'changeView':
								view = response[len][1][0];
								html = response[len][1][1];
								break;
							case 'updateTemplateData':
								template = response[len][1];
								if(unsafeWindow.ikariam.templateView)
								{
									if(unsafeWindow.ikariam.templateView.id == 'researchAdvisor')
									{
										view = unsafeWindow.ikariam.templateView.id;
									}
								}
								break;
							case 'updateBackgroundData':
								oldCity = this.CurrentCityId;
								this._currentCity = parseInt(response[len][1].id);
								events('updateCityData').pub(this._currentCity, $.extend(true, {}, unsafeWindow.dataSetForView, response[len][1]));
								events('updateBuildingData').pub(this._currentCity, response[len][1].position);
								break;
						}
					}
					this.parseViewData(view,html,template);
					if(oldCity !== this.CurrentCityId)
					{
						events('cityChanged').pub(this.CurrentCityId);
					}
				}.bind(ikariam));
				events('formSubmit').sub(function(form)
				{
					var formID = form.getAttribute('id');
					if(!ikariam[formID + 'Submitted'])return false;
					var formSubmission = (function formSubmit()
					{
						var data = ikariam[formID + 'Submitted']();
						return function formSubmitID(response)
						{
							var len = response.length;
							var feedback = 0;
							while(len)
							{
								len--;
								if(response[len][0] == 'provideFeedback')
									feedback = response[len][1][0].type;
							}
							if(feedback == 10)
								ikariam[formID + 'Submitted'](data);
							events('ajaxResponse').unsub(formSubmission);
						};
					})();
					events('ajaxResponse').sub(formSubmission);
				}.bind(ikariam));
				events(Constant.Events.CITYDATA_AVAILABLE).sub(ikariam.FetchAllTowns.bind(ikariam));
			},
			Init: function() { this.setupEventHandlers(); },
			parseViewData:function(view,html,tData)
			{
				var LD = Constant.LanguageData[database.settings.languageChange.value];
				$.each(Object.keys(LD.viewCityMenu),function(k,c)
				{
					$('#js_viewCityMenu > ul > li > div.'+c+' + div.name > span.namebox').text(LD.viewCityMenu[c]);
				});
				if(database.settings.ambrosiaPay.value) { $('#js_viewCityMenu ul.menu_slots li[onclick*="view=premiumTrader"]').hide(); }
				if(typeof(bUpinterv)!='undefined') { clearInterval(bUpinterv); }
				var citymenu = '';
				$.each(database.settings.cityOrder.value,function(k,c)
				{
					citymenu += $('#dropDown_js_citySelectContainer > div.bg > ul > li[selectvalue="'+c+'"]').prop('outerHTML');
				});
				$('#dropDown_js_citySelectContainer > div.bg > ul').empty().append(citymenu);
//				$('[id^="empire_researchAdvisorPoints"], [id^="empire_researchAdvisorCurrResearchCosts"], [id^="researchAdvisorCurrResearchCostsPercentage"], [id^="empire_researchAdvisorCurrResearchPointsNotEnough"], [id^="empire_researchAdvisorCurrResearchTimeNeeded"], [id^="empire_researchAdvisorProgressTxt"]').remove();
				$.each($('#dropDown_js_citySelectContainer > div.bg > ul > li'),function(k,c)
				{
					$(c).removeClass('first-child last-child');
					$(c).addClass(k==0? 'first-child':(k==database.settings.cityOrder.value.length-1?'last-child':''));
				});
				$('[id^="registrationGiftDay"]').hide();
				if(view!==undefined)
				{
					if(ikariam.mainView=='city')
					{
						$('#'+view).css('right',(-$('#'+view).width())+'px');
						$('#'+view+'_c').css({'left':'auto','right':($('#'+view).width()+60)+'px'});
						$('#container .templateView:after').css('left',(parseInt($('#'+view).css('left').replace('px',''))+10)+'px');
						$('#container .templateView:before').css('left',(parseInt($('#'+view).css('left').replace('px',''))+10)+'px');
					}
				}
				var pos = isNaN(parseInt(unsafeWindow.ikariam.model.advisorData.cities.link.split('position=')[1]))? -1 : parseInt(unsafeWindow.ikariam.model.advisorData.cities.link.split('position=')[1]);
				var city = ikariam.getCurrentCity;
//				console.log(unsafeWindow.dataSetForView.branchOfficeResources);
//				console.log(city);
				if(city.isColony) { $('#cityRegistrationGifts').addClass('invisible'); }
				if(city.isCapital && !$('#cityRegistrationGifts').hasClass('invisible'))
				{
					var giftsinterv = setInterval(function()
					{
						$('#cityRegistrationGifts').attr('title',Utils.format(LD.regGiftstxt[14],[Utils.FormatTimeLengthToStr(moment(moment(database.getGlobalData.getRegDate-(moment().utcOffset()*60-unsafeWindow.dataSetForView.serverTimezoneOffset)*1000).startOf('day')+(moment().utcOffset()*60-unsafeWindow.dataSetForView.serverTimezoneOffset)*1000).add(14,'days')-moment(),6),Utils.FormatFullTimeToDateString(moment(moment(database.getGlobalData.getRegDate-(moment().utcOffset()*60-unsafeWindow.dataSetForView.serverTimezoneOffset)*1000).startOf('day')+(moment().utcOffset()*60-unsafeWindow.dataSetForView.serverTimezoneOffset)*1000).add(14,'days'),true)]));
						if($('#cityRegistrationGifts').hasClass('invisible')) { $('#cityRegistrationGifts').removeAttr('title').hide(); clearInterval(giftsinterv); } else { $('#cityRegistrationGifts').css('display',city.isCapital && database.getGlobalData.getGiftsReceived<7 && !($('#cityRegistrationGifts').hasClass('invisible'))?'block':'none'); }
					},1000);
					$('#cityRegistrationGifts').attr('title',Utils.format(LD.regGiftstxt[14],[Utils.FormatTimeLengthToStr(moment(moment(database.getGlobalData.getRegDate-(moment().utcOffset()*60-unsafeWindow.dataSetForView.serverTimezoneOffset)*1000).startOf('day')+(moment().utcOffset()*60-unsafeWindow.dataSetForView.serverTimezoneOffset)*1000).add(14,'days')-moment(),6),Utils.FormatFullTimeToDateString(moment(moment(database.getGlobalData.getRegDate-(moment().utcOffset()*60-unsafeWindow.dataSetForView.serverTimezoneOffset)*1000).startOf('day')+(moment().utcOffset()*60-unsafeWindow.dataSetForView.serverTimezoneOffset)*1000).add(14,'days'),true)]));
					if($('#cityRegistrationGifts').hasClass('invisible')) { $('#cityRegistrationGifts').removeAttr('title').hide(); clearInterval(giftsinterv); } else { $('#cityRegistrationGifts').css('display',city.isCapital && database.getGlobalData.getGiftsReceived<7 && !($('#cityRegistrationGifts').hasClass('invisible'))?'block':'none'); }
				}
				if(city.isColony) { $('#cityRegistrationGifts').addClass('invisible'); clearInterval(giftsinterv); }
				$('tr[id^=resource_]').each(function()
				{
					$(this).find('> td.empireactions > div.transport').css('cursor',parseInt($(this).attr('id').split('_')[1])==city.getId?'default':'pointer').attr('data-tooltip',parseInt($(this).attr('id').split('_')[1])!=city.getId?Utils.format(LD.transporting,[LD[city.isCapital?'capital':'colony'],city._name]):LD.transtip);
				});
				
				var building = pos!=-1 ? city.getBuildingFromPosition(pos) : '';
				if(building!='' && !building.isEmpty)
				{
					if($('#informationSidebar').length==1)
					{
						$('#informationSidebar').parent().prevAll('a.accordionTitle').contents().first()[0].textContent = building.getLevel+building.isUpgrading<=Constant.BuildingData[building.getName].maxLevel?Utils.format(LD.in_level,[building.getLevel+building.isUpgrading+1]):'';
					}
					var ct = $.now();
					if($('#upgradeInProgress').length==1)
					{
						$('#upgradeInProgress').css({'background-position-x':'2%','height':'61px'}).find('div:first > p').text(LD.level).parent().next('div').css('margin-left','-10px').find('p').text(LD.constructing_mine).next('div').css('width','300px');
						$('#buildingSpeedupBuilding').css('right','-309px').attr('title',LD.shortbuildingtime[0]);
						$('#upgradeInProgress > a').attr('title',LD.pirtxt[12]).text(LD.pirtxt[12]);
						$('[id^="upgradeEndTime_"]').remove();
						$('#upgradeCountDown').hide().after('<div class="smallFont" id="upgradeEndTime_'+ct+'" style="position:relative;top:5px">'+Utils.FormatFullTimeToDateString(building.getCompletionTime,false)+'<br>('+Utils.FormatTimeLengthToStr(building.getCompletionTime-moment(),4)+')</div>');
						var bonTime = 1+Constant.GovernmentData[database.getGlobalData.getGovernmentType].buildingTime;
						var buildtime = Constant.BuildingData[building.getName].time;
						buildtime = ((building.getName==Constant.Buildings.PIRATE_FORTRESS?buildtime[building.getLevel]:Math.round(buildtime.a/buildtime.b*Math.pow(buildtime.c,building.getLevel+1)-buildtime.d))-(buildtime.e!=undefined?(buildtime.e[building.getLevel]!=undefined?buildtime.e[building.getLevel]:0):0))*1000*bonTime;
						$('[id^="upgradePercentage_"]').remove();
						$('#upgradeProgress').parent('div').css({'height':'16px'}).after('<div id="upgradePercentage_'+ct+'" style="display:table;margin:0px auto 0px auto;font-weight:bold;text-shadow: -1px -1px 0 #FFFFFF, 1px -1px 0 #FFFFFF, -1px 1px 0 #FFFFFF, 1px 1px 0 #FFFFFF;text-align:center;position:relative;top:-16px;margin-bottom:-18px">'+(Utils.FormatNumToStr((buildtime-(building.getCompletionTime-$.now()))/buildtime*100,false,2)+' %')+'</div>');
						$('#buildingSpeedupBuilding').css('top','-44px');
						var upgradeinterv = setInterval(function()
						{
							var now = moment();
							$('#upgradePercentage_'+ct).text(Utils.FormatNumToStr(building.getCompletionTime>now?(buildtime-(building.getCompletionTime-now))*100/buildtime:100,false,2)+' %');
							$('#upgradeEndTime_'+ct).html(building.getCompletionTime>now?Utils.FormatFullTimeToDateString(building.getCompletionTime,false)+'<br>('+Utils.FormatTimeLengthToStr(building.getCompletionTime-now,4)+')':'&nbsp;<br>&nbsp;');
							$('#buildingSpeedupBuilding').css('top','-44px');
							$('#buildingSpeedupBuilding').attr('title',LD.shortbuildingtime[building.getCompletionTime-now>(buildtime/2)?0:1]);
							if(building.getCompletionTime<now) { clearInterval(upgradeinterv); }
						},1000);
						$('#demolition > h3.header').text(LD.demolitiontxt[0]);
						$('#demolition > div.content > div.warning > h4').text(LD.demolitiontxt[1]);
						$('#demolition > div.content > div.warning > p:first').text(LD.demolitiontxt[2]);
						$('#demolition > div.content > div.warning > p.bold').text(LD.demolitiontxt[3]+':');
						$('#demolition > div.content > div.warning > ul.resources > li').each(function(i,li)
						{
							$(li).attr('title',LD[$(li).attr('class')+'_']).find('span.accesshint').text(LD[$(li).attr('class')+'_']+':');
//							console.log($(li));
							$(li)[0].lastChild.textContent = Utils.FormatNumToStr(parseInt($(li)[0].lastChild.nodeValue.replace(/\D+/g,'')),false,0);
						});
						$('#demolition > div.content > div.warning > div.centerButton > a.button:first').attr('title',LD.demolitiontxt[4]).text(LD.demolitiontxt[4]);
						$('#demolition > div.content > div.warning > div.centerButton > a.button:last').attr('title',LD.demolitiontxt[5]).text(LD.demolitiontxt[5]);
					}
					$('[id^="restable"]').remove();
					var serverTyp = (ikariam.Server()=='s201' || ikariam.Server()=='s202') ? 3 : 1;
					var uConst = building.isUpgrading;
					var rtable = '<table id="restable_{0}" style="width:90%;margin-left:auto;margin-right:auto">';
					var rCost = building.getUpgradeCost;
					var i = 0;
					var z = Object.values(rCost).filter(x=>x==0).length;
					var rC = [ct];
					var sum = [0,0,0];
					$.each(rCost,function(k,r)
					{
						if(k=='time')
						{
							i++;
							rtable += '<tr class="data" style="border-top:1px solid brown"><td style="width:30px;height:26px;line-height:26px;font-weight:bold">&Sigma;</td><td id="curr_total_{0}" style="text-align:right">{'+(3*i-2)+'}</td><td id="diff_total_{0}" class="{'+(3*i-1)+'}" style="text-align:right">{'+(3*i)+'}</td></tr><tr class="total"><td rowspan="2"><img src="skin/resources/icon_time.png" style="height:20px"></td><td id="btime_{0}" colspan="2" style="text-align:center">{'+(3*i+1)+'}</td></tr>';
//							console.log(i,3*i-1);
							rC[3*i-2] = Utils.FormatNumToStr(sum[0],false,0)+(database.settings.quantityLoads.value?'<br>'+Utils.FormatQuantityToLoad(sum[0]):'');
							rC[3*i-1] = sum[2]<0?'red':'green';
							rC[3*i] = (sum[2]<0?'':'<img src="skin/interface/check_mark_17px.png" style="height:12px;"> ')+'('+Utils.FormatNumToStr(sum[sum[2]<0?2:1],false,0)+')'+(database.settings.quantityLoads.value?'<br><span style="color:black">'+Utils.FormatQuantityToLoad(Math.abs(sum[sum[2]<0?2:1]))+'</span>':'');
							rC[3*i+1] = Utils.FormatFullTimeToDateString(r/serverTyp+(!uConst?$.now():building.getCompletionTime),true)+'<br>('+Utils.FormatTimeLengthToStr(r/serverTyp,4)+')';
						}
						else if(r!=0)
						{
							i++;
							rtable += '<tr class="data"><td style="background:url(\'skin/resources/icon_'+k+'.png\') no-repeat 4px 2px;width:30px;height:26px;line-height:26px"></td><td id="curr_'+k+'_{0}" style="text-align:right">{'+(3*i-2)+'}</td><td id="diff_'+k+'_{0}" class="{'+(3*i-1)+'}" style="text-align:right">{'+(3*i)+'}</td></tr>';
							var c = building.city().getResource(k).getCurrent;
							var diff = c-r;
							sum[0] += r;
							sum[diff<0?2:1] += diff;
							rC[3*i-2] = Utils.FormatNumToStr(r,false,0)+(database.settings.quantityLoads.value?'<br>'+Utils.FormatQuantityToLoad(r):'');
							rC[3*i-1] = diff<0?'red':'green';
							rC[3*i] = (diff<0?'':'<img src="skin/interface/check_mark_17px.png" style="height:12px;"> ')+'('+Utils.FormatNumToStr(diff,false,0)+')'+(database.settings.quantityLoads.value?'<br><span style="color:black">'+Utils.FormatQuantityToLoad(Math.abs(diff))+'</span>':'');
						}
//						console.log(k,r);
					});
					rtable += '</table>';
//					console.log(building.isMaxLevel,building.getLevel,Constant.BuildingData[building.getName].maxLevel,uConst);
					$('#sidebarWidget > li:nth-child(1) > a').html(LD.upgrade);
					$('#js_buildingUpgradeButton > span').html($('#js_buildingUpgradeButton').hasClass('disabled')?'':(unsafeWindow.ikariam.model.advisorData.hasPremiumAccount?(building.city().isUpgrading?LD.inqueue:LD.upgrade):LD.upgrade));
					$('#buildingUpgrade').parent().css({'padding':'5px 0px 0px 0px'});
					$('#buildingUpgrade > div > ul > li.downgrade > a > span').html(LD.downgrade);
					$('#js_buildingUpgradeButton').attr('title',LD[$('#js_buildingUpgradeButton').hasClass('disabled')?'upbtntitle':(unsafeWindow.ikariam.model.advisorData.hasPremiumAccount?(building.city().isUpgrading?'qubtntitle':'upgrade'):'upgrade')]);
					$('#buildingUpgrade > div > ul > li.downgrade > a').attr('title',LD.downbtntitle[$('#buildingUpgrade > div > ul > li.downgrade > a').hasClass('disabled')?0:1]);
					$('#buildingUpgrade > div > ul > li.showLevel > div').html(LD.level);
					$('#buildingUpgrade > h4').html(building.isMaxLevel||(building.getLevel==Constant.BuildingData[building.getName].maxLevel-1 && uConst)?LD[!uConst?'max_Level_complete':'max_Level_tocomplete']:(LD.next_Level+' '+(building.getLevel+(uConst?2:1))));
					if(typeof(bUpinterv)!='undefined') { clearInterval(bUpinterv); }
					if(!(building.isMaxLevel!==(building.getLevel==Constant.BuildingData[building.getName].maxLevel-1 && uConst)))
					{
						if($('#buildingUpgrade').length==1)
						{
							$('#restable_'+ct).remove();
							var ArC = rC;
							var bUpinterv = setInterval(function()
							{
								var i = 0;
								var sum = [0,0,0];
								$.each(rCost,function(k,r)
								{
									if(k=='time')
									{
										i++;
//										console.log(i,3*i-1);
										ArC[3*i-1] = sum[2]<0?'red':'green';
										ArC[3*i] = (sum[2]<0?'':'<img src="skin/interface/check_mark_17px.png" style="height:12px;"> ')+'('+Utils.FormatNumToStr(sum[sum[2]<0?2:1],false,0)+')'+(database.settings.quantityLoads.value?'<br><span style="color:black">'+Utils.FormatQuantityToLoad(Math.abs(sum[sum[2]<0?2:1]))+'</span>':'');
										ArC[3*i+1] = Utils.FormatFullTimeToDateString(r/serverTyp+(!uConst?$.now():building.getCompletionTime),true)+'<br>('+Utils.FormatTimeLengthToStr(r/serverTyp,4)+')';
									}
									else if(r!=0)
									{
										i++;
										var c = building.city().getResource(k).getCurrent;
										var diff = c-r;
										sum[0] += r;
										sum[diff<0?2:1] += diff;
										ArC[3*i-1] = diff<0?'red':'green';
										ArC[3*i] = (diff<0?'':'<img src="skin/interface/check_mark_17px.png" style="height:12px;"> ')+'('+Utils.FormatNumToStr(diff,false,0)+')'+(database.settings.quantityLoads.value?'<br><span style="color:black">'+Utils.FormatQuantityToLoad(Math.abs(diff))+'</span>':'');
									}
								});
								$('td.city_name > span.clickable, td.building > span.clickable, div.city, div.temple, div.pirates, div.spies, div.barracks, div.shipyard, div#HelpTab > span[id^="help"], span.happy, span.growth, span.scientists, [id^="position"], #dropDown_js_citySelectContainer, #js_buildingUpgradeButton').on('click',function(){clearInterval(bUpinterv);});
								if($('[id^="restable"]').attr('id')!=undefined && parseInt($('[id^="restable"]').attr('id').replace(/\D+/g,''))>rC[0]){$('[id^="restable"]').remove(); clearInterval(bUpinterv);}
								$('#rtblcontainer').empty().html(Utils.format(rtable,ArC));
							},1000);
							$('#buildingUpgrade > ul').hide().after('<div id="rtblcontainer">'+Utils.format(rtable,ArC)+'</div>');
							var whtxt, dumptxt = '';
							$.each(city.getBuildings,function(k,bld)
							{
								if(bld.getName==Constant.Buildings.WAREHOUSE)
								{
									whtxt = '<a class="bold" onclick="ajaxHandlerCall(this.href); return false;" href="?view=city&amp;cityId='+bld.getUrlParams.cityid+'&amp;dialog=warehouse&amp;position='+bld.getUrlParams.position+'">{0}</a>';
									return false;
								}
							});
							$.each(city.getBuildings,function(k,bld)
							{
								if(bld.getName==Constant.Buildings.DUMP)
								{
									dumptxt = '<a class="bold" onclick="ajaxHandlerCall(this.href); return false;" href="?view=city&amp;cityId='+bld.getUrlParams.cityid+'&amp;dialog=dump&amp;position='+bld.getUrlParams.position+'">{0}</a>';
								}
							});
							var NotEnCap = '';
							if(whtxt!='' && dumptxt=='')
							{
								NotEnCap = Utils.format(LD.notEnCap[1],[Utils.format(whtxt,[LD.warehouse])]);
							}
							else if(whtxt=='' && dumptxt!='')
							{
								NotEnCap = Utils.format(LD.notEnCap[2],[Utils.format(dumptxt,[LD.dump])]);
							}
							else if(whtxt!='' && dumptxt!='')
							{
								NotEnCap = Utils.format(LD.notEnCap[3],[Utils.format(whtxt,[LD.warehouse]),Utils.format(dumptxt,[LD.dump])]);
							}
							$('#buildingUpgrade').find('div.red_box > a.bold').remove();
							$('#buildingUpgrade').find('div.red_box > div.red').text(LD.notEnCap[0]).after(NotEnCap);
						}
					}
					// Utils.format(rtable,['{0}','{1}','{2}','{3}','{4}','{5}','{6}','{7}','{8}'])
/*					var uConst = building.isUpgrading;
					var resourceCost = building.getUpgradeCost;
					var serverTyp = (ikariam.Server()=='s201' || ikariam.Server()=='s202') ? 3 : 1;
					var elem, nelem = '';
					var time, ntime = '';
					var ctime = 0;
					var needlevel = 0;
					var costlevel = 0;
//					console.log(building);
					ctime = Constant.BuildingData[building.getName].time;
					ctime = Math.round(ctime.a / ctime.b * Math.pow(ctime.c, building.getLevel + 1) - ctime.d) * 1000;
					needlevel = building.getLevel + 2;
					costlevel = building.getLevel + 1;
					var restable = '';
					var sum = [0,0,0];
					for(var key in resourceCost)
					{
						if(key == 'time')
						{
							ntime = '<tr class="total"><td rowspan="2"><img src="skin/resources/icon_time.png" style="height:20px"></td><td id="btime_'+ct+'" colspan="2" style="text-align:center"></td></tr>'
							time = '<tr class="total"><td rowspan="2"><img src="skin/resources/icon_time.png" style="height:20px"></td><td colspan="2" style="text-align:center;">'+Utils.FormatFullTimeToDateString(resourceCost[key]/serverTyp+(!uConst?$.now():building.getCompletionTime),true)+'<br>('+Utils.FormatTimeLengthToStr(resourceCost[key]/serverTyp,4)+')</td></tr>';
							continue;
						}
						if(resourceCost[key])
						{
							var diff = building.city().getResource(key).getCurrent-resourceCost[key];
							sum[0] += resourceCost[key];
							sum[diff>=0?1:2] += diff;
							console.log(sum);
							nelem += '<tr class="data"><td style="background-image:url(skin/resources/icon_'+key+'.png);background-repeat:no-repeat;background-position:4px 2px;width:30px;height:26px;line-height:26px"></td><td id="curr_'+key+'_'+ct+'" style="text-align:right"></td><td id="diff_'+key+'_'+ct+'" style="text-align:right"></td></tr>';
							elem += '<tr class="data"><td style="background-image:url(skin/resources/icon_'+key+'.png);background-repeat:no-repeat;background-position:4px 2px;width:30px;height:26px;line-height:26px"></td><td style="text-align:right">'+Utils.FormatNumToStr(resourceCost[key],false,0)+'</td>';
							elem += '<td class="'+(diff<0?'red':'green')+'" style="text-align:right">'+(diff<0 ? '' : '<img src="skin/interface/check_mark_17px.png" style="height:12px;">')+' ('+Utils.FormatNumToStr(diff,true,0)+')</td></tr>';
						}
					}
					elem = (elem!=='') ? '<table style="width:80%;margin-left:auto;margin-right:auto"><tbody>'+elem+'</tbody><tfoot>'+time+'</tfoot></table>' : '';
					restable = '<table id="restable_'+ct+'" style="width:90%;margin-left:auto;margin-right:auto"><tbody>'+nelem+'<tr class="data" style="border-top:1px solid brown;font-weight:bold"><td style="width:30px;height:26px;line-height:26px">&Sigma;</td><td id="curr_total_'+ct+'" style="text-align:right">'+Utils.FormatNumToStr(sum[0],false,0)+'<br><span style="font-weight:normal;color:black">'+Utils.FormatQuantityToLoad(sum[0])+'</span></td><td id="diff_total_'+ct+'" class="'+(sum[2]<0?'red':'green')+'" style="text-align:right">('+Utils.FormatNumToStr(sum[sum[2]<0?2:1],false,0)+')<br><span style="font-weight:normal;color:black">'+Utils.FormatQuantityToLoad(Math.abs(sum[sum[2]<0?2:1]))+'</span></td></tr></tbody><tfoot>'+ntime+'</tfoot></table>';
					$('#sidebarWidget > li:nth-child(1) > a').html(LD.upgrade);
					$('#js_buildingUpgradeButton > span').html($('#js_buildingUpgradeButton').hasClass('disabled')?'':(unsafeWindow.ikariam.model.advisorData.hasPremiumAccount?(city.isUpgrading?LD.inqueue:LD.upgrade):LD.upgrade));
					if($('#buildingUpgrade').length==1)
					{
						$('#restable_'+ct).remove();
						clearInterval(interv);
						$('#buildingUpgrade > div > ul > li.downgrade > a > span').html(LD.downgrade);
						$('#js_buildingUpgradeButton').attr('title',LD[$('#js_buildingUpgradeButton').hasClass('disabled')?'upbtntitle':(unsafeWindow.ikariam.model.advisorData.hasPremiumAccount?(city.isUpgrading?'qubtntitle':'upgrade'):'upgrade')]);
						$('#buildingUpgrade > div > ul > li.downgrade > a').attr('title',LD.downbtntitle[$('#buildingUpgrade > div > ul > li.downgrade > a').hasClass('disabled')?0:1]);
						$('#buildingUpgrade > div > ul > li.showLevel > div').html(LD.level);
						$('#buildingUpgrade > h4').html(building.isMaxLevel||(building.getLevel==Constant.BuildingData[building.getName].maxLevel-1 && uConst)?LD.max_Level_complete:(LD.next_Level+' '+(building.getLevel+(uConst?2:1))));
						if($('#buildingUpgrade > ul').html()!='') { $('#buildingUpgrade > ul').replaceWith(restable); }
						var remaintime = building.getCompletionTime-$.now();
						var s = 0;
						var interv = setInterval(function()
						{
							var sum = [0,0,0];
							$.each(resourceCost,function(k,r)
							{
								if(building.city().getResource(k)!==undefined)
								{
									var diff = building.city().getResource(k).getCurrent-r;
									sum[0] += r;
									sum[diff<0?2:1] += diff;
									$('#curr_'+k+'_'+ct+', #diff_'+k+'_'+ct).empty();
									$('#curr_'+k+'_'+ct).html(Utils.FormatNumToStr(r/serverTyp,false,0)+'<br><span style="color:black">'+Utils.FormatQuantityToLoad(r/serverTyp)+'</span>');
									$('#diff_'+k+'_'+ct).attr('class',diff<0?'red':diff>0?'green':'').html((diff<0?'':'<img src="skin/interface/check_mark_17px.png" style="height:12px;white-space:nowrap">')+' ('+Utils.FormatNumToStr(diff+city.getResource(k).getProduction*(s/1000),true,0)+')<br><span style="color:black">'+Utils.FormatQuantityToLoad(Math.abs(diff+city.getResource(k).getProduction*(s/1000)))+'</span>');
								}
							});
							$('#curr_total_'+ct+', #diff_total_'+ct).empty();
							$('#curr_total_'+ct).html(Utils.FormatNumToStr(sum[0]/serverTyp,false,0)+'<br><span style="font-weight:normal;color:black">'+Utils.FormatQuantityToLoad(sum[0]/serverTyp)+'</span>');
							$('#diff_total_'+ct).attr('class',sum[2]<0?'red':sum[1]>0?'green':'').html((sum[2]<0?'':'<img src="skin/interface/check_mark_17px.png" style="height:12px;white-space:nowrap">')+' ('+Utils.FormatNumToStr(sum[sum[2]<0?2:1],true,0)+')<br><span style="font-weight:normal;color:black">'+Utils.FormatQuantityToLoad(Math.abs(sum[sum[2]<0?2:1]))+'</span>');
							$('#btime_'+ct).empty();
							$('#btime_'+ct).html(Utils.FormatFullTimeToDateString((!uConst?$.now():building.getCompletionTime)+resourceCost[key]/serverTyp,true)+'<br>('+Utils.FormatTimeLengthToStr(resourceCost[key]/serverTyp,4)+')');
							s++;
						},1000);
						$('#btime_'+ct).empty();
						$('#btime_'+ct).html(Utils.FormatFullTimeToDateString((!uConst?$.now():building.getCompletionTime)+resourceCost[key]/serverTyp,true)+'<br>('+Utils.FormatTimeLengthToStr(resourceCost[key]/serverTyp,4)+')');
						$.each(resourceCost,function(i,x)
						{
							if(building.city().getResource(i)!==undefined)
							{
								var dif = building.city().getResource(i).getCurrent-x;
								$('#curr_'+i+'_'+ct+', #diff_'+i+'_'+ct).empty();
								$('#curr_'+i+'_'+ct).html(Utils.FormatNumToStr(x/serverTyp,false,0)+'<br>'+Utils.FormatQuantityToLoad(x/serverTyp));
								$('#diff_'+i+'_'+ct).attr('class',dif<0?'red':dif>0?'green':'').html((dif<0?'':'<img src="skin/interface/check_mark_17px.png" style="height:12px;white-space:nowrap">')+' ('+Utils.FormatNumToStr(dif,true,0)+')<br>'+Utils.FormatQuantityToLoad(Math.abs(dif)));
							}
						});
					}*/
				}
				events.scheduleAction(function()
				{
					if(moment()>database._globalData._pirates.mission.endtime && database._globalData._pirates.auto[0]==true && $('#pirateFortress').length==0)
					{
						var cid = 0;
						for(var c in database.settings.cityOrder.value) { if(database.getCityFromId(database.settings.cityOrder.value[c]).isPirateFortress) { cid = database.settings.cityOrder.value[c]; break; } }
						cid = database.getCityFromId(ikariam.CurrentCityId).isPirateFortress ? ikariam.CurrentCityId : cid;
						var city = database.getCityFromId(cid);
						var building = city.getBuildingFromName(Constant.Buildings.PIRATE_FORTRESS);
						if(building!=null)
						{
							var params = building.getUrlParams;
							params.activeTab = 'tabBootyQuest';
							params.cityId = city.getId;
							params.position = 17;
							if(ikariam.viewIsIsland)
							{
								params.currentIslandId = ikariam.getCurrentCity.getIslandID;
							}
							ikariam.loadUrl(true,ikariam.mainView,params);
							render.AddCityCSS();
						}
					}
//					console.log('Check');
				},1000);
				if(this.getCurrentCity)
				{
					switch(view)
					{
						case 'registrationGifts':
							this.parseregGifts();
							break;
						case 'abolishCity':
							this.parseabolishCity();
							break;
						case 'ambrosiaFountain':
							this.parseAmbrosiaFountain();
							break;
						case Constant.Buildings.ACADEMY:
							this.parseAcademy(tData);
							break;
						case Constant.Buildings.BLACK_MARKET:
							this.parseBlackMarket(view,html,tData);
							break;
						case Constant.Buildings.WAREHOUSE:
						case Constant.Buildings.DUMP:
							this.parseWarehouse(view,tData);
							break;
						case 'inventory':
							this.parsePremium(tData);
							break;
						case 'avatarDetails':
						case 'avatarProfile':
							this.parsePlayerDetails(view);
							break;
						case 'cinema':
							this.parseTheater(tData);
							break;
						case Constant.Buildings.EMBASSY:
						case 'diplomacyAllyMemberlist':
						case 'diplomacyAllyInfo':
						case 'diplomacyAllySearch':
							this.parseEmbassy(view,tData);
							break;
						case 'finances':
							this.parseFinances($('#finances').find('table.table01 tr').slice(2).children('td'));
							break;
						case 'friendListEdit':
							this.parseInviteFriend();
							break;
						case 'friendListEdit2':
							this.parseFriendList();
							break;
						case 'highscore':
							this.parseHighscore();
							break;
						case Constant.Buildings.SAFEHOUSE:
							this.parseSafehouse(tData);
							break;
						case Constant.Buildings.PIRATE_FORTRESS:
							this.parsePirates(tData);
							break;
						case Constant.Buildings.TOWN_HALL:
							this.parseTownHall(tData);
							break;
						case Constant.Buildings.TRADING_POST:
						case Constant.Buildings.TRADING_POST+'Soldier':
						case Constant.Buildings.TRADING_POST+'TradePartners':
						case Constant.Buildings.TRADING_POST+'OwnOffers':
							this.parseTradingPost(view,tData);
							break;
						case 'takeOffer':
							this.parseTakeOffer(view,html,tData);
							break;
						case Constant.Buildings.WALL:
							this.parseWall(view);
							break;
						case 'militaryAdvisor':
						case 'militaryAdvisorCombatList':
						case 'militaryAdvisorWarList':
							this.parseMilitaryAdvisor(view,html,tData);
							break;
						case 'cityMilitary':
							this.parseCityMilitary();
							break;
						case 'garrisonEdit':
							this.parseDismissUnits(view,tData);
							break;
						case 'tradeAdvisor':
						case 'tradeRoutes':
							this.parsetradeAdvisor(view,tData);
							break;
						case 'researchAdvisor':
						case 'noViewChange':
							this.parseResearchAdvisor(tData);
							break;
						case 'diplomacyAdvisor':
						case 'diplomacyAdvisorOutBox':
						case 'diplomacyAdvisorArchive':
						case 'diplomacyAdvisorArchiveOutBox':
						case 'diplomacyIslandBoard':
						case 'diplomacyTreaty':
						case 'diplomacyAlly':
						case 'diplomacyAdvisorSearchUser':
						case 'ignoreList':
							this.parseDiplomacyAdvisor(view,html,tData);
							break;
						case Constant.Buildings.PALACE:
							this.parsePalace();
							break;
						case 'changeGovernment':
							this.parsechangeGovernment();
							break;
						case Constant.Buildings.GOVERNORS_RESIDENCE:
							this.parseGovResidence();
							break;
						case 'culturalPossessions_assign':
							this.parseCulturalPossessions(html);
							break;
						case Constant.Buildings.MUSEUM:
							this.parseMuseum();
							break;
						case Constant.Buildings.MUSEUM+'Treaties':
							this.parseMuseumTreaties();
							break;
						case Constant.Buildings.TAVERN:
							this.parseTavern();
							break;
						case Constant.Buildings.TRADING_PORT:
							this.parsePort(view,tData);
							break;
//						case 'transport':
//							this.parseTransport(view,html,tData);
						case 'transport':
						case 'plunder':
							this.transportFormSubmitted();
							break;
						case Constant.Buildings.TEMPLE:
							this.parseTemple(view,tData);
							break;
						case 'wonder':
							this.parseWonder(tData);
							break;
						case Constant.Buildings.BARRACKS:
						case Constant.Buildings.SHIPYARD:
							this.parseBarracks(view,html,tData);
							break;
						case 'deployment':
						case 'plunder':
							this.parseMilitaryTransport();
							break;
						case 'sendIKMessage':
							this.parseIKMessage();
							break;
						case 'dailyTasks':
						case 'dailyTasksRewards':
							this.parseDailyTasks(view,tData);
							break;
						case 'tradegood':
						case 'resource':
							this.parseResTradeGood(view,tData);
							break;
						case Constant.Buildings.MARINE_CHART_ARCHIVE:
							this.parseSeaChartArchive(view,tData);
							break;
						case Constant.Buildings.WORKSHOP:
							this.parseWorkshop(view,tData);
							break;
						case 'barbarianVillage':
							this.parsebarbarianVillage();
							break;
						case 'premiumDummy':
							this.parsepremiumDummy();
							break;
						case Constant.Buildings.FORESTER:
						case Constant.Buildings.WINERY:
						case Constant.Buildings.STONEMASON:
						case Constant.Buildings.GLASSBLOWER:
						case Constant.Buildings.ALCHEMISTS_TOWER:
							this.parseprodBuild(view,tData);
							break;
						case Constant.Buildings.CARPENTER:
						case Constant.Buildings.VINEYARD:
						case Constant.Buildings.ARCHITECT:
						case Constant.Buildings.OPTICIAN:
						case Constant.Buildings.FIREWORK_TEST_AREA:
							this.parseReductBuild(view);
							break;
					}
				}
				$('.empiretooltip').each(function(k,elem)
				{
					'mouseenter mouseleave mousemove mouseout mouseover'.split(' ').forEach(function(event)
					{
						elem.addEventListener(event,function(e)
						{
							var target = e.target;
							var t = 0;
							if($(target).parents('.empiretooltip').find('.tooltip-div').length==1)
							{
								t = $(target).parents('.empiretooltip').find('.tooltip-div');
							}
							else if($(target).find('.tooltip-div').length==1)
							{
								t = $(target).find('.tooltip-div');
							}
							else
							{
								t = $(target);
							}
							var top = e.clientY+$(t).outerHeight()+15>$(window).height() ? e.clientY-$(t).outerHeight()-15 : e.clientY+15;
							var left = e.clientX+$(t).outerWidth()+15>$(window).width() ? e.clientX-$(t).outerWidth()+15 : e.clientX-25;
							elem.querySelector('div.tooltip-div').style.top = (top+10>0?top+10:0)+'px';
							elem.querySelector('div.tooltip-div').style.left = (left+10>0?left+10:0)+'px';
							elem.querySelector('div.tooltip-div').style.zIndex = 2147483647;
							document.querySelector('span.info_tip').style.display = e.type=='mouseleave' ? 'block' : 'none';
						},false);
					});
				});
			},
			parsePalace:function()
			{
				var LD = Constant.LanguageData[database.settings.languageChange.value];
//				console.log(LD.palacetxt);
				var city = ikariam.getCurrentCity;
				var governmentType = $('#formOfRuleContent').find('td.government_pic img').attr('src').slice(16,-8);
				var changed = (database.getGlobalData.getGovernmentType != governmentType);
				database.getGlobalData.governmentType = governmentType;
				if(changed) events(Constant.Events.GLOBAL_UPDATED).pub({type:'government'});
				$('[href*="changeGovernment"]').css('display',database.getGlobalData.getResearchTopicLevel(Constant.Research.Science.GOVERNMENT_FORMATION)==0?'none':'inline-block');
				$('#js_mainBoxHeaderTitle').text(LD.palace);
				$('#palace').find('div.buildingDescription > h1').text(LD.palace).next('p').text(LD.palacetxt[0]);
				$('#palace').find('div.buildingDescription + div > h3').text(Utils.format(LD.palacetxt[1],[LD[database.getGlobalData.governmentType]]));
				$('#formOfRuleContent').parent().next('div').find('h3:first').text(LD.palacetxt[2]);
				$('#formOfRuleContent').find('h3.headline').text(LD[database.getGlobalData.governmentType]).next('p').text(LD.palacetxt[3][database.getGlobalData.governmentType]);
				if($('#formOfRuleContent').find('a.button')[0]!=undefined)
				{
					$('#formOfRuleContent').find('a.button')[0].childNodes[2].textContent = LD.palacetxt[4];
				}
				if($('#formOfRuleContent').find('p.anarchy_text')[0]!=undefined)
				{
					$('#formOfRuleContent').find('p.anarchy_text')[0].childNodes[0].textContent = LD.palacetxt[15]+': ';
				}
				var match = $('#anarchyCounter + script').text().match(/getCountdown\((\{[^]*\}\);)/gm);
				if(match)
				{
					match = eval(match[0].replace('getCountdown','').replace(';',''));
					enddate = match.enddate*1000;
					var palaceinterv = setInterval(function()
					{
						$('#empire_anarchyCounter').text(Utils.FormatTimeLengthToStr(enddate-moment(),3));
						if(moment()>enddate) { clearInterval(palaceinterv); }
					},1000);
					$('#anarchyCounter').hide().after('<span id="empire_anarchyCounter">'+Utils.FormatTimeLengthToStr(enddate-moment(),3)+'</span>');
				}
				if($('table.government_effects').length==1)
				{
					$('table.government_effects').find('tr > td:first').html('<b>'+LD.palacetxt[6]+'</b><ul><li style="list-style:disc">'+LD.palacetxt[5][database.getGlobalData.governmentType][0].replace(/\|/g,'</li><li style="list-style:disc">')+'</li></ul>');
					$('table.government_effects').find('tr > td:last').html('<b>'+LD.palacetxt[7]+'</b><ul><li style="list-style:disc">'+LD.palacetxt[5][database.getGlobalData.governmentType][1].replace(/\|/g,'</li><li style="list-style:disc">')+'</li></ul>');
				}
				$('#formOfRuleContent').parent().next('div').next('div').find('h3:first').text(LD.palacetxt[8]);
				$('#formOfRuleContent').parent().next('div').next('div').find('div.content > table > tbody > tr:first').html('<th class="crown"></th><th>'+LD.city+'</th><th>'+LD.level+'</th><th>'+LD.island+'</th><th>'+LD.luxres+'</th><th>'+LD.action+'</th>');
				if($('#formOfRuleContent').parent().next('div').next('div').find('div.content > table > tbody > tr').length==2)
				{
					$('#formOfRuleContent').parent().next('div').next('div').find('div.content > table > tbody > tr:last > td').text(LD.palacetxt[10]);
				}
				$('#formOfRuleContent').parent().next('div').next('div').next('div').find('h3:first').text(LD.palacetxt[9]);
				$('#formOfRuleContent').parent().next('div').next('div').next('div').find('div.content > table > tbody > tr:first').html('<th class="crown"></th><th>'+LD.city+'</th><th>'+LD.level+'</th><th>'+LD.island+'</th><th>'+LD.luxres+'</th><th>'+LD.action+'</th>');
				if($('#formOfRuleContent').parent().next('div').next('div').next('div').find('div.content > table > tbody > tr').length==2)
				{
					$('#formOfRuleContent').parent().next('div').next('div').next('div').find('div.content > table > tbody > tr:last > td').text(LD.palacetxt[11]);
				}
				var citysort = '<tr><th class="crown"></th><th>'+LD.city+'</th><th>'+LD.level+'</th><th>'+LD.palace+'</th><th>'+LD.island+'</th><th>'+LD.luxres+'</th></tr>';
				$.each(database.settings.cityOrder.value,function(k,c)
				{
					citysort += $('#formOfRuleContent').parent().next('div').find('div.content > table > tbody > tr:not(:first) > td.left:contains('+database.cities[c].getName+')').parent().prop('outerHTML')+'\r\n';
				});
				$('#formOfRuleContent').parent().next('div').find('div.content > table > tbody').html(citysort);
				render.toast(Utils.format('{0}: {1} {2} {3} {4}',[LD.updated_,LD.palace,LD.tothe,LD[city.isCapital?'capital':'colony'],LD.leftquot+city._name+LD.rightquot]));
			},
			parsechangeGovernment:function()
			{
				var LD = Constant.LanguageData[database.settings.languageChange.value];
				$('#js_mainBoxHeaderTitle').text(LD.palacetxt[4]);
				$('#changeGovernment').find('div.buildingDescription').html('<h1>'+LD.palacetxt[4]+'</h1><p><b>'+Utils.format(LD.palacetxt[1],[LD[database.getGlobalData.governmentType]])+'</b></p>'+Utils.format(LD.palacetxt[12],[Utils.FormatNumToStr(5e3,false,0),Utils.FormatNumToStr(5e3*database.settings.cityOrder.value.length,false,0),Utils.FormatTimeLengthToStr(18e5),Utils.FormatTimeLengthToStr(18e5*database.settings.cityOrder.value.length)]));
				$('#formOfRuleContent').prev('h3').text(LD.palacetxt[13]);
				$('#formOfRuleContent > table').each(function(k,t)
				{
					var gov = $(t).find('tbody > tr > td > img').attr('src').split('/')[2].split('_')[0];
					$(t).find('tbody > tr:nth-child(1) > td.government_desc > h4').text(LD[gov]).next('p').text(LD.palacetxt[3][gov]);
					if($(t).find('tbody > tr:nth-child(2) > td > div').length==1)
					{
						$(t).find('tbody > tr:nth-child(2) > td > div').addClass('centerButton').find('a')[0].childNodes[2].textContent = LD.palacetxt[4];
					}
					else
					{
						$(t).find('tbody > tr:nth-child(2) > td > p').css('text-align','center').find('b').text(LD.palacetxt[14]);
					}
//					$(t).find('tbody > tr:nth-child(2) > td > div > a')[0].childNodes[2].textContent = LD.palacetxt[4];
					$(t).find('tbody > tr:nth-child(3) > td > table > tbody > tr > td:first').css('vertical-align','top').html('<b>'+LD.palacetxt[6]+'</b><ul><li style="list-style:disc">'+LD.palacetxt[5][gov][0].replace(/\|/g,'</li><li style="list-style:disc">')+'</li></ul>');
					$(t).find('tbody > tr:nth-child(3) > td > table > tbody > tr > td:last').css('vertical-align','top').html('<b>'+LD.palacetxt[7]+'</b><ul><li style="list-style:disc">'+LD.palacetxt[5][gov][1].replace(/\|/g,'</li><li style="list-style:disc">')+'</li></ul>');
				});
				render.toast(Utils.format('{0}',[LD.palacetxt[4]]));
			},
			parseGovResidence:function()
			{
				var LD = Constant.LanguageData[database.settings.languageChange.value];
				var city = ikariam.getCurrentCity;
				$('#js_mainBoxHeaderTitle').html(LD.palaceColony);
				$('#palaceColony').find('div.buildingDescription > h1').text(LD.palaceColony);
				$('#palaceColony').find('div.buildingDescription > p').text(LD.palaceColonytxt[0]);
				$('#palaceColony').find('div.buildingDescription + div > h3').text(LD.palaceColonytxt[1]);
				var citysort = '<thead><tr><th class="crown"></th><th>'+LD.city+'</th><th>'+LD.level+'</th><th>'+LD.palace+'</th><th>'+LD.island+'</th><th>'+LD.luxres+'</th></tr></thead><tbody>';
				$.each(database.settings.cityOrder.value,function(k,c)
				{
					citysort += $('#palaceColony').find('div.buildingDescription + div > div.content > table > tbody > tr > td:contains('+database.cities[c].getName+')').parent().prop('outerHTML');
				});
				$('#palaceColony').find('div.buildingDescription + div > div.content > table').empty().append(citysort+'</tbody>');
				$('#moveCapital').find('h3').text(LD.palaceColonytxt[2]);
				var govres = city.getBuildingFromName(Constant.Buildings.GOVERNORS_RESIDENCE).getLevel;
				console.log(city.getBuildingFromName(Constant.Buildings.GOVERNORS_RESIDENCE).isUpgrading);
				var colonies = Object.keys(database.cities).length-1;
				if(govres>=colonies)
				{
					$('#moveCapital').find('div.content > p').html(LD.palaceColonytxt[3]);
					$('#moveCapital').find('div.content > div.centerButton > a').html(LD.palaceColonytxt[5]);
					$('#moveCapital').find('p.bold.red').text(LD.palaceColonytxt[6]);
				}
				else
				{
					$('#moveCapital').find('div.content > div.warning').html(Utils.format(LD.palaceColonytxt[4],[(colonies-govres)+' '+LD.levelcnt[colonies-govres==1?1:0]]));
				}
				govres = govres + (city.getBuildingFromName(Constant.Buildings.GOVERNORS_RESIDENCE).isUpgrading ? 1 : 0);
				var corr = Math.floor((1-(govres+2)/(Object.keys(database.cities).length))*100)+Constant.GovernmentData[database.getGlobalData.getGovernmentType].corruption*100;
				var corruption = govres>(Object.keys(database.cities).length-1) || corr<=0 ? 0 : (corr>100 ? 100 : corr);
				$('#informationSidebar > div > div').text(function(){return LD.corruption+': '+Utils.FormatNumToStr(-parseInt(corruption),false,0)+' %';});
				render.toast(Utils.format('{0}: {1} {2} {3} {4}',[LD.updated_,LD.palaceColony,LD.tothe,LD[city.isCapital?'capital':'colony'],LD.leftquot+city._name+LD.rightquot]));
			},
			parseCulturalPossessions:function(html)
			{
				var LD = Constant.LanguageData[database.settings.languageChange.value];
				var city = ikariam.getCurrentCity;
				$('#js_mainBoxHeaderTitle').html(LD.museum);
				$('#js_tab_museum > b').html(LD.cultinfo[3]);
				$('#js_tab_museumTreaties > b').html(LD.cultinfo[1]);
				$('#js_tab_culturalPossessions_assign > b').html(LD.cultinfo[4]);
				$('#moveCulturalGoods > h3').html(LD.cultinfo[17]);
				var icons = ['outraged','sad','neutral','happy','ecstatic'];
				$.each(Object.keys(database.cities),function(k,c)
				{
					if(database.cities[c].getBuildingFromName(Constant.Buildings.MUSEUM)!=null)
					{
						$('#slider_city_'+c+'_satisfaction').hide().after('<div id="empire_slider_city_'+c+'_satisfaction" class="'+$('#slider_city_'+c+'_satisfaction').attr('class')+'"></div>');
					}
				});
				$('[id^="js_museum_setmin_city"],[id^="js_museum_setmax_city"]').each(function(i,a)
				{
					var cid = parseInt($(a).attr('id').replace(/\D+/g,''));
					$(a).hide().after('<a class="set'+(i%2==0?'Min':'Max')+'" href="#'+(i%2==0?'reset':'max')+'" id="empire_museum_set'+(i%2==0?'min':'max')+'_city_'+cid+'" title="'+LD.cultinfo[(i%2)+21]+'"></a>');
					$(document).ready(function()
					{
						$('#empire_slider_city_'+cid+'_satisfaction').text(LD.cultinfo[23+icons.indexOf($('#empire_slider_city_'+cid+'_satisfaction').attr('class').replace('satisfaction ',''))]);
						$(document).on('click','#empire_museum_set'+(i%2==0?'min':'max')+'_city_'+cid,function(evt)
						{
							evt.preventDefault();
							$('#textfield_city_'+cid).val(i%2==0?0:parseInt($('#val_change_city_'+cid).text().replace(/\D+/g,''))).trigger('click');
							$('#sliderthumb_city_'+cid).css('left',(i%2==0?10:326)+'px');
							$('#actualValue_city_'+cid).css('clip','rect(0px,'+(i%2==0?18:334)+'px,auto,0px)');
							$('#empire_slider_city_'+cid+'_satisfaction').removeClass('outraged sad neutral happy ecstatic').addClass($('#slider_city_'+cid+'_satisfaction').attr('class').replace('satisfaction ','')).text(LD.cultinfo[23+icons.indexOf($('#empire_slider_city_'+cid+'_satisfaction').attr('class').replace('satisfaction ',''))]);
							$('#moveCulturalGoodsFormError').text(parseInt($('#cgAmount').text())>0?LD.cultinfo[28]:'');
						}).on('change click dblclick drag focusin focusout keydown keypress keyup mousedown mouseenter mouseleave mousemove mouseout mouseover mouseup select textInput','#textfield_city_'+cid+',#sliderthumb_city_'+cid+',#actualValue_city_'+cid,function(evt)
						{
							$('#empire_slider_city_'+cid+'_satisfaction').removeClass('outraged sad neutral happy ecstatic').addClass($('#slider_city_'+cid+'_satisfaction').attr('class').replace('satisfaction ','')).text(LD.cultinfo[23+icons.indexOf($('#empire_slider_city_'+cid+'_satisfaction').attr('class').replace('satisfaction ',''))]);
							$('#moveCulturalGoodsFormError').text(parseInt($('#cgAmount').text())>0?LD.cultinfo[28]:'');
						});
					});
				});
				var max = 0;
				$.each(database.cities,function(k,ct)
				{
					if(ct.getBuildingFromName(Constant.Buildings.MUSEUM)!=null)
					{
						max += parseInt(ct.getCulturalGoods);
						$('#val_change_city_'+ct.getId).html('('+LD.cultinfo[19]+' <span>'+ct.maxculturalgood+'</span>)');
						$('#textfield_city_'+ct.getId).val(ct.getCulturalGoods);
					}
				});
				$('#moveCulturalGoods > div.content > p:first').html(Utils.format(LD.cultinfo[18],[max]));
				$('#moveCulturalGoodsFormSubmit').val(LD.cultinfo[20]);
				var cts = html.match(/iniValue:\s(\d*)/g);
				var changes = [];
				$('#moveCulturalGoods > div.content > ul > li').each(function(k,li)
				{
					var elem = $(li).find('div[id^=sliderbg_city_]');
					if(elem.length)
					{
						var ct = parseInt(cts[k].split(' ')[1]);
						var cityID = parseInt($(elem).attr('id').split('_')[2]);
						database.cities[cityID]._culturalGoods = database.cities[cityID]._culturalGoods!=ct ? ct : database.cities[cityID]._culturalGoods;
						changes.push(cityID);
					}
				});
				if(changes.length) $.each(changes,function(idx,cityID){events(Constant.Events.CITY_UPDATED).pub(cityID,{culturalGoods:true});});
				var citysort = '';
				$.each(database.settings.cityOrder.value,function(k,c)
				{
					if($('#moveCulturalGoodsFormError').prev('ul').find('li > div[id="slider_city_'+c+'_satisfaction"]').length==1)
					{
						citysort += $('#moveCulturalGoodsFormError').prev('ul').find('li > div[id="slider_city_'+c+'_satisfaction"]').parent().prop('outerHTML');
					}
				});
				$('#moveCulturalGoodsFormError').prev('ul').html(citysort);
				render.toast(Utils.format('{0}: {1} {2} {3} {4}',[LD.updated_,LD.cultural,LD.tothe,LD[city.isCapital?'capital':'colony'],LD.leftquot+city._name+LD.rightquot]));
			},
		parseMuseum:function()
		{
			var LD = Constant.LanguageData[database.settings.languageChange.value];
			var city = ikariam.getCurrentCity;
//			console.log(LD.cultinfo);
			$('#js_mainBoxHeaderTitle').html(LD.museum);
			$('#museum').find('div.buildingDescription > h1').text(LD.museum);
			$('#museum').find('div.buildingDescription > p').css({'text-align':'justify','margin':'0px 15px 10px 0px'}).text(LD.cultinfo[29]);
			$('#js_tab_museum > b').html(LD.cultinfo[3]);
			$('#js_tab_museumTreaties > b').html(LD.cultinfo[1]);
			$('#js_tab_culturalPossessions_assign > b').html(LD.cultinfo[4]);
			$('#tab_museum > div.contentBox01h.culturalGoods > h3').html(Utils.format(LD.cultinfo[5],[city.getName]));
			$('#tab_museum > div.contentBox01h.culturalGoods > div.content > p.desc').css('text-align','justify').html(LD.cultinfo[6]);
			$('#tab_museum > div.contentBox01h.culturalGoods > div.content > div > p').html(LD.cultinfo[7]+':'+$('#tab_museum > div.contentBox01h.culturalGoods > div.content > div > p > span').prop('outerHTML'));
			$('#tab_museum > div.contentBox01h.culturalGoods > div.content > p.result').html(Utils.format(LD.cultinfo[8],[Utils.FormatNumToStr(city.maxculturalgood*20+city.getCulturalGoods*50),Utils.FormatNumToStr(city.maxculturalgood*20),Utils.FormatNumToStr(city.getCulturalGoods*50)]));
			for(var i=2;i<=5;i++)
			{
				$('#tab_museum > div:nth-child(2) > div.content > table > tbody > tr:first > th:nth-child('+i+')').html(LD.cultinfo[i+7]);
			}
			var max = 0;
			$.each(database.cities,function(k,city)
			{
				max += parseInt(city.maxculturalgood);
			});
			var page = parseInt($('#tab_museum > div > div.content > div > div.paginator > div > span.page_link').text());
			var pages = parseInt($('#tab_museum > div > div.content > div > div.paginator > div > .page_link:last').text());
			var changed;
			var regText = $('#val_culturalGoodsDeposit').parent().text().match(/(\d+)/g);
			if(regText.length == 2)
			{
				changed = ikariam.getCurrentCity.updateCulturalGoods(parseInt(regText[0]));
			}
			if(changed) events(Constant.Events.CITY_UPDATED).pub(ikariam.CurrentCityId, {culturalGoods: true});
			if(database.settings.ctfinder.value)
			{
				var rows = {};
				rows[page] = $('#tab_museum > div:nth-child(2) > div.content > table > tbody > tr:not(:first)');
				rows[page] = rows[page].length ? rows[page] : null;
				if(rows[page]!=null)
				{
					$.each(rows[page],function(k,tr)
					{
						$(tr).find('a.writeMsg').attr('title',LD.CompMsg).find('img').attr('alt',LD.CompMsg);
						var cCT = $(tr).find('a.cancelTreaty').attr('href').split('=')[3];
						$(tr).find('a.cancelTreaty').attr('title',LD.cultinfo[cCT*0.5-26]).find('img').attr('alt',LD.cultinfo[cCT*0.5-26]);
						$(tr).find('a.cancelTreaty').after('<span style="line-height:20px;font-size:20pt;color:red" title="'+LD.ctrequested[cCT*0.5-39]+'">&#'+(8703-cCT*0.5)+';</span>');
						database.getGlobalData.tempdb['pot'][$(tr).find('a.writeMsg').attr('href').split('=')[2]] = {id:parseInt($(tr).find('a.writeMsg').attr('href').split('=')[2]),name:$(tr).find('td.player.center').text(),alliance:$(tr).find('td.ally.center').text(),capital:$(tr).find('td.capital.center').text(),type:parseInt($(tr).find('a.cancelTreaty').attr('href').split('=')[3])};
					});
					if(page==pages)
					{
						database._globalData._potmuseumTreaties = database.getGlobalData.tempdb['pot'];
						database.getGlobalData.tempdb['pot'] = {};
					}
				}
				else
				{
					database._globalData._potmuseumTreaties = {};
				}
			}
			$('#tab_museum > div:nth-child(2) > div.content > div').attr('style','display: block !important')
			$('#tab_museum > div:nth-child(2) > div.content > table').before($('#tab_museum > div:nth-child(2) > div.content > div').clone().attr('style','display: block !important'));
			$('#tab_museum > div:nth-child(2) > h3').css('height','40px').html(LD.pCTs[Object.keys(database.getGlobalData.getPotMuseumTreaties).length>1?2:(Object.keys(database.getGlobalData.getPotMuseumTreaties).length==1?1:0)]+' '+LD.pCTs[3]+'<br><span class="CTcounter"></span>');
			$('#tab_museum > div:nth-child(2) > h3').find('span.CTcounter').html(Utils.format('({0}: <span style="color:blue">{1}</span>, {2}: <span style="color:green">{3}</span>, {4}: <span style="color:red">{5}</span>, {6}: <span style="color:orange">{7}</span>)',[LD.cultinfo[0],max,LD.cultinfo[1],Object.keys(database.getGlobalData.getMuseumTreaties).length,LD.cultinfo[2],max-Object.keys(database.getGlobalData.getMuseumTreaties).length,LD.cultinfo[3],Object.keys(database.getGlobalData.getPotMuseumTreaties).length]));
			render.toast(Utils.format('{0}: {1}'+(!isNaN(page) && !isNaN(pages) ? ' - {2} {3} / {4}' : ''),[LD.updated_,LD.museum,LD.Page,page,pages]));
		},
		parseMuseumTreaties: function()
		{
			var LD = Constant.LanguageData[database.settings.languageChange.value];
			$('#js_mainBoxHeaderTitle').html(LD.museum);
			$('#js_tab_museum > b').html(LD.cultinfo[3]);
			$('#js_tab_museumTreaties > b').html(LD.cultinfo[1]);
			$('#js_tab_culturalPossessions_assign > b').html(LD.cultinfo[4]);
			$('#tab_museumTreaties > div > h3').html(LD.cultinfo[15]);
			for(var i=1;i<=4;i++)
			{
				$('#tab_museumTreaties > div > div.content > table > tbody > tr:nth-child(1) > th:nth-child('+i+')').html(LD.cultinfo[i+8]);
			}
			var max = 0;
			$.each(database.cities,function(k,city)
			{
				max += parseInt(city.maxculturalgood);
			});
			var page = parseInt($('#tab_museumTreaties > div > div.content > div > div.paginator > div > span.page_link').text());
			var pages = parseInt($('#tab_museumTreaties > div > div.content > div > div.paginator > div > .page_link:last').text());
			if(database.settings.ctfinder.value)
			{
				var rows = {};
				rows[page] = $('#tab_museumTreaties > div > div.content > table > tbody > tr:not(:first)');
				rows[page] = rows[page].length ? rows[page] : null;
				if(rows[page]!=null)
				{
					$.each(rows[page],function(k,tr)
					{
						$(tr).find('a.writeMsg').attr('title',LD.CompMsg).find('img').attr('alt',LD.CompMsg);
						$(tr).find('a.cancelTreaty').attr('title',LD.cultinfo[16]).find('img').attr('alt',LD.cultinfo[16]);
						database.getGlobalData.tempdb['cts'][$(tr).find('a.writeMsg').attr('href').split('=')[2]] = {id:parseInt($(tr).find('a.writeMsg').attr('href').split('=')[2]),name:$.trim($(tr).find('td.player.center').text()),alliance:$(tr).find('td.ally.center').text(),capital:$(tr).find('td.capital.center').text()};
					});
					if(page==pages)
					{
						database._globalData._museumTreaties = database.getGlobalData.tempdb['cts'];
						database.getGlobalData.tempdb['cts'] = {};
					}
				}
				else
				{
					database._globalData._museumTreaties = {};
				}
			}
			$('#tab_museumTreaties > div > div.content > div').attr('style','display: block !important')
			$('#tab_museumTreaties > div > div.content > table').before($('#tab_museumTreaties > div > div.content > div').clone().attr('style','display: block !important'));
			$('#tab_museumTreaties > div > h3').css('height','40px').append('<br><span class="CTcounter"></span>');
			$('#tab_museumTreaties > div > h3').find('span.CTcounter').html(Utils.format('({0}: <span style="color:blue">{1}</span>, {2}: <span style="color:green">{3}</span>, {4}: <span style="color:red">{5}</span>, {6}: <span style="color:orange">{7}</span>)',[LD.cultinfo[0],max,LD.cultinfo[1],Object.keys(database.getGlobalData.getMuseumTreaties).length,LD.cultinfo[2],max-Object.keys(database.getGlobalData.getMuseumTreaties).length,LD.cultinfo[3],Object.keys(database.getGlobalData.getPotMuseumTreaties).length]));
			render.toast(Utils.format('{0}: {1}'+(!isNaN(page) && !isNaN(pages) ? ' - {2} {3} / {4}' : ''),[LD.updated_,LD.cultural,LD.Page,page,pages]));
		},
		parseTavern: function()
		{
			var LD = Constant.LanguageData[database.settings.languageChange.value];
			$('#js_mainBoxHeaderTitle').text(LD.tavern);
			$('#tavern').find('div.buildingDescription > h1').text(LD.tavern);
			$('#tavernDesc > p').text(LD.taverntxt[0]);
			$('#tavern').find('div.buildingDescription + div > h3').text(LD.taverntxt[1]);
			$('#wineAssignForm').find('div.content_left > h4').text(LD.taverntxt[2]);
			$('#wineAssignForm').find('div.content_left > p').css('text-align','justify').text(LD.taverntxt[3]);
			$('#wineAssignForm').find('div.content_left > div.sliderinput > a.setMin').removeAttr('title').addClass('empiretooltip').append('<div class="tooltip-div" style="display:none;text-align:center">'+LD.taverntxt[4]+'</div>');
			$('#wineAssignForm').find('div.content_left > div.sliderinput > a.setMax').removeAttr('title').addClass('empiretooltip').append('<div class="tooltip-div" style="display:none;text-align:center">'+LD.taverntxt[5]+'</div>');
			Utils.waitElem('#sliderbg_wine[title!="slider value = 0"]',slider);
			function slider()
			{
				var city = ikariam.getCurrentCity;
				var vineyard = city.getBuildingFromName(Constant.Buildings.VINEYARD)==null ? 0 : city.getBuildingFromName(Constant.Buildings.VINEYARD).getLevel;
				$('#wineAssignForm > div.content_left > p+div#tavernlevels').remove();
				$('#wineAssignForm > div.content_left > p').after('<div id="tavernlevels" style="text-align:center;font-weight:bold;font-size:12pt"><span id="currlevel" style="color:blue">'+$('#sliderbg_wine').attr('title')+'</span> / '+city.maxtavernlevel+'</div>');
				$('#bonus').parent().css('margin-left','-12px');
				$('#bonus').hide().after('<span id="empire_bonus" class="value headline_big brown vertical_middle">'+Utils.FormatNumToStr(parseInt($('#sliderbg_wine').attr('title'))*60,false,0)+'</span>');
				$('#serve').css('margin-left','90px');
				$('#serve > p')[0].childNodes[3].textContent = ' '+LD.taverntxt[parseInt($('#sliderbg_wine').attr('title'))*60==1?7:6];
//				console.log($('#serve > p'));
				$('#wineAmount > option').each(function(k,li)
				{
					if(k==0)
					{
						$(li).css('text-align','center').text(LD.taverntxt[8]);
					}
					else
					{
						$(li).css('text-align','right').text(function(){return Utils.format(LD.taverntxt[parseInt($(this).text().replace(/\D+/g,''))==1?10:9],[Utils.FormatNumToStr(parseInt($(this).text().replace(/\D+/g,'')),false,0)])});
					}
				});
				$('#dropDown_js_wineAmountContainer > div.bg > ul > li').each(function(k,li)
				{
					$(li).css('border',parseInt($('#sliderbg_wine').attr('title'))==k?'solid 1px #000':'none');
					if(k==0)
					{
						$(li).css('text-align','center').text(LD.taverntxt[8]);
					}
					else
					{
						$(li).css('text-align','right').text(function(){return Utils.format(LD.taverntxt[parseInt($(this).text().replace(/\D+/g,''))==1?10:9],[Utils.FormatNumToStr(parseInt($(this).text().replace(/\D+/g,'')),false,0)])});
					}
				});
				$('#js_wineAmountContainer > span > a').text($('#dropDown_js_wineAmountContainer > div.bg > ul > li[selectvalue="'+$('#sliderbg_wine').attr('title')+'"]').text());
				$('#savedWine').hide().parent().html(LD.taverntxt[11]+' <span id="empire_savedWine">'+Utils.FormatNumToStr(Constant.BuildingData[Constant.Buildings.TAVERN].wineUse[$('#sliderbg_wine').attr('title')]*vineyard/100,false,2)+'</span> '+LD.taverntxt[(Constant.BuildingData[Constant.Buildings.TAVERN].wineUse[$('#sliderbg_wine').attr('title')]*vineyard/100)==1?13:12]);
				$('#citySatisfaction').prev('div').find('input').val(LD.taverntxt[14]);
				$('#serve, #dropDown_js_wineAmountContainer, div.sliderinput').on('focusin click mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave', function()
				{ 
					$('#currlevel').css('color',parseInt($('#sliderbg_wine').attr('title'))==city.tavernlevel?'blue':(parseInt($('#sliderbg_wine').attr('title'))<city.tavernlevel?'green':'red')).text($('#sliderbg_wine').attr('title'));
					$('#empire_bonus').text(Utils.FormatNumToStr(parseInt($('#sliderbg_wine').attr('title'))*60,false,0));
					$('#serve > p')[0].childNodes[3].textContent = ' '+LD.taverntxt[parseInt($('#sliderbg_wine').attr('title'))*60==1?7:6];
					$('#js_wineAmountContainer > span > a').text($('#dropDown_js_wineAmountContainer > div.bg > ul > li[selectvalue="'+$('#sliderbg_wine').attr('title')+'"]').text());
					$('#empire_savedWine').text(Utils.FormatNumToStr(Constant.BuildingData[Constant.Buildings.TAVERN].wineUse[$('#sliderbg_wine').attr('title')]*vineyard/100,false,2));
				});
				render.toast(Utils.format('{0}: {1} {2} {3} {4}',[LD.updated_,LD.tavern,LD.tothe,LD[city.isCapital?'capital':'colony'],LD.leftquot+city._name+LD.rightquot]));
			}
		},
		resTransportObject: function() {return {id:null,wood:0,wine:0,marble:0,glass:0,sulfur:0,gold:0,targetCityId:0,arrivalTime:0,originCityId:0,loadedTime:0,mission:''};},
		troopTransportObject: function() {return {id:null,troops:{},targetCityId:0,arrivalTime:0,originCityId:0,returnTime:0,mission:''};},
		parseBarracks: function(view,html,data)
		{
//			console.log(data);
//			console.log(Object.keys(data).filter((d) => d.startsWith('js_barracksUnitUnitsAvailable')).length);
			var LD = Constant.LanguageData[database.settings.languageChange.value];
			var city = ikariam.getCurrentCity;
			var building = city.getBuildingFromName(view);
//			console.log(building);
			var type = view == Constant.Buildings.BARRACKS ? 'army' : view == Constant.Buildings.SHIPYARD ? 'fleet' : false;
			$('#js_mainBoxHeaderTitle').text(LD[view]);
			$('#buildUnits > div.buildingDescription > h1').text(LD[view]);
			$('#buildUnits > div.buildingDescription > p').css({'text-align':'justify','margin':'0px 15px 10px 0px'}).text(LD.barrackstxt[view == Constant.Buildings.SHIPYARD?27:0]);
			$('#js_barracksOccupyNotice > div').html('<h5>'+LD.barrackstxt[1]+'</h5><p>'+LD.barrackstxt[view == Constant.Buildings.SHIPYARD?28:2]+'</p>');
			$('#selected_units > h3').text(LD.barrackstxt[view == Constant.Buildings.SHIPYARD?29:3]);
			$('#js_noUnitsSelected').text(LD.barrackstxt[view == Constant.Buildings.SHIPYARD?30:4]);
			Utils.waitElem('#accumulatedResourcesCosts',parser);
			function parser()
			{
				var now = moment();
//				console.log($('#accumulatedResourcesCosts').length);
				$('#js_unitCountIcons').css('text-align','center').find('div.floatleft').each(function(k,d)
				{
					var mid = parseInt($(d).find('div:first').attr('class').replace(/\D+/,''));
					$(d).css({'display':'inline-block','float':'none'}).find('div:first').attr('title',LD[Constant.unitIds[mid]]).next('div').text(function(){return Utils.FormatNumToStr($(this).text(),false,0);});
				});
				var ulcontent = '';
				var costs = ['citizens','wood','wine','crystal','sulfur','upkeep','time'];
				var left = [20,90,175,260,345,430,515];
				$('#accumulatedUnitCosts').css({'position':'relative','top':'-8px'});
				$('#accumulatedResourcesCosts > li').each(function(i,li)
				{
					var litxt = $(li).clone(false);
					var multiplier = '1e'+parseInt($(li).text().includes('k') ? 3 : ($(li).text().includes('k') ? 6 : 0));
//					console.log(Utils.FormatTimeLengthToStr(Utils.FormatLocDurToSecs($(li).text()==''?'0s':$(li).text())*1000,6));
//					console.log(Utils.FormatTimeLengthToStr(Utils.FormatLocDurToSecs($(li).text()==''?0:$(li).text())*1000,6));
					var tip = !$(li).hasClass('time') ? parseInt($(li).text().replace(/(\d+)[,.](?=\d{3}(\D|$))/g,'$1'))*multiplier : (Utils.FormatLocDurToSecs($(li).text()==''?'0s':$(li).text())*1000);
					var tiptxt = '';
					switch(costs[i])
					{
						case 'citizens':
							if(tip==0)
							{
								tiptxt = LD.barrackstxt[5];
							}
							else if(tip==1)
							{
								tiptxt = Utils.FormatNumToStr(tip,false,0)+' '+LD.barrackstxt[7];
							}
							else if(tip>1)
							{
								tiptxt = Utils.FormatNumToStr(tip,false,0)+' '+LD.barrackstxt[6];
							}
							break;
						case 'wood':
						case 'wine':
						case 'crystal':
						case 'sulfur':
							if(tip==0)
							{
								tiptxt = LD.barrackstxt[8]+' '+LD.barrackstxt[13][costs[i]];
							}
							else if(tip==1)
							{
								tiptxt = Utils.FormatNumToStr(tip,false,0)+' '+LD.barrackstxt[10]+' '+LD.barrackstxt[13][costs[i]];
							}
							else if(tip>1)
							{
								tiptxt = Utils.FormatNumToStr(tip,false,0)+' '+LD.barrackstxt[9]+' '+LD.barrackstxt[13][costs[i]];
							}
							break;
						case 'upkeep':
							if(tip==0)
							{
								tiptxt = LD.barrackstxt[11];
							}
							else if(tip==1)
							{
								tiptxt = LD.barrackstxt[13][costs[i]]+'<br><b>'+Utils.FormatNumToStr(tip,false,0)+' '+LD.barrackstxt[10]+'</b>';
							}
							else if(tip>1)
							{
								tiptxt = LD.barrackstxt[13][costs[i]]+'<br><b>'+Utils.FormatNumToStr(tip,false,0)+' '+LD.barrackstxt[9]+'</b>';
							}
							break;
						case 'time':
							if(tip==0)
							{
								tiptxt = LD.barrackstxt[view == Constant.Buildings.SHIPYARD?31:12];
//								console.log(tiptxt);
							}
							else if(tip>1)
							{
								tiptxt = (view == Constant.Buildings.SHIPYARD?32:LD.barrackstxt[13][costs[i]])+'<br><b>'+Utils.FormatTimeLengthToStr(tip,6)+'</b>'+'<br>'+LD.barrackstxt[14]+'<br><b>'+Utils.FormatFullTimeToDateString(moment()+tip,6)+'</b>';
//								console.log(tiptxt);
							}
							break;
					}
					$(litxt).attr('id','empire_accumulatedResourcesCosts_'+costs[i]).removeAttr('title').addClass('empiretooltip').css('left',left[i]+'px').append('<div class="tooltip-div" style="display:none;text-align:center">'+tiptxt+'</div>');
					$(litxt)[0].childNodes[0].textContent = costs[i]!='time' ? Utils.FormatNumToStr(tip,false,0) : Utils.FormatTimeLengthToStr(tip,6);
//					console.log($(litxt)[0].childNodes[0].textContent);
//					console.log(tip);
					$(li).hide().after($(litxt).prop('outerHTML'));
//					ulcontent += '<li class="'+c+' '+c+'_inactive empiretooltip">0<div class="tooltip-div">'+LD[c]+'</div></li>';
				});
			}
			$('#button_purchase').css({'position':'relative','top':'18px','text-align':'center'}).find('input').val(LD.barrackstxt[view == Constant.Buildings.SHIPYARD?38:37]);
			$('#premium_btn > h3').text(LD.barrackstxt[15]);
//			console.log(LD.barrackstxt);
			$('#js_citizensPremiumOffer').find('div.tooltip > span, div.amountAndActiveBox > div:first').text('5 '+LD.citizens);
			$('#js_citizensPremiumOffer').find('div.options > div').each(function(i,d)
			{
				$(d).attr('tooltip',(2.5*i*(i+1)+5)+' '+LD.citizens).on('click',function()
				{
					$('#js_citizensPremiumOffer').find('div.tooltip > span, div.amountAndActiveBox > div:first').text($(this).attr('tooltip'));
				});
			});
			$('#premium_btn2 > h3').text(LD.barrackstxt[16]);
			$('#premium_btn2').find('td.left').css('text-align','justify').text(LD.barrackstxt[17]);
			$('#premium_btn2').find('td:not(.left) > a').text(LD.barrackstxt[18]);
			$('#premium_btn2 + div.contentBox01h').find('h3').text(LD.barrackstxt[view == Constant.Buildings.SHIPYARD?33:19]);
			var cat = view == Constant.Buildings.BARRACKS ? 'Units' : view == Constant.Buildings.SHIPYARD ? 'Ships' : false;
			$('#units > li').each(function(i,u)
			{
				var ucn = $(u).attr('class').split(' ')[1];
				var offrank = parseInt($(u).find('[id^="js_barracksOffUpgrade"]').attr('src').replace(/\D+/g,''));
				var defrank = parseInt($(u).find('[id^="js_barracksDefUpgrade"]').attr('src').replace(/\D+/g,''));
//				console.log(ucn,Constant.UnitData[ucn].minlevel);
				$(u).find('[id^="js_barracksOffUpgrade"]').attr('title',isNaN(offrank)||LD.militaryupgrades[cat][ucn.replace('ship_','')]==undefined?'':LD.militaryupgrades[cat][ucn.replace('ship_','')][0][3-offrank]);
				$(u).find('[id^="js_barracksDefUpgrade"]').attr('title',isNaN(defrank)||LD.militaryupgrades[cat][ucn.replace('ship_','')]==undefined?'':LD.militaryupgrades[cat][ucn.replace('ship_','')][1][3-defrank]);
				$(u).find('[id^="js_barracksUnitName"]').text(LD[ucn]);
				$(u).find('a[id^="js_barracksUnitHelp"]').attr('title',Utils.format(LD.barrackstxt[view == Constant.Buildings.SHIPYARD?34:20],[LD[ucn]]));
				$(u).find('[id^="js_barracksUnitUnitsAvailable"]').text(function(){return Utils.FormatNumToStr($(this).text(),false,0);});
				$(u).find('[id^="js_barracksUnitDescription"]').text(LD.unitdescs[ucn]);
				$(u).find('a[class="setMin"]').attr('title',LD.barrackstxt[view == Constant.Buildings.SHIPYARD?35:21]);
				$(u).find('a[class="setMax"]').attr('title',LD.barrackstxt[22]);
				var error = building.isUpgrading ? LD.barrackstxt[39] : (Constant.UnitData[ucn].minlevel>building.getLevel?Utils.format(LD.barrackstxt[40],[Constant.UnitData[ucn].minlevel]):LD.barrackstxt[41]);
				$(u).find('[id^="js_barracksProblemTextfield"]').html(function(){return $(this).text().length>0?error:''});
				$(u).find('a[id^="js_barracksBuyMax"]').attr('title',LD.barrackstxt[22]).text(LD.barrackstxt[23]);
				$(u).find('[id^="js_barracksCosts"] > ul.resources > li').each(function(k,r)
				{
					switch($(r).attr('class'))
					{
						case 'citizens':
							$(r).attr('title',LD[$(r).attr('class')]).find('span.accesshint').text(LD[$(r).attr('class')]);
							$(r)[0].childNodes[1].textContent = Utils.FormatNumToStr(parseInt($(r)[0].childNodes[1].nodeValue.replace(/\D+/,'')),false,0);
							break;
						case 'wood':
						case 'wine':
						case 'glass':
						case 'sulfur':
							$(r).attr('title',LD[$(r).attr('class')+'_']).find('span.accesshint').text(LD[$(r).attr('class')+'_']);
							$(r)[0].childNodes[1].textContent = Utils.FormatNumToStr(parseInt($(r)[0].childNodes[1].nodeValue.replace(/\D+/,'')),false,0);
							break;
						case 'upkeep':
							$(r).attr('title',LD.barrackstxt[24]).find('span.accesshint').text(LD.barrackstxt[25]);
							$(r)[0].childNodes[1].textContent = Utils.FormatNumToStr(parseInt($(r)[0].childNodes[1].nodeValue.replace(/\D+/,'')),false,0);
							break;
						case 'time':
							$(r).attr('title',LD.barrackstxt[view == Constant.Buildings.SHIPYARD?36:26]).find('span.accesshint').text(LD.barrackstxt[view == Constant.Buildings.SHIPYARD?36:26]);
							$(r)[0].childNodes[1].textContent = Utils.FormatTimeLengthToStr(Utils.FormatLocDurToSecs($(r)[0].childNodes[1].nodeValue)*1000,6);
							break;
					}
				});
				database.getGlobalData.updateImprovements(ucn,isNaN(offrank)?0:4-offrank,isNaN(defrank)?0:4-defrank);
			});
			var city = ikariam.getCurrentCity;
			var currentUnits = {};
			var i = Object.keys(data).filter((d) => d.startsWith('js_barracksUnitUnitsAvailable')).length;
			while(i--)
			{
				if(data['js_barracksUnitUnitsAvailable'+(i-1)])
				{
					currentUnits[data['js_barracksUnitClass'+(i-1)]['class'].split(' ').pop()] = parseInt(data['js_barracksUnitUnitsAvailable'+(i-1)].text);
				}
			}
			var changes = city.military.updateUnits(currentUnits);
			var elem = $('#unitConstructionList');
			if(elem.length)
			{
				var tasks = [];
				tasks.push({units:parseUnits(elem.find('> .army_wrapper .army')),completionTime: parseTime($('#buildCountDown').text()),type:type});
				elem.find('div.constructionBlock').each(function()
				{
					tasks.push({units:parseUnits($(this).find('> .army_wrapper .army')),completionTime:parseTime($(this).find('h4 > span').text()),type:type});
				});
				changes = changes.concat(city.military.setTraining(tasks));
			}
			elem = null;
			if(changes.length)
			{
				events(Constant.Events.MILITARY_UPDATED).pub(city.getId, $.exclusive(changes));
			}
			function parseUnits(element)
			{
				var units = {};
				element.each(function()
				{
					units[Constant.unitIds[this.classList.toString().match(/(\d+)/g)]] = parseInt(this.nextElementSibling.textContent.match(/(\d+)/g));
				});
				return units;
			}
			function parseTime(timeText)
			{
				var completionTime = new Date();
				var server = ikariam.Nationality();
				completionTime.setSeconds(completionTime.getSeconds() + (timeText.match(/(\d+)s/) ? parseInt(timeText.match(/(\d+)s/)[1]) : 0));
				completionTime.setMinutes(completionTime.getMinutes() + (timeText.match(/(\d+)m/) ? parseInt(timeText.match(/(\d+)m/)[1]) : 0));
				completionTime.setHours(completionTime.getHours() + (timeText.match(/(\d+)h/) ? parseInt(timeText.match(/(\d+)h/)[1]) : 0));
				completionTime.setDate(completionTime.getDate() + (timeText.match(/(\d+)D/) ? parseInt(timeText.match(/(\d+)D/)[1]) : 0));
				switch(server)
				{
					case 'de':
						completionTime.setDate(completionTime.getDate() + (timeText.match(/(\d+)T/) ? parseInt(timeText.match(/(\d+)T/)[1]) : 0));
						break;
					case 'gr':
						completionTime.setDate(completionTime.getDate() + (timeText.match(/(\d+)M/) ? parseInt(timeText.match(/(\d+)M/)[1]) : 0));
						break;
				}
				return completionTime.getTime();
			}
			var tp = {'army':'troops','fleet':'fleet'};
			render.toast(Utils.format('{0}: {1} {2} {3} {4}',[LD.updated_,LD[tp[type]],LD.tothe,LD[city.isCapital?'capital':'colony'],LD.leftquot+city._name+LD.rightquot]));
		},
		parsePort: function(view,data)
		{
			var LD = Constant.LanguageData[database.settings.languageChange.value];
//			console.log(LD.porttxt);
//			console.log(data);
//			console.log(unsafeWindow);
//			console.log(unsafeWindow.ikariam);
			$('#js_mainBoxHeaderTitle').text(LD[view]);
			$('#port').find('div.buildingDescription > h1').text(LD[view]);
			$('#port').find('div.buildingDescription > p:first').css({'text-align':'justify','margin':'0px 17px 10px 0px'}).text(LD.porttxt[0]);
			$('#js_tabSendTransporter > b').text(LD.porttxt[1]);
			$('#js_tabBuyTransporter > b').text(LD.porttxt[2]);
			$('#js_tabTradeRoutes > b').text(LD.porttxt[3]);
			$('#tabSendTransporter > div:first > h3').text(LD.porttxt[4]);
			$.each(Object.keys(database.cities),function(k,c)
			{
				$('#js_cityBox'+c+',#js_cityBoxLink'+c).attr('title',Utils.format(LD.porttxt[5],[LD[database.getCityFromId(c).isCapital?'capital':'colony'],LD.leftquot+database.getCityFromId(c).getName+LD.rightquot]));
//				console.log(k,c);
			});
			$('#js_noCitiesInfoBox > p').text(LD.porttxt[6]).next('a').text(LD.porttxt[7]);
			$('#tabSendTransporter > div:nth-child(2) > h3').text(LD.porttxt[8]);
			$('ul.cities').css('text-align','center');
			if($('#js_noCitiesInfoBox').css('display')=='none')
			{
				$('[id^="js_cityBox"].cityBox').css({'display':'inline-block','float':'unset','width':'111px','height':'100px'});
				$('[id^="js_cityBoxLink"]').css('background-size','108px 102px');
				$('[id^="js_cityBoxCoords"]').css('top','7px');
				$('[id^="js_cityBoxTradegood"]').css({'top':'10px','right':'21px'});
				var px = [2,-67,-67,-132,-136,-136,-202,-202,-202,-278,-278,-278,-347,-347,-347,-417,-417,-485,-485,-485,-485,-485,-485,-485];
				$('[id^="js_cityBoxLevel"]').css({'background-size':'557px 65px','background-position':(px[parseInt($('[id^="js_cityBoxLevel"]').attr('class').replace(/\D+/,''))-1])+'px','top':'7px','right':'29px'});
				$('[id^="js_cityBoxLevel"] + div.name').css({'top':'77px','left':'8px','width':'90px'});
			}
			var city = ikariam.getCurrentCity;
			Utils.waitElem('#tabSendTransporter > div:nth-child(2) > div.content > table > tbody > tr:not(:first)',portparser);
			function portparser()
			{
//				console.log(unsafeWindow.ikariam);
//				var movs = unsafeWindow.ikariam.TemplateView.viewScripts.militaryAdvisor.militaryMovementsFleetMovements || undefined;
//				if(movs!==undefined)
//				{
//					var filter = movs.currentFilter;
//					var hostile = movs.hostileMissions;
//					var states = movs.missionStates;
//					var missions = movs.missions;
//					var movements = movs.movements;
//					console.log(movs);
//					console.log(filter,hostile,states,missions,movements);
//				}
			}
			var Out = $('#js_noOwnOutgoingShips');
			var For = $('#js_noStrangeOutgoingShips');
			var In = $('#js_noIncomingShips');
			var Rd = $('#js_noPlunderShips');
//			var portmtitles = [['Target','Quantity','Mission','Status'],['','','',''],['Origin','Quantity','Mission','Arrival'],['','','','']];
			var portmtitles = [[LD.porttxt[14],LD.porttxt[15],LD.porttxt[16],LD.porttxt[17]],[LD.porttxt[20],LD.porttxt[21],LD.porttxt[22],LD.porttxt[23]],[LD.porttxt[22],LD.porttxt[23],LD.porttxt[24],LD.porttxt[25]],[LD.porttxt[28],LD.porttxt[29],LD.porttxt[30],LD.porttxt[31]]];
			var txt = '';
			var eids = [];
			var now = moment();
			$('div.tcap').each(function(k,div)
			{
				$(div).text(LD.porttxt[k+9]);
				$(div).next('p:first').text(LD.porttxt[13]);
				if($(div).next('table').length==1)
				{
					var interv = setInterval(function()
					{
						$(div).next('table').find('tbody:first > tr').each(function(k,r)
						{
							if(k>0 && data['js_outgoingOwnCountDown'+(k-1)]!=undefined)
							{
								$('#empire_outgoingOwnCountDownCounter'+(k-1)).html(Utils.FormatTimeLengthToStr(parseInt(data['js_outgoingOwnCountDown'+(k-1)].progressbar.enddate)*1000-moment(),6));
							}
						});
						$('td.city_name > span.clickable, td.building > span.clickable, div.city, div.temple, div.pirates, div.spies, div.barracks, div.shipyard, div#HelpTab > span[id^="help"], span.happy, span.growth, span.scientists, [id^="position"], #dropDown_js_citySelectContainer, #js_buildingUpgradeButton').on('click',function(){clearInterval(interv);});
//						if(moment()>parseInt(data['js_outgoingOwnCountDown'+(k-1)].progressbar.enddate)*1000) { clearInterval(interv); }
					},1000);
					$(div).next('table').find('tbody:first > tr').each(function(i,tr)
					{
						$(tr).children('th,td').each(function(a,td)
						{
							if(i==0)
							{
								$(td).text(portmtitles[k][a]);
							}
							else
							{
								var target = $('#js_outgoingOwnShipName'+(i-1)).text(); // Όνομα πόλης
								var resources = {};
								$('#js_outgoingOwnShipTooltip'+(i-1)+' > table > tbody > tr:not(:first) > td').each(function(b,t)
								{
									if(b%2==0)
									{
										resources[$(t).find('img').attr('src').split('_')[1].split('.')[0]] = parseInt($(t).next('td').text().replace(/(\d+)[,.](?=\d{3}(\D|$))/g,'$1'));
										$(t).css({'width':'30px'}).next('td').css({'float':'left','padding-left':'5px'}).text(Utils.FormatNumToStr(resources[$(t).find('img').attr('src').split('_')[1].split('.')[0]],false,0));
									}
								});
								$('#js_incomingShipTooltip'+(i-1)+' > table > tbody > tr:not(:first) > td').each(function(b,t)
								{
									if(b%2==0)
									{
										$(t).css({'width':'30px'}).next('td').css({'float':'left','padding-left':'5px'}).text(function(){return Utils.FormatNumToStr(parseInt($(this).text().replace(/\D+/g,'')),false,0)});
									}
								});
								var ships = [parseInt($('#js_outgoingOwnShipSet'+(i-1)).text()),parseInt($('#js_incomingShipSet'+(i-1)).text())]; // Πλοία
								$('#js_outgoingOwnShipMission'+(i-1)).text(LD.porttxt[19]);
								$('#js_incomingShipMission'+(i-1)).text(LD.porttxt[19]);
								var countdown = $('#js_outgoingOwnCountDownCounter'+(i-1)).text(); // Χρόνος φόρτωσης
//								var eid = parseInt($('#js_accloading'+(i-1)).attr('href').split('&')[1].split('=')[1]); // Ταυτότητα μετακίνησης
								$('#js_outgoingOwnShipTooltip'+(i-1)+' > table > tbody > tr:first > th:first').text(LD.porttxt[18]);
								$('#js_incomingShipTooltip'+(i-1)+' > table > tbody > tr:first > th:first').text(LD.porttxt[18]);
//								var callback = $('#js_callBackFleet'+(i-1)).text(); // Διακοπή φόρτωσης
							}
						});
						if(i>0 && data['js_outgoingOwnCountDown'+(i-1)]!=undefined && $('#empire_outgoingOwnCountDownCounter'+(i-1)).length==0)
						{
							$('#js_outgoingOwnCountDownCounter'+(i-1)).hide().after('<div class="time" id="empire_outgoingOwnCountDownCounter'+(i-1)+'">'+Utils.FormatTimeLengthToStr(parseInt(data['js_outgoingOwnCountDown'+(i-1)].progressbar.enddate)*1000-now,6)+'</div>');
							$('#js_outgoingOwnShipState'+(i-1)).html(LD.porttxt[20]);
							$('#js_accloading'+(i-1)).attr('title',LD.porttxt[21]);
							$('#js_callBackFleet'+(i-1)).attr('title',LD.porttxt[26]);
						}
						if(i>0 && data['js_incomingShipState'+(i-1)]!=undefined && $('#empire_incomingShipState'+(i-1)).length==0)
						{// js_incomingShipState0
							$('#js_incomingShipState'+(i-1)).html(moment($('#js_incomingShipState'+(i-1)).text(),'HH|mm|ss').format('H:mm:ss'));
						}
					});
				}
			});
//			console.log(data);
			var citysort = '';
			$.each(database.settings.cityOrder.value,function(k,c)
			{
				citysort += $('#js_noCitiesInfoBox').parent().find('li#js_cityBox'+c).length==1 ? $('#js_noCitiesInfoBox').parent().find('li#js_cityBox'+c).prop('outerHTML') : '';
			});
			$('li[id^="js_cityBox"]').remove();
			$('#js_noCitiesInfoBox').before(citysort);
			$('li[id^="js_cityBox"]:eq('+(Math.ceil($('li[id^="js_cityBox"]').length/2)-1)+')').after('<br>');
			$('#tabSendTransporter > div:last > h3').text(LD.porttxt[32]);
			$('#tabSendTransporter > div:last > div.content > p').text(LD.porttxt[33]);
			$('[id^="js_loadingSpeedImgPort"],[id^="js_loadingSpeedPort"]').each(function(i,ld)
			{
				if(i%2==0)
				{
					$(ld).attr('title',function(){return Utils.format(LD.porttxt[34],[$(this).attr('title').replace(/\D+/g,'')]);});
				}
				else
				{
					$(ld).text(function(){return Utils.format(LD.porttxt[35],[Utils.FormatNumToStr($(this).text().replace(/\D+/g,''),false,0)]);});
				}
			});
			$('#js_governmentBonusRow > td > img').attr('title',function(){return Utils.format(LD.porttxt[36],[$(this).attr('title').replace(/\D+/g,'')]);});
			$('#js_governmentBonusValue').text(function(){return Utils.format(LD.porttxt[35],[Utils.FormatNumToStr($(this).text().replace(/\D+/g,''),false,0)]);});
			$('#js_wonderBonusRow > td > img').attr('title',function(){return Utils.format(LD.porttxt[37],[$(this).attr('title').replace(/\D+/g,'')]);});
			$('#js_wonderBonusValue').text(function(){return Utils.format(LD.porttxt[35],[Utils.FormatNumToStr($(this).text().replace(/\D+/g,''),false,0)]);});
			$('#js_loadingSpeedSumValue').text(function(){return Utils.format(LD.porttxt[35],[Utils.FormatNumToStr($(this).text().replace(/\D+/g,''),false,0)]);});
			$('#tabBuyTransporter > div > h3').text(LD.porttxt[38]);
			$('#tabBuyTransporter > div > div > p').text(LD.porttxt[39]);
			$('#tabBuyTransporter > div > div > div > a').attr('title',LD.porttxt[40]);
			$('#tabBuyTransporter > div > div > div > div').removeAttr('title')[0].childNodes[2].textContent = ' / '+180;
			var costs = [...Array(181).keys()].slice(1).map(x => 3*Math.round(4500*Math.pow(1.03,x)-4475));
			var accumulative = [];
			costs.reduce(function(a,b,i) { return accumulative[i] = a+b; },0);
			var allcosts = [];
			for(var i=0;i<180;i++)
			{
				allcosts[i] = [costs[i],accumulative[i],Math.max(...accumulative)-(isNaN(accumulative[i-1])?0:accumulative[i-1])];
			}
			var start = parseInt($('#js_currentBuyableTransporters').text())+1;
			var tip = '<table style="text-align:right;font-size:95%"><tr>';
			for(var i=1;i<=180;i++)
			{
				if(i%30==1) { tip += '<td style="vertical-align:top;background-color:#fae0ae;border: 1px solid #e4b873"><table style="text-align:right">'; }
				tip += '<tr><td style="background-color:#fae0ae'+(i>=start?(i==start?';font-weight:bold':''):';opacity:0.5')+'">'+i+'.</td><td style="background-color:#fae0ae'+(i>=start?(i==start?';font-weight:bold':''):';opacity:0.5')+'"><img src="skin/relatedCities/trade_ship_20.png" style="width:auto;height:10px;display:inline">:</td><td style="background-color:#fae0ae'+(i>=start?(i==start?';font-weight:bold':''):';opacity:0.5')+'"><img src="skin/resources/icon_gold_small.png"></td><td style="text-align:right;background-color:#fae0ae'+(i>=start?(i==start?';font-weight:bold':''):';opacity:0.5')+'">'+Utils.FormatNumToStr(allcosts[i-1][0],false,0)+'</td><td style="text-align:right;background-color:#fae0ae'+(i>=start?(i==start?';font-weight:bold':''):';opacity:0.5')+'">'+Utils.FormatNumToStr(allcosts[i-1][1],false,0)+'</td><td style="text-align:right;background-color:#fae0ae'+(i>=start?(i==start?';font-weight:bold':''):';opacity:0.5')+'">('+Utils.FormatNumToStr(allcosts[i-1][2],false,0)+')</td></tr>';
				if(i%30==0) { tip += '</table></td>'; }
			}
			tip += '</tr></table>';
//			console.log(database.getGlobalData.finance.currentGold);
			$('#js_transporterTooltip').parent().empty().addClass('empiretooltip').append('<div id="empire_transporterTooltip" class="tooltip-div" style="display:none;text-align:center">'+(parseInt($('#js_currentBuyableTransporters').text())<180?tip:LD.porttxt[41])+'</div>');
			$('#js_transporterCosts').prev('span').text(LD.porttxt[42]);
			$('#js_transporterCosts').text(function(){return Utils.FormatNumToStr($(this).text().replace(/\D+/g,''),false,0);});
			if(allcosts[start-1]!=undefined)
			{
				$('#js_buyTransporterWarning').removeClass('bold').html(allcosts[start-1][0]>Math.floor(database.getGlobalData.finance.currentGold) ?Utils.format(LD.porttxt[44],[Utils.FormatNumToStr(allcosts[start-1][0]-Math.floor(database.getGlobalData.finance.currentGold),false,0)]) : '');
			}
			else
			{
				$('#js_buyTransporterWarning').addClass('bold').text(LD.porttxt[45]);
			}
			$('#js_buyTransporterAction').text(LD.porttxt[43]).on('click',function()
			{
				$.ajax(
				{
					success: function()
					{
						if(allcosts[start-1]!=undefined)
						{
							$('#js_buyTransporterWarning').removeClass('bold').html(allcosts[start-1][0]>Math.floor(database.getGlobalData.finance.currentGold) ?Utils.format(LD.porttxt[44],[Utils.FormatNumToStr(allcosts[start-1][0]-Math.floor(database.getGlobalData.finance.currentGold),false,0)]) : '');
						}
						else
						{
							$('#js_buyTransporterWarning').addClass('bold').text(LD.porttxt[45]);
						}
						$('#js_transporterCosts').text(function(){return Utils.FormatNumToStr($(this).text().replace(/\D+/g,''),false,0);});
					}
				});
			});
			$('#js_currentBuyablePhoenicianTransporters').parent().contents().last().each(function(){$(this).replaceWith(' / '+40);});
			var costs = [...Array(41).keys()].slice(1).map(x => (x<5?-3*x+77:(x<17?-2*x+73:-x+57)));
			var accumulative = [];
			costs.reduce(function(a,b,i) { return accumulative[i] = a+b; },0);
			var allcosts = [];
			for(var i=0;i<40;i++)
			{
				allcosts[i] = [costs[i],accumulative[i],Math.max(...accumulative)-(isNaN(accumulative[i-1])?0:accumulative[i-1])];
			}
			var start = parseInt($('#js_currentBuyablePhoenicianTransporters').text())+1;
			var tip = LD.porttxt[46]+'<table style="text-align:right;font-size:80%"><tr>';
			for(var i=1;i<=40;i++)
			{
				if(i%10==1) { tip += '<td style="vertical-align:top;background-color:#fae0ae;border: 1px solid #e4b873"><table style="text-align:right">'; }
				tip += '<tr><td style="background-color:#fae0ae'+(i>=start?(i==start?';font-weight:bold':''):';opacity:0.5')+'">'+i+'.</td><td style="background-color:#fae0ae'+(i>=start?(i==start?';font-weight:bold':''):';opacity:0.5')+'"><img src="skin/relatedCities/phoenician_transporter_small.png" style="width:auto;height:10px;display:inline">:</td><td style="background-color:#fae0ae'+(i>=start?(i==start?';font-weight:bold':''):';opacity:0.5')+'"><img src="skin/resources/icon_gold_small.png"></td><td style="text-align:right;background-color:#fae0ae'+(i>=start?(i==start?';font-weight:bold':''):';opacity:0.5')+'">'+Utils.FormatNumToStr(allcosts[i-1][0],false,0)+'</td><td style="text-align:right;background-color:#fae0ae'+(i>=start?(i==start?';font-weight:bold':''):';opacity:0.5')+'">'+Utils.FormatNumToStr(allcosts[i-1][1],false,0)+'</td><td style="text-align:right;background-color:#fae0ae'+(i>=start?(i==start?';font-weight:bold':''):';opacity:0.5')+'">('+Utils.FormatNumToStr(allcosts[i-1][2],false,0)+')</td></tr>';
				if(i%10==0) { tip += '</table></td>'; }
			}
			tip += '</tr></table>';
			$('#js_phoenicianTransporterTooltip').parent().empty().addClass('empiretooltip').append('<div id="empire_phoenicianTransporterTooltip" class="tooltip-div" style="display:none;text-align:center">'+(parseInt($('#js_currentBuyablePhoenicianTransporters').text())<40?tip:LD.porttxt[58])+'</div>');
			$('#js_phoenicianTransporterCosts').prev('span').text(LD.porttxt[42]);
			$('#js_buyPhoenicianTransporterAction').html(LD.porttxt[47]);
			if(allcosts[start-1]!=undefined)
			{
				$('#js_buyPhoenicianTransporterWarning > a').html(allcosts[start-1][0]>parseInt($('#headlineAmbrosia').text()) ? Utils.format('{0}<br>{1}',[Utils.format(LD.porttxt[allcosts[start-1][0]-parseInt($('#headlineAmbrosia').text())==1?49:48],[allcosts[start-1][0]-parseInt($('#headlineAmbrosia').text())]),LD.porttxt[50]]) : '');
			}
			else
			{
				$('#js_buyPhoenicianTransporterWarning > a').text(LD.porttxt[45]);
			}
			$('#js_buyTransporterAction').text(LD.porttxt[43]).on('click',function()
			{
				$.ajax(
				{
					success: function()
					{
						if(allcosts[start-1]!=undefined)
						{
							$('#js_buyPhoenicianTransporterWarning > a').html(allcosts[start-1][0]>parseInt($('#headlineAmbrosia').text()) ? Utils.format('{0}<br>{1}',[Utils.format(LD.porttxt[allcosts[start-1][0]-parseInt($('#headlineAmbrosia').text())==1?49:48],[allcosts[start-1][0]-parseInt($('#headlineAmbrosia').text())]),LD.porttxt[50]]) : '');
						}
						else
						{
							$('#js_buyPhoenicianTransporterWarning > a').text(LD.porttxt[45]);
						}
						$('#js_transporterCosts').text(function(){return Utils.FormatNumToStr($(this).text().replace(/\D+/g,''),false,0);});
					}
				});
			});
			$('#tabBuyTransporter > div > div.content.buyTransporter > div.tradeShip.phoenician').css('z-index','999');
			$('#tabBuyTransporter > div > div.content.buyTransporter > table > tbody > tr').each(function(k,tr)
			{
				switch(k)
				{
					case 0:
						$(tr).find('th').text(LD.porttxt[51]+':');
						break;
					case 1:
						$(tr).find('td:first > a').text(LD.porttxt[52]);
						break;
					case 2:
						$(tr).find('td:first').attr('title',LD[database.getGlobalData.getGovernmentType]).find('a').text(LD.porttxt[53]);
						break;
					case 3:
						$(tr).find('td:first').attr('title',LD.porttxt[54]).text(LD.porttxt[54]);
						break;
					case 4:
					case 5:
						$(tr).find('th,td:first').text(LD.porttxt[55]+(k==4?':':''));
						break;
					case 6:
						$(tr).find('td:first > a').text(LD.porttxt[56]);
						break;
				}
			});
			$('#tradeRouteBox > h3').text(LD.porttxt[57]);
			$('#tradeRouteBoxContent > p').css('text-align','justify').html(LD.porttxt[59]);
			var serverTimezoneOffset = unsafeWindow.dataSetForView.serverTimezoneOffset;
			var diff = (moment().utcOffset()*60-serverTimezoneOffset)/3600;
			$('[id^="tradeRouteForm"]').each(function(k,r)
			{
				$(r).prev('div').find('div:first').text(LD.porttxt[60]+':');
				$(r).prev('div').find('div:first + div').text(LD.porttxt[61]);
				if($(r).find('div.status > span').hasClass('red'))
				{
					$(r).find('div.status > span').text(LD.porttxt[62]);
					$(r).find('div.renew > a').css({'position':'relative','right':'10px'}).attr('title',LD.porttxt[63]).text(LD.porttxt[63]);
				}
				else if($(r).find('div.status > span').hasClass('green'))
				{
					var dur = $(r).find('div.status > span').text().split(' ').splice(1).join(' ');
					$(r).find('div.status > span').html(Utils.format(LD.porttxt[67],[Utils.FormatTimeLengthToStr(Utils.FormatLocDurToSecs(dur)*1000,3)]));
					$(r).find('div.renew > a').css({'position':'relative','right':'10px'}).attr('title',LD.porttxt[68]).text(LD.porttxt[68]);
				}
				$(r).find('div.orderBtnTraderoute').attr('title',LD.porttxt[63]);
				$(r).find('div.save > input').attr('title',LD.porttxt[64]);
				$(r).find('div.delete > a').attr('title',LD.porttxt[65]);
				if($(r).find('div.extend > input').is(':not(:checked)'))
				{
					$(r).find('div.extend > input').attr('title',LD.porttxt[69]);
					$(r).find('div.extend > div.tooltip').html('<div style="text-align:justify">'+LD.porttxt[70]+'</div>');
					$(r).find('div.extend > span.checkbox_label').text(LD.porttxt[69]);
				}
				else if($(r).find('div.extend > input').is(':checked'))
				{
					$(r).find('div.extend > input').attr('title',LD.porttxt[71]);
					$(r).find('div.extend > div.tooltip').html('<div style="text-align:justify">'+LD.porttxt[72]+'</div>');
					$(r).find('div.extend > span.checkbox_label').text(LD.porttxt[71]);
				}
				$('#tradegood'+k+' > option').each(function(i,op)
				{
					$(op).attr('title',LD[Object.values(Constant.Resources).slice(1)[$(op).attr('value')]+'_']).text(LD[Object.values(Constant.Resources).slice(1)[$(op).attr('value')]+'_']);
					$('#dropDown_js_tradegood'+k+'Container > div.bg > ul > li[selectvalue="'+$(this).attr('value')+'"] > a').text(LD[Object.values(Constant.Resources).slice(1)[$(op).attr('value')]+'_']);
				});
				$('#time'+k+' > option').each(function(i,op)
				{
					$(op).text(function(){return (parseInt($(this).attr('value'))+diff+(parseInt($(this).attr('value'))+diff<0?24:(parseInt($(this).attr('value'))+diff>=24?-24:0)))+':00';});
					$('#dropDown_js_time'+k+'Container > div.bg > ul > li[selectvalue="'+$(this).attr('value')+'"] > a').text((parseInt($(this).attr('value'))+diff+(parseInt($(this).attr('value'))+diff<0?24:(parseInt($(this).attr('value'))+diff>=24?-24:0)))+':00');
					if($(op).is(':selected'))
					{
//						console.log($(op).text());
						$(op).parent().next('span.dropDownButton').find('a').text($(op).text());
					}
				});
				$('#time'+k).html($('#time'+k).find('option').sort(function(x,y) {return $(x).text().padStart(5,'0') > $(y).text().padStart(5,'0') ? 1 : -1;}));
				$('#dropDown_js_time'+k+'Container > div.bg > ul').html($('#dropDown_js_time'+k+'Container > div.bg > ul').find('li').sort(function(x,y) {return $(x).text().padStart(5,'0') > $(y).text().padStart(5,'0') ? 1 : -1;}).removeAttr('class').each(function(a,b){$(b).addClass(a==0? 'first-child':(a==$('#dropDown_js_time'+k+'Container > div.bg > ul').find('li').length-1?'last-child':''));}));
			});
			$('#tradeRouteBox').find('div.centerButton > a').text(LD.porttxt[66]);
			citysort = [];
//			var startval = [];
			$('[id^="tradeRouteStart"],[id^="tradeRouteEnd"]').each(function(k,c)
			{
				var num = parseInt($(c).attr('id').replace(/\D+/g,''));
				var startend = $(c).attr('id').indexOf('Start')!=-1?0:1;
				var fromto = $(c).attr('id').indexOf('Start')!=-1?LD.traderoutestxt[1]:($(c).attr('id').indexOf('End')!=-1?LD.traderoutestxt[2]:null);
//				startval[num] = [];
				citysort[num] = [];
//				startval[num][startend] += $(c).find('option').is(':selected')? $(c).find('option').text() : '';
				citysort[num][startend] = '<option>-- '+(fromto!=null?fromto:'')+' --</option>';
				$.each(database.settings.cityOrder.value,function(i,t)
				{
					citysort[num][startend] += $(c).find('option[value="'+t+'"]').prop('outerHTML');
				});
				$(c).empty().append(citysort[num][startend]);
				if($(c).find('option').is(':selected'))
				{
//					console.log($(c).find('option:selected').text());
					$(c).next('span.dropDownButton').addClass($(c).find('option:selected').attr('class')).find('a').text($(c).find('option:selected').text());
				}
			});
			citysort = '';
			$('[id^="dropDown_js_tradeRoute"]').each(function(k,c)
			{
				var fromto = $(c).attr('id').indexOf('Start')!=-1?LD.traderoutestxt[1]:($(c).attr('id').indexOf('End')!=-1?LD.traderoutestxt[2]:null);
				var citysort = '<li selectvalue="-- '+(fromto!=null?fromto:'')+' --" class="first-child"><a> -- '+(fromto!=null?fromto:'')+' --</a></li>';
				$.each(database.settings.cityOrder.value,function(i,t)
				{
					citysort += $(c).find('div.bg > ul > li[selectvalue="'+t+'"]').prop('outerHTML');
				});
				$(c).find('div.bg > ul').empty().append(citysort);
//				console.log(citysort);
			});
			$('[id^="dropDown_js_tradeRoute"] > div.bg > ul > li').each(function(k,c)
			{
				$(c).removeClass('first-child last-child');
				$(c).addClass(k==0? 'first-child':(k==database.settings.cityOrder.value.length?'last-child':''));
			});
//			console.log(LD.porttxt);
			render.toast(Utils.format('{0}: {1} {2} {3} {4}',[LD.updated_,LD.port,LD.tothe,LD[city.isCapital?'capital':'colony'],LD.leftquot+city._name+LD.rightquot]));
		},
		parseTransport: function(view,html,data)
		{
			// translation
			$('#js_mainBoxHeaderTitle,#mission > div.buildingDescription > h1').html(LD.transprttxt[0]).next('p').html(LD.transprttxt[1]);
			$('#setPremiumTransports > h3').html(LD.transprttxt[2]);
			$('#setPremiumTransports > h3 + div > p.description').css('text-align','justify').html(Utils.format(LD.transprttxt[3],[parseInt($('#js_GlobalMenu_maxTransporters').text())])).next('label').html(LD.transprttxt[2]+':');
			$('#slider_premium_min').attr('title',LD.transprttxt[4]).find('span').html(LD.transprttxt[5]);
			$('#slider_premium_max').attr('title',LD.transprttxt[6]).find('span').html(LD.transprttxt[7]);
			$('#ambrosiaWarningBox').css({'z-index':1,'left':'336px'}).find('a').html(Utils.format(LD.transprttxt[8],['<span id="missingAmbrosia"></span>']));
			$('#premiumTransporterText').html(Utils.format(LD.transprttxt[9],['<span id="ambrosiaCosts" class="ambrosiaIcon" title="'+LD.ambrosia+'">0</span>',parseInt($('#headlineAmbrosia').text())]));
			$('#transportGoods > h3').html(LD.transprttxt[10]).next('div').find('p:first').html(Utils.format(LD.transprttxt[11],['<b>'+ikariam.getCurrentCity.getName+'</b>','<b>'+$('#missionSummary > div > ul > li.journeyTarget').contents().last().text().trim()+'</b>']));
			$('#transportGoods').find('ul.resourceAssign > li').each(function(k,li)
			{
				var res = $(li).attr('class');
				$(li).attr('title',Utils.format(LD.transprttxt[12],[LD.transprttxt[13][res]])).find('label').html(Utils.format(LD.transprttxt[12],[LD.transprttxt[13][res]])+':');
				$('#slider_'+res+'_min').attr('title',LD.transprttxt[14]);
				$('#slider_'+res+'_max').attr('title',LD.transprttxt[15]);
				$('#cargo_'+res+'_minus').attr('title',LD.transprttxt[16]);
				$('#cargo_'+res+'_plus').attr('title',LD.transprttxt[17]);
			});
			$('#transportGoods').find('div.transportersCapacity > h4').html(LD.transprttxt[18]);
			$('#transportGoods').find('div.transportersCapacity > p').attr('title',LD.transprttxt[19]).find('span').attr('title',LD.transprttxt[19]).parent().contents().last().each(function(){$(this).replaceWith(' '+LD.transprttxt[20]);});
			$('#empire_capacitySpeedValue,#empire_summary_capacity,#empire_speedValue,#empire_summary_triton,#empire_summary_wonder,#empire_summary_total,#floorquantities,#empire_loadingTime,#empire_journeyTime,#empire_arrival').remove();
			$('#capacitySpeedValue').hide().after('<span id="empire_capacitySpeedValue" title="'+LD.transprttxt[19]+'">+ '+Utils.FormatNumToStr(0,false,2)+' %</span>');
			$('#summary_capacity').hide().after('<span id="empire_summary_capacity" style="margin-left:30px">+ '+Utils.FormatNumToStr(0,false,2)+' %</span>');
			$('#capacityTextfieldValue').on('DOMNodeInserted DOMNodeRemoved DOMSubtreeModified',function()
			{
				$('#empire_capacitySpeedValue').html('+ '+Utils.FormatNumToStr((500-parseInt($('#capacityTextfieldValue').text()))/6,false,2)+' %');
				$('#empire_summary_capacity').html('+ '+Utils.FormatNumToStr((500-parseInt($('#capacityTextfieldValue').text()))/6,false,2)+' %');
			});
			$('#setPremiumJetPropulsion > h4').html(LD.transprttxt[21]);
			$('#setPremiumJetPropulsion > p:first').attr('title',LD.transprttxt[19]).find('span').attr('title',LD.transprttxt[19]).parent().contents().last().each(function(){$(this).replaceWith(' '+LD.transprttxt[20]);});
			$('#speedValue').hide().after('<span id="empire_speedValue" title="'+LD.transprttxt[19]+'">+ '+Utils.FormatNumToStr(0,false,0)+' %</span>');
			$('#summary_triton').hide().after('<span id="empire_summary_triton" style="margin-left:30px">+ '+Utils.FormatNumToStr(0,false,0)+' %</span>');
			$('#jetTextfieldValue').on('DOMNodeInserted DOMNodeRemoved DOMSubtreeModified',function()
			{
				$('#empire_speedValue').html('+ '+Utils.FormatNumToStr(parseInt($('#jetTextfieldValue').text().replace(/\D+/g,'')),false,0)+' %');
				$('#empire_summary_triton').html('+ '+Utils.FormatNumToStr(parseInt($('#jetTextfieldValue').text().replace(/\D+/g,'')),false,0)+' %');
			});
			$('#summary_wonder').hide().after('<span id="empire_summary_wonder" style="margin-left:30px">+ '+Utils.FormatNumToStr($('#summary_wonder').val()==undefined?0:$('#summary_wonder').val().replace(/[+%]/g,''),false,2)+' %</span>');
			$('#summary_total').hide().after('<span id="empire_summary_total" style="margin-left:30px">+ '+Utils.FormatNumToStr(((500-parseInt($('#capacityTextfieldValue').text()))/6)+parseInt($('#jetTextfieldValue').text().replace(/\D+/g,''))+parseFloat($('#summary_wonder').val()==undefined?0:$('#summary_wonder').val().replace(/[+%]/g,'')),false,2)+' %</span>');
			$('#capacityTextfieldValue,#jetTextfieldValue').on('DOMNodeInserted DOMNodeRemoved DOMSubtreeModified',function()
			{
				$('#empire_summary_total').html('+ '+Utils.FormatNumToStr(((500-parseInt($('#capacityTextfieldValue').text()))/6)+parseInt($('#jetTextfieldValue').text().replace(/\D+/g,''))+parseFloat($('#summary_wonder').val()==undefined?0:$('#summary_wonder').val().replace(/[+%]/g,'')),false,2)+' %');
			});
			$('#setPremiumJetPropulsion > div.jetContainer > div:first').html(LD.transprttxt[22]);
			$('#setPremiumJetPropulsion > p:last').css('text-align','justify').html(LD.transprttxt[23]);
			$('#missionSummary > div.summaryBox > h3').html(LD.transprttxt[24]);
			$('#missionSummary > div.summaryBox > ul > li.journeyTime').css({'margin-left':'5px','padding-left':'36px'}).attr('title',LD.transprttxt[25]);
			$('#missionSummary > div.summaryBox > ul > li.journeyTime > div:first > span:first').html(LD.transprttxt[26]+':');
			$('#missionSummary > div.summaryBox > ul > li.journeyTime > div:last > span:first').html(LD.transprttxt[25]+':');
			$('#missionSummary > div.summaryBox > ul > li.arrival').css({'margin-left':'2px','padding-left':'36px'}).attr('title',LD.transprttxt[27]);
			$('#missionSummary > div.summaryBox > ul > li.journeyTarget').css({'margin-left':'2px','padding-left':'36px'}).attr('title',LD.transprttxt[28]).find('span').html(LD.transprttxt[28]+':').parent().contents().last().each(function(){$(this).replaceWith(' '+$(this).text().trim());});
			$('#transporterCount').css('width','34px');
			$('#totalTansporters').css('margin-left','0px');
			$('ul.cargoInfo > li.rowTitle').html(LD.transprttxt[29]+':');
			$('ul.cargoInfo > li:not(:first)').each(function(k,li)
			{
				var res = $(li).attr('class');
				$(li).attr('title',LD.transprttxt[30][res]);
			});
			$('ul.speedInfo > li.rowTitle').html(LD.transprttxt[31]+':');
			$('#submit').val(LD.transprttxt[32]);
			$('#tradeRoute > h3').html(LD.transprttxt[33]);
			$('#tradeRoute p:first').css('text-align','justify').html(LD.transprttxt[34]);
			$('#js_tradeRouteButton').val(LD.transprttxt[35]);
//			checkbox
			$('#minusPlusValue').after('<input type="checkbox" id="floorquantities" title="" style="position:relative;left:120px"'+(database._globalData.floorquantities===true?' checked=checked':'')+'>');
			if(database._globalData.floorquantities===true) { $('#floorquantities').attr('checked','checked'); } else {$('#floorquantities').removeAttr('checked'); }
			$.ajax(
			{
				success: function()
				{
//					console.log(unsafeWindow);
//					console.log(unsafeWindow.transportConfig);
					$('#transportGoods').find('ul.resourceAssign > li').each(function(k,li)
					{
						var res = $(li).attr('class');
//						console.log(unsafeWindow['i'+res].range);
					});
					$('#floorquantities').on('change click input',function(event)
					{
						database._globalData.floorquantities = $(this).is(':checked');
						if($(this).is(':checked'))
						{
							var cp = parseInt($('#capacityTextfieldValue').text());
//							console.log(cp);
							$('#transportGoods').find('ul.resourceAssign > li').each(function(k,li)
							{
								var res = $(li).attr('class');
								var v = parseInt(isNaN($('#textfield_'+res).val())? 0 : $('#textfield_'+res).val());
								$('#textfield_'+res).val(parseInt(Math.floor(v/cp))==0 ? v : parseInt(Math.floor(v/cp))*cp);
							});
						}
					});
				}
			});
/*			if(database._globalData.floorquantities==true)
			{
				var cp = parseInt($('#capacityTextfieldValue').text());
				$('#transportGoods').find('ul.resourceAssign > li').each(function(k,li)
				{
					var res = $(li).attr('class');
					var v = isNaN($('#textfield_'+res).val())? 0 : $('#textfield_'+res).val();
					$('#textfield_'+res).val(parseInt(Math.floor(v/cp))==0 ? v : parseInt(Math.floor(v/cp))*cp);
				});
				$('#capacityTextfieldValue,#loadingTime').on('DOMNodeInserted DOMNodeRemoved DOMSubtreeModified',function()
				{
					var cp = parseInt($('#capacityTextfieldValue').text());
					$('#transportGoods').find('ul.resourceAssign > li').each(function(k,li)
					{
						var res = $(li).attr('class');
						var v = isNaN($('#textfield_'+res).val())? 0 : $('#textfield_'+res).val();
//						console.log(isNaN($('#textfield_'+res).val())? 0 : $('#textfield_'+res).val());
						$('#textfield_'+res).val(parseInt(Math.floor(v/cp))==0 ? v : parseInt(Math.floor(v/cp))*cp);
					});
				});
			}
			else
			{
				$('#transportGoods').find('ul.resourceAssign > li').each(function(k,li)
				{
					var res = $(li).attr('class');
					$('#textfield_'+res).val(parseInt(isNaN($('#textfield_'+res).val())? 0 : $('#textfield_'+res).val()));
				});
			}
			$.ajax(
			{
				success: function()
				{
					$('#transportGoods').find('ul.resourceAssign > li').each(function(k,li)
					{
						var res = $(li).attr('class');
						$('#textfield_'+res).val(parseInt(isNaN($('#textfield_'+res).val())? 0 : $('#textfield_'+res).val()));
					});
					var trD = unsafeWindow.transportConfig;
					var avships = trD.availableTransporters;
					var speed = trD.transporterSpeed;
					var lspeed = trD.loadingSpeed;
					var gov = trD.governmentBonus;
					var sca = trD.marineChartArchiveBonus;
					var psd = trD.poseidonEffect;
					var srv = ikariam.Server() == 's201' || ikariam.Server() == 's202' ? 3 : 1;
					var draft = 1+((500-parseInt($('#capacityTextfieldValue').text()))/6)/100;
					var triton = 1+parseInt($('#jetTextfieldValue').text().replace(/\D+/g,''))/100;
					var rarr = {};
					var sum = 0;
					var rsc = Object.values(Constant.Resources).slice(1);
					$('div.minusPlusValueOuterContainer,div.transportersCapacity > div.sliderBox,#setPremiumJetPropulsion > div.sliderBox').css('opacity',avships==0 && parseInt($('#totalTansporters').text().replace(/\D+/g,''))==0?0.5:1);
					$('#totalTansporters').on('DOMNodeInserted DOMNodeRemoved DOMSubtreeModified',function()
					{
						$('div.minusPlusValueOuterContainer,div.transportersCapacity > div.sliderBox,#setPremiumJetPropulsion > div.sliderBox').css('opacity',avships==0 && parseInt($('#totalTansporters').text().replace(/\D+/g,''))==0?0.5:1);
					});
					$.each(rsc,function(k,res)
					{
						var r = $('input#textfield_'+res);
						rarr[res] = $('input#textfield_'+res).length==1 ? (isNaN(parseInt($(r).val())) ? 0 : parseInt($(r).val())) : 0;
						$('#summary_'+res).hide().after('<span id="empire_summary_'+res+'" style="margin-left:40px">'+rarr[res]+'</span>');
					});
					sum = Object.values(rarr).reduce((a,b)=>a+b);
					$('#submit').prop('disabled',sum==0);
					$('#loadingTime').hide().after('<span id="empire_loadingTime">'+(sum==0?0+LD.second:Utils.FormatTimeLengthToStr(sum*1000/lspeed,6))+'</span>');
					$('#journeyTime').hide().after('<span id="empire_journeyTime">'+Utils.FormatTimeLengthToStr(Math.ceil((trD.distance*trD.fleetJourneyTime*1000)/(speed*draft*triton*gov*sca*(1+psd)*srv)),6)+'</span>');
					$('#loadingTime').on('DOMNodeInserted DOMNodeRemoved DOMSubtreeModified',function()
					{
						$.each(rsc,function(k,res)
						{
							var r = $('input#textfield_'+res);
							rarr[res] = $('input#textfield_'+res).length==1 ? (isNaN(parseInt($(r).val())) ? 0 : parseInt($(r).val())) : 0;
							$('#empire_summary_'+res).html(Utils.FormatNumToStr(rarr[res],false,0));
						});
						sum = Object.values(rarr).reduce((a,b)=>a+b);
						$('#empire_loadingTime').html(sum==0?0+LD.second:Utils.FormatTimeLengthToStr(sum*1000/lspeed,6));
						$('#submit').prop('disabled',sum==0);
					});
					$('#capacityTextfieldValue,#jetTextfieldValue').on('DOMNodeInserted DOMNodeRemoved DOMSubtreeModified',function()
					{
						draft = 1+((500-parseInt($('#capacityTextfieldValue').text()))/6)/100;
						triton = 1+parseInt($('#jetTextfieldValue').text().replace(/\D+/g,''))/100;
						$('#empire_journeyTime').html(Utils.FormatTimeLengthToStr(Math.ceil((trD.distance*trD.fleetJourneyTime*1000)/(speed*draft*triton*gov*sca*(1+psd)*srv)),6));
					});
					$('#arrival').hide().after('<span id="empire_arrival">'+Utils.FormatFullTimeToDateString(moment()+Math.ceil((trD.distance*trD.fleetJourneyTime*1000)/(speed*draft*triton*gov*sca*(1+psd)*srv))+sum*1000/lspeed)+'</span>');
					var transportinterv = setInterval(function()
					{
						draft = 1+((500-parseInt($('#capacityTextfieldValue').text()))/6)/100;
						triton = 1+parseInt($('#jetTextfieldValue').text().replace(/\D+/g,''))/100;
						$.each(rsc,function(k,res)
						{
							var r = $('input#textfield_'+res);
							rarr[res] = $('input#textfield_'+res).length==1 ? (isNaN(parseInt($(r).val())) ? 0 : parseInt($(r).val())) : 0;
						});
						sum = Object.values(rarr).reduce((a,b)=>a+b);
						$('#empire_arrival').html(Utils.FormatFullTimeToDateString(moment()+Math.ceil((trD.distance*trD.fleetJourneyTime*1000)/(speed*draft*triton*gov*sca*(1+psd)*srv))+sum*1000/lspeed));
						$('#capacityTextfieldValue,#jetTextfieldValue,#loadingTime').on('DOMNodeInserted DOMNodeRemoved DOMSubtreeModified',function()
						{
							draft = 1+((500-parseInt($('#capacityTextfieldValue').text()))/6)/100;
							triton = 1+parseInt($('#jetTextfieldValue').text().replace(/\D+/g,''))/100;
							$.each(rsc,function(k,res)
							{
								var r = $('input#textfield_'+res);
								rarr[res] = $('input#textfield_'+res).length==1 ? (isNaN(parseInt($(r).val())) ? 0 : parseInt($(r).val())) : 0;
							});
							sum = Object.values(rarr).reduce((a,b)=>a+b);
							$('#empire_arrival').html(Utils.FormatFullTimeToDateString(moment()+Math.ceil((trD.distance*trD.fleetJourneyTime*1000)/(speed*draft*triton*gov*sca*(1+psd)*srv))+sum*1000/lspeed));
						});

					},1000);
					$('#submit').on('click',function() { clearInterval(transportinterv); });
//					console.log(unsafeWindow.transportConfig);
				}
			});
			$('#capacityTextfieldValue,#loadingTime').on('DOMNodeInserted DOMNodeRemoved DOMSubtreeModified',function()
			{
				$('#transportGoods').find('ul.resourceAssign > li').each(function(k,li)
				{
					var res = $(li).attr('class');
					var v = isNaN($('#textfield_'+res).val())? 0 : $('#textfield_'+res).val();
//					console.log(isNaN($('#textfield_'+res).val())? 0 : $('#textfield_'+res).val());
					$('#textfield_'+res).val(parseInt(Math.floor(v/cp))==0 ? v : parseInt(Math.floor(v/cp))*cp);
				});
			});
			$('#transportGoods').find('ul.resourceAssign > li').each(function(k,li)
			{
				var res = $(li).attr('class');
				$('#textfield_'+res).val(parseInt(isNaN($('#textfield_'+res).val())? 0 : $('#textfield_'+res).val()));
			});
*/		},
		transportFormSubmitted: function(data)
		{
			try
			{
				if(!data)
				{
					var journeyTime = $('#journeyTime').text();
					var loadingTime = $('#loadingTime').text();
					var wood = parseInt($('#textfield_wood').val());
					var wine = parseInt($('#textfield_wine').val());
					var marble = parseInt($('#textfield_marble').val());
					var glass = parseInt($('#textfield_glass').val());
					var sulfur = parseInt($('#textfield_sulfur').val());
					var gold = '';
					var targetID = parseInt($('input[name=destinationCityId]').val());
					var ships = parseInt($('#transporterCount').val());
					var arrTime = new Date();
					var arrms = Utils.FormatLocDurToSecs(journeyTime)*1000;
					var lddms = loadingTime=='-'?0:Utils.FormatLocDurToSecs(loadingTime)*1000;
					var server = ikariam.Nationality();
					database.getGlobalData.tempdb['movs'] = {
						_id: 'XXX-'+(arrms+arrTime.getTime()),
						_originCityId: this.CurrentCityId,
						_targetCityId: targetID,
						_arrivalTime: arrms+lddms+arrTime.getTime(),
						_mission: 'transport',
						_loadingTime: lddms+arrTime.getTime(),
						_resources: {gold: gold || 0, wood: wood || 0, wine: wine || 0, marble: marble || 0, glass: glass || 0, sulfur: sulfur || 0},
						_military: undefined,
						_ships: ships,
						_eventid: null
						};
					return new Movement(database.getGlobalData.tempdb['movs']);
				}
				else
				{
//					console.log('########### tempdb after submit ###########');
//					console.log(database.getGlobalData.tempdb['movs']);
//					console.log('########### fleetMovements after submit ###########');
//					console.log(data);
					database.getGlobalData.addFleetMovement(data);
					events(Constant.Events.MOVEMENTS_UPDATED).pub([data.getTargetCityId]);
					$.each(database.getGlobalData.fleetMovements,function(k,m)
					{
//						console.log(m,m['_id'],m['_eventid']);
						if(m._id==database.getGlobalData.tempdb['movs']['_id'])
						{
							m._eventid = parseInt($('[id^=js_accloading]').last().attr('href').split('eventId=')[1]);
						}
					});
//					console.log('########### fleetMovements after update ###########');
//					console.log(database.getGlobalData.fleetMovements);
				}
			} catch(e) { empire.error('transportFormSubmitted', e); } finally { }
		},
		parseMilitaryTransport: function(submit)
		{
			var LD = Constant.LanguageData[database.settings.languageChange.value];
			submit = submit || false;
			var that = this;
			if(submit)
			{
				var journeyTime = $('#journeyTime').text();
				var returnTime = $('#returnTime').text();
				var targetID = parseInt($('input:[name=destinationCityId]').val());
				var troops = {};
				var mission = '';
				$('ul.assignUnits li input.textfield').each(function()
				{
					if(this.value !== 0)
					{
						troops[this.getAttribute('name').split('_').pop()] = parseInt(this.value);
					}
					if(mission === '')
					{
						mission = 'deploy' + this.getAttribute('name').match(/_(.*)_/)[1];
					}
					else
					{
						mission = 'plunder' + this.getAttribute('name').match(/_(.*)_/)[1];
					}
				});
				var arrTime = new Date();
				var transport = this.troopTransportObject();
				var server = ikariam.Nationality();
				transport.id = 'XXX-' + arrTime.getTime();
				transport.targetCityId = targetID;
				transport.originCityId = this.CurrentCityId;
				transport.mission = mission;
				transport.troops = troops;
				arrTime.setSeconds(arrTime.getSeconds() + (journeyTime.match(/(\d+)s/) ? parseInt(journeyTime.match(/(\d+)s/)[1]) : 0));
				arrTime.setMinutes(arrTime.getMinutes() + (journeyTime.match(/(\d+)m/) ? parseInt(journeyTime.match(/(\d+)m/)[1]) : 0));
				arrTime.setHours(arrTime.getHours() + (journeyTime.match(/(\d+)h/) ? parseInt(journeyTime.match(/(\d+)h/)[1]) : 0));
				arrTime.setDate(arrTime.getDate() + (journeyTime.match(/(\d+)D/) ? parseInt(journeyTime.match(/(\d+)D/)[1]) : 0));
				if(server=='de')
					arrTime.setDate(arrTime.getDate() + (journeyTime.match(/(\d+)T/) ? parseInt(journeyTime.match(/(\d+)T/)[1]) : 0));
				transport.arrivalTime = arrTime.getTime();
				arrTime = new Date();
				arrTime.setSeconds(arrTime.getSeconds() + (returnTime.match(/(\d+)s/) ? parseInt(returnTime.match(/(\d+)s/)[1]) : 0));
				arrTime.setMinutes(arrTime.getMinutes() + (returnTime.match(/(\d+)m/) ? parseInt(returnTime.match(/(\d+)m/)[1]) : 0));
				arrTime.setHours(arrTime.getHours() + (returnTime.match(/(\d+)h/) ? parseInt(returnTime.match(/(\d+)h/)[1]) : 0));
				arrTime.setDate(arrTime.getDate() + (returnTime.match(/(\d+)D/) ? parseInt(returnTime.match(/(\d+)D/)[1]) : 0));
				if(server=='de')
					arrTime.setDate(arrTime.getDate() + (returnTime.match(/(\d+)T/) ? parseInt(returnTime.match(/(\d+)T/)[1]) : 0));
				transport.returnTime = arrTime.getTime();
				database.getGlobalData.addFleetMovement(transport);
				render.toast(LD.updated_ + ': ' + LD.addtransport);
				return false;
			}
			else
			{
				return true;
			}
		},
		parseFinances: function($elem)
		{
			var LD = Constant.LanguageData[database.settings.languageChange.value];
			$('span[id^="currGold"').remove();
			var updateTime = $.now();
			var changed;
			for(var i=1;i<database.getCityCount+1;i++)
			{
				var city = database.cities[Object.keys(database.cities)[i - 1]];
				if(city !== false)
				{
					changed = city.updateIncome(parseInt($elem[(i*4)-3].textContent.replace(/(\d+)[,.](?=\d{3}(\D|$))/g,'$1')));
					changed = city.updateExpenses(parseInt($elem[(i*4)-2].textContent.replace(/(\d+)[,.](?=\d{3}(\D|$))/g,'$1'))) || changed;
				}
				if(changed) events(Constant.Events.CITY_UPDATED).pub(city.getId, {finances: true});
			}
			var $breakdown = $('#finances').find('tbody tr.bottomLine td:last-child');
//			console.log($breakdown);
			database.getGlobalData.finance.armyCost = parseInt($breakdown[0].textContent.replace(/(\d+)[,.](?=\d{3}(\D|$))/g,'$1'));
			database.getGlobalData.finance.fleetCost = parseInt($breakdown[1].textContent.replace(/(\d+)[,.](?=\d{3}(\D|$))/g,'$1'));
			database.getGlobalData.finance.armySupply = parseInt($breakdown[2].textContent.replace(/(\d+)[,.](?=\d{3}(\D|$))/g,'$1'));
			database.getGlobalData.finance.fleetSupply = parseInt($breakdown[3].textContent.replace(/(\d+)[,.](?=\d{3}(\D|$))/g,'$1'));
			events('globalData').pub({finances:true});
			$('#js_mainBoxHeaderTitle').text(LD.financestxt[0]);
			$('#js_BadTaxAccountantOffer').parent().prevAll('td.sigma').text(LD.financestxt[1]);
			var citysort = '<tr><th class="city left" colspan="2"><img style="padding-left:10px" src="skin/layout/icon-city2.png" alt="'+LD.city+'"></th><th class="left">'+LD.income+'</th><th class="left">'+LD.scientists+'</th><th class="left">'+LD.financestxt[4]+'</th></tr>';
			var sum = [0,0,0];
			$.each(database.settings.cityOrder.value,function(k,c)
			{
				var city = database.cities[c];
				citysort += '<tr'+(k%2==1?' class="alt"':'')+'><td class="nowrap res" style="text-align:center;width:20px">'+(k+1)+'</td><td class="city">'+city.getName+'</td><td class="nowrap res">'+Utils.FormatNumToStr(city.getIncome,0)+'</td><td class="nowrap res"><span class="nowrap red bold">'+Utils.FormatNumToStr(city.getExpenses,0)+'</span></td><td class="nowrap res">'+Utils.FormatNumToStr(city.getIncome+city.getExpenses,0)+'</td></tr>\r\n';
				sum[0] += city.getIncome;
				sum[1] += city.getExpenses;
				sum[2] += city.getIncome+city.getExpenses;
			});
			citysort += '<tr class="result"><td colspan="2">'+LD.financestxt[2]+'</td><td class="nowrap res">0</td><td class="nowrap res"></td><td class="nowrap res"></td></tr><tr class="result"><td class="sigma" colspan="2"><img src="skin/layout/sigma.png" alt="'+LD.financestxt[3]+'"></td><td class="nowrap bold res">'+Utils.FormatNumToStr(sum[0],0)+'</td><td class="nowrap bold res"><span class="nowrap red bold">'+Utils.FormatNumToStr(sum[1],0)+'</span></td><td class="nowrap bold res">'+Utils.FormatNumToStr(sum[2],0)+'</td></tr>';
			$('#finances > div.bd.mainContentScroll > div.mainContent.minimizableContent > table:nth-child(4) > tbody').html(citysort);
			var s = 0;
			setInterval(function()
			{
				s++;
				$('#currGold_'+updateTime).text(Utils.FormatNumToStr(database.getGlobalData.finance.currentGold+s*((sum[2]-database.getGlobalData.finance.armyCost-database.getGlobalData.finance.fleetCost-database.getGlobalData.finance.armySupply-database.getGlobalData.finance.fleetSupply)/3600),0));
			},1000);
			$('#js_BadTaxAccountantOffer').parent().prevAll('td:not(.sigma)').html('<span id="currGold_'+updateTime+'">'+Utils.FormatNumToStr(database.getGlobalData.finance.currentGold,0)+'</span>');
			render.toast(LD.updated_+': '+LD.balances);
		},
		parsetradeAdvisor: function(view,data)
		{
			var LD = Constant.LanguageData[database.settings.languageChange.value];
			$('#sidebar').hide();
			$('#js_mainBoxHeaderTitle').text(LD.mayortxt[0]);
			$('#'+view).find('div.buildingDescription > h1').text(LD.mayortxt[0]);
			$('#js_tab_tradeAdvisor > b').text(LD.mayortxt[1]);
			$('#js_tab_tradeRoutes > b').text(LD.mayortxt[2]);
			if(view=='tradeAdvisor')
			{
				$('#tab_tradeAdvisor > div:first > h3').text(function(){return Utils.format(LD.mayortxt[3],[Utils.FormatNumToStr(parseInt($(this).text().replace(/\D+/g,'')),false,0)])});
				$('#filterForm > span.filterEntry').each(function(k,sp)
				{
					$(sp).find('span.filterEntryButton > span.name').text(LD.mayortxt[k+4]);
				});
				$('table#inboxCity > tbody > tr:first > th:eq(1)').text(LD.mayortxt[12]);
				$('table#inboxCity > tbody > tr:first > th:eq(2)').text(LD.mayortxt[13]);
				$('table#inboxCity > tbody > tr:first > th:eq(3)').text(LD.mayortxt[14]);
				var cat = ['all','military','transport','production','espionage','diplomacy','plus','piracy'];
				$('table#inboxCity > tbody > tr:not(:first,:last)').each(function(k,tr)
				{
					$(tr).find('td:eq(0)').css({'min-width':'auto','width':'auto','white-space':'nowrap'});
					$(tr).find('td:eq(0) > span.category').each(function(i,sp)
					{
						$(sp).attr('title',LD.mayortxt[cat.indexOf($(sp).attr('class').split(' ')[1])+4]);
					});
					$(tr).find('td:eq(1) > a').attr('title',function(){return Utils.format(LD.mayortxt[15],[$(this).text().trim()])});
					$(tr).find('td:eq(2)').css('text-align','center').text(function(){return moment($(this).text().trim()+'+0200','DD.MM.YYYY HH:mm Z').format(LD.fulldateshort);});
//					console.log(moment($(this).text().trim(),'DD.MM.YYYY HH:mm').calendar().split(' ')[0]);
				});
				$('table#inboxCity > tbody > tr:last > td.paginator > a').each(function(i,a)
				{
					var t = $(a).find('img').attr('src').split('_')[1].split('.')[0];
//					console.log()
					if(t=='min')
					{
						$(a).attr('title',LD.mayortxt[16]);
					}
					else if(t=='max')
					{
						$(a).attr('title',LD.mayortxt[17]);
					}
				});
				$('table#inboxCity > tbody > tr:last > td:not(.paginator)').remove();
			$('table#inboxCity > tbody > tr:last > td.paginator').attr('colspan',4).css({'text-align':'center','padding':'0px 10px'}).children().css({'float':'none','display':'inline-block'});
//				console.log($('table#inboxCity > tbody > tr:last > td.paginator').prop('innerHTML'));
				if(database.settings.ctfinder.value)
				{
					$('#inboxCity > tbody > tr:not(:first)').each(function(k,tr)
					{
						var nObjs = $(tr).find('td.subject > a[href*="receiverId="]');
						if(nObjs.length)
						{
							$(nObjs).each(function(k,n)
							{
								var uid = $(n).attr('href').split('&')[1].replace(/\D+/g,'');
								if(Object.keys(database.getGlobalData.getMuseumTreaties).indexOf(uid)!=-1)
								{
									$(n).append('<img src="skin/museum/icon32_culturalgood.png" style="width:15px;height:auto;" title="'+LD.ctenabled+'">');
								}
								else if(Object.keys(database.getGlobalData.getPotMuseumTreaties).indexOf(uid)!=-1)
								{
									$(n).append('<img src="skin/museum/icon32_culturalgood.png" style="width:15px;height:auto;opacity:0.5" title="'+LD.ctrequested[database.getGlobalData.getPotMuseumTreaties[uid].type*0.5-39]+'">');
								}
							});
						}
					});
				}
				$('table#inboxCity > tbody > tr:first').after('<tr><td colspan="4" class="paginator" style="text-align:center;padding:0px 10px">'+$('table#inboxCity > tbody > tr:last > td.paginator').prop('innerHTML')+'</td></tr>');
			}
			else if(view=='tradeRoutes')
			{
				$('#tradeRouteBox > h3').text(LD.porttxt[57]);
				$('#tradeRouteBoxContent > p').css('text-align','justify').html(LD.porttxt[59]);
				var serverTimezoneOffset = unsafeWindow.dataSetForView.serverTimezoneOffset;
				var diff = (moment().utcOffset()*60-serverTimezoneOffset)/3600;
				$('[id^="tradeRouteForm"]').each(function(k,r)
				{
					$(r).prev('div').find('div:first').text(LD.porttxt[60]+':');
					$(r).prev('div').find('div:first + div').text(LD.porttxt[61]);
					if($(r).find('div.status > span').hasClass('red'))
					{
						$(r).find('div.status > span').text(LD.porttxt[62]);
						$(r).find('div.renew > a').css({'position':'relative','right':'10px'}).attr('title',LD.porttxt[63]).text(LD.porttxt[63]);
					}
					else if($(r).find('div.status > span').hasClass('green'))
					{
						var dur = $(r).find('div.status > span').text().split(' ').splice(1).join(' ');
						$(r).find('div.status > span').html(Utils.format(LD.porttxt[67],[Utils.FormatTimeLengthToStr(Utils.FormatLocDurToSecs(dur)*1000,3)]));
						$(r).find('div.renew > a').css({'position':'relative','right':'10px'}).attr('title',LD.porttxt[68]).text(LD.porttxt[68]);
					}
					$(r).find('div.orderBtnTraderoute').attr('title',LD.porttxt[63]);
					$(r).find('div.save > input').attr('title',LD.porttxt[64]);
					$(r).find('div.delete > a').attr('title',LD.porttxt[65]);
					if($(r).find('div.extend > input').is(':not(:checked)'))
					{
						$(r).find('div.extend > input').attr('title',LD.porttxt[69]);
						$(r).find('div.extend > div.tooltip').html('<div style="text-align:justify">'+LD.porttxt[70]+'</div>');
						$(r).find('div.extend > span.checkbox_label').text(LD.porttxt[69]);
					}
					else if($(r).find('div.extend > input').is(':checked'))
					{
						$(r).find('div.extend > input').attr('title',LD.porttxt[71]);
						$(r).find('div.extend > div.tooltip').html('<div style="text-align:justify">'+LD.porttxt[72]+'</div>');
						$(r).find('div.extend > span.checkbox_label').text(LD.porttxt[71]);
					}
					$('#tradegood'+k+' > option').each(function(i,op)
					{
						$(op).attr('title',LD[Object.values(Constant.Resources).slice(1)[$(op).attr('value')]+'_']).text(LD[Object.values(Constant.Resources).slice(1)[$(op).attr('value')]+'_']);
						$('#dropDown_js_tradegood'+k+'Container > div.bg > ul > li[selectvalue="'+$(this).attr('value')+'"] > a').text(LD[Object.values(Constant.Resources).slice(1)[$(op).attr('value')]+'_']);
					});
					$('#time'+k+' > option').each(function(i,op)
					{
						$(op).text(function(){return (parseInt($(this).attr('value'))+diff+(parseInt($(this).attr('value'))+diff<0?24:(parseInt($(this).attr('value'))+diff>=24?-24:0)))+':00';});
						$('#dropDown_js_time'+k+'Container > div.bg > ul > li[selectvalue="'+$(this).attr('value')+'"] > a').text((parseInt($(this).attr('value'))+diff+(parseInt($(this).attr('value'))+diff<0?24:(parseInt($(this).attr('value'))+diff>=24?-24:0)))+':00');
						if($(op).is(':selected'))
						{
//							console.log($(op).text());
							$(op).parent().next('span.dropDownButton').find('a').text($(op).text());
						}
					});
					$('#time'+k).html($('#time'+k).find('option').sort(function(x,y) {return $(x).text().padStart(5,'0') > $(y).text().padStart(5,'0') ? 1 : -1;}));
					$('#dropDown_js_time'+k+'Container > div.bg > ul').html($('#dropDown_js_time'+k+'Container > div.bg > ul').find('li').sort(function(x,y) {return $(x).text().padStart(5,'0') > $(y).text().padStart(5,'0') ? 1 : -1;}).removeAttr('class').each(function(a,b){$(b).addClass(a==0? 'first-child':(a==$('#dropDown_js_time'+k+'Container > div.bg > ul').find('li').length-1?'last-child':''));}));
				});
				$('#tradeRouteBox').find('div.centerButton > a').text(LD.porttxt[66]);
				citysort = [];
				$('[id^="tradeRouteStart"],[id^="tradeRouteEnd"]').each(function(k,c)
				{
					var num = parseInt($(c).attr('id').replace(/\D+/g,''));
					var startend = $(c).attr('id').indexOf('Start')!=-1?0:1;
					var fromto = $(c).attr('id').indexOf('Start')!=-1?LD.traderoutestxt[1]:($(c).attr('id').indexOf('End')!=-1?LD.traderoutestxt[2]:null);
					citysort[num] = [];
					citysort[num][startend] = '<option>-- '+(fromto!=null?fromto:'')+' --</option>';
					$.each(database.settings.cityOrder.value,function(i,t)
					{
						citysort[num][startend] += $(c).find('option[value="'+t+'"]').prop('outerHTML');
					});
					$(c).empty().append(citysort[num][startend]);
					if($(c).find('option').is(':selected'))
					{
						$(c).next('span.dropDownButton').addClass($(c).find('option:selected').attr('class')).find('a').text($(c).find('option:selected').text());
					}
				});
				citysort = '';
				$('[id^="dropDown_js_tradeRoute"]').each(function(k,c)
				{
					var fromto = $(c).attr('id').indexOf('Start')!=-1?LD.traderoutestxt[1]:($(c).attr('id').indexOf('End')!=-1?LD.traderoutestxt[2]:null);
					var citysort = '<li selectvalue="-- '+(fromto!=null?fromto:'')+' --" class="first-child"><a> -- '+(fromto!=null?fromto:'')+' --</a></li>';
					$.each(database.settings.cityOrder.value,function(i,t)
					{
						citysort += $(c).find('div.bg > ul > li[selectvalue="'+t+'"]').prop('outerHTML');
					});
					$(c).find('div.bg > ul').empty().append(citysort);
				});
				$('[id^="dropDown_js_tradeRoute"] > div.bg > ul > li').each(function(k,c)
				{
					$(c).removeClass('first-child last-child');
					$(c).addClass(k==0? 'first-child':(k==database.settings.cityOrder.value.length?'last-child':''));
				});
			}
			render.toast(Utils.format('{0}: {1}',[LD.updated_,LD.advisors[0]]));
		},
		parseDiplomacyAdvisor: function(view,html,data)
		{ 
			var LD = Constant.LanguageData[database.settings.languageChange.value];
			$('#js_mainBoxHeaderTitle').text(LD.advisors[3]);
			$('#tabMenu > li:eq(1) > b').text(function(){return Utils.format(LD.dipladvtxt[0],[Utils.FormatNumToStr(parseInt($(this).text().replace(/\D+/g,'')),false,0)]);});
			$('#tabMenu > li:eq(2) > b').text(function(){return Utils.format(LD.dipladvtxt[1],[Utils.FormatNumToStr(parseInt($(this).text().replace(/\D+/g,'')),false,0)]);});
			$('#tabMenu > li:eq(3) > b').text(LD.dipladvtxt[2]);
			$('#tabMenu > li:eq(4) > b').text(function(){return Utils.format(LD.dipladvtxt[3],[Utils.FormatNumToStr(parseInt($(this).text().replace(/\D+/g,'')),false,0)]);});
			$('#tabMenu > li:eq(5) > b').text(LD.dipladvtxt[4]);
			$('#tabMenu > li:eq(6) > b').text(LD.dipladvtxt[5]);
			if(['diplomacyAdvisor','diplomacyAdvisorOutBox','diplomacyAdvisorArchive','diplomacyAdvisorArchiveOutBox'].indexOf(view)!=-1)
			{
				$('#diplomacyAdvisor').find('div.buildingDescription > h1').text(LD.advisors[3]);
				$('#tab_diplomacyAdvisor > div:first > h3').text(function(){return Utils.format(LD.dipladvtxt[0],[Utils.FormatNumToStr(parseInt($(this).text().replace(/\D+/g,'')),false,0)]);});
				$('#tab_diplomacyAdvisor > div:first > div.content > div.filter > span.filterEntry').each(function(k,sp)
				{
					$(sp).find('a').attr('title',LD.dipladvtxt[k+7]);
					$(sp).find('a > span > span:last').text(function(){return Utils.format(LD.dipladvtxt[k+(k<2?0:2)+7]+' ({0})',[Utils.FormatNumToStr(parseInt($(this).text().replace(/\D+/g,'')),false,0)]);});
				});
				if(view=='diplomacyAdvisor')
				{
					$('#sidebarWidget > li:first').hide();
					$('#tab_diplomacyAdvisor > div:eq(1) > h3').text(LD.dipladvtxt[7]);
					var rows = $('form#deleteMessages > table > tbody > tr').length;
					$('form#deleteMessages > table > tbody > tr').each(function(i,tr)
					{
						if(i==0)
						{
							if(rows==1)
							{
								$(tr).find('th > p').text(LD.dipladvtxt[31]);
							}
							else
							{
								$(tr).find('th').each(function(k,th) { $(th).text(LD.dipladvtxt[k+13]); });
							}
						}
						else
						{
							if($(tr).attr('id')!=undefined && ($(tr).attr('id').startsWith('message')||$(tr).attr('id').startsWith('gmessage')))
							{
								$(tr).attr('title',LD.dipladvtxt[18]);
								$(tr).find('td:eq(0)').css({'width':'14px'});
								$(tr).find('td:eq(1)').css({'width':'20px','padding':'4px 0px'});
								$(tr).find('td:eq(2)').css({'white-space':'nowrap','width':'120px','padding':'4px 0px'}).removeAttr('onclick').find('a').css({'white-space':'nowrap'}).attr({'href':$('#tbl_reply'+$(tr).attr('id').replace(/\D+/g,'')+',#tbl_greply'+$(tr).attr('id').replace(/\D+/g,'')).find('a[href*="receiverId"]').attr('href') || '#','title':LD.dipladvtxt[20]}).text(function(){return $(this).text().trim();});
								$(tr).find('td:eq(3)').css({'white-space':'nowrap'}).text(function(){return $(this).text().trim();});
								$(tr).find('td:eq(4)').css({'white-space':'nowrap','padding':'4px 3px','width':'225px'}).attr('title',LD.dipladvtxt[19]).find('a').html(function(){return $(this).text().replace(/([^]*)(\[\d+:\d+\])/,'<span style="display:inline-block;float:left" onMouseOver="this.style.textDecoration=\'underline\'" onMouseOut="this.style.textDecoration=\'none\'">$1</span> <span style="display:inline-block;float:right" onMouseOver="this.style.textDecoration=\'underline\'" onMouseOut="this.style.textDecoration=\'none\'">$2</span>');});
								$(tr).find('td:eq(5)').css({'white-space':'nowrap','text-align':'center','padding':'4px 0px'}).text(function(){return moment($(this).text().trim()+'+0200','DD.MM.YYYY HH:mm:ss Z').format(LD.fulldateshort+':ss');});
								$('#tbl_reply'+$(tr).attr('id').replace(/\D+/g,'')).find('a[href*="msgType=79"]').text(LD.dipladvtxt[46]);
								$('#tbl_reply'+$(tr).attr('id').replace(/\D+/g,'')).find('a[href*="msgType=80"]').text(LD.dipladvtxt[47]);
								$('#tbl_reply'+$(tr).attr('id').replace(/\D+/g,'')+',#tbl_greply'+$(tr).attr('id').replace(/\D+/g,'')).find('a[href*="replyTo"]').text(LD.dipladvtxt[21]);
								$('#tbl_reply'+$(tr).attr('id').replace(/\D+/g,'')+',#tbl_greply'+$(tr).attr('id').replace(/\D+/g,'')).find('a[onclick^="createDeletePopup"]').text(LD.dipladvtxt[22]).on('click',function()
								{
									$('#js_popupBtn1').text(LD.dipladvtxt[29]).parent().prev('div').text(LD.dipladvtxt[28]);
									$('#js_popupBtn2').text(LD.dipladvtxt[30]);
//									console.log($('#js_popupBtn1').text());
								});
								$('#tbl_greply4 > td > span > a').text(LD.dipladvtxt[22]);
								$('#tbl_reply'+$(tr).attr('id').replace(/\D+/g,'')+',#tbl_greply'+$(tr).attr('id').replace(/\D+/g,'')).find('a[onclick^="createReportPopup"]').attr('title',LD.dipladvtxt[26]).text(LD.dipladvtxt[23]).on('click',function()
								{
									$('#js_popupBtn1').text(LD.dipladvtxt[29]).parent().prev('div').css('text-align','justify').html(LD.dipladvtxt[26].replace('\n','<br>')).parent().prev('div').find('div:eq(1) > h3').text(LD.dipladvtxt[28]);
									$('#js_popupBtn2').text(LD.dipladvtxt[30]);
//									console.log($('#js_popupBtn1').text());
								});
								$('#tbl_reply'+$(tr).attr('id').replace(/\D+/g,'')+',#tbl_greply'+$(tr).attr('id').replace(/\D+/g,'')).find('a[href*="allyId"]').text(LD.dipladvtxt[25]);
								$('#tbl_reply'+$(tr).attr('id').replace(/\D+/g,'')+',#tbl_greply'+$(tr).attr('id').replace(/\D+/g,'')).find('a[href*="ignoreId"]').attr('title',LD.dipladvtxt[27]).text(LD.dipladvtxt[24]);
								$('#tbl_mail'+$(tr).attr('id').replace(/\D+/g,'')+',#tbl_gmail'+$(tr).attr('id').replace(/\D+/g,'')).find('td.msgText').html(function()
								{
									anchorme({input:$(this).html(),options:{attributes:{target:'_blank',style:'color:blue'}}});
									return anchorme({input:$(this).html(),options:{attributes:{target:'_blank',style:'color:blue'}}}).replace(/(\[\d+:\d+\])/igm,function(x)
									{
										var c = x.replace(/(\[|\])/igm,'').split(':');
										return '<a href="?view=island&islandId='+Utils.isXYtoID(c[0],c[1])+'" style="color:blue">['+c[0]+':'+c[1]+']</a>';
									});
								});
							}
						}
					});
					if(database.settings.ctfinder.value)
					{
						var mids = [], uids = [];
						$('tr[id^=tbl_reply]').each(function(k,tr)
						{
							mids.push($(tr).attr('id').replace(/\D+/g,''));
							uids.push($(tr).find('> td > a:nth-child(1)').attr('href')!=undefined?$(tr).find('td > a:nth-child(1)').attr('href').split('&')[1].replace(/\D+/g,''):$(tr).find('> td > div.red_box.warning > div > a').attr('href')!=undefined?$(tr).find('> td > div.red_box.warning > div > a').attr('href').split('&')[1].replace(/\D+/g,''):0);
						});
						for(var i=0;i<uids.length;i++)
						{
							if(Object.keys(database.getGlobalData.getMuseumTreaties).indexOf(uids[i])!=-1)
							{
								$('#message'+mids[i]+' > td:nth-child(3) > a').append('<img src="skin/museum/icon32_culturalgood.png" style="width:15px;height:auto;float:right" title="'+LD.ctenabled+'">');
							}
							else if(Object.keys(database.getGlobalData.getPotMuseumTreaties).indexOf(uids[i])!=-1)
							{
								$('#message'+mids[i]+' > td:nth-child(3) > a').append('<img src="skin/museum/icon32_culturalgood.png" style="width:15px;height:auto;float:right;opacity:0.5" title="'+LD.ctrequested[database.getGlobalData.getPotMuseumTreaties[uids[i]].type*0.5-39]+'">');
							}
						}
					}
					var pg = $('form#deleteMessages > table > tbody > tr > td.paginator').css('text-align','center').contents().filter(function(){return this.nodeType==Node.TEXT_NODE && $.trim(this.nodeValue)!=='';}).text().trim().split('-');
					var prev = parseInt(pg[0])>1?'<a onclick="ajaxHandlerCall(this.href);return false;" href="?view=diplomacyAdvisor&amp;start='+(parseInt(pg[0])-11)+'" title="...'+LD.dipladvtxt[33]+' 10">...'+LD.dipladvtxt[33]+' 10 <img src="skin/interface/btn_min.png"></a>':'';
					var next = parseInt(pg[1])<parseInt($('#tab_diplomacyAdvisor > div:eq(0)').find('span.name:eq(0)').text().replace(/\D+/g,''))?' <a onclick="ajaxHandlerCall(this.href);return false;" href="?view=diplomacyAdvisor&amp;start='+pg[1]+'" title="...'+LD.dipladvtxt[32]+' 10"><img src="skin/interface/btn_max.png"> '+LD.dipladvtxt[32]+' 10...</a>':'';
					$('form#deleteMessages > table > tbody > tr > td.paginator').html(prev+parseInt(pg[0])+' - '+parseInt(pg[1])+next);
					$('form#deleteMessages > table > tbody > tr > td.paginator').parent().next('tr').find('td > a').each(function(k,a){return $(a).text(LD.dipladvtxt[k+34]);});
					$('input#actionType + input.button').val(LD.dipladvtxt[38]);
					$('input#actionType + input.button + a.button').attr('title',LD.dipladvtxt[39]).text(LD.dipladvtxt[39]);
					if($('#sidebarWidget > li:eq(1) > a')[0]!=undefined)
					{
						$('#sidebarWidget > li:eq(1) > a')[0].childNodes[0].textContent = LD.dipladvtxt[40];
						$('#diplomaticInfluenceSidebar > p').text(function(){return Utils.format(LD.dipladvtxt[41],[$(this).text().replace(/\D+/g,'')]);});
					}
				}
				else if(view=='diplomacyAdvisorOutBox')
				{
					$('#sidebar').hide();
					$('#tab_diplomacyAdvisor > div:eq(1) > h3').text(LD.dipladvtxt[8]);
					var rows = $('form#deleteMessages > table > tbody > tr').length;
					$('form#deleteMessages > table > tbody > tr').each(function(i,tr)
					{
						if(i==0)
						{
							if(rows==1)
							{
								$(tr).find('th > p').text(LD.dipladvtxt[31]);
							}
							else
							{
								$(tr).find('th:eq(0)').text(LD.dipladvtxt[13]);
								$(tr).find('th:eq(1)').text(LD.dipladvtxt[42]);
								$(tr).find('th:eq(2)').text(LD.dipladvtxt[15]);
								$(tr).find('th:eq(4)').text(LD.dipladvtxt[17]);
							}
						}
						else
						{
							if($(tr).attr('id')!=undefined && $(tr).attr('id').startsWith('message'))
							{
								$(tr).attr('title',LD.dipladvtxt[18]);
								$(tr).find('td:eq(0)').css({'width':'14px'});
								$(tr).find('td:eq(1)').css({'width':'20px','padding':'4px 0px'});
								$(tr).find('td:eq(2)').find('a').css('white-space','nowrap').removeAttr('href').text(function(){return $(this).text().trim();});
								$(tr).find('td:eq(3)').css({'white-space':'nowrap'}).text(function(){return $(this).text().trim();});
								$(tr).find('td:eq(5)').css({'white-space':'nowrap','text-align':'center','padding':'4px 0px'}).text(function(){return moment($(this).text().trim()+'+0200','DD.MM.YYYY HH:mm:ss Z').format(LD.fulldateshort+':ss');});
								$('#tbl_mail'+$(tr).attr('id').replace(/\D+/g,'')).find('td.msgText').html(function()
								{
									anchorme({input:$(this).html(),options:{attributes:{target:'_blank',style:'color:blue'}}});
									return anchorme({input:$(this).html(),options:{attributes:{target:'_blank',style:'color:blue'}}}).replace(/(\[\d+:\d+\])/igm,function(x)
									{
										var c = x.replace(/(\[|\])/igm,'').split(':');
										return '<a href="?view=island&islandId='+Utils.isXYtoID(c[0],c[1])+'" style="color:blue">['+c[0]+':'+c[1]+']</a>';
									});
								});
								$('#actionType + a.button').attr('title',LD.dipladvtxt[22]).text(LD.dipladvtxt[22]).on('click',function()
								{
									$('#js_popupBtn1').text(LD.dipladvtxt[29]).parent().prev('div').text(LD.dipladvtxt[28]);
									$('#js_popupBtn2').text(LD.dipladvtxt[30]);
//									console.log($('#js_popupBtn1').text());
								});
							}
						}
					});
					var pg = $('form#deleteMessages > table > tbody > tr > td.paginator').css('text-align','center').contents().filter(function(){return this.nodeType==Node.TEXT_NODE && $.trim(this.nodeValue)!=='';}).text().trim().split('-');
					var prev = parseInt(pg[0])>1?'<a onclick="ajaxHandlerCall(this.href);return false;" href="?view=diplomacyAdvisorOutBox&amp;start='+(parseInt(pg[0])-11)+'" title="...'+LD.dipladvtxt[33]+' 10">...'+LD.dipladvtxt[33]+' 10 <img src="skin/interface/btn_min.png"></a>':'';
					var next = parseInt(pg[1])<parseInt($('#tab_diplomacyAdvisor > div:eq(0)').find('span.name:eq(1)').text().replace(/\D+/g,''))?' <a onclick="ajaxHandlerCall(this.href);return false;" href="?view=diplomacyAdvisorOutBox&amp;start='+pg[1]+'" title="...'+LD.dipladvtxt[32]+' 10"><img src="skin/interface/btn_max.png"> '+LD.dipladvtxt[32]+' 10...</a>':'';
					$('form#deleteMessages > table > tbody > tr > td.paginator').html(prev+parseInt(pg[0])+' - '+parseInt(pg[1])+next);
					$('form#deleteMessages > table > tbody > tr > td.paginator').parent().next('tr').find('td > a:first').text(LD.dipladvtxt[34]);
					$('form#deleteMessages > table > tbody > tr > td.paginator').parent().next('tr').find('td > a:last').text(LD.dipladvtxt[37]);
					$('input#actionType + a.button').attr('title',LD.dipladvtxt[39]).text(LD.dipladvtxt[39]);
//					console.log(LD.dipladvtxt);
				}
				else if(view=='diplomacyAdvisorArchive')
				{
					$('#sidebar').hide();
					$('#tab_diplomacyAdvisor > div:eq(1) > h3').text(LD.dipladvtxt[9]);
					var rows = $('form#deleteMessages > table > tbody > tr').length;
					$('form#deleteMessages > table > tbody > tr').each(function(i,tr)
					{
						if(i==0)
						{
							if(rows==1)
							{
								$(tr).find('th > p').text(LD.dipladvtxt[31]);
							}
							else
							{
								$(tr).find('th').each(function(k,th) { $(th).text(LD.dipladvtxt[k+13]); });
							}
						}
						else
						{
							if($(tr).attr('id')!=undefined && ($(tr).attr('id').startsWith('message')||$(tr).attr('id').startsWith('gmessage')))
							{
								$(tr).attr('title',LD.dipladvtxt[18]);
								$(tr).find('td:eq(0)').css({'width':'14px'});
								$(tr).find('td:eq(1)').css({'width':'20px','padding':'4px 0px'});
								$(tr).find('td:eq(2)').css({'white-space':'nowrap','width':'120px','padding':'4px 0px'}).removeAttr('onclick').find('a').css({'white-space':'nowrap'}).attr({'href':$('#tbl_reply'+$(tr).attr('id').replace(/\D+/g,'')+',#tbl_greply'+$(tr).attr('id').replace(/\D+/g,'')).find('a[href*="receiverId"]').attr('href') || '#','title':LD.dipladvtxt[20]}).text(function(){return $(this).text().trim();});
								$(tr).find('td:eq(3)').css({'white-space':'nowrap'}).text(function(){return $(this).text().trim();});
								$(tr).find('td:eq(4)').css({'white-space':'nowrap','padding':'4px 3px','width':'225px'}).attr('title',LD.dipladvtxt[19]).find('a').html(function(){return $(this).text().replace(/([^]*)(\[\d+:\d+\])/,'<span style="display:inline-block;float:left" onMouseOver="this.style.textDecoration=\'underline\'" onMouseOut="this.style.textDecoration=\'none\'">$1</span> <span style="display:inline-block;float:right" onMouseOver="this.style.textDecoration=\'underline\'" onMouseOut="this.style.textDecoration=\'none\'">$2</span>');});
								$(tr).find('td:eq(5)').css({'white-space':'nowrap','text-align':'center','padding':'4px 0px'}).text(function(){return moment($(this).text().trim()+'+0200','DD.MM.YYYY HH:mm:ss Z').format(LD.fulldateshort+':ss');});
								$('#tbl_reply'+$(tr).attr('id').replace(/\D+/g,'')+',#tbl_greply'+$(tr).attr('id').replace(/\D+/g,'')).find('a[href*="receiverId"]').text(LD.dipladvtxt[21]);
								$('#tbl_reply'+$(tr).attr('id').replace(/\D+/g,'')+',#tbl_greply'+$(tr).attr('id').replace(/\D+/g,'')).find('a[onclick^="createDeletePopup"]').text(LD.dipladvtxt[22]).on('click',function()
								{
									$('#js_popupBtn1').text(LD.dipladvtxt[29]).parent().prev('div').text(LD.dipladvtxt[28]);
									$('#js_popupBtn2').text(LD.dipladvtxt[30]);
//									console.log($('#js_popupBtn1').text());
								});
								$('#tbl_greply4 > td > span > a').text(LD.dipladvtxt[22]);
								$('#tbl_reply'+$(tr).attr('id').replace(/\D+/g,'')+',#tbl_greply'+$(tr).attr('id').replace(/\D+/g,'')).find('a[onclick^="createReportPopup"]').attr('title',LD.dipladvtxt[26]).text(LD.dipladvtxt[23]).on('click',function()
								{
									$('#js_popupBtn1').text(LD.dipladvtxt[29]).parent().prev('div').css('text-align','justify').html(LD.dipladvtxt[26].replace('\n','<br>')).parent().prev('div').find('div:eq(1) > h3').text(LD.dipladvtxt[28]);
									$('#js_popupBtn2').text(LD.dipladvtxt[30]);
//									console.log($('#js_popupBtn1').text());
								});
								$('#tbl_reply'+$(tr).attr('id').replace(/\D+/g,'')+',#tbl_greply'+$(tr).attr('id').replace(/\D+/g,'')).find('a[href*="allyId"]').text(LD.dipladvtxt[25]);
								$('#tbl_reply'+$(tr).attr('id').replace(/\D+/g,'')+',#tbl_greply'+$(tr).attr('id').replace(/\D+/g,'')).find('a[href*="ignoreId"]').attr('title',LD.dipladvtxt[27]).text(LD.dipladvtxt[24]);
								$('#tbl_mail'+$(tr).attr('id').replace(/\D+/g,'')+',#tbl_gmail'+$(tr).attr('id').replace(/\D+/g,'')).find('td.msgText').html(function()
								{
									anchorme({input:$(this).html(),options:{attributes:{target:'_blank',style:'color:blue'}}});
									return anchorme({input:$(this).html(),options:{attributes:{target:'_blank',style:'color:blue'}}}).replace(/(\[\d+:\d+\])/igm,function(x)
									{
										var c = x.replace(/(\[|\])/igm,'').split(':');
										return '<a href="?view=island&islandId='+Utils.isXYtoID(c[0],c[1])+'" style="color:blue">['+c[0]+':'+c[1]+']</a>';
									});
								});
							}
						}
					});
				}
				else if(view=='diplomacyAdvisorArchiveOutBox')
				{
					$('#tab_diplomacyAdvisor > div:eq(1) > h3').text(LD.dipladvtxt[10]);
					var rows = $('form#deleteMessages > table > tbody > tr').length;
					$('form#deleteMessages > table > tbody > tr').each(function(i,tr)
					{
						if(i==0)
						{
							if(rows==1)
							{
								$(tr).find('th > p').text(LD.dipladvtxt[31]);
							}
							else
							{
								$(tr).find('th:eq(0)').text(LD.dipladvtxt[13]);
								$(tr).find('th:eq(1)').text(LD.dipladvtxt[42]);
								$(tr).find('th:eq(2)').text(LD.dipladvtxt[15]);
								$(tr).find('th:eq(4)').text(LD.dipladvtxt[17]);
							}
						}
						else
						{
							if($(tr).attr('id')!=undefined && $(tr).attr('id').startsWith('message'))
							{
								$(tr).attr('title',LD.dipladvtxt[18]);
								$(tr).find('td:eq(0)').css({'width':'14px'});
								$(tr).find('td:eq(1)').css({'width':'20px','padding':'4px 0px'});
								$(tr).find('td:eq(2)').find('a').css('white-space','nowrap').removeAttr('href').text(function(){return $(this).text().trim();});
								$(tr).find('td:eq(3)').css({'white-space':'nowrap'}).text(function(){return $(this).text().trim();});
								$(tr).find('td:eq(5)').css({'white-space':'nowrap','text-align':'center','padding':'4px 0px'}).text(function(){return moment($(this).text().trim()+'+0200','DD.MM.YYYY HH:mm:ss Z').format(LD.fulldateshort+':ss');});
								$('#tbl_mail'+$(tr).attr('id').replace(/\D+/g,'')).find('td.msgText').html(function()
								{
									anchorme({input:$(this).html(),options:{attributes:{target:'_blank',style:'color:blue'}}});
									return anchorme({input:$(this).html(),options:{attributes:{target:'_blank',style:'color:blue'}}}).replace(/(\[\d+:\d+\])/igm,function(x)
									{
										var c = x.replace(/(\[|\])/igm,'').split(':');
										return '<a href="?view=island&islandId='+Utils.isXYtoID(c[0],c[1])+'" style="color:blue">['+c[0]+':'+c[1]+']</a>';
									});
								});
								$('#actionType + a.button').attr('title',LD.dipladvtxt[22]).text(LD.dipladvtxt[22]).on('click',function()
								{
									$('#js_popupBtn1').text(LD.dipladvtxt[29]).parent().prev('div').text(LD.dipladvtxt[28]);
									$('#js_popupBtn2').text(LD.dipladvtxt[30]);
//									console.log($('#js_popupBtn1').text());
								});
							}
						}
					});
					var pg = $('form#deleteMessages > table > tbody > tr > td.paginator').css('text-align','center').contents().filter(function(){return this.nodeType==Node.TEXT_NODE && $.trim(this.nodeValue)!=='';}).text().trim().split('-');
					var prev = parseInt(pg[0])>1?'<a onclick="ajaxHandlerCall(this.href);return false;" href="?view=diplomacyAdvisorOutBox&amp;start='+(parseInt(pg[0])-11)+'" title="...'+LD.dipladvtxt[33]+' 10">...'+LD.dipladvtxt[33]+' 10 <img src="skin/interface/btn_min.png"></a>':'';
					var next = parseInt(pg[1])<parseInt($('#tab_diplomacyAdvisor > div:eq(0)').find('span.name:eq(1)').text().replace(/\D+/g,''))?' <a onclick="ajaxHandlerCall(this.href);return false;" href="?view=diplomacyAdvisorOutBox&amp;start='+pg[1]+'" title="...'+LD.dipladvtxt[32]+' 10"><img src="skin/interface/btn_max.png"> '+LD.dipladvtxt[32]+' 10...</a>':'';
					$('form#deleteMessages > table > tbody > tr > td.paginator').html(prev+parseInt(pg[0])+' - '+parseInt(pg[1])+next);
					$('form#deleteMessages > table > tbody > tr > td.paginator').parent().next('tr').find('td > a:first').text(LD.dipladvtxt[34]);
					$('form#deleteMessages > table > tbody > tr > td.paginator').parent().next('tr').find('td > a:last').text(LD.dipladvtxt[37]);
					$('input#actionType + a.button').attr('title',LD.dipladvtxt[39]).text(LD.dipladvtxt[39]);
					$('#sidebar').hide();
				}
				var toast = LD.advisors[3];
			}
			else if(view=='diplomacyIslandBoard')
			{
				$('#sidebarWidget > li:first').hide();
				$('#tab_diplomacyIslandBoard > div:first > a').text(LD.dipladvtxt[43]);
				$('#tab_diplomacyIslandBoard > div:last > h3,#sidebarWidget > li:eq(1) > a').text(LD.dipladvtxt[44]);
				$('#tab_diplomacyIslandBoard > div:last > div.content > div > p.warning').text(LD.dipladvtxt[45]);
				$('form.newMessage').css({'width':'520px','margin':'20px auto'}).find('p').css({'text-align':'justify','padding':'4px 0px 4px 20px'}).text(LD.dipladvtxt[102]);
				$('form.newMessage > div.postMessage > label:first').text(LD.dipladvtxt[103]);
				$('form.newMessage > div.postMessage > label:last').text(LD.dipladvtxt[104]);
				$('form.newMessage > div.postMessage > div.centerButton > input').val(LD.dipladvtxt[105]);
				$('form.newMessage > div.postMessage > div.centerButton > a').text(LD.dipladvtxt[106]);
				$('form.newMessage > div.postMessage > span.chars').hide().after('<span id="empire_msgRemainingChars" class="chars bold tinyFont">'+Utils.format(LD.dipladvtxt[107],[Utils.FormatNumToStr(1000)])+'</span>');
				$('#js_islandMsgTextInput').on('keyup textInput',function(e)
				{
					var len = 1000-e.target.value.length;
					$('#empire_msgRemainingChars').text(Utils.format(LD.dipladvtxt[len==0?109:(len==1?108:107)],[Utils.FormatNumToStr(len)]));
				});
				var toast = LD.agora;
			}
			else if(view=='diplomacyTreaty')
			{
				$('#sidebarWidget > li:first').hide();
				$('#tab_diplomacyTreaty > div:first > h3').text(LD.dipladvtxt[48]);
				$('#tab_diplomacyTreaty > div:first > div.content > table > tbody > tr').each(function(k,tr)
				{
					if(k==0)
					{
						$(tr).html('<th>'+LD.dipladvtxt[49]+'</th><th>'+LD.dipladvtxt[50]+'</th><th>'+LD.dipladvtxt[51]+'</th><th>'+LD.dipladvtxt[52]+'</th>');
					}
					else
					{
						var cities = $(tr).find('td[id^="show"] > div.tooltip > table > tbody > tr');
						$(tr).find('td[id^="show"] > div.tooltip > table').css({'margin':'0 auto'}).find('tbody > tr').each(function(i,ct)
						{
							if(i==0)
							{
								$(ct).html('<th style="text-align:center;font-weight:bold">'+LD.dipladvtxt[56]+'</th><th style="text-align:center;font-weight:bold">'+LD.dipladvtxt[57]+'</th><th style="text-align:center;font-weight:bold">'+LD.dipladvtxt[58]+'</th>');
							}
							else
							{
								$(ct).find('td.location').css({'text-align':'center','width':'50px'}).text(function(){return $(this).text().replace(/\[(\d+)?\s+?:(\d+)\][^]*/g,'[$1:$2]')});
								$(ct).find('td.cityName').css({'white-space':'nowrap'});
								$(ct).find('td.luxuryGood').css({'text-align':'center'});
							}
						});
						$(tr).find('td[id^="show"] > div[id^="panel"] > p.city_count').text(Utils.format(LD.dipladvtxt[cities.length==2?55:54],[cities.length-1]));
						$(tr).find('td.actions > a:first').attr('title',LD.CompMsg).find('img').attr('alt',LD.CompMsg);
						$(tr).find('td.actions > a:last').attr('title',LD.dipladvtxt[53]).find('img').attr({'title':LD.dipladvtxt[53],'alt':LD.dipladvtxt[53]});
					}
				});
				$('#tab_diplomacyTreaty > div:last > h3').text(function(){return Utils.format(LD.dipladvtxt[59],[$(this).text().replace(/[^]*\((\d+)\/(\d+)\)/g,'($1/$2)')]);});
				$('#tab_diplomacyTreaty > div:last > div.content > table > tbody > tr:not(:first)').each(function(k,tr)
				{
					$(tr).find('td.city').text(function(){return $(this).text().trim();});
					var icon = $(tr).find('td:eq(3) > img').attr('src').split('_')[0].split('/').pop();
//					console.log(icon);
					$(tr).find('td:eq(3) > img').attr({'alt':LD[icon],'title':LD[icon]})
					$(tr).find('td.actions > a').attr('title',LD.dipladvtxt[60]);
				});
				$('#tab_diplomacyTreaty > div:last > div.content > div.centerButton > a').text(function(){return Utils.format(LD.dipladvtxt[61],[$(this).text().replace(/\D+/g,'')])});
				if($('#sidebarWidget > li:eq(1) > a')[0]!=undefined)
				{
					$('#sidebarWidget > li:eq(1) > a')[0].childNodes[0].textContent = LD.dipladvtxt[40];
					$('#diplomaticInfluenceSidebar > p').text(function(){return Utils.format(LD.dipladvtxt[41],[$(this).text().replace(/\D+/g,'')]);});
				}
				if(database.settings.ctfinder.value)
				{
					if($('#tab_diplomacyTreaty > div:first > div.content > table:not(#culturalTreaties,#militaryAccessObtained)').length)
					{
						$('#tab_diplomacyTreaty > div:first > div.content > table:not(#culturalTreaties,#militaryAccessObtained) > tbody > tr:not(:first)').each(function(k,tr)
						{
							var uid = $(tr).find('td.actions > a:first').attr('href').split('=')[2];
							if(Object.keys(database.getGlobalData.getMuseumTreaties).indexOf(uid)!=-1)
							{
								$(tr).find('td:first').append('<img src="skin/museum/icon32_culturalgood.png" style="width:15px;height:auto;float:right" title="'+LD.ctenabled+'">');
							}
							else if(Object.keys(database.getGlobalData.getPotMuseumTreaties).indexOf(uid)!=-1)
							{
								$(tr).find('td:first').append('<img src="skin/museum/icon32_culturalgood.png" style="width:15px;height:auto;opacity:0.5;float:right" title="'+LD.ctrequested[database.getGlobalData.getPotMuseumTreaties[uid].type*0.5-39]+'">');
							}
						});
					}
					if($('#militaryAccessObtained > tbody > tr:not(:first)').length)
					{
						$('#militaryAccessObtained > tbody > tr:not(:first)').each(function(k,tr)
						{
							var uid = $(tr).find('td.actions > a:nth-child(1)').attr('href').split('&')[1].replace(/\D+/g,'');
							if(Object.keys(database.getGlobalData.getMuseumTreaties).indexOf(uid)!=-1)
							{
								$(tr).find('td:first').append('<img src="skin/museum/icon32_culturalgood.png" style="width:15px;height:auto;float:right" title="'+LD.ctenabled+'">');
							}
							else if(Object.keys(database.getGlobalData.getPotMuseumTreaties).indexOf(uid)!=-1)
							{
								$(tr).find('td:first').append('<img src="skin/museum/icon32_culturalgood.png" style="width:15px;height:auto;opacity:0.5;float:right" title="'+LD.ctrequested[database.getGlobalData.getPotMuseumTreaties[uid].type*0.5-39]+'">');
							}
						});
					}
				}
				var citysort = '<tr><th colspan="2">'+LD.city+'</th><th>'+LD.cultural+'</th><th>'+LD.museumlvl+'</th><th>'+LD.satisfaction+'</th><th>'+LD.action+'</th></tr>';
				$.each(database.settings.cityOrder.value,function(k,c)
				{
					citysort += $('#culturalTreaties > tbody > tr:not(:first) > td.actions > a[href*="cityId='+c+'"]').parents('tr').prop('outerHTML')+'\r\n';
				});
				$('#culturalTreaties > tbody').html(citysort);
				$('#culturalTreaties > tbody > tr:not(:first)').each(function(k,c)
				{
					$(c).removeClass('alt').addClass(k%2==1?'alt':'').find('td:first').before('<td style="text-align:center">'+(k+1)+'</td>');
				});
				var toast = LD.treaties_;
			}
			else if(view=='diplomacyAlly')
			{
				$('#sidebar').hide();
				$('#tab_diplomacyAlly > div:first > h3')[0].childNodes[0].textContent = LD.dipladvtxt[6]+' ';
				$('#tab_diplomacyAlly > div:first > h3 > a').attr('title',LD.embassytxt[36]).find('span').text(LD.embassytxt[36]);
				$('#tab_diplomacyAlly > div:first > div.content > div.filter > span.filterEntry:eq(0) > a').attr('title',LD.dipladvtxt[62]).find('span.filterEntryButton > span:last').text(function(){return Utils.format(LD.dipladvtxt[63],[Utils.FormatNumToStr(parseInt($(this).text().replace(/\D+/g,'')),false,0)]);});
				$('#tab_diplomacyAlly > div:first > div.content > div.filter > span.filterEntry:eq(1) > a').attr('title',LD.dipladvtxt[64]).find('span.filterEntryButton > span:last').text(LD.dipladvtxt[65]);
				$('#tab_diplomacyAlly > div:first > div.content > div.filter > span.filterEntry:eq(2) > a').attr('title',LD.dipladvtxt[66]).find('span.filterEntryButton > span:last').text(LD.dipladvtxt[66]);
				$('#tab_diplomacyAlly > div:first > div.content > div.filter > span.filterEntry:eq(3) > a').attr('title',LD.dipladvtxt[67]).find('span.filterEntryButton > span:last').text(LD.dipladvtxt[67]);
				$('#tab_diplomacyAlly > div:last > h3').text(LD.dipladvtxt[62]);
				$('#tab_diplomacyAlly > div:last > div.content > table.topic_table > tbody > tr').each(function(k,tr)
				{
					if(k==0)
					{
						$(tr).html('<th class="openCloseArrow"></th><th class="topic_title">'+LD.dipladvtxt[68]+'</th><th class="topic_num_threads">'+LD.dipladvtxt[69]+'</th><th class="topic_lastupdate">'+LD.dipladvtxt[70]+'</th><th class="topic_actions">'+LD.dipladvtxt[71]+'</th>');
					}
					else
					{
						$(tr).find('td:eq(2)').text(function(){return Utils.format(LD.dipladvtxt[72],[Utils.FormatNumToStr(parseInt($(this).text().replace(/\D+/g,'')),false,0)]);});
						$(tr).find('td:eq(3)').css({'white-space':'nowrap','text-align':'center','padding':'4px 0px'}).text(function(){return moment($(this).text().trim()+'+0200','DD.MM.YYYY HH:mm:ss Z').format(LD.fulldateshort+':ss');});
					}
				});
				$('#tab_diplomacyAlly > div:last > div.content > table.board_header_table:first > tbody > tr.header_bar > td:first > a:first').text(LD.dipladvtxt[62]);
				$('#tab_diplomacyAlly > div:last > div.content > table.thread_table > tbody > tr').each(function(k,tr)
				{
					if(k==0)
					{
						$(tr).html('<th class="thread_title">'+LD.dipladvtxt[73]+'</th><th class="thread_replies">'+LD.dipladvtxt[74]+'</th><th class="thread_lastupdate">'+LD.dipladvtxt[70]+'</th><th class="thread_actions">'+LD.dipladvtxt[71]+'</th>');
					}
					else
					{
						$(tr).find('td:eq(1)').text(function(){return Utils.FormatNumToStr(parseInt($(this).text().replace(/\D+/g,'')),false,0);});
						$(tr).find('td:eq(2)')[0].childNodes[2].textContent = moment($(tr).find('td:eq(2)')[0].childNodes[2].nodeValue.trim()+'+0200','DD.MM.YYYY HH:mm:ss Z').format(LD.fulldateshort+':ss');
					}
				});
				$('#tab_diplomacyAlly > div:last > div.content > table.board_header_table:last > tbody > tr > td:first > div.thread_buttons > a').attr('title',LD.dipladvtxt[75]).text(LD.dipladvtxt[75]);
				$('#tab_diplomacyAlly > div:last > div.content > table.board_header_table:last > tbody > tr > td:first > div.posting_table_footer > a:first').attr('title',LD.dipladvtxt[76]).text(LD.dipladvtxt[76]);
				$('#tab_diplomacyAlly > div:last > div.content > table.posting_table > tbody > tr').each(function(k,tr)
				{
					$(tr).find('td.posting_right_column > div.posting_header > table > tbody > tr > td:eq(1) > span').text(function(){return moment($(this).text().trim()+'+0200','DD.MM.YYYY HH:mm:ss Z').format(LD.fulldateshort+':ss');});
					$(tr).find('td.posting_right_column > div.posting_header > table > tbody > tr > td:eq(2) > a:first').attr('title',LD.dipladvtxt[78]);
					$(tr).find('td.posting_right_column > div.posting_header > table > tbody > tr > td:eq(2) > a:last').attr('title',LD.dipladvtxt[79]);
					$(tr).find('td.posting_right_column > div.posting_footer').text(function(){return $(this).text().replace(/\(([^]*)\)/,'('+(moment($(this).text().replace(/[^]*\(([^]*)\)/,'$1').trim()+'+0200','DD.MM.YYYY HH:mm:ss Z').format(LD.fulldateshort+':ss'))+')');});
				});
				$('#tab_diplomacyAlly > div:last > div.content > table.board_header_table:last > tbody > tr > td:first > div.posting_table_footer > a:last').attr('title',LD.dipladvtxt[77]).find('img').attr({'alt':LD.dipladvtxt[77],'title':LD.dipladvtxt[77]});
				$('#js_ThreadTitleInput').prev('label').text(LD.dipladvtxt[80]);
				$('#js_CreateSubmit').val(LD.dipladvtxt[81]);
				$('#js_CreateSubmit + span.smallFont:first').hide().after('<span id="empire_nrChars">'+Utils.format(LD.dipladvtxt[82],[Utils.FormatNumToStr(10000)])+'</span>');
				$('#js_ThreadTextInput').on('keyup',function(e)
				{
					var target = e.target;
//					console.log($(target).val());
					var chars = $(target).val().length==10000 ? LD.dipladvtxt[84] : Utils.format(LD.dipladvtxt[10000-$(target).val().length==1?83:82],[Utils.FormatNumToStr(10000-$(target).val().length,false,0)]);
					$('#empire_nrChars').html(chars);
				});
				var toast = LD.dipladvtxt[6];
			}
			else if(view=='diplomacyAdvisorSearchUser')
			{
				$('#sidebar').hide();
				$('#tab_diplomacyAdvisor > div > h3').text(LD.dipladvtxt[4]);
				$('#tab_diplomacyAdvisor').find('div.userSearchContainer').css({'margin':'5px auto','text-align':'center'});
				$('#tab_diplomacyAdvisor').find('form > span.player_name_label').text(LD.dipladvtxt[85]+':');
				$('#tab_diplomacyAdvisor').find('form > input[type="submit"]').val(LD.dipladvtxt[86]);
				$('#userSearchTable > thead > tr > th').each(function(k,th){return $(th).text(LD.dipladvtxt[k+87]);});
				$('#userSearchTable > tbody > tr').each(function(i,tr)
				{
					if($('#userSearchTable > tbody > tr').length==1&&$('#userSearchTable > tbody > tr > td:first').attr('colspan')!=undefined)
					{
						$(tr).find('td').attr('colspan',6).text(LD.dipladvtxt[93]);
					}
					else
					{
						$(tr).find('td:eq(0)').text(function(){return Utils.FormatNumToStr(parseInt($(this).text().replace(/\D+/g,'')),false,0);});
						$(tr).find('td:eq(4)').text(function(){return Utils.FormatNumToStr(parseInt($(this).text().replace(/\D+/g,'')),false,0);});
						$(tr).find('td:eq(5)').css('text-align','center').find('a').attr('title',LD.CompMsg).find('img').attr({'alt':LD.CompMsg,'title':LD.CompMsg});
					}
				});
				if(database.settings.ctfinder.value)
				{
					$('#userSearchTable > tbody > tr').each(function(k,tr)
					{
						var uid = 0;
						if($(tr).find('td:nth-child(3) > a').length)
						{
							uid = $(tr).find('td:nth-child(3) > a').attr('href').split('&')[1].replace(/\D+/g,'');
							if(Object.keys(database.getGlobalData.getMuseumTreaties).indexOf(uid)!=-1)
							{
								$(tr).find('td:nth-child(3) > a').append('<img src="skin/museum/icon32_culturalgood.png" style="width:15px;height:auto;float:right" title="'+LD.ctenabled+'">');
							}
							else if(Object.keys(database.getGlobalData.getPotMuseumTreaties).indexOf(uid)!=-1)
							{
								$(tr).find('td:nth-child(3) > a').append('<img src="skin/museum/icon32_culturalgood.png" style="width:15px;height:auto;opacity:0.5;float:right" title="'+LD.ctrequested[database.getGlobalData.getPotMuseumTreaties[uid].type*0.5-39]+'">');
							}
						}
					});
				}
				var toast = LD.playersearch;
			}
			else if(view=='ignoreList')
			{
				$('#sidebar').hide();
				$('#tabMenu + div.contentBox01h > h3').text(LD.dipladvtxt[94]);
				$('#tabMenu + div.contentBox01h > div.content > p').text(LD.dipladvtxt[95]);
				$('#ignoreListTable > thead > tr > th').each(function(k,th){$(th).text(LD.dipladvtxt[k+96]);});
				$('#ignoreListTable > tbody > tr > td:last > a').attr('title',LD.dipladvtxt[100]).text(LD.dipladvtxt[101]);
				var toast = LD.ignoreList;
			}
			render.toast(Utils.format('{0}: {1}',[LD.updated_,toast]));
		},
		parseResearchAdvisor: function(data)
		{
			var now = moment();
			$('[id^="empire_researchAdvisorPoints"], [id^="empire_researchAdvisorCurrResearchCosts"], [id^="researchAdvisorCurrResearchCostsPercentage"], [id^="empire_researchAdvisorCurrResearchPointsNotEnough"], [id^="empire_researchAdvisorCurrResearchTimeNeeded"], [id^="empire_researchAdvisorProgressTxt"]').remove();
			var LD = Constant.LanguageData[database.settings.languageChange.value];
			var tot = [0,parseInt($('#js_researchAdvisorPoints').text().replace(/(\d+)[,.](?=\d{3}(\D|$))/g,'$1')),0,0,0,0,0];
			$.each(database.cities,function(k,c)
			{
				tot[0] += c.research.getResearchers;
				tot[2] += c.research.getResearch;
				tot[3] += c.research.researchData.researchBonus;
				tot[4] += c.research.researchData.corruption;
				tot[5] += c.research.researchData.premiumCulturalGoodsBonus;
				tot[6] += c.research.researchData.culturalGoods;
			});
			$('#js_mainBoxHeaderTitle').text(LD.advisors[2]);
			database.getGlobalData._research.unused = parseInt($('#js_researchAdvisorPoints').text().replace(/(\d+)[,.](?=\d{3}(\D|$))/g,'$1'));
			database.getGlobalData._research.lastUpdate = $.now();
			$.ajax(
			{
				success: function()
				{
					var check = $('#js_researchAdvisorCurrResearchesArr > li:last > a').attr('href').replace(/\D+/g,'');
					var selected = $('#js_researchAdvisorCurrResearchesArr > li.selected > a').attr('href').replace(/\D+/g,'');
					var rtype = 0;
					for(var i=0;i<4;i++)
					{
						var nextcost = parseInt($('#js_researchAdvisorNextResearchCost'+i).text().replace(/\D+/g,''));
						$('#js_researchAdvisorNextResearchCost'+i).text(Utils.FormatNumToStr(nextcost));
						$('#js_researchAdvisorChangeResearchTypeTxt'+i).text(LD.researchzones[i]);
						var next = 0, flvl = 0;
						$.each(Object.values(Object.values(Constant.Research)[i]),function(a,n)
						{
							if(database.getGlobalData.getResearchTopicLevel(n)==0 || (a==Object.values(Object.values(Constant.Research)[i]).length-1 && database.getGlobalData.getResearchTopicLevel(n)>0))
							{
								next = n;
								flvl = a==Object.values(Object.values(Constant.Research)[i]).length-1 ? database.getGlobalData.getResearchTopicLevel(n)+1:0;
//								console.log(next,flvl);
								return false;
							}
						});
						$('#js_researchAdvisorNextResearchName'+i+',#js_researchAdvisorNextResearchTooltipName'+i).text(LD.researchtxt[next]+(flvl>0?' ('+flvl+')':''));
						$('#js_researchAdvisorNextResearchTooltipShortDesc'+i).text(LD.researchshortdesc[next]);
						$('#js_researchAdvisorProgressTxt'+i).hide().after('<div id="empire_researchAdvisorProgressTxt'+i+'_'+now+'" class="bold smallFont" style="text-shadow: -1px -1px 0 #FFFFFF, 1px -1px 0 #FFFFFF, -1px 1px 0 #FFFFFF, 1px 1px 0 #FFFFFF;">'+(tot[0]==0?LD.resadvtxt[0]:(tot[1]<nextcost && data['js_researchAdvisorProgressbar'+i].progressbar!=undefined?Utils.format(LD.resadvtxt[1],[Utils.FormatTimeLengthToStr(data['js_researchAdvisorProgressbar'+i].progressbar.enddate*1000-moment(),5)]):LD.resadvtxt[2]))+'</div>');
						$.each(Object.values(Constant.Research)[i],function(k,n) { rtype += n==check ? i : 0; });
					}
					$('#js_researchAdvisorScientists').parent().html(LD.scientists+': <span id="js_researchAdvisorScientists" style="font-weight:bold">'+Utils.FormatNumToStr(tot[0])+'</span>');
					$('#js_researchAdvisorPoints').hide().parent().contents().first().each(function(){$(this).replaceWith(LD.researchP+': ');});
					$('#js_researchAdvisorPoints').after('<span id="empire_researchAdvisorPoints_'+now+'" style="font-weight:bold">'+Utils.FormatNumToStr(tot[1])+'</span>');
					$('#js_researchAdvisorTime').parent().html(LD.resadvtxt[3]+': <span id="js_researchAdvisorTime" style="font-weight:bold">'+Utils.FormatNumToStr(tot[2],false,2)+'</span><div id="js_infoResearchAdvisorBreakdownTooltip" class="tooltip" style="line-height:13px;" updated="true"><table class="breakdown_table"><tbody><tr><td class="description">'+LD.resadvtxt[4]+':</td><td class="value">'+Utils.FormatNumToStr(tot[0],false,2)+'</td></tr><tr><td class="description">'+LD.corruption+':</td><td class="value">'+(tot[4]==0?'+':'-')+' '+Utils.FormatNumToStr(tot[4],false,2)+'</td></tr><tr><td style="white-space:nowrap">'+LD.resadvtxt[5]+':</td><td class="value">+ '+Utils.FormatNumToStr(tot[5],false,2)+'</td></tr><tr><td>'+LD.research+':</td><td class="value">+ '+Utils.FormatNumToStr(tot[3],false,2)+'</td></tr>'+(tot[6]>0?'<tr><td>'+LD.cultural+'</td><td class="value">'+Utils.FormatNumToStr(tot[6],false,2)+'</td></tr>':'')+'<tr><td>&nbsp;</td><td>&nbsp;</td></tr><tr><td>'+LD.total_+':</td><td class="value">'+Utils.FormatNumToStr(tot[0]-tot[4]+tot[3]+tot[5]+tot[6],false,2)+'</td></tr></tbody></table></div>');
					$('#js_researchAdvisorCurrResearchName').text(LD.researchtxt[selected]+(selected%1000==999?' ('+(database.getGlobalData.getResearchTopicLevel(selected)+1)+')':''));
					var CurrCost = parseInt($('#js_researchAdvisorCurrResearchCosts').text().replace(/(\d+)[,.](?=\d{3}(\D|$))/g,'$1'));
					var n = {b:'buildingId',f:'formId',h:'helpId',sh:'subHelpId',s:'shipId',u:'unitId',v:'view'};
					var v = {b:'buildingDetail',f:'formOfRuleDetail',i:'ikipedia',u:'unitdescription'};
					$('#js_researchAdvisorCurrResearchDesc').html(LD.researchdesc[selected].replace(/\[\[([^\[\]]*)\]\]/g,function(match)
					{
						var m = match.split('|');
						var href = m[0].split(',');
						var hf = '<a href="?';
						for(var i=0;i<href.length;i++)
						{
							var kv = href[i].split(':');
							hf += n[kv[0].replace(/\[/g,'')]+'='+(kv[0].replace(/\[/g,'')=='v' ? v[kv[1]] : kv[1])+(i<href.length-1?'&':'')
						}
						hf += '" onclick="ajaxHandlerCall(this.href);return false;" style="text-decoration:underline">'+m[1].replace(/\]/g,'')+'</a>';
						return hf;
					}));
					$('#js_researchAdvisorCurrResearchDesc + span.desc').css('width','100px').text(LD.resadvtxt[9]+':');
					var rtptxt = ['seafaring','economy','knowledge','military'];
					var precondsum = 0;
					$('#js_researchAdvisorCurrResearchPrecondArr > li').each(function(k,li)
					{
						var rid = parseInt($(li).find('a').attr('href').replace(/\D+/,''));
						var rt = rtptxt.indexOf($(li).find('a').attr('href').split('=')[3]);
						precondsum += database.getGlobalData.getResearchTopicLevel(rid)==0?Constant.Research.Costs[rid]:0;
						$(li).find('a').html(LD.researchtxt[rid]+' ('+LD.researchzones[rt]+')<span'+(database.getGlobalData.getResearchTopicLevel(rid)>0?' class="arrow_ok"':' style="float:right"')+'>'+(database.getGlobalData.getResearchTopicLevel(rid)>0?'':Utils.FormatNumToStr(Constant.Research.Costs[rid])+' <img src="skin/resources/icon_research.png" style="width:11px;height:14px">')+'</span>');
					});
					$('#js_researchAdvisorCurrResearchPrecondArr').css('margin-left','100px').append($('#js_researchAdvisorCurrResearchPrecondArr > li').length>1 && precondsum>0?'<hr style="margin: 0px 0px"><li class="bold red">&Sigma;<span style="float:right">'+Utils.FormatNumToStr(precondsum)+' <img src="skin/resources/icon_research.png" style="width:11px;height:14px"></span></li>':'');
					$('#js_researchAdvisorCurrResearchPrecondArr + span.desc').text(LD.resadvtxt[10]+':');
					$('[id^="empire_researchAdvisorCurrResearchCosts"]').remove();
					$('span#js_researchAdvisorCurrResearchCosts').hide().after('<span id="empire_researchAdvisorCurrResearchCosts_'+now+'" class="'+$('span#js_researchAdvisorCurrResearchCosts').attr('class')+'" style="margin-left:-40px"></span>');
					$('span#empire_researchAdvisorCurrResearchCosts_'+now).html(Utils.FormatNumToStr(CurrCost,false,0)+($('#js_researchAdvisorCurrResearchesArr > li.selected:not(.explored)').length>0 && tot[1]<=CurrCost ?' <b>(<span id="researchAdvisorCurrResearchCostsPercentage_'+now+'">'+Utils.FormatNumToStr((1-((CurrCost-tot[1])/CurrCost))*100,false,3)+'</span> %)</b>':''));
					$('[id^="empire_researchAdvisorCurrResearchPointsNotEnough"]').remove();
					$('span#js_researchAdvisorCurrResearchPointsNotEnough').hide().after('<span id="empire_researchAdvisorCurrResearchPointsNotEnough_'+now+'" class="red" style="margin-left:-40px"></span>');
					$('span#empire_researchAdvisorCurrResearchPointsNotEnough_'+now).text($('#js_researchAdvisorCurrResearchesArr > li.selected:not(.explored)').length>0 && tot[1]<=CurrCost ?LD.resadvtxt[6]:'');
					$('#js_researchesOfTypeDetails > span.desc').text(LD.resadvtxt[11]+':');
					$('[id^="empire_researchAdvisorCurrResearchTimeNeeded"]').remove();
					$('#js_researchAdvisorCurrResearchTimeNeeded').hide().after('<span id="empire_researchAdvisorCurrResearchTimeNeeded_'+now+'" style="display: inline-block;text-align:center;font-weight:bold;margin-left:-40px"></span>');
//					console.log(rtype);
					$('#empire_researchAdvisorCurrResearchTimeNeeded_'+now).html($('#js_researchAdvisorCurrResearchesArr > li.selected.explored').length>0?LD.resadvtxt[7]:(tot[1]>=CurrCost || data['js_researchAdvisorProgressbar'+rtype].progressbar==undefined ?LD.resadvtxt[8]:Utils.FormatFullTimeToDateString(data['js_researchAdvisorProgressbar'+rtype].progressbar.enddate*1000)+'<br>('+Utils.FormatTimeLengthToStr(data['js_researchAdvisorProgressbar'+rtype].progressbar.enddate*1000-moment(),5)+')'));
					$('#tab_researchAdvisor > h3.header').html(LD.zones[rtype]);
					$('#js_researchAdvisorConservationLink').text(LD.research);
					var changes = [];
					var selected = 0;
					$('#js_researchAdvisorCurrResearchesArr > li').each(function(a,li)
					{
						var id = parseInt($(li).find('a').attr('href').replace(/\D+/g,''));
						var level = parseInt($(li).find('a').text().replace(/\D+/,''));
						var explored = !isNaN(level) ? level-1 : ($(li).hasClass('explored')===true ? 1 : 0);
						selected += parseInt($(li).hasClass('selected')===true ? id : 0);
						var changed = database.getGlobalData.updateResearchTopic(id,explored);
						if(changed) changes.push({type:'research_topic',subType:id});
						$(li).css({'list-style-position':'outside','margin-left':'20px'}).find('a').css({'margin':'0px'}).text(LD.researchtxt[id]+(id==((rtype+1)*1000)+999?' ('+(database.getGlobalData.getResearchTopicLevel(id)+1)+')':''));
					});
					if(changes.length) events(Constant.Events.GLOBAL_UPDATED).pub(changes);
					var s = 0;
					var cc = parseInt(unsafeWindow.ikariam.templateView.script.params.currResearchCosts.replace(/(\d+)[,.](?=\d{3}(\D|$))/g,'$1'));
					if(tot[0]>0)
					{
						var rate = parseFloat((tot[0]-tot[4]+tot[3]+tot[5])/3600);
						var rPointTimer = setInterval(function()
						{
							var CurrCost = parseInt($('#js_researchAdvisorCurrResearchCosts').text().split(' ')[0].replace(/(\d+)[,.](?=\d{3}(\D|$))/g,'$1'));
							$('#empire_researchAdvisorPoints_'+now).text(Utils.FormatNumToStr(tot[1]+(s*rate),false,0));
							$('#researchAdvisorCurrResearchCostsPercentage_'+now).text(Utils.FormatNumToStr((1-((cc-tot[1]-(s*rate))/cc))*100,false,3));
							$('#empire_researchAdvisorCurrResearchPointsNotEnough_'+now).text($('#js_researchAdvisorCurrResearchesArr > li.selected:not(.explored)').length>0 && tot[1]+(s*rate)<=CurrCost ?LD.resadvtxt[6]:'');
							
							if(tot[1]+(s*rate)<=CurrCost && $('#js_researchAdvisorCurrResearchesArr > li.selected:not(.explored)'))
							{
								$('#empire_researchAdvisorCurrResearchTimeNeeded_'+now).html($('#js_researchAdvisorCurrResearchesArr > li.selected.explored').length>0?LD.resadvtxt[7]:(tot[1]>=CurrCost || data['js_researchAdvisorProgressbar'+rtype].progressbar==undefined ?LD.resadvtxt[8]:Utils.FormatFullTimeToDateString(data['js_researchAdvisorProgressbar'+rtype].progressbar.enddate*1000)+'<br>('+Utils.FormatTimeLengthToStr(data['js_researchAdvisorProgressbar'+rtype].progressbar.enddate*1000-moment(),5)+')'));
								$('#js_researchAdvisorConservationLink').removeClass('invisible flowright button').addClass($('#js_researchAdvisorCurrResearchesArr > li.selected.explored').length>0?'invisible':(tot[1]>=CurrCost?'flowright button':'invisible'));
							}
							$('a[id^="js_researchAdvisorChangeResearchType"]').each(function(k,r)
							{
								var nextcost = parseInt($('#js_researchAdvisorNextResearchCost'+k).text().replace(/(\d+)[,.](?=\d{3}(\D|$))/g,'$1'));
								$('#empire_researchAdvisorProgressTxt'+k+'_'+now).html(tot[0]==0?LD.resadvtxt[0]:(tot[1]<nextcost && data['js_researchAdvisorProgressbar'+k].progressbar!=undefined ? Utils.format(LD.resadvtxt[1],[Utils.FormatTimeLengthToStr(data['js_researchAdvisorProgressbar'+k].progressbar.enddate*1000-moment(),5)]) : LD.resadvtxt[2]));
							});
							s++;
							$('#js_GlobalMenu_research, [id^="js_researchAdvisorChangeResearchType"], #js_researchAdvisorCurrResearchesArr > li > a').on('click',function()
							{
								if(tot[1]+(s*rate)>CurrCost){clearInterval(rPointTimer);}
							});
						},1000);
					}
					else
					{
						clearInterval(rPointTimer);
					}
					render.toast(Utils.format('{0}: {1} - {2}',[LD.updated_,LD.advisors[2],LD['zones'][rtype]]));
				}
			});
		},
		parseregGifts:function()
		{
			var LD = Constant.LanguageData[database.settings.languageChange.value];
			var now = moment();
			$('#js_mainBoxHeaderTitle').text(LD.regGiftstxt[0]);
			$('#registrationGifts > div.bd.mainContentScroll > div.mainContent.minimizableContent > div.buildingDescription > p').text(LD.regGiftstxt[1]).prev().text(LD.regGiftstxt[0]);
			$('#registrationGifts > div.bd.mainContentScroll > div.mainContent.minimizableContent > div.contentBox01h > h3').text(LD.overview);
			var serverTimezoneOffset = unsafeWindow.dataSetForView.serverTimezoneOffset;
			var diff = -(moment(now).utcOffset()*60-serverTimezoneOffset)*1000;
			var d = moment(moment(now)+diff).endOf('day')-diff;
			var giftq = [200,15,2,[100,15],100,80,150];
			var gifts = $('[id^=registrationGiftDay]').length;
			var startofshow = moment(database.getGlobalData.getRegDate+diff).startOf('day')-diff;
			var endofshow = moment(startofshow).add(gifts*2,'days');
			var dis = gifts-moment(now).diff(startofshow,'days');
			var giftcnt = $('[id^="registrationGiftDay"].button_disabled').length;
			$('[id^="registrationGiftDay"]').hide();
			$('[id^="regGiftDay"], [id^="regGiftsRemTime"]').remove();
			setInterval(function()
			{
				$('[id^=registrationGiftDay]').each(function(k,rd)
				{
					$('#regGiftDay'+(k+2)+'_'+now).attr({'class':$('#registrationGiftDay'+(k+2)).attr('class'),'href':$('#registrationGiftDay'+(k+2)).attr('href')}).prop('disabled',$('#registrationGiftDay'+(k+2)).hasClass('button_disabled')).html(dis+k<gifts?LD.regGiftstxt[$('#registrationGiftDay'+(k+2)).hasClass('button_disabled')?11:10]:Utils.FormatFullTimeToDateString(moment(startofshow).add(k+1,'days'),true)+'<br>('+Utils.FormatTimeLengthToStr(moment(startofshow).add(k+1,'days')-moment(),4)+')');
				});
				$('#regGiftsRemTime_'+now).html(moment(endofshow).subtract(7,'days')<now?Utils.format(LD.regGiftstxt[gifts-giftcnt>0?12:12],[Utils.FormatTimeLengthToStr(endofshow-moment(),4),Utils.FormatFullTimeToDateString(endofshow,true)]):'');
			},1000);
			var received = 0;
			$('[id^=registrationGiftDay]').each(function(k,rd)
			{
				received += dis+k<gifts?1:0;
				$(rd).parent().prevAll('td.registrationGiftsFirstColumn').css('opacity',dis+k<gifts?0.5:1).html(Utils.format(LD.regGiftstxt[2],[Utils.Nth(k+1)])).find('sup').css('vertical-align','text-bottom');
				$(rd).parent().prevAll('td.left').find('ul > li > span').text(Utils.format(k==3?LD.regGiftstxt[k+3][0]:LD.regGiftstxt[k+3],[Utils.FormatNumToStr(k==3?giftq[k][0]:giftq[k],false,0)]));
				$(rd).parent().prevAll('td.left').find('ul > li:nth-child(2) > span').text(Utils.format(k==3?LD.regGiftstxt[k+3][1]:LD.regGiftstxt[k+3],[Utils.FormatNumToStr(k==3?giftq[k][0]:giftq[k],false,0)]));
				$('#registrationGiftDay'+(k+2)).hide().after('<a id="regGiftDay'+(k+2)+'_'+now+'" class="'+$('#registrationGiftDay'+(k+2)).attr('class')+'" onclick="ajaxHandlerCall(this.href); return false;" disabled="disabled" href="'+$('#registrationGiftDay'+(k+2)).attr('href')+'" style="line-height:'+(dis+k<gifts?27:13)+'px;height:27px;width:160px"></a>');
				$('#regGiftDay'+(k+2)+'_'+now).html(dis+k<gifts?LD.regGiftstxt[$('#registrationGiftDay'+(k+2)).hasClass('button_disabled')?11:10]:Utils.FormatFullTimeToDateString(moment(startofshow).add(k+1,'days'),true)+'<br>('+Utils.FormatTimeLengthToStr(moment(startofshow).add(k+1,'days')-now,4)+')');
			});
			$('#registrationGiftsRemainingTimeContainer').hide().after('<p id="regGiftsRemTime_'+now+'">'+(moment(endofshow).subtract(7,'days')<now?Utils.format(LD.regGiftstxt[gifts-giftcnt>0?12:13],[Utils.FormatTimeLengthToStr(endofshow-now,4),Utils.FormatFullTimeToDateString(endofshow,true)]):'')+'</p>');
			$('[id^="regGiftDay"]:not(".button_disabled")').on('click',function()
			{
				$('[id^="registrationGiftDay"]').hide();
				$('[id^="regGiftDay"], [id^="regGiftsRemTime"]').remove();
				giftcnt = $('[id^="registrationGiftDay"].button_disabled').length;
				setInterval(function()
				{
					$('[id^=registrationGiftDay]').each(function(k,rd)
					{
						$('#regGiftDay'+(k+2)+'_'+now).attr({'class':$('#registrationGiftDay'+(k+2)).attr('class'),'href':$('#registrationGiftDay'+(k+2)).attr('href')}).prop('disabled',$('#registrationGiftDay'+(k+2)).hasClass('button_disabled')).html(dis+k<gifts?LD.regGiftstxt[$('#registrationGiftDay'+(k+2)).hasClass('button_disabled')?11:10]:Utils.FormatFullTimeToDateString(moment(startofshow).add(k+1,'days'),true)+'<br>('+Utils.FormatTimeLengthToStr(moment(startofshow).add(k+1,'days')-moment(),4)+')');
					});
					$('#regGiftsRemTime_'+now).html(moment(endofshow).subtract(7,'days')<now?Utils.format(LD.regGiftstxt[gifts-giftcnt>0?12:13],[Utils.FormatTimeLengthToStr(endofshow-moment(),4),Utils.FormatFullTimeToDateString(endofshow,true)]):'');
				},1000);
				$('[id^=registrationGiftDay]').each(function(k,rd)
				{
					$(rd).parent().prevAll('td.registrationGiftsFirstColumn').css('opacity',dis+k<gifts?0.5:1).html(Utils.format(LD.regGiftstxt[2],[Utils.Nth(k+1)])).find('sup').css('vertical-align','text-bottom');
					$(rd).parent().prevAll('td.left').find('ul > li > span').text(Utils.format(k==3?LD.regGiftstxt[k+3][0]:LD.regGiftstxt[k+3],[Utils.FormatNumToStr(k==3?giftq[k][0]:giftq[k],false,0)]));
					$(rd).parent().prevAll('td.left').find('ul > li:nth-child(2) > span').text(Utils.format(k==3?LD.regGiftstxt[k+3][1]:LD.regGiftstxt[k+3],[Utils.FormatNumToStr(k==3?giftq[k][0]:giftq[k],false,0)]));
					$('#registrationGiftDay'+(k+2)).hide().after('<a id="regGiftDay'+(k+2)+'_'+now+'" class="'+$('#registrationGiftDay'+(k+2)).attr('class')+'" onclick="ajaxHandlerCall(this.href); return false;" disabled="disabled" href="'+$('#registrationGiftDay'+(k+2)).attr('href')+'" style="line-height:'+(dis+k<gifts?27:13)+'px;height:27px;width:160px"></a>');
					$('#regGiftDay'+(k+2)+'_'+now).html(dis+k<gifts?LD.regGiftstxt[$('#registrationGiftDay'+(k+2)).hasClass('button_disabled')?11:10]:Utils.FormatFullTimeToDateString(moment(startofshow).add(k+1,'days'),true)+'<br>('+Utils.FormatTimeLengthToStr(moment(startofshow).add(k+1,'days')-now,4)+')');
				});
				$('#registrationGiftsRemainingTimeContainer').hide().after('<p id="regGiftsRemTime_'+now+'">'+(moment(endofshow).subtract(7,'days')<now?Utils.format(LD.regGiftstxt[gifts-giftcnt>0?12:12],[Utils.FormatTimeLengthToStr(endofshow-moment(),4),Utils.FormatFullTimeToDateString(endofshow,true)]):'')+'</p>');
			});
			$.ajax(
			{
				success: function()
				{
					database.getGlobalData._giftsreceived = $('td.registrationGiftsFirstColumn').filter(function(){return $(this).css('opacity')==0.5;}).length;
				}
			});
			render.toast(Utils.format('{0}: {1}',[LD.updated_,LD.regGiftstxt[0]]));
		},
		parseabolishCity: function(data)
		{
			var LD = Constant.LanguageData[database.settings.languageChange.value];
			var city = ikariam.getCurrentCity;
			$('#js_mainBoxHeaderTitle').text(LD.abandoncitytxt[1]);
			$('#abolishCity').find('div.buildingDescription > h1').text(LD.abandoncitytxt[1]);
			$('#abolishCity').find('div.buildingDescription > p').css({'text-align':'justify','margin':'0px 15px 10px 0px'}).text(LD.abandoncitytxt[2]);
			$('#abolishCity').find('form > div > h3.header').text(LD.abandoncitytxt[1]+' : '+city.getName);
			$('#abolishCity').find('form > div > div.content > p:first').css({'text-align':'justify','margin':'0px 15px 10px 0px'}).text(LD.abandoncitytxt[3]);
			$('#abolishCity').find('form > div > div.content > div:first > label').text(LD.abandoncitytxt[4]+':');
			$('#abolishCity').find('form > div > div.content > div:last > input').val(LD.abandoncitytxt[1]+': '+city.getName);
			var previous = 'captchaImage0';
			$('#abolishCity').find('form > div > div.content > img').before('<div id="captchaimgcontainer" style="display:inline-block;width:269px;height:62px"></div>');
			$('#abolishCity').find('form > div > div.content > img').appendTo('#captchaimgcontainer');
			$('#captchaimgcontainer > img.captchaImage').css({'cursor':'zoom-in'}).attr('id','captchaImage1').on('click',function()
			{
				var s=$(this).attr('id');
				$('#'+s).animate({'width':'360px','height':'83px','top':'-5px','left':'15px'});
				$('#'+s).css({'cursor':'zoom-out'});
				if($('#'+previous).width()!=269 || $('#'+previous).height()!=62)
				{
					$('#'+previous).animate({'width':'269px','height':'62px','top':'0px','left':'78px'});
					$('#'+previous).css({'cursor':'zoom-in'});
				}
				$('#captcha').focus();
				previous=s;
			});
			if($('#captcha').length==1)
			{
				$('#captcha').after('<div id="captchtxtcnter" style="width:158px;text-align:center">(<b>'+$('#captcha').val().length+'</b> '+LD.chrcnt[($('#captcha').val().length==1?1:0)]+')</div>');
			}
			$('#captcha').attr({'autocomplete':'off','size':'14'}).css({'text-align':'center','font':'bold 150% monospace','letter-spacing':'10px','width':'158px'}).on('keydown',function(event)
			{
				if(event.originalEvent.code=='NumpadEnter' || event.originalEvent.code=='Enter' || event.originalEvent.code=='ArrowLeft' || event.originalEvent.code=='ArrowRight' || event.originalEvent.code=='Home' || event.originalEvent.code=='End' || event.originalEvent.code=='Tab' || (event.ctrlKey && event.originalEvent.code=='KeyC'))
				{
					return true;
				}
				else if(event.originalEvent.code=='Backspace' || event.originalEvent.code=='Delete')
				{
					$('#captchtxtcnter').html('(<b>'+(event.target.value.length-1)+'</b> '+LD.chrcnt[event.target.value.length-1==1?1:0]+')');
					return true;
				}
				else if((event.ctrlKey && event.originalEvent.code=='KeyX') || (event.ctrlKey && event.originalEvent.code=='KeyV'))
				{
					$('#captchtxtcnter').html('(<b>'+($('#captcha').val().length)+'</b> '+LD.chrcnt[$('#captcha').val().length==1?1:0]+')');
					return true;
				}
				event.preventDefault();
				var c = event.originalEvent.code;
				var val = event.target.value;
				event.target.value = val+(val.length>7?'':(c.startsWith('Key') || c.startsWith('Digit') || c.startsWith('Numpad')?c.replace(/Key([A-Z])|Digit([0-9])|Numpad([0-9])|Numpad([A-Za-z]+)/,'$1$2$3'):''));
				$('#captchtxtcnter').html('(<b>'+$('#captcha').val().length+'</b> '+LD.chrcnt[$('#captcha').val().length==1?1:0]+')');
			}).focus();
			$('#abolishCity').find('form').submit(function(e)
			{
				e.preventDefault();
				$.ajax(
				{
					url:	$('#abolishCity').find('form').attr('action'),
					type:	'POST',
					data:	$('#abolishCity').find('form').serialize(),
					success: function(data)
					{
						delete database.cities[city.getId];
						$.each(database.settings.cityOrder.value,function(k,v)
						{
							if(Object.keys(database.cities).indexOf(v)==-1)
							{
								database.settings.cityOrder.value.splice(k,1);
							}
						});
//						console.log(data);
//						console.log('City with id: '+city.getId+' was deleted!');
					}
				});
				return false;
			});
			render.toast(Utils.format(LD.abandoncitytxt[0],[LD.colony,LD.leftquot+city._name+LD.rightquot]));
		},
		parseAmbrosiaFountain: function(data)
		{
			var LD = Constant.LanguageData[database.settings.languageChange.value];
			var city = ikariam.getCurrentCity;
			$('#js_mainBoxHeaderTitle').text(LD.ambrosiaFountain);
			$('#ambrosiaFountain').find('div.buildingDescription > h1').text(LD.ambrosiaFountain);
			$('#ambrosiaFountain').find('div.buildingDescription + div > h3').text(LD.ambrosiaFountain);
			$('#ambrosiaFountain').find('div.buildingDescription + div > div > table > tbody > tr:last > td').each(function(k,td)
			{
				$(td).find('div > div:first').html(Utils.Nth(k+1)+' '+LD.day_long);
				$(td).find('div > div:last > img').attr('alt',LD.ambrosia);
			});
			$('#js_buyAmbrosiaText').text(function(){return Utils.format(LD.ambrosiaFountaintxt[parseInt($(this).text().replace(/\D+/g,''))==1?1:0],[Utils.FormatNumToStr(parseInt($(this).text().replace(/\D+/g,'')),false,0)])}).next('span').text(LD.ambrosiaFountaintxt[2]);
			$('#ambrosiaFountain').find('div.buildingDescription + div + div > h3').text(LD.ambrosiaFountain);
			$('#ambrosiaFountain').find('div.buildingDescription + div + div > div > p').each(function(k,p)
			{
				$(p).css('text-align','justify').html(LD.ambrosiaFountaintxt[k+3]);
			});
			$('#ambrosiaFountain').find('div.buildingDescription + div + div > div > div > ul > li').each(function(k,li)
			{
				$(li).css('text-align','justify').html(LD.ambrosiaFountaintxt[k+6]);
			});
			render.toast(Utils.format('{0}: {1} {2} {3} {4}',[LD.updated_,LD.ambrosiaFountain,LD.tothe,LD[city.isCapital?'capital':'colony'],LD.leftquot+city._name+LD.rightquot]));
		},
		parseAcademy: function(data)
		{
			var now = moment();
			$('[id^="empire_expachivtxt"],[id^="empire_expcosttxt"],[id^="empire_expachiv"],[id^="empire_expcost"]').remove();
			var LD = Constant.LanguageData[database.settings.languageChange.value];
			var city = ikariam.getCurrentCity;
			$('#js_mainBoxHeaderTitle').text(LD.academy);
			if($('#upgradeInProgress').length==0)
			{
				$('#setScientists').prev('div.buildingDescription').find('h1').text(LD.academy);
				$('#setScientists').prev('div.buildingDescription').find('p').css({'text-align':'justify','margin':'0px 15px 10px 0px'}).text(LD.academytxt[0]);
			}
			$('#setScientists > div > h3.header').text(LD.academytxt[1]);
			$('#valueCitizens').parent()[0].childNodes[0].nodeValue = LD.citizens+':';
			$('#valueWorkers').parent()[0].childNodes[0].nodeValue = LD.scientists+':';
			$('#gainPoints').prev('span.smallFont').text(LD.academytxt[2]+':');
			var researchkeys = ['scientists','premiumScientistBonus|premiumResearchBonus|premiumCulturalGoodsBonus','researchBonus','culturalGoods','corruption','total']
			$('#gainPoints').nextAll('div.tooltip').find('table > tbody > tr').each(function(k,tr)
			{
				$(tr).find('td:first').css('white-space','nowrap').html(k==5?'&nbsp;':LD.academytxt[k+5-(k==6?1:0)]+':');
				if(k==1)
				{
					var premsum = 0;
					var keys = researchkeys[k].split('|');
					$.each(keys,function(key,rk)
					{
						premsum += city.research.researchData[rk];
					});
				}
				$(tr).find('td:last').css('white-space','nowrap').html(k==5?'&nbsp;':Utils.FormatNumToStr(k==1?premsum:city.research.researchData[researchkeys[k-(k==6?1:0)]],k==6?false:true,2));
			});
			$('#overchargeMsg').text(LD.academytxt[11]+':');
			$('#js_AcademySlider').find('a.setMin').addClass('empiretooltip').removeAttr('title').append('<div class="tooltip-div" style="display:none;text-align:center">'+LD.academytxt[12]+'</div>');
			$('#js_AcademySlider').find('a.setMax').addClass('empiretooltip').removeAttr('title').append('<div class="tooltip-div" style="display:none;text-align:center">'+LD.academytxt[13]+'</div>');
			$('#inputWorkersSubmit').val(LD.academytxt[14]);
			//$('#accelerateResearch > h3').text(LD.academytxt[15]);
//			console.log(city.getBuildingFromName(Constant.Buildings.OPTICIAN).getLevel);
			var rp = 0, gl = 0;
			var prc = city.getBuildingFromName(Constant.Buildings.OPTICIAN)==null?0:city.getBuildingFromName(Constant.Buildings.OPTICIAN).getLevel;
			var exptxts = setInterval(function()
			{
				if((database.getGlobalData.getTotalRPntsProduced+database.getGlobalData.getUnusedRPs)<=4.5e6)
				{
					rp = Math.ceil((database.getGlobalData.getTotalRPntsProduced+database.getGlobalData.getUnusedRPs)/30+1);
					gl = Math.floor(rp*(100-prc)/50-1);
					$('#empire_expachivtxt_'+now+',#empire_expachiv_'+now).html(Utils.FormatNumToStr(rp,false,0));
					$('#empire_expcosttxt_'+now+',#empire_expcost_'+now).html(Utils.FormatNumToStr(gl,false,0));
					$('#empire_ExperimentAcceleration').css('display',city._resources.glass.getCurrent<gl?'none':'inline-block').next('a').css('display',city._resources.glass.getCurrent<gl?'inline-block':'none');
				}
				else
				{
					gl = 3e5;
					rp = Math.ceil(50*gl/(100-prc));
					$('#empire_expachivtxt_'+now+',#empire_expachiv_'+now).html(Utils.FormatNumToStr(rp,false,0));
					$('#empire_expcosttxt_'+now+',#empire_expcost_'+now).html(Utils.FormatNumToStr(gl,false,0));
					$('#empire_ExperimentAcceleration').css('display',city._resources.glass.getCurrent<gl?'none':'inline-block').next('a').css('display',city._resources.glass.getCurrent<gl?'inline-block':'none');
					clearInterval(exptxts);
				}
//				console.log(rp,gl);
			},1000);
			rp = (database.getGlobalData.getTotalRPntsProduced+database.getGlobalData.getUnusedRPs)<=4.5e6 ? Math.ceil((database.getGlobalData.getTotalRPntsProduced+database.getGlobalData.getUnusedRPs)/30+1) : Math.ceil(1.5e7/(100-prc));
			gl = (database.getGlobalData.getTotalRPntsProduced+database.getGlobalData.getUnusedRPs)<=4.5e6 ? Math.floor(rp*(100-prc)/50-1) : 3e5;
			$('#valueResearch + span.timeUnit').text(LD.academytxt[3]);
			$('#valueWorkCosts').prevAll('span.smallFont').text(LD.academytxt[4]+':');
			$('#valueWorkCosts').nextAll('span.timeUnit').text(LD.academytxt[3]);
			$('#accelerateResearch > h3.header').text(LD.academytxt[15]).next('p').css('text-align','justify').html(Utils.format(LD.academytxt[16],['<span id="empire_expachivtxt_'+now+'" style="color:green;font-weight:bold">'+Utils.FormatNumToStr(rp,false,0)+'</span>','<span id="empire_expcosttxt_'+now+'" style="color:red;font-weight:bold">'+Utils.FormatNumToStr(gl,false,0)+'</span>']));
			$('#accelerateResearch > div.centerButton > p.notice').text(LD.academytxt[17]);
			$('#accelerateResearch > div.centerButton > table > tbody > tr:first > td.left').text(LD.academytxt[18]);
			$('#accelerateResearch > div.centerButton > table > tbody > tr:first > td.right').addClass('empiretooltip').html('<span id="empire_expachiv_'+now+'" style="color:green;font-weight:bold">'+Utils.FormatNumToStr(rp,false,0)+'</span><div class="tooltip-div" style="display:none;text-align:center">'+Utils.format(LD.academytxt[28],[Utils.FormatTimeLengthToStr(Math.floor(rp/(database.getGlobalData.getCurrRPRate/3.6e6)),6)])+'</div>');
			$('#accelerateResearch > div.centerButton > table > tbody > tr:last > td.left').text(LD.academytxt[19]);
			var glcities = '';
			var i = 0, sm = 0;
			$.each(database.settings.cityOrder.value,function(k,c)
			{
				c = database.cities[c];
				if(c.getTradeGoodID==3)
				{
					i++;
					sm += c.getResource(Constant.Resources.GLASS).getProduction;
					glcities += '<tr><td style="text-align:center">'+i+'</td><td style="text-align:left">'+c.getName+'</td><td>'+Utils.FormatNumToStr(c.getResource(Constant.Resources.GLASS).getProduction*3600,false,0)+'</td><td style="text-align:center">'+Utils.FormatTimeLengthToStr(gl*1000/c.getResource(Constant.Resources.GLASS).getProduction,6)+'</td></tr>';
				}
			});
			glcities = '<table><tr><th>'+LD.incr+'</th><th>'+Utils.format(LD.academytxt[33],[LD[i==1?'city':'towns']])+'</th><th>'+LD.academytxt[34]+'</th><th>'+LD.academytxt[35]+'</th></tr>'+glcities+(i>1?'<tr><th>&Sigma;</th><th>'+i+' '+LD[i==1?'city':'towns']+'</th><th style="text-align:right;padding-right:10px">'+Utils.FormatNumToStr(sm*3600,false,0)+'</th><th>'+Utils.FormatTimeLengthToStr(gl*1000/sm,6)+'</th></tr>':'')+'</table>';
			$('#accelerateResearch > div.centerButton > table > tbody > tr:last > td.right').addClass('empiretooltip').html('<span id="empire_expcost_'+now+'" style="color:red;font-weight:bold">'+Utils.FormatNumToStr(gl,false,0)+'</span><div class="tooltip-div" style="display:none;text-align:center">'+(i>0?(sm>0?Utils.format(LD.academytxt[30],[glcities]):Utils.format(LD.academytxt[31],[i+' '+LD[i==1?'city':'towns']])):LD.academytxt[32])+'</div>');
			$('#js_ExperimentAcceleration').hide().before('<div class="empiretooltip" style="display:inline-block"></div>');
//			$('#js_ExperimentAcceleration').css('display',city._resources.glass.getCurrent<gl?'none':'inline-block').val(LD.academytxt[20]);
			$($('#js_ExperimentAcceleration').prop('outerHTML')).appendTo('div.centerButton > div.empiretooltip');
			$('div.centerButton > div.empiretooltip > #js_ExperimentAcceleration').attr('id','empire_ExperimentAcceleration');
			$('#empire_ExperimentAcceleration').css('display',city._resources.glass.getCurrent<gl?'none':'inline-block').val(LD.academytxt[20]);
			$('div.centerButton > div.empiretooltip').append((city._resources.glass.getCurrent<gl?'<a href="javascript:void();" class="button button_disabled">'+LD.academytxt[20]+'</a>':'')+'<div class="tooltip-div" style="display:none;text-align:center">'+Utils.format(LD.academytxt[city._resources.glass.getCurrent<gl?22:23],['<b>'+Utils.FormatNumToStr(city._resources.glass.getCurrent<gl?(gl-city._resources.glass.getCurrent):Math.floor((city._resources.glass.getCurrent)/gl),false,0)+'</b> '+(city._resources.glass.getCurrent<gl?(gl-city._resources.glass.getCurrent==1?LD.academytxt[24]:LD.academytxt[25]):(Math.floor((city._resources.glass.getCurrent)/gl)==1?LD.academytxt[26]:LD.academytxt[27]))])+'</div>');
//			$('#js_ExperimentAcceleration').prop('outerHTML').appendTo('div.centerButton > div.empiretooltip');
//			console.log($('#js_ExperimentAcceleration').prop('outerHTML'));
			var resBon = 0+(database.getGlobalData.getResearchTopicLevel(Constant.Research.Science.PAPER)*0.02)+(database.getGlobalData.getResearchTopicLevel(Constant.Research.Science.INK)*0.04)+(database.getGlobalData.getResearchTopicLevel(Constant.Research.Science.MECHANICAL_PEN)*0.08)+(database.getGlobalData.getResearchTopicLevel(Constant.Research.Science.SCIENTIFIC_FUTURE)*0.02);
			$('#valueResearch').hide().after('<span id="empire_valueResearch" class="positive overcharged">'+Utils.FormatNumToStr(Math.round(city.research.researchData.culturalGoods+($('#inputScientists').val()*(1+resBon))),true,0)+'</span>');
			$('#setScientists > div > div.content').on('blur change click dblclick drag focusin focusout keydown keypress keyup mousedown mouseenter mouseleave mousemove mouseout mouseover mouseup select textInput',function()
			{
				$('#empire_valueResearch').text(Utils.FormatNumToStr(Math.round($('#inputScientists').val()*(1+resBon)+city.research.researchData.culturalGoods),true,0));
				$('#gainPoints').nextAll('div.tooltip').find('table > tbody > tr').each(function(k,tr)
				{
					if(k==1)
					{
						var premsum = 0;
						var keys = researchkeys[k].split('|');
						$.each(keys,function(key,rk)
						{
							premsum += city.research.researchData[rk];
						});
					}
					var kk = 0;
					switch(k)
					{
						case 0:
							kk = $('#inputScientists').val();
							break;
						case 2:
							kk = $('#inputScientists').val()*resBon;
							break;
						case 3:
							kk = city.research.researchData.culturalGoods;
							break;
						case 4:
							kk = city.research.researchData.corruption;
							break;
						case 6:
							kk = city.research.researchData.culturalGoods+($('#inputScientists').val()*(1+resBon));
							break;
					}
					$(tr).find('td:last').html(k==5?'&nbsp;':Utils.FormatNumToStr(k==1?premsum:(kk),k==6?false:true,2));
				});
				$('#empire_valueWorkCosts').text(Utils.FormatNumToStr(parseInt(data.valueWorkCosts+(data.valueWorkers-$('#inputScientists').val())*data.js_AcademySlider.slider.callback_data.costPerScientist),false,0));
				$('#empire_valueCitizens').text(Utils.FormatNumToStr(parseInt(data.valueCitizens+data.valueWorkers-$('#inputScientists').val()),false,0));
				$('#empire_valueWorkers').text(Utils.FormatNumToStr(parseInt($('#inputScientists').val()),false,0));
			});
			$('#valueWorkCosts').hide().after('<span class="negative" id="empire_valueWorkCosts">'+Utils.FormatNumToStr(parseInt(data.valueWorkCosts+(data.valueWorkers-$('#inputScientists').val())*data.js_AcademySlider.slider.callback_data.costPerScientist),false,0)+'</span>');
			$('#valueCitizens').hide().after('<span class="value scroll_view" id="empire_valueCitizens">'+Utils.FormatNumToStr(data.valueCitizens+data.valueWorkers-$('#inputScientists').val(),false,0)+'</span>');
			$('#valueWorkers').hide().after('<span class="value scroll_view" id="empire_valueWorkers">'+Utils.FormatNumToStr($('#inputScientists').val(),false,0)+'</span>');
			if(data.experimentCooldown!=undefined)
			{
//				$('#accelerateResearch > p.notice').css('text-align','center')[0].childNodes[0].nodeValue = LD.academytxt[21];
				$('#accelerateResearch > p.notice').css('text-align','center').contents().first().each(function(){$(this).replaceWith(LD.academytxt[21]);});
				var expinterv = setInterval(function()
				{
					var mmt = moment();
					$('#empire_experimentCooldown').text(Utils.FormatTimeLengthToStr(data.experimentCooldown.countdown.enddate*1000-mmt,3));
					$('#empire_expbar').attr('title',Utils.FormatNumToStr(100-(mmt-(data.experimentCooldown.countdown.enddate*1000-1.44e7))/1.44e5,false,2)+' %').find('div.bar').css('width',Math.floor((mmt-(data.experimentCooldown.countdown.enddate*1000-1.44e7))/1.44e5)+'%').attr('title',Utils.FormatNumToStr((mmt-(data.experimentCooldown.countdown.enddate*1000-1.44e7))/1.44e5,false,2)+' %').next('div').text(Utils.FormatNumToStr((mmt-(data.experimentCooldown.countdown.enddate*1000-1.44e7))/1.44e5,false,2)+' %');
					if(mmt>data.experimentCooldown.countdown.enddate*1000) { $('#empire_expbar').remove(); clearInterval(expinterv); }
				},1000);
				$('#experimentCooldown').hide().after('<div id="empire_expbar" class="progressbar" title="'+Utils.FormatNumToStr(100-(now-(data.experimentCooldown.countdown.enddate*1000-1.44e7))/1.44e5,false,2)+' %" style="width:200px;height:16px;margin:0 auto;"><div class="bar" style="width:'+Math.floor((now-(data.experimentCooldown.countdown.enddate*1000-1.44e7))/1.44e5)+'%;height:16px;" title="'+Utils.FormatNumToStr((now-(data.experimentCooldown.countdown.enddate*1000-1.44e7))/1.44e5,false,2)+' %"></div><div style="display:table;margin:0px auto 0px auto;font-weight:bold;text-shadow: -1px -1px 0 #FFFFFF, 1px -1px 0 #FFFFFF, -1px 1px 0 #FFFFFF, 1px 1px 0 #FFFFFF;text-align:center;position:relative;top:-15px;margin-bottom:-18px">'+Utils.FormatNumToStr((now-(data.experimentCooldown.countdown.enddate*1000-1.44e7))/1.44e5,false,2)+' %</div></div><span style="font-weight:bold">'+Utils.FormatFullTimeToDateString(data.experimentCooldown.countdown.enddate*1000)+'</span> (<span id="empire_experimentCooldown" style="font-weight:bold">'+Utils.FormatTimeLengthToStr(data.experimentCooldown.countdown.enddate*1000-now,3)+'</span>)');
				$('#accelerateResearch > div.centerButton > a').attr('title',LD.academytxt[29]).text(LD.academytxt[20]);
			}
			//data.experimentCooldown.countdown.enddate
//			console.log(data);
//			console.log(unsafeWindow.ikariam);
			//data.js_AcademySlider.slider.ini_value
			var changed = city.updateResearchers(parseInt(unsafeWindow.ikariam.templateView.script.params.startScientists));
			if(changed)
				events(Constant.Events.CITY_UPDATED).pub(ikariam.CurrentCityId, {research: changed});
//			console.log(database.getGlobalData.getCurrRPRate,database.getGlobalData.getTotalRPntsProduced,database.getGlobalData.getUnusedRPs);
//			console.log(LD.academytxt);
			render.toast(Utils.format('{0}: {1} {2} {3} {4}',[LD.updated_,LD.academy,LD.tothe,LD[city.isCapital?'capital':'colony'],LD.leftquot+city._name+LD.rightquot]));
		},
		parseBlackMarket: function(view,html,data)
		{
			var LD = Constant.LanguageData[database.settings.languageChange.value];
			var city = ikariam.getCurrentCity;
			$('#js_mainBoxHeaderTitle').text(LD[view]);
			$('#'+view).find('div.buildingDescription > h1').text(LD[view]).next('p').css({'text-align':'justify','margin':'0px 15px 10px 0px'}).text(LD.blackmarkettxt[0]);
			$('#js_tabOfferUnits > b').text(LD.blackmarkettxt[1]);
			$('#js_tabMyOffers > b').text(LD.blackmarkettxt[2]);
			$('#tabOfferUnits > div > h3').text(Utils.format(LD.blackmarkettxt[3],[data.openOffers,data.maxOffers]));
			$('#blackmarketInfoBox > b').text(Utils.format(LD.blackmarkettxt[4],[Constant.BuildingData[Constant.Buildings.BLACK_MARKET].tax[city.getBuildingFromName(Constant.Buildings.BLACK_MARKET).getLevel-1]]));
			$('#blackmarketInfoBox > ul > li').each(function(k,li)
			{
				$(li).css('text-align','justify').html(Utils.format(LD.blackmarkettxt[k+5],[k==0?Constant.BuildingData[Constant.Buildings.BLACK_MARKET].tax[city.getBuildingFromName(Constant.Buildings.BLACK_MARKET).getLevel-1]:'']));
			});
			$('#blackmarketOfferForm > table > tbody > tr:first > th:not(:last)').each(function(k,th)
			{
				$(th).text(LD.blackmarkettxt[k+8]);
			});
			$('#js_offerAbleUnits > option').each(function(k,op)
			{
				$(op).text(LD[Constant.unitIds[parseInt($(op).val())]]);
				$('#dropDown_js_offerAbleUnitsContainer > div.bg > ul > li[selectvalue="'+$(op).val()+'"] > a').text(LD[Constant.unitIds[parseInt($(op).val())]]);
			});
			$('#js_offerUnitFreeAmount').parent()[0].childNodes[0].textContent = '('+LD.blackmarkettxt[13]+': ';
			$('#js_offerResource > option').each(function(k,op)
			{
				$(op).text(LD[(k==5?'plunder':'')+Object.values(Constant.Resources)[k==5?0:k+1]+(k==5?'':'_')]);
				$('#dropDown_js_offerResourceContainer > div.bg > ul > li[selectvalue="'+k+'"] > a').text(LD[(k==5?'plunder':'')+Object.values(Constant.Resources)[k==5?0:k+1]+(k==5?'':'_')]);
			});
			$('#minLimit').text(function(){return Utils.FormatNumToStr(parseInt($(this).text().replace(/\D+/g,'')),false,0)});
			$('#maxLimit').text(function(){return Utils.FormatNumToStr(parseInt($(this).text().replace(/\D+/g,'')),false,0)});
			$('#js_offerAbleUnitsContainer,#dropDown_js_offerAbleUnitsContainer,#js_offerResourceContainer,#dropDown_js_offerResourceContainer').on('click',function()
			{
				$('#minLimit').text(function(){return Utils.FormatNumToStr(parseInt($(this).text().replace(/\D+/g,'')),false,0)});
				$('#maxLimit').text(function(){return Utils.FormatNumToStr(parseInt($(this).text().replace(/\D+/g,'')),false,0)});
			});
			$('#js_addOffer').val(LD.blackmarkettxt[14]);
			
			$('#tabMyOffers > div > h3').text(Utils.format(LD.blackmarkettxt[15],[data.openOffers,data.maxOffers]));
			$('#blackmarketNoOffers').css({'color':'red','font-weight':'bold'}).text(LD.blackmarkettxt[16]);
			$('#offerTable > thead > tr > th').each(function(k,th)
			{
				$(th).css('text-overflow','unset').text(LD.blackmarkettxt[k+17]);
			});
			$('#offerTable > tbody > tr').each(function(k,tr)
			{
				$(tr).find('td:eq(1)').text(function(){return Utils.FormatNumToStr(parseInt($(this).text().replace(/\D+/g,'')),false,0)});
				var currency = $(tr).find('td:eq(2) > img').attr('src').split('_')[1].split('.')[0];
				$(tr).find('td:eq(2)')[0].childNodes[0].textContent = Utils.FormatNumToStr(parseInt($(tr).find('td:eq(2)')[0].childNodes[0].nodeValue.replace(/\D+/g,'')),false,0)+' ';
				$(tr).find('td:eq(2) > img').attr({'alt':LD[(currency=='gold'?'plunder':'')+currency+(currency=='gold'?'':'_')],'title':LD[(currency=='gold'?'plunder':'')+currency+(currency=='gold'?'':'_')]});
				$(tr).find('td:eq(3)')[0].childNodes[0].textContent = Utils.FormatNumToStr(parseInt($(tr).find('td:eq(3)')[0].childNodes[0].nodeValue.replace(/\D+/g,'')),false,0)+' ';
				$(tr).find('td:eq(3) > img').attr({'alt':LD[(currency=='gold'?'plunder':'')+currency+(currency=='gold'?'':'_')],'title':LD[(currency=='gold'?'plunder':'')+currency+(currency=='gold'?'':'_')]});
				$(tr).find('td:eq(4)')[0].childNodes[0].textContent = Utils.FormatNumToStr(parseInt($(tr).find('td:eq(4)')[0].childNodes[0].nodeValue.replace(/\D+/g,'')),false,0)+' ';
				$(tr).find('td:eq(4) > img').attr({'alt':LD[(currency=='gold'?'plunder':'')+currency+(currency=='gold'?'':'_')],'title':LD[(currency=='gold'?'plunder':'')+currency+(currency=='gold'?'':'_')]});
				$(tr).find('td:eq(5) > a').attr('title',LD.blackmarkettxt[23]);
			});
			render.toast(Utils.format('{0}: {1} {2} {3} {4}',[LD.updated_,LD[view],LD.tothe,LD[city.isCapital?'capital':'colony'],LD.leftquot+city._name+LD.rightquot]));
		},
		parseWarehouse: function(view,data)
		{
			var LD = Constant.LanguageData[database.settings.languageChange.value];
			var city = ikariam.getCurrentCity;
			$('#js_mainBoxHeaderTitle').text(LD[view]);
			$('#'+view).find('div.buildingDescription > h1').text(LD[view]).next('p').css({'text-align':'justify','margin':'0px 15px 10px 0px'}).text(LD.warehousetxt[view==Constant.Buildings.DUMP?0:1]);
			$('#'+view).find('div.contentBox01h:not(#demolition) > h3.header').text(LD.warehousetxt[2]).next('div').find('div').css('display','none');
			$('#warehouseList').prev('table').find(view==Constant.Buildings.DUMP ? 'thead > tr' : 'tbody > tr:first').html('<th>'+LD.warehousetxt[7]+'</th><th>'+LD.lootable+'</th><th>'+LD.total_+'</th><th>'+LD.capacity+'</th>');
			var res = Object.values(Constant.Resources).slice(1);
//			console.log(city.maxResourceCapacities.safe,city.maxResourceCapacities.capacity);
//			console.log(city._resources[]);
			var warehouseinterv = setInterval(function()
			{
				$.each(res,function(k,r)
				{
					$('span#js_plunderable_'+r).text(city._resources[r].getCurrent<=city.maxResourceCapacities.safe?0:Utils.FormatNumToStr(city._resources[r].getCurrent>city.maxResourceCapacities.capacity?city.maxResourceCapacities.capacity-city.maxResourceCapacities.safe:(city._resources[r].getCurrent-city.maxResourceCapacities.safe),false,0));
					$('span#js_total_'+r).text(city._resources[r].getCurrent<=0?0:Utils.FormatNumToStr(city._resources[r].getCurrent>city.maxResourceCapacities.capacity?city.maxResourceCapacities.capacity:city._resources[r].getCurrent,false,0));
				});
				$('td.city_name > span.clickable, td.building > span.clickable, div.city, div.temple, div.pirates, div.spies, div.barracks, div.shipyard, div#HelpTab > span[id^="help"], span.happy, span.growth, span.scientists, [id^="position"], #dropDown_js_citySelectContainer, #js_buildingUpgradeButton').on('click',function(){clearInterval(warehouseinterv);});
			},1000);
			$('#warehouseList').prev('table').find('tbody:first > tr'+(view==Constant.Buildings.DUMP?'':':not(:first)')+' > td').each(function(x,c)
			{
				$(c).find('tr').each(function(y,r)
				{
					$(r).find('td:first > img').attr({'title':LD[res[y]+'_'],'alt':LD[res[y]+'_']});
					$(r).find('td:last > span'+(x<=1?' > span':'')).text(function(){return Utils.FormatNumToStr(parseInt($(this).text().replace(/(\d+)[,.](?=\d{3}(\D|$))/g,'$1')),false,0);});
				});
			});
			$('#warehouseList > tbody > tr').each(function(i,b)
			{
				$(b).css({'padding':'0 10px','height':'29px'}).find('td').css({'padding':'0 10px','height':'29px'});
				if($('#warehouseList > tbody > tr').length>=5 && i>1 && i<$('#warehouseList > tbody > tr').length-3)
				{
					var type = $(b).find('td.image > img').attr('src').split('.')[0].split('/').pop();
					var level = parseInt($(b).find('td.left > a').text().replace(/\D+/g,''));
					$(b).find('td.image > img').attr('title',LD[type]);
					$(b).find('td.left > a').text(LD[type]+' ('+LD.level+' '+level+')');
					$(b).find('td.left + td').text(function(){return Utils.FormatNumToStr(parseInt($(this).text().replace(/(\d+)[,.](?=\d{3}(\D|$))/g,'$1')),false,0);});
					$(b).find('td:last').text(function(){return Utils.FormatNumToStr(parseInt($(this).text().replace(/(\d+)[,.](?=\d{3}(\D|$))/g,'$1')),false,0);});
				}
				switch(i)
				{
					case 0:
						$(b).html('<th colspan="2">'+LD.buildings+'</th><th>'+LD.warehousetxt[7]+'</th><th>'+LD.capacity+'</th>');
						break;
					case 1:
						$(b).html('<td class="image"><img src="skin/buildings/x40_y40/townHall.png" title="'+LD.town+'"></td><td class="left">'+LD.townHall+'</td><td>100</td><td>'+Utils.FormatNumToStr(2500,false,0)+'</td>');
						break;
					case $('#warehouseList > tbody > tr').length-3:
						$(b).find('td.image > img').attr('title',LD.warehousetxt[3]);
						$(b).find('td.left > div').css('display','block')[0].childNodes[0].textContent = LD.warehousetxt[3];
						$('#js_safe_capacity_bonus').text(function(){return LD.warehousetxt[$(this).hasClass('red')?4:5];});
						$('#js_safe_capacity_bonus_total').text(function(){return Utils.FormatNumToStr(parseInt($(this).text().replace(/(\d+)[,.](?=\d{3}(\D|$))/g,'$1')),false,0);});
						$(b).find('td:last').text(function(){return Utils.FormatNumToStr(parseInt($(this).text().replace(/(\d+)[,.](?=\d{3}(\D|$))/g,'$1')),false,0);});
						break;
					case $('#warehouseList > tbody > tr').length-2:
						$(b).find('td.image > img').attr('title',LD.warehousetxt[6]);
						$(b).find('td.left > div').css('display','block')[0].childNodes[0].textContent = LD.warehousetxt[6];
						$('#js_storage_capacity_bonus').text(function(){return LD.warehousetxt[$(this).hasClass('red')?4:5];});
						$(b).find('td.left + td').text(function(){return Utils.FormatNumToStr(parseInt($(this).text().replace(/(\d+)[,.](?=\d{3}(\D|$))/g,'$1')),false,0);});
						$(b).find('td:last').text(function(){return Utils.FormatNumToStr(parseInt($(this).text().replace(/(\d+)[,.](?=\d{3}(\D|$))/g,'$1')),false,0);});
						break;
					case $('#warehouseList > tbody > tr').length-1:
						$(b).find('td#js_total_safe_capacity').text(function(){return Utils.FormatNumToStr(parseInt($(this).text().replace(/(\d+)[,.](?=\d{3}(\D|$))/g,'$1')),false,0);});
						$(b).find('td#js_total_storage_capacity').text(function(){return Utils.FormatNumToStr(parseInt($(this).text().replace(/(\d+)[,.](?=\d{3}(\D|$))/g,'$1')),false,0);});
						break;
				}
			});
			$('#informationSidebar > table > tbody > tr').each(function(k,tr)
			{
				if(k==0)
				{
					$(tr).empty().html('<th style="text-align:center">'+LD.warehousetxt[8]+'</th><th style="text-align:center">'+LD.warehousetxt[9]+'</th><th style="text-align:center">'+LD.warehousetxt[10]+'</th>');
				}
				else
				{
					$(tr).find('td:not(:first)').each(function(i,td)
					{
						$(td).text(function(){return '+'+Utils.FormatNumToStr(parseInt($(this).text().replace(/\D+/g,'')),false,0)});
					});
				}
			});
			render.toast(Utils.format('{0}: {1} {2} {3} {4}',[LD.updated_,LD[view],LD.tothe,LD[city.isCapital?'capital':'colony'],LD.leftquot+city._name+LD.rightquot]));
		},
		parseDailyTasks: function(view,data)
		{
			var LD = Constant.LanguageData[database.settings.languageChange.value];
//			console.log(view);
//			console.log(data);
//			console.log(unsafeWindow);
//			console.log(unsafeWindow.ikariam);
			$('#js_mainBoxHeaderTitle').text(LD.dailytasks);
			$('#'+view).find('div.buildingDescription > h1').text(LD.dailytasks).next('p').css({'text-align':'justify','margin':'0px 15px 10px 0px'}).html(LD.dailytaskstxt[0]);
			var serverTimezoneOffset = unsafeWindow.dataSetForView.serverTimezoneOffset;
			var diff = -(moment().utcOffset()*60-serverTimezoneOffset)*1000;
			var d = moment(moment()+diff).add(1,'week').startOf('week')-diff;
			database._globalData._favour = parseInt($('#dailyTasks > div.bd.mainContentScroll > div.mainContent.minimizableContent > div.buildingDescription > div > div.leftMargin30, #currentFavour').text().replace(/\D+/g,''));
//			$('#dailyTasksCountdown').parent().parent().css({'height':'23px'});
			$('#dailyTasksCountdown').parent().empty().css({'display':'inline-block','float':'left','margin-top':'5px','margin-left':'10px'}).html(LD.remainingtime+': &nbsp;<div id="dialytasktime" style="text-align:center;float:right"></div>');
			setInterval(function()
			{
				$('#dialytasktime').empty().html(Utils.format('{0} ({1})',[Utils.FormatFullTimeToDateString(d,true),Utils.FormatTimeLengthToStr(d-$.now(),4)]));
			},1000);
			$('#dialytasktime').empty().html(Utils.format('{0} ({1})',[Utils.FormatFullTimeToDateString(d,true),Utils.FormatTimeLengthToStr(d-$.now(),4)]));
			$('#dailyTasks, #dailyTasksRewards').find('div.leftMargin30').css({'display':'inline-block','float':'right','margin-right':'25px'}).html(LD.favours[1]+': '+Utils.FormatNumToStr(database._globalData._favour,false,0)+' <img src="skin/resources/favour.png" alt="'+LD.favours[1]+'" title="'+LD.favours[1]+'">');
			$('#js_tab_dailyTasks > b').text(LD.dailytaskstxt[1]);
			$('#js_tab_dailyTasksRewards > b').text(LD.dailytaskstxt[2]);
			if(view=='dailyTasks')
			{
				var completed = $('#'+view).find('div.buildingDescription + ul + div > div > table > tbody > tr[class$="textLineThrough"]').length;
				var tasks = $('#'+view).find('div.buildingDescription + ul + div > div > table > tbody > tr').length;
				$('#'+view).find('div.buildingDescription + ul + div > h3').text(Utils.format(LD.dailytaskstxt[3],[completed,tasks,15]));
				var improvsum = Object.values(database.getGlobalData._improvements).reduce((a,b) => parseInt(a)+parseInt(b[0])+parseInt(b[1]),0);
				var tasktxt = [];
				tasktxt[0] = LD.dailytaskstxt[4];
				tasktxt[1] = LD.dailytaskstxt[5];
				tasktxt[2] = LD.dailytaskstxt[6];
				$.each(database.cities,function(k,c) { if(c.getBuildingFromName(Constant.Buildings.WORKSHOP)!=null&&ikariam.getCapital.getBuildingFromName(Constant.Buildings.TOWN_HALL).getLevel>=6&&improvsum<132) { tasktxt[3] = LD.dailytaskstxt[7]; return false; } });
				tasktxt[3] = typeof(tasktxt[3])=='string' ? tasktxt[3] : 7;
//				console.log(typeof(tasktxt[3]));
				$.each(database.cities,function(k,c) { if(c.getBuildingFromName(Constant.Buildings.PIRATE_FORTRESS)!=null) { tasktxt[4] = LD.dailytaskstxt[8]; return false; } });
				tasktxt[4] = typeof(tasktxt[4])=='string' ? tasktxt[4] : 8;
				tasktxt[5] = LD.dailytaskstxt[9];
				tasktxt[6] = LD.dailytaskstxt[10];
				$.each(database.cities,function(k,c) { if(c.getWonder.level<5) { tasktxt[7] = LD.dailytaskstxt[11]; return false; } });
				tasktxt[7] = typeof(tasktxt[7])=='string' ? tasktxt[7] : 11;
				$.each(database.cities,function(k,c) { if(c.getForest.level<60||c.getMine.level<60) { tasktxt[8] = LD.dailytaskstxt[12]; return false; } });
				tasktxt[8] = typeof(tasktxt[8])=='string' ? tasktxt[8] : 12;
				tasktxt[9] = LD.dailytaskstxt[13];
				tasktxt[10] = LD.dailytaskstxt[14];
				tasktxt[11] = LD.dailytaskstxt[15];
				$.each(database.cities,function(k,c) { if(c.getBuildingFromName(Constant.Buildings.PIRATE_FORTRESS)!=null) { tasktxt[12] = LD.dailytaskstxt[16]; return false; } });
				tasktxt[12] = typeof(tasktxt[12])=='string' ? tasktxt[12] : 16;
				tasktxt[13] = LD.dailytaskstxt[17];
				tasktxt[14] = database.settings.noTheater.value==false ? LD.dailytaskstxt[18] : 18;
//				console.log(LD.dailytaskstxt);
//				console.log(tasktxt);
				for(var i=0;i<15;i++)
				{
					if(typeof(tasktxt[i])=='number')
					{
						$('#'+view).find('div.buildingDescription + ul + div > div > table > tbody > tr:eq('+(i-1)+')').after('<tr style="height:31px;opacity:0.5"><td></td><td class="left">'+LD.dailytaskstxt[tasktxt[i]]+'</td><td class="center" colspan="5"></td><td class="smallright"></td><td style="width:10px;"><img height="20px" src="skin/resources/favour.png" title="'+LD.favours[1]+'" alt="'+LD.favours[1]+'"></td></tr>');
					}
					else if(typeof(tasktxt[i])=='string')
					{
						var tr = $('#'+view).find('div.buildingDescription + ul + div > div > table > tbody > tr:eq('+i+')');
						$(tr).find('td:eq(1)').text(tasktxt[i]);
						if($(tr).find('td').length==8)
						{
							var curr = parseInt($(tr).find('td:eq(2)').text().replace(/\D+/g,''));
							var reqr = parseInt($(tr).find('td:eq(4)').text().replace(/\D+/g,''));
							$(tr).find('td:eq(4)').text(Utils.FormatNumToStr(reqr,false,0));
							if($(tr).find('td:eq(5) > img').attr('src').includes('icon_gold'))
							{
								$(tr).find('td:eq(5) > img').attr({'title':LD.plundergold,'alt':LD.plundergold});
							}
							else if($(tr).find('td:eq(5) > img').attr('src').includes('capturePoints_small'))
							{
								$(tr).find('td:eq(1)').text(LD.dailytaskstxt[8]);
								$(tr).find('td:eq(5) > img').attr({'title':LD.pirtxt[3],'alt':LD.pirtxt[3]});
							}
							else
							{
								$(tr).find('td:eq(5) > img').attr({'title':LD.dailytaskstxt[19],'alt':LD.dailytaskstxt[19]});
							}
							$(tr).find('td:eq(2)').html(Utils.FormatNumToStr(curr,false,0)).before('<td class="smallright" style="color:red">'+(curr==reqr?'':'('+Utils.FormatNumToStr(curr-reqr,false,0)+')')+'</td>');
						}
						else
						{
							$(tr).find('td:eq(2)').attr('colspan',parseInt($(tr).find('td:eq(2)').attr('colspan'))+1);
							$(tr).find('td:eq(3) > a.adVideoButton > div.tooltip').text(LD.dailytaskstxt[23]);
						}
//						console.log(tasktxt[i]);
					}
				}
				$('#'+view).find('div.buildingDescription + ul + div > div > table > tbody > tr:even').addClass('alt');
				$('#'+view).find('div.buildingDescription + ul + div > div > table > tbody > tr:odd').removeClass('alt');
			}
			else if(view=='dailyTasksRewards')
			{
				$('#'+view).find('div.buildingDescription + ul + div > h3').text(LD.dailytaskstxt[2]);
				var units = ikariam.getCapital.getBuildingFromName(Constant.Buildings.TOWN_HALL).getLevel<=15?2:3;
				$('#'+view).find('div.buildingDescription + ul + div > div > table > tbody > tr').each(function(k,tr)
				{
					var tid = '';
					if(k<7)
					{
//						tid = (k==5?'plunder':'')+$(tr).find('td:first > img').attr('src').replace(/[^]*_([^]*)\.[^]*/,'$1')+(k<5?'_':'');
//						console.log(k,k==6?LD.dailytaskstxt[20][tid]:LD[tid]);
						tid = $(tr).find('td:eq(0) > img').attr('src').replace(/[^]*_([^]*)\.[^]*/,'$1');
						$(tr).find('td:eq(0) > img').attr({'alt':LD.dailytaskstxt[20][tid],'title':LD.dailytaskstxt[20][tid]});
						$(tr).find('td:eq(1)').text(function(){return Utils.FormatNumToStr(parseInt($(this).text().replace(/\D+/g,'')),false,0)+' '+LD.dailytaskstxt[20][tid]});
					}
					else if(k<(units+7))
					{
//						console.log();
						tid = $(tr).find('td:eq(0) > img').attr('src').replace(/[^]*_([^]*)_[^]*/,'$1');
						$(tr).find('td:eq(0) > img').attr({'alt':LD.dailytaskstxt[20][tid],'title':LD.dailytaskstxt[20][tid]});
						$(tr).find('td:eq(1)').text(function(){return Utils.FormatNumToStr(parseInt($(this).text().replace(/\D+/g,'')),false,0)+' '+LD.dailytaskstxt[20][tid]});
					}
					else
					{
						tid = $(tr).find('td:eq(0) > div').attr('class').split(' ')[1].replace(/(Account|Icon)/,'');
						$(tr).find('td:eq(0) > div').attr({'title':LD.dailytaskstxt[20][tid]});
						$(tr).find('td:eq(1)').text(LD.dailytaskstxt[20][tid]);
						
					}
					$(tr).find('td:eq(3) > img').attr({'alt':LD.favours[0],'title':LD.favours[0]});
					$(tr).find('td:eq(4) > a')[0].childNodes[0].textContent = LD.dailytaskstxt[21];
					$(tr).find('td:eq(4) > a > div.tooltip').text(LD.dailytaskstxt[22]);
					$(tr).find('td:eq(2)').before('<td class="smallright" style="color:red">'+(data.currentFavour<parseInt($(tr).find('td:eq(2)').text().replace(/\D+/g,''))?'('+Utils.FormatNumToStr(data.currentFavour-parseInt($(tr).find('td:eq(2)').text().replace(/\D+/g,'')),false,0)+')':'')+'</td>').html(function(){return Utils.FormatNumToStr(parseInt($(tr).find('td:eq(3)').text().replace(/\D+/g,'')),false,0)});
					$(tr).find('td:eq(4) > a:not(.button_disabled)').on('click',function(event)
					{//:not(.button_disabled)
//						event.preventDefault();
						$.ajax(
						{
							success: function()
							{
								var curr = parseInt($('div.leftMargin30').text().replace(/\D+/g,''));
								var reqr = parseInt($(tr).find('td:eq(3)').replace(/\D+/g,''));
								$(tr).find('td:eq(3)').html((curr>=reqr?'':'('+Utils.FormatNumToStr(curr-reqr,false,0)+')'));
								$('div.leftMargin30').html(LD.favours[1]+': '+Utils.FormatNumToStr(curr,false,0)+' <img src="skin/resources/favour.png" alt="'+LD.favours[1]+'" title="'+LD.favours[1]+'">');
							}
						});
					});
				});
			}
//			console.log(data.currentFavour);
			render.toast(Utils.format('{0}: {1}',[LD.updated_,LD.tasks]));
		},
		parsePirates: function(data)
		{
			render.AddCityCSS();
			var LD = Constant.LanguageData[database.settings.languageChange.value];
//			console.log(unsafeWindow.missionpbar);
//			console.log(unsafeWindow.missionpcnt);
//			console.log(JSON.parse(data.load_js.params));
			var city = ikariam.getCurrentCity;
			var rand = Math.random()*10000;
			var currt = $.now();
			var params = unsafeWindow.ikariam.templateView.script.params;
			var building = city && params ? city.getBuildingFromName(params.view) : '';
			var serverTimezoneOffset = unsafeWindow.dataSetForView.serverTimezoneOffset;
			var diff = serverTimezoneOffset-moment().utcOffset()*60;
			var HourOfDay = $('#pirateFortress > div.bd.mainContentScroll > div.mainContent.minimizableContent > div.pirateHighscoreNextCalc').text().match(/(0*[0-9]|1[0-9]|2[0-3]):([0-5][0-9])/)[0].split(':');
			$('#js_mainBoxHeaderTitle').html(LD.pirtxt[0]);
			$('#js_tabBootyQuest').parent().before('<table style="table-layout:fixed;width:100%;text-align:center;position:relative;bottom:13px;margin-bottom:-36px;margin-left:auto;margin-right:auto;"><tr><td style="width:50%;height:10px;line-height:15px"><input type="checkbox" id="auto_tabCapture"><br><div id="autoCaptureInterv'+currt+'" style="display:inline-block;position:relative;top:'+(building.isUpgrading?24:20)+'px;margin-top:0px;margin-bottom:0px">&nbsp;</div></td><td style="width:50%;height:10px;line-height:15px;vertical-align:top"><input type="checkbox" id="auto_tabConvert"></td></tr></table>');
			$('#informationSidebar').html(Utils.format('<p>+2 <img src="skin/resources/icon_piratecrew_small.png"> {0}<br>+1 {1}{2}</p>',[LD.pirtxt[2],LD.pirtxt[38],(building.getLevel+(building.isUpgrading?2:1))<18&&(building.getLevel+(building.isUpgrading?2:1))%2==1?'<br>+1 '+LD.pirtxt[39]:'']));
			if(database._globalData._pirates.auto[0]===true) { $('#auto_tabCapture').attr('checked','checked'); } else {$('#auto_tabCapture').removeAttr('checked'); }
			if(database._globalData._pirates.auto[1]===true) { $('#auto_tabConvert').attr('checked','checked'); } else {$('#auto_tabConvert').removeAttr('checked'); }
			database._globalData._pirates = {
				points:parseInt(params.crewPoints),
				strength:parseInt(params.capturePoints),
				position:params.highscorePlayerPosition==undefined?0:parseInt(params.highscore[params.highscorePlayerPosition].place),
				dailyreset:HourOfDay,
				resetin:params.highscoreTimeLeft*1000+$.now(),
				miss:params.hasOngoingMission,
				conv:params.hasOngoingConvertion,
				auto:[$('#auto_tabCapture').is(':checked'),$('#auto_tabConvert').is(':checked')],
				mission:params.hasOngoingMission?{level:params.ongoingMissionLevel?(params.ongoingMissionLevel-1)/2:-1,endtime:params.ongoingMissionTimeRemaining*1000+$.now(),type:params.ongoingMissionType}:{},
				conversion:params.hasOngoingConvertion?{points:params.ongoingConvertionCapturePoints,endtime:params.ongoingConvertionTimeRemaining*1000+$.now()}:{}
			};
			$('#auto_tabCapture').on('change',function(event)
			{
				database._globalData._pirates.auto[0] = $(this).is(':checked');
				if($(this).is(':checked') && $('#missionProgressBar').length!=1)
				{
					var s = 0;
					var autocpinterv = setInterval(function()
					{
						s++;
						$('#autoCaptureInterv'+currt).html('('+Utils.FormatTimeLengthToStr((Math.floor(rand/1000)-s)*1000,2)+')');
						if(Math.floor(rand/1000)<=s || $('#missionProgressBar').length==1) { clearInterval(autocpinterv); $('#autoCaptureInterv'+currt).html('&nbsp;'); }
					},1000);
				}
				else
				{
					clearInterval(autocpinterv);
					$('#autoCaptureInterv'+currt).html('&nbsp;');
				}
			}).attr('title',LD.pirtxt[40]);
			$('#auto_tabConvert').on('change',function(event)
			{
				database._globalData._pirates.auto[1] = $(this).is(':checked');
			});
			var pt = database.getGlobalData.getPirates;
			if(pt.auto[0]==true && pt.miss==false && $('#pirateCaptureBox > div.content > form > img.captchaImage').length==0 && $('#missionProgressBar').length!=1)
			{
				var s = 0;
				var autocpinterv = setInterval(function()
				{
					s++;
					$('#autoCaptureInterv'+currt).html('('+Utils.FormatTimeLengthToStr((Math.floor(rand/1000)-s)*1000,2)+')');
					if(Math.floor(rand/1000)<=s || $('#missionProgressBar').length==1) { clearInterval(autocpinterv); $('#autoCaptureInterv'+currt).html('&nbsp;'); }
				},1000);
			}
			else
			{
				clearInterval(autocpinterv);
				var previous = 'captchaImage0';
				$("#pirateCaptureBox > div.content > form > img.captchaImage").before('<div id="captchaimgcontainer" style="display:inline-block;width:269px;height:62px"></div>');
				$("#pirateCaptureBox > div.content > form > img.captchaImage").appendTo('#captchaimgcontainer');
				$('#captchaimgcontainer > img.captchaImage').css({'cursor':'zoom-in'}).attr('id','captchaImage1').on('click',function()
				{
					var s=$(this).attr('id');
					$('#'+s).animate({'width':'360px','height':'83px','top':'-5px','left':'15px'});
					$('#'+s).css({'cursor':'zoom-out'});
					if($('#'+previous).width()!=269 || $('#'+previous).height()!=62)
					{
						$('#'+previous).animate({'width':'269px','height':'62px','top':'0px','left':'78px'});
						$('#'+previous).css({'cursor':'zoom-in'});
					}
					$('#captcha').focus();
					previous=s;
				});
				if($('#captcha').length==1)
				{
					$('#captcha').after('<div id="captchtxtcnter" style="width:158px;text-align:center">(<b>'+$('#captcha').val().length+'</b> '+LD.chrcnt[($('#captcha').val().length==1?1:0)]+')</div>');
				}
				$('#captcha').attr({'autocomplete':'off','size':'14'}).css({'text-align':'center','font':'bold 150% monospace','letter-spacing':'10px','width':'158px'}).on('keydown',function(event)
				{
					if(event.originalEvent.code=='NumpadEnter' || event.originalEvent.code=='Enter' || event.originalEvent.code=='ArrowLeft' || event.originalEvent.code=='ArrowRight' || event.originalEvent.code=='Home' || event.originalEvent.code=='End' || event.originalEvent.code=='Tab' || (event.ctrlKey && event.originalEvent.code=='KeyC'))
					{
						return true;
					}
					else if(event.originalEvent.code=='Backspace' || event.originalEvent.code=='Delete')
					{
						$('#captchtxtcnter').html('(<b>'+(event.target.value.length-1)+'</b> '+LD.chrcnt[event.target.value.length-1==1?1:0]+')');
						return true;
					}
					else if((event.ctrlKey && event.originalEvent.code=='KeyX') || (event.ctrlKey && event.originalEvent.code=='KeyV'))
					{
						$('#captchtxtcnter').html('(<b>'+($('#captcha').val().length)+'</b> '+LD.chrcnt[$('#captcha').val().length==1?1:0]+')');
						return true;
					}
					event.preventDefault();
					var c = event.originalEvent.code;
					var val = event.target.value;
					event.target.value = val+(val.length>7?'':(c.startsWith('Key') || c.startsWith('Digit') || c.startsWith('Numpad')?c.replace(/Key([A-Z])|Digit([0-9])|Numpad([0-9])|Numpad([A-Za-z]+)/,'$1$2$3'):''));
					$('#captchtxtcnter').html('(<b>'+$('#captcha').val().length+'</b> '+LD.chrcnt[$('#captcha').val().length==1?1:0]+')');
				}).focus();
				$('#autoCaptureInterv'+currt).html('&nbsp;');
			}
			var icons = ['unerforscht','Ruderboot','Fischerboot','Weinhaendler','Haendler','leichtes_Kriegsschiff','UBoot','Diplomatenschiff','Schiffbruechige','Phoenizier'];
			var notyet = 'skin/pirateFortress/2012-11-09_IK_Kaperfahrt_unerforscht.png';
//			var active = (act?'':'in')+'aktiv';
			var path = 'skin/pirateFortress/2012-11-09_IK_Kaperfahrt_{0}_{1}.png';
			var duration = [150,450,900,1800,3600,7200,14400,28800,57600];
			var gold = [40,96,173,311,560,1008,1814,3265,5877];
			var cp = [115,276,442,707,1131,1810,2896,4634,7414];
//			$('#js_tabCrew').prepend('<div style="position:relative;bottom:23px;margin-bottom:-10px">Hallo</div>');
			$('#pirateFortress > div.bd.mainContentScroll').css('min-height','600px');
			$('#pirateFortress > div.bd.mainContentScroll > div.mainContent.minimizableContent > div.buildingDescription > h1').html(LD.pirtxt[0]);
			$('#pirateFortress > div.bd.mainContentScroll > div.mainContent.minimizableContent > div.buildingDescription > p').html(LD.pirtxt[32]);
			$('#js_tabBootyQuest > b.tabBootyQuest').html(LD.pirtxt[1]);
			$('#js_tabCrew > b.tabCrew').html(LD.pirtxt[2]);
			$('#pirateFortress > div.bd.mainContentScroll > div.mainContent.minimizableContent > div.pirateHeader > ul').css({'left':'35px','width':'620px'}).find('li').each(function(k,i)
			{
				switch(k)
				{
					case 0:
						$(i).css({'width':'170px'});
						break;
					case 1:
						$(i).css({'left':'335px','width':'245px'});
						break;
					case 2:
						$(i).css({'left':'215px','width':'100px'});
						break;
				}
			});
			$('#pirateFortress > div.bd.mainContentScroll > div.mainContent.minimizableContent > div.pirateHeader > ul > li.capturePoints').attr('title',LD.pirtxt[3]);
			$('#pirateFortress > div.bd.mainContentScroll > div.mainContent.minimizableContent > div.pirateHeader > ul > li.capturePoints > span.textLabel').html(LD.pirtxt[3]);
			$('#pirateFortress > div.bd.mainContentScroll > div.mainContent.minimizableContent > div.pirateHeader > ul > li.time').attr('title',LD.pirtxt[4]);
			$('#pirateFortress > div.bd.mainContentScroll > div.mainContent.minimizableContent > div.pirateHeader > ul > li.time > span.textLabel').html(LD.pirtxt[4]);
			var curcpts = parseInt($('#pirateFortress > div.bd.mainContentScroll > div.mainContent.minimizableContent > div.pirateHeader > ul > li.capturePoints > span.value').text().replace(/(\d+)[,.](?=\d{3}(\D|$))/g,'$1'));
			$('#pirateFortress > div.bd.mainContentScroll > div.mainContent.minimizableContent > div.pirateHeader > ul > li.capturePoints > span.value').text(Utils.FormatNumToStr(curcpts,false,0)).after('<span id="nextcapturepoints" class="value"></span>');
			$('#piracyHighscoreTime').before('<span id="piratesEndOfTime_'+currt+'"></span>').hide();
			$('#piratesEndOfTime').prev('span.textLabel').text(LD.pirtxt[4]).parent().attr('title',LD.pirtxt[4]);
//			$('.tooltip-div').each(function(){$(this).remove();});
			$('#pirateFortress > div.bd.mainContentScroll > div.mainContent.minimizableContent > div.pirateHeader > ul > li.pirateCrew').addClass('empiretooltip').append('<div class="tooltip-div" style="display:none"></div>');
			$('#pirateFortress > div.bd.mainContentScroll > div.mainContent.minimizableContent > div.pirateHeader > ul > li.pirateCrew').find('.tooltip-div').html(Utils.format('<table style="color:#000;font-weight:normal;font-size:12px;line-height:18px"><tbody><tr><td style="text-align:left">{0}</td><td><b>:</b></td><td style="text-align:right">{1}</td></tr><tr><td style="text-align:left">{2}</td><td><b>:</b></td><td style="text-align:right">{3}</td></tr><tr style="border-top: 1px solid #CCA569;"><td style="text-align:left">&Sigma;</td><td><b>:</b></td><td style="text-align:right"><b>{4}</b></td></tr>'+(params.bonusCrewPoints>0?'<tr><td style="text-align:left">{5}</td><td><b>:</b></td><td style="text-align:right">{6}</td></tr>':'')+'<tr style="border-top: 1px solid #CCA569;"><td style="text-align:left">&Sigma;</td><td><b>:</b></td><td style="text-align:right"><b>{7}</b></td></tr></tbody></table>',[LD.pirtxt[5],Utils.FormatNumToStr(params.basicCrewPoints),LD.pirtxt[2],Utils.FormatNumToStr(params.crewPoints),Utils.FormatNumToStr(params.basicCrewPoints+parseInt(params.crewPoints)),LD.pirtxt[6],Utils.FormatNumToStr(params.bonusCrewPoints),Utils.FormatNumToStr(params.basicCrewPoints+parseInt(params.crewPoints)+params.bonusCrewPoints)]));
			var curcrew = parseInt($('#pirateFortress > div.bd.mainContentScroll > div.mainContent.minimizableContent > div.pirateHeader > ul > li.pirateCrew > span.value').text().replace(/(\d+)[,.](?=\d{3}(\D|$))/g,'$1'));
			$('#pirateFortress > div.bd.mainContentScroll > div.mainContent.minimizableContent > div.pirateHeader > ul > li.pirateCrew > span.value').text(Utils.FormatNumToStr(curcrew,false,0)+' +').next('span').after('<span id="nextcrew" class="value"></span> = <span id="totalcrew" class="value" style="font-weight:bold"></span>');
			$('#pirateFortress > div.bd.mainContentScroll > div.mainContent.minimizableContent > div.pirateHeader > ul > li.pirateCrew > span.textLabel').text(LD.pirtxt[2]);
			$('#pirateFortress > div.bd.mainContentScroll > div.mainContent.minimizableContent > div.pirateHeader > ul > li.pirateCrew > span.pirateCrewBonus').css({'position':'unset','display':'inline-block'}).html(function(i,t)
			{
				return Utils.FormatNumToStr(parseInt(t.replace(/(\d+)[,.](?=\d{3}(\D|$))/g,"$1")),false,0)+' <img src="skin/resources/icon_piratecrew_small.png" title="'+LD.pirtxt[2]+'" alt="'+LD.pirtxt[2]+'">';
			});
			setInterval(function()
			{
				$('#pirateHighscore > li').each(function(k,p)
				{
					var plr = params.highscore[k];
					var mul = Utils.mul(plr.place);
					var diff = '';
					switch(Math.abs(parseInt(plr.oldPlace)-parseInt(plr.place)))
					{
						case 0:
							diff = LD.pirtxt[41];
							break;
						case 1:
							diff = LD.pirtxt[42];
							break;
						default:
							diff = LD.pirtxt[43];
							break;
					}
					city = ikariam.getCurrentCity;
					var pDiff = params.highscorePlayerPosition!=undefined ? parseInt(params.highscore[params.highscorePlayerPosition].capturePoints)-parseInt(plr.capturePoints): 0;
					var curDiff = parseInt(params.capturePoints)-parseInt(plr.capturePoints);
					var tip = '<table style="color:#000;font-weight:normal;font-size:12px"><tbody><tr><th colspan="3" style="text-align:center;font-size:15px">'+(mul>0?'{0} &times; {1} = {2}':LD.pirtxt[52])+'</th></tr><tr><td colspan="3" style="text-align:center;border-bottom:1px solid #FFE4B5">'+plr.name+'</td></tr><tr><td>{4}</td><td><b>«</b></td><td>{3}</td></tr><tr><td>{6}</td><td><b>«</b></td><td>{5}</td></tr><tr><td style="white-space:nowrap">{8}</td><td><b>«</b></td><td>{7}</td></tr>'+(plr.avatarId==unsafeWindow.dataSetForView.avatarId?'':'<tr style="border-top:1px solid #FFE4B5"><td style="color:{18};font-weight:bold">{19}</td><td><b>«</b></td><td>{17}</td></tr>')+'<tr style="border-top:1px solid #FFE4B5"><td style="color:{20};font-weight:bold">{21}</td><td><b>«</b></td><td>{22}</td></tr><tr><td>{23}</td><td><b>«</b></td><td>{24}</td></tr><tr><td>{25}</td><td><b>«</b></td><td>{26}</td></tr>'+(plr.avatarId==unsafeWindow.dataSetForView.avatarId?'':(building.getLevel>=plr.distance?'<tr style="border-top:1px solid #FFE4B5"><td>{10}<br>{14}</td><td><b>«</b></td><td>{13}</td></tr><tr><td>{12}<br>{16}</td><td><b>«</b></td><td>{15}</td></tr>':'<tr style="border-top:1px solid #FFE4B5"><td colspan="3" style="text-align:center">'+Utils.format(LD.pirtxt[44],[LD[city.isCapital?'capital':'colony'],city.getName])+'</td></tr>'))+'</tbody></table>';
					var now = moment();
					$('#tooltip-div'+k+'_'+currt).html(Utils.format(tip,['<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAcAAAAJCAYAAAD+WDajAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAEFJREFUeNpi/P//PwMIhOrzQhhAsPriZ0YQzYQugcxnQhaE6YABxhA9HhRdyICJAQ/AayzxOtFdzYRuFLIVAAEGANwqFwuukYKqAAAAAElFTkSuQmCC" style="width:auto;height:15px">',Utils.FormatNumToStr(mul,false,3).replace(/0+$/,'').replace(/[,.]$/,''),'<img src="skin/resources/icon_wood.png" style="width:auto;height:15px">+<img src="data:image/gif;base64,R0lGODlhGgAUAPZ9AA8KCScZFjY2FjslJFMzM0VAG3pIC0xzC15KNzNedXNIR2tWQnRgTXtoVYdUD5dlFaNyHIteK61+IolSUp5cXYFuW4VzYYh2Y415ZI58abRqasV4dlyJD2ibEHOtEnuPNHSlILeLLYWrN8qfNIfIFbuXXZOBbZmHdbGafMGWQdStQuG8Tc6sbd++YKHKT+3KU+/QbPXVY+zPefPWeEWGpV2TrE+Ut2ees2OrzmqszXqyzW2y1G+53ny20nK323a63Hu/4X/A4aCQgKqbi7mihbSnmIyoqZmuq5OytqWxpa2zpL+0pLu+q8qvidW4jNy+lMS7oMS5q7vHvePGi/XahejIl+XHnebInO/anv7kg9jEqNbKrM3Cs8LKvtPKvOzPpenRrfXlvYzA15TD2ITD4onH5o3J5pPK5JvN5ZXN6JbQ7qLQ5qTT667Z7bTa7Lrd7Lvh8s3QwcnUzc/YztvSxOXayenj2crg5s7p9tLr99bu+PXw6Pz37wAAAAAAAAAAACH5BAUAAH0ALAAAAAAaABQAAAf/gH2Cg3ZCKIOIfU4HHCBOiYhLdg0ZF02QHYwgLpCCWl51CxcNFZBEHIxEnWBeXEN2GA0NiU4EAQUHHR2QdEtFXnsNJhlPg04UAxMbAh0cHom9dkV7CycnJn1XA8kbEwAfzh0kglZ2UXVeXnYIGRXYVxrdAQEEJBwdHs9WdF4ZGSdR1jGoMMvJAAIEAGygkAvfLi+9KDGwQAcBAgYM+kwgoEyBggFONnAgsatTJydOFDwaRISECEhVXpQwSRMSFRgwSlQxuSVOzTAxwoSAEKHTER9l5pjkIwNLFhgPHjiYIojJGSlGyASpkQTSlykzZsQYkcLACgOCkKQx08MHkARyZhLxwTJjxIoXD1ZAkOBAkJI3QH6MoaFDDaK5VFqEqPtAxQoHDwbdYIMjjRs8QLoMwtIiRYgYKiQ8SPFCtCAoZ3LsgIMGTh4eg6pMqTLjRQoJLFjAUIFWkA0xevq0WdOmx52ayDsFAgA7" style="width:auto;height:15px">',LD.pirtxt[45],Utils.Nth(plr.place),LD.pirtxt[46],Utils.Nth(plr.oldPlace),LD.pirtxt[47],'<span style="display:inline;color:'+(parseInt(plr.oldPlace)==parseInt(plr.place)?'blue':(parseInt(plr.oldPlace)<parseInt(plr.place)?'red':'green'))+';font-weight:bold">'+Utils.FormatNumToStr(parseInt(plr.oldPlace)-parseInt(plr.place),true)+'</span>'+diff,LD.pirtxt[48],Utils.FormatTimeLengthToStr(Utils.estimateTravelTime(plr.distance),4),LD.pirtxt[49],Utils.FormatTimeLengthToStr(Utils.estimateTravelTime(plr.distance)*2,4),LD.pirtxt[50],Utils.FormatFullTimeToDateString(Utils.estimateTravelTime(plr.distance)+now),LD.pirtxt[51],Utils.FormatFullTimeToDateString(Utils.estimateTravelTime(plr.distance)*2+now),LD.pirtxt[54],pDiff>0?'green':(pDiff<0?'red':'blue'),Utils.FormatNumToStr(pDiff,true,0),curDiff>0?'green':(curDiff<0?'red':'blue'),Utils.FormatNumToStr(curDiff,true,0),LD.pirtxt[55],Utils.FormatNumToStr(Math.ceil(Math.abs(curDiff/cp[0])),false,0),LD.pirtxt[56],Utils.FormatTimeLengthToStr(Math.ceil(Math.abs(curDiff/cp[0]))*duration[0]*1000,4),LD.pirtxt[57]]));
				});
			},1000);
			var mymul = 0;
			$('[id^="tooltip-div"]').remove();
			var lstplc = params.highscore.slice(-1)[0].place.toString().length;
			var fstcpts = Utils.FormatNumToStr(params.highscore[0].capturePoints,0,false).length;
			$('.pirateHeader').prepend('<span id="getHighscorelist" style="font-size:12pt;position:relative;top:50px;left:8px;cursor:pointer" title="'+LD.pirtxt[59]+'">📋</span>');
			var listtxt = '';
			$.each(params.highscore,function(key,plist)
			{
				listtxt += plist.place.toString().padStart(lstplc,' ')+'. '+''.padStart(fstcpts-Utils.FormatNumToStr(plist.capturePoints,0,false).length,' ')+Utils.FormatNumToStr(plist.capturePoints,0,false)+' '+plist.name+'\r\n';
			});
			$('#getHighscorelist').on('click',function(){ navigator.clipboard.writeText(listtxt); render.toast(Utils.format('<b>{0}</b>',[LD.pirtxt[60]])); });
			$('#pirateHighscore > li').each(function(k,p)
			{
				var plr = params.highscore[k];
				var mul = Utils.mul(plr.place);
				mymul += plr.avatarId==unsafeWindow.dataSetForView.avatarId ? mul : 0;
				var diff = '';
				switch(Math.abs(parseInt(plr.oldPlace)-parseInt(plr.place)))
				{
					case 0:
						diff = LD.pirtxt[41];
						break;
					case 1:
						diff = LD.pirtxt[42];
						break;
					default:
						diff = LD.pirtxt[43];
						break;
				}
				var top = $(this).find('.tooltip-div').css('top');
				var left = $(this).find('.tooltip-div').css('left');
				$(this).addClass('empiretooltip').append('<div id="tooltip-div'+k+'_'+currt+'" class="tooltip-div" style="display:none;top:'+top+';left:'+left+'"></div>');
				var pDiff = params.highscorePlayerPosition?parseInt(params.highscore[params.highscorePlayerPosition].capturePoints)-parseInt(plr.capturePoints):0;
				var curDiff = parseInt(params.capturePoints)-parseInt(plr.capturePoints);
				var tip = '<table style="color:#000;font-weight:normal;font-size:12px"><tbody><tr><th colspan="3" style="text-align:center;font-size:15px">'+(mul>0?'{0} &times; {1} = {2}':LD.pirtxt[52])+'</th></tr><tr><td colspan="3" style="text-align:center;border-bottom:1px solid #FFE4B5">'+plr.name+'</td></tr><tr><td>{4}</td><td><b>«</b></td><td>{3}</td></tr><tr><td>{6}</td><td><b>«</b></td><td>{5}</td></tr><tr><td style="white-space:nowrap">{8}</td><td><b>«</b></td><td>{7}</td></tr>'+(plr.avatarId==unsafeWindow.dataSetForView.avatarId?'':'<tr style="border-top:1px solid #FFE4B5"><td style="color:{18};font-weight:bold">{19}</td><td><b>«</b></td><td>{17}</td></tr>')+'<tr style="border-top:1px solid #FFE4B5"><td style="color:{20};font-weight:bold">{21}</td><td><b>«</b></td><td>{22}</td></tr><tr><td>{23}</td><td><b>«</b></td><td>{24}</td></tr><tr><td>{25}</td><td><b>«</b></td><td>{26}</td></tr>'+(plr.avatarId==unsafeWindow.dataSetForView.avatarId?'':(building.getLevel>=plr.distance?'<tr style="border-top:1px solid #FFE4B5"><td>{10}<br>{14}</td><td><b>«</b></td><td>{13}</td></tr><tr><td>{12}<br>{16}</td><td><b>«</b></td><td>{15}</td></tr>':'<tr style="border-top:1px solid #FFE4B5"><td colspan="3" style="text-align:center">'+Utils.format(LD.pirtxt[44],[LD[city.isCapital?'capital':'colony'],city.getName])+'</td></tr>'))+'</tbody></table>';
				$(this).addClass('empiretooltip');
				$('#tooltip-div'+k+'_'+currt).html(Utils.format(tip,['<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAcAAAAJCAYAAAD+WDajAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAEFJREFUeNpi/P//PwMIhOrzQhhAsPriZ0YQzYQugcxnQhaE6YABxhA9HhRdyICJAQ/AayzxOtFdzYRuFLIVAAEGANwqFwuukYKqAAAAAElFTkSuQmCC" style="width:auto;height:15px">',Utils.FormatNumToStr(mul,false,3).replace(/0+$/,'').replace(/[,.]$/,''),'<img src="skin/resources/icon_wood.png" style="width:auto;height:15px">+<img src="data:image/gif;base64,R0lGODlhGgAUAPZ9AA8KCScZFjY2FjslJFMzM0VAG3pIC0xzC15KNzNedXNIR2tWQnRgTXtoVYdUD5dlFaNyHIteK61+IolSUp5cXYFuW4VzYYh2Y415ZI58abRqasV4dlyJD2ibEHOtEnuPNHSlILeLLYWrN8qfNIfIFbuXXZOBbZmHdbGafMGWQdStQuG8Tc6sbd++YKHKT+3KU+/QbPXVY+zPefPWeEWGpV2TrE+Ut2ees2OrzmqszXqyzW2y1G+53ny20nK323a63Hu/4X/A4aCQgKqbi7mihbSnmIyoqZmuq5OytqWxpa2zpL+0pLu+q8qvidW4jNy+lMS7oMS5q7vHvePGi/XahejIl+XHnebInO/anv7kg9jEqNbKrM3Cs8LKvtPKvOzPpenRrfXlvYzA15TD2ITD4onH5o3J5pPK5JvN5ZXN6JbQ7qLQ5qTT667Z7bTa7Lrd7Lvh8s3QwcnUzc/YztvSxOXayenj2crg5s7p9tLr99bu+PXw6Pz37wAAAAAAAAAAACH5BAUAAH0ALAAAAAAaABQAAAf/gH2Cg3ZCKIOIfU4HHCBOiYhLdg0ZF02QHYwgLpCCWl51CxcNFZBEHIxEnWBeXEN2GA0NiU4EAQUHHR2QdEtFXnsNJhlPg04UAxMbAh0cHom9dkV7CycnJn1XA8kbEwAfzh0kglZ2UXVeXnYIGRXYVxrdAQEEJBwdHs9WdF4ZGSdR1jGoMMvJAAIEAGygkAvfLi+9KDGwQAcBAgYM+kwgoEyBggFONnAgsatTJydOFDwaRISECEhVXpQwSRMSFRgwSlQxuSVOzTAxwoSAEKHTER9l5pjkIwNLFhgPHjiYIojJGSlGyASpkQTSlykzZsQYkcLACgOCkKQx08MHkARyZhLxwTJjxIoXD1ZAkOBAkJI3QH6MoaFDDaK5VFqEqPtAxQoHDwbdYIMjjRs8QLoMwtIiRYgYKiQ8SPFCtCAoZ3LsgIMGTh4eg6pMqTLjRQoJLFjAUIFWkA0xevq0WdOmx52ayDsFAgA7" style="width:auto;height:15px">',LD.pirtxt[45],Utils.Nth(plr.place),LD.pirtxt[46],Utils.Nth(plr.oldPlace),LD.pirtxt[47],'<span  style="display:inline;color:'+(parseInt(plr.oldPlace)==parseInt(plr.place)?'blue':(parseInt(plr.oldPlace)<parseInt(plr.place)?'red':'green'))+';font-weight:bold">'+Utils.FormatNumToStr(parseInt(plr.oldPlace)-parseInt(plr.place),true)+'</span>'+diff,LD.pirtxt[48],Utils.FormatTimeLengthToStr(Utils.estimateTravelTime(plr.distance),4),LD.pirtxt[49],Utils.FormatTimeLengthToStr(Utils.estimateTravelTime(plr.distance)*2,4),LD.pirtxt[50],Utils.FormatFullTimeToDateString(Utils.estimateTravelTime(plr.distance)+moment()),LD.pirtxt[51],Utils.FormatFullTimeToDateString(Utils.estimateTravelTime(plr.distance)*2+moment()),LD.pirtxt[54],pDiff>0?'green':(pDiff<0?'red':'blue'),Utils.FormatNumToStr(pDiff,true,0),curDiff>0?'green':(curDiff<0?'red':'blue'),Utils.FormatNumToStr(curDiff,true,0),LD.pirtxt[55],Utils.FormatNumToStr(Math.ceil(Math.abs(curDiff/cp[0])),false,0),LD.pirtxt[56],Utils.FormatTimeLengthToStr(Math.ceil(Math.abs(curDiff/cp[0]))*duration[0]*1000,4),LD.pirtxt[57]]));
				$(this).find('span.place').text(function(){return Utils.FormatNumToStr(parseInt($(this).text().replace(/\D+/g,'')),false,0)+'.';}).removeAttr('title').before(k==parseInt(params.highscorePlayerPosition) || building.getLevel<=plr.distance?'':'<span style="float:right'+(parseInt(plr.place) <=50 ? ';margin-right:27px' : '')+'">'+Utils.FormatTimeLengthToStr(Utils.estimateTravelTime(plr.distance),2)+'</span>');
				var capPoints = typeof plr.capturePoints === 'number' && isFinite(plr.capturePoints) ? parseInt(plr.capturePoints) : parseInt(plr.capturePoints.replace(/(\d+)[,.](?=\d{3}(\D|$))/g,"$1"));
				$(this).find('span.pirateBooty').removeAttr('title').html(Utils.FormatNumToStr(capPoints,false,0)+' &nbsp;<img src="skin/resources/capturePoints_small.png" alt="'+LD.pirtxt[3]+'">');
				if(params.highscorePlayerPosition==undefined) { $(this).find('span.userName').text(LD.pirtxt[58]); }
				$(this).find('span.short_text80').removeAttr('title').find('span.short_text80 > a.userName').css('font-weight','normal');
				if(database.settings.ctfinder.value)
				{
					if(Object.keys(database.getGlobalData.getMuseumTreaties).indexOf(plr.avatarId)!=-1)
					{
						$(this).find('span.short_text80 > a.userName').before('<img src="skin/museum/icon32_culturalgood.png" style="width:15px;height:auto" title="'+LD.ctenabled+'">');
					}
					else if(Object.keys(database.getGlobalData.getPotMuseumTreaties).indexOf(plr.avatarId)!=-1)
					{
						$(this).find('span.short_text80 > a.userName').before('<img src="skin/museum/icon32_culturalgood.png" style="width:15px;height:auto;opacity:0.5" title="'+LD.ctrequested[database.getGlobalData.getPotMuseumTreaties[plr.avatarId].type*0.5-39]+'">');
					}
				}
			});
			console.log();
			$('#pirateFortress > div.bd.mainContentScroll > div.mainContent.minimizableContent > div.pirateHighscoreNextCalc').text(Utils.format(LD.pirtxt[8],[moment().startOf('day').add({h:parseInt(pt.dailyreset[0]),m:parseInt(pt.dailyreset[1])}).subtract(diff,'s').format('H:mm')]));
			$('#pirateFortress > div.bd.mainContentScroll > div.mainContent.minimizableContent > div.pirateHighscoreNextCalc').append('<span class="indicator" style="float:left;left:30px;top:-4px"></span><span class="indicator" style="float:right;right:45px;top:-4px"></span><div class="info-div" style="display:none;text-align:center;overflow:visible;background-color:transparent;border:0px;width:661px;margin-left:9px;position:absolute;z-index:7483647"></div>');
			$('.pirateHighscoreNextCalc .indicator').click(function(e){var target = e.target;$(target).nextAll('div.info-div').slideToggle('fast','linear',function(){$(target).parent().toggleClass('active');});});
			var tip = '<table style="display:inline;color:#000;font-weight:normal;font-size:11px;background-color:transparent;border:0px;overflow:auto"><thead><tr><th colspan="9" style="text-align:center">{0}</th></tr><tr><th colspan="2" style="text-align:center">{1}</th><th style="text-align:center">{2}</th><th style="text-align:center">{3}</th><th style="text-align:center">{4}</th><th style="text-align:center">{5}</th><th style="text-align:center">{6}</th><th style="text-align:center">{7}</th><th style="text-align:center">{8}</th></tr></thead><tbody>{9}<tr><th colspan="2" style="text-align:center">{8}</th>{10}</tbody></table>';
			var tiprows = '';
			var sum = 0;
			$.each(database.settings.cityOrder.value,function(k,c)
			{
				var p = database.getCityFromId(c);
				var max = p.maxResourceCapacities.safe;
				sum += max;
				tiprows += '<tr'+(c==city.getId?' style="background-color:#eccf8e !important;border:1px solid #000"':'')+'><td style="text-align:center">'+(k+1)+'</td><td style="text-align:left">'+p.getName+'</td><td>'+Utils.FormatNumToStr(max,false,max>0?0:2)+(database.settings.quantityLoads.value?'<br>'+Utils.FormatQuantityToLoad(max):'')+'</td><td>'+Utils.FormatNumToStr(max*mymul,false,mymul>0?0:2)+(database.settings.quantityLoads.value?'<br>'+Utils.FormatQuantityToLoad(max*mymul):'')+'</td><td>'+Utils.FormatNumToStr(max*mymul,false,mymul>0?0:2)+(database.settings.quantityLoads.value?'<br>'+Utils.FormatQuantityToLoad(max*mymul):'')+'</td><td>'+Utils.FormatNumToStr(max*mymul,false,mymul>0?0:2)+(database.settings.quantityLoads.value?'<br>'+Utils.FormatQuantityToLoad(max*mymul):'')+'</td><td>'+Utils.FormatNumToStr(max*mymul,false,mymul>0?0:2)+(database.settings.quantityLoads.value?'<br>'+Utils.FormatQuantityToLoad(max*mymul):'')+'</td><td>'+Utils.FormatNumToStr(max*mymul,false,mymul>0?0:2)+(database.settings.quantityLoads.value?'<br>'+Utils.FormatQuantityToLoad(max*mymul):'')+'</td><th style="font-weight:normal">'+Utils.FormatNumToStr(max*mymul*5,false,mymul>0?0:2)+(database.settings.quantityLoads.value?'<br>'+Utils.FormatQuantityToLoad(max*mymul*5):'')+'</th></tr>';
			});
			$('#pirateFortress > div.bd.mainContentScroll > div.mainContent.minimizableContent > div.pirateHighscoreNextCalc').find('.info-div').html(Utils.format(tip,[LD.pirtxt[53]+'<div style="font-weight:normal">('+(mymul>0?'<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAcAAAAJCAYAAAD+WDajAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAEFJREFUeNpi/P//PwMIhOrzQhhAsPriZ0YQzYQugcxnQhaE6YABxhA9HhRdyICJAQ/AayzxOtFdzYRuFLIVAAEGANwqFwuukYKqAAAAAElFTkSuQmCC"> &times; '+Utils.FormatNumToStr(mymul,false,3).replace(/0+$/,'').replace(/[,.]$/,'')+' = <img src="skin/resources/icon_wood.png" style="width:auto;height:10px">+<img src="data:image/gif;base64,R0lGODlhGgAUAPZ9AA8KCScZFjY2FjslJFMzM0VAG3pIC0xzC15KNzNedXNIR2tWQnRgTXtoVYdUD5dlFaNyHIteK61+IolSUp5cXYFuW4VzYYh2Y415ZI58abRqasV4dlyJD2ibEHOtEnuPNHSlILeLLYWrN8qfNIfIFbuXXZOBbZmHdbGafMGWQdStQuG8Tc6sbd++YKHKT+3KU+/QbPXVY+zPefPWeEWGpV2TrE+Ut2ees2OrzmqszXqyzW2y1G+53ny20nK323a63Hu/4X/A4aCQgKqbi7mihbSnmIyoqZmuq5OytqWxpa2zpL+0pLu+q8qvidW4jNy+lMS7oMS5q7vHvePGi/XahejIl+XHnebInO/anv7kg9jEqNbKrM3Cs8LKvtPKvOzPpenRrfXlvYzA15TD2ITD4onH5o3J5pPK5JvN5ZXN6JbQ7qLQ5qTT667Z7bTa7Lrd7Lvh8s3QwcnUzc/YztvSxOXayenj2crg5s7p9tLr99bu+PXw6Pz37wAAAAAAAAAAACH5BAUAAH0ALAAAAAAaABQAAAf/gH2Cg3ZCKIOIfU4HHCBOiYhLdg0ZF02QHYwgLpCCWl51CxcNFZBEHIxEnWBeXEN2GA0NiU4EAQUHHR2QdEtFXnsNJhlPg04UAxMbAh0cHom9dkV7CycnJn1XA8kbEwAfzh0kglZ2UXVeXnYIGRXYVxrdAQEEJBwdHs9WdF4ZGSdR1jGoMMvJAAIEAGygkAvfLi+9KDGwQAcBAgYM+kwgoEyBggFONnAgsatTJydOFDwaRISECEhVXpQwSRMSFRgwSlQxuSVOzTAxwoSAEKHTER9l5pjkIwNLFhgPHjiYIojJGSlGyASpkQTSlykzZsQYkcLACgOCkKQx08MHkARyZhLxwTJjxIoXD1ZAkOBAkJI3QH6MoaFDDaK5VFqEqPtAxQoHDwbdYIMjjRs8QLoMwtIiRYgYKiQ8SPFCtCAoZ3LsgIMGTh4eg6pMqTLjRQoJLFjAUIFWkA0xevq0WdOmx52ayDsFAgA7" style="width:auto;height:10px">':LD.pirtxt[52])+')</div>',LD.city,'<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAcAAAAJCAYAAAD+WDajAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAEFJREFUeNpi/P//PwMIhOrzQhhAsPriZ0YQzYQugcxnQhaE6YABxhA9HhRdyICJAQ/AayzxOtFdzYRuFLIVAAEGANwqFwuukYKqAAAAAElFTkSuQmCC" style="width:auto;height:10px">','<img src="skin/resources/icon_wood.png" style="width:auto;height:10px">','<img src="skin/resources/icon_wine.png" style="width:auto;height:10px">','<img src="skin/resources/icon_marble.png" style="width:auto;height:10px">','<img src="skin/resources/icon_crystal.png" style="width:auto;height:10px">','<img src="skin/resources/icon_sulfur.png" style="width:auto;height:10px">','&Sigma;',tiprows,'<th>'+Utils.FormatNumToStr(sum,false,sum?0:2)+(database.settings.quantityLoads.value?'<br>'+Utils.FormatQuantityToLoad(sum):'')+'</th><th>'+Utils.FormatNumToStr(sum*mymul,false,mymul>0?0:2)+(database.settings.quantityLoads.value?'<br>'+Utils.FormatQuantityToLoad(sum*mymul):'')+'</th><th>'+Utils.FormatNumToStr(sum*mymul,false,mymul>0?0:2)+(database.settings.quantityLoads.value?'<br>'+Utils.FormatQuantityToLoad(sum*mymul):'')+'</th><th>'+Utils.FormatNumToStr(sum*mymul,false,mymul>0?0:2)+(database.settings.quantityLoads.value?'<br>'+Utils.FormatQuantityToLoad(sum*mymul):'')+'</th><th>'+Utils.FormatNumToStr(sum*mymul,false,mymul>0?0:2)+(database.settings.quantityLoads.value?'<br>'+Utils.FormatQuantityToLoad(sum*mymul):'')+'</th><th>'+Utils.FormatNumToStr(sum*mymul,false,mymul>0?0:2)+(database.settings.quantityLoads.value?'<br>'+Utils.FormatQuantityToLoad(sum*mymul):'')+'</th><th>'+Utils.FormatNumToStr(sum*mymul*5,false,mymul>0?0:2)+(database.settings.quantityLoads.value?'<br>'+Utils.FormatQuantityToLoad(sum*mymul*5):'')+'</th>']));
			$('#pirateCaptureBox > h3').text(LD.pirtxt[9]);
			$('#pirateCaptureBox > div.content > div > p').css('text-align','center').html(Utils.format(LD.pirtxt[10],['<b>'+LD.pirtxt[36+(params.ongoingMissionType=='capture'?1:0)]+'</b>']));
			$('#pirateCaptureBox > div.content > div > div.duration').css({'margin':'0px','vertical-align':'unset','width':'auto','position':'relative','bottom':'6px'}).text(LD.pirtxt[11]+':').parent().css({'text-align':'center','margin':'0px'});
			$('#missionEndOfTime_'+currt).remove();
			$('#missionProgressTime').after('<div id="missionEndOfTime_'+currt+'" style="display:inline-block"></div>').hide();
			var ct = params.ongoingConvertionTimeRemaining*1000+$.now();
			$('#conversionProgressTime').before('<div class="time">'+Utils.FormatFullTimeToDateString(ct,false)+'<br><span id="conversionEndOfTime_'+currt+'"></span></div>').hide();
			$('#pirateCaptureBox > div.content > div > a').attr('title',LD.pirtxt[12]);
			$('#pirateCaptureBox > div.content > table > thead > tr > th').css('height','14px');
			$('#pirateCaptureBox > div.content > table > thead > tr > th.target').text(LD.pirtxt[13]);
			$('#pirateCaptureBox > div.content > table > thead > tr > th.requirement').text(LD.pirtxt[11]);
			$('#pirateCaptureBox > div.content > table > thead > tr > th.reward').text(LD.pirtxt[14]);
			$('#pirateCaptureBox > div.content > table > thead > tr > th.action').text(LD.pirtxt[15]);
			$('#pirateCaptureBox > div.content > table > tbody > tr > td.action > a').text(LD.pirtxt[16]);
			var toolinterv = setInterval(function()
			{
				var now = moment();
				$('#pirateCaptureBox > div.content > table > tbody > tr').each(function(y,r)
				{
					$(r).find('td').each(function(x,c)
					{
						$('#tooltip-div_'+x+'_'+y+'_'+currt).html(Utils.FormatFullTimeToDateString((duration[y]+(params.ongoingMissionTimeRemaining?params.ongoingMissionTimeRemaining:0))*1000+now-1000,false));
					});
				});
				if(params.ongoingMissionTimeRemaining) { clearInterval(toolinterv); }
			},1000);
			$('#pirateCaptureBox > div.content > table > tbody > tr').each(function(y,r)
			{
				$(r).find('td').each(function(x,c)
				{
					if(x==1) { $(c).text(LD.pirtxt[y+18]); }
					if(x==2) { $(c).find('ul > li').css({'text-align':'center','padding-left':'15px'}).html('<span class="textLabel">'+LD.pirtxt[11]+':</span>'+Utils.FormatTimeLengthToStr(duration[y]*1000,2)); }
					if(x==3)
					{
						$(c).find('ul > li.gold').css({'text-align':'right','padding-left':'15px'}).html('<span class="textLabel">'+LD.plundergold+':</span> '+Utils.FormatNumToStr(gold[y],false,0));
						$(c).find('ul > li.capturePoints').css({'text-align':'right','padding-left':'40px'}).html('<span class="textLabel">'+LD.pirtxt[3]+':</span> '+Utils.FormatNumToStr(cp[y],false,0));
					}
					$('[id^="tooltip-div_'+x+'_'+y+'"').remove();
					$(c).addClass('empiretooltip').css('padding','0px').append('<div id="tooltip-div_'+x+'_'+y+'_'+currt+'" class="tooltip-div" style="display:none">'+Utils.FormatFullTimeToDateString((duration[y]+(params.ongoingMissionTimeRemaining?params.ongoingMissionTimeRemaining:0))*1000+moment()-1000,false)+'</div>');
				});
				$(this).find('> td.action > p').text(LD.pirtxt[17]+' '+(2*y+1));
				$(this).css({'background-color':y==pt.mission.level?'#eccf8e':'initial','border':y==pt.mission.level?'1px solid #000':'initial'});
			});
			$('#pirateCaptureBox > div.content > form > p').html(LD.pirtxt[34]);
			$('#pirateCaptureBox > div.content > form > div.captcha_input > label').html(LD.pirtxt[35]);
			$('#pirateCaptureBox > div.content > form > div.centerButton > input').val(LD.pirtxt[16]);
			$('#tabCrew > div > h3').text(LD.pirtxt[27]);
			$('#CPToCrewForm').css('opacity',parseInt($('#pirateFortress > div.bd.mainContentScroll > div.mainContent.minimizableContent > div.pirateHeader > ul > li.capturePoints > span.value').text().replace(/(\d+)[,.](?=\d{3}(\D|$))/g,'$1'))<10?'0.5':'1.0');
			$('#CPToCrewForm > div.unitinfo > h4').text(LD.pirtxt[2]);
			$('#CPToCrewForm > div.unitinfo > div').text(Utils.FormatNumToStr(parseInt($('#CPToCrewForm > div.unitinfo > div').text().replace(/(\d+)[,.](?=\d{3}(\D|$))/g,"$1")),false,0));
			$('#CrewbonusExplanation > h3').text(LD.pirtxt[2]);
			$('#CPToCrewForm > div.notEnoughCapturePoints > p').text(LD.pirtxt[28]);
			$('#CPToCrew > div.unitinfo > h4').text(LD.pirtxt[2]);
			$('#CPToCrew > div.unitinfo > img').attr('alt',LD.pirtxt[2]).attr('title',LD.pirtxt[2]);
			$('#CPToCrew > div.unitinfo > div.scroll_view').text(function(i,t)
			{
				return Utils.FormatNumToStr(parseInt(t.replace(/(\d+)[,.](?=\d{3}(\D|$))/g,"$1")),false,0);
			});
			$('#conversionProgressTxt').css('text-shadow','-1px -1px 0 #FFFFFF, 1px -1px 0 #FFFFFF, -1px 1px 0 #FFFFFF, 1px 1px 0 #FFFFFF').html(function(i,t)
			{
				return Utils.FormatNumToStr(parseInt(t.replace(/(\d+)[,.](?=\d{3}(\D|$))/g,"$1")),false,0)+' <img src="skin/resources/capturePoints_small.png" title="'+LD.pirtxt[3]+'" alt="'+LD.pirtxt[3]+'"> &nbsp;&gt;&nbsp; '+Utils.FormatNumToStr(parseInt(t.replace(/(\d+)[,.](?=\d{3}(\D|$))/g,"$1"))/10,false,0)+' <img src="skin/resources/icon_piratecrew_small.png" title="'+LD.pirtxt[2]+'" alt="'+LD.pirtxt[2]+'">';
			});
			$('#convertHint').text(Utils.format(LD.pirtxt[33],[Utils.FormatTimeLengthToStr(156000,2)]));
			var swordsimg = '<img src="skin/resources/capturePoints_small.png" title="'+LD.pirtxt[3]+'" alt="'+LD.pirtxt[3]+'">';
			var crewimg = '<img src="skin/resources/icon_piratecrew_small.png" title="'+LD.pirtxt[2]+'" alt="'+LD.pirtxt[2]+'">';
			$('#CrewbonusExplanation > p').html(Utils.format(LD.pirtxt[30],[Utils.FormatNumToStr(7000,false,0)+' '+swordsimg,Utils.FormatNumToStr(1400,false,0)+' '+crewimg]));
			$('#CPToCrewSubmit').attr('value',LD.pirtxt[31]).attr('title',LD.pirtxt[31]);
			$('#CrewbonusExplanation > div').html(function(i,t)
			{
				return Utils.FormatNumToStr(parseInt(t.replace(/(\d+)[,.](?=\d{3}(\D|$))/g,"$1")),false,0)+' <img src="skin/resources/icon_piratecrew_small.png" title="'+LD.pirtxt[2]+'" alt="'+LD.pirtxt[2]+'">';
			});
			$('#CPToCrewForm > div.costsPerUnit > ul > li.capturePoints > span.textLabel').text(LD.pirtxt[3]);
			$('#CPToCrewForm > div.costsPerUnit > ul > li.time > span.textLabel').text(LD.pirtxt[4]);
			$('#CPToCrewForm > div.costsPerUnit > ul > li.time > span.value').text(Utils.FormatTimeLengthToStr(7000,4));
			$('#CPToCrewTotalCP').before('<span id="empire_CPToCrewTotalCP"></span>');
			$('#CPToCrewTotalTime').before('<span id="empire_CPToCrewTotalTime" style="float:left"></span><br><span id="empire_CPToCrewTotalDate"></span>');
//			Utils.trackEvents('#CPToCrewForm > div.sliderinput.slider_x286, #CPToCrewForm > div.valueinput, #CPToCrewInput');
			$('#CPToCrewForm > div.sliderinput.slider_x286, #CPToCrewForm > div.valueinput, #CPToCrewInput')
			.on('blur change click dblclick drag focus focusin focusout keydown keypress keyup mousedown mouseenter mouseleave mousemove mouseout mouseover mouseup mousewheel select textInput',function()
			{
				$('#empire_CPToCrewTotalCP').text(Utils.FormatNumToStr(parseInt($('#CPToCrewTotalCP').text().replace(/(\d+)[,.](?=\d{3}(\D|$))/g,"$1")),false,0));
				$('#empire_CPToCrewTotalTime').html(Utils.FormatTimeLengthToStr((parseInt($('#CPToCrewTotalCP').text().replace(/(\d+)[,.](?=\d{3}(\D|$))/g,"$1"))*0.7+156)*1000,4));
				$('#empire_CPToCrewTotalDate').text('').text(Utils.FormatFullTimeToDateString(parseInt($('#CPToCrewTotalCP').text().replace(/(\d+)[,.](?=\d{3}(\D|$))/g,"$1"))*1000+$.now(),false));
			});
			$('#CPToCrewTotalCP').hide();
			$('#CPToCrewTotalTime').hide();
			var ht = moment(database.getGlobalData.getPirates.resetin).startOf('day').add({h:18,m:0}).subtract(diff,'seconds');
//			console.log(Utils.FormatFullTimeToDateString(ht))
//			var ht = (params.serverTime+params.highscoreTimeLeft)*1000;
			var et = params.ongoingMissionTimeRemaining*1000+$.now();
			if($('#piratesEndOfTime_'+currt).length==1) { clearInterval(piratesTimer); }
			var piratesTimer = $('#piratesEndOfTime_'+currt).length==1 ? setInterval(function()
			{
				$('#piratesEndOfTime_'+currt).text(Utils.FormatTimeLengthToStr(ht-$.now(),4));
				if($.now()>ht || $.now()>et || $.now()>ct || !$('#piratesEndOfTime_'+currt).length) {clearInterval(piratesTimer);}
			},1000):-1;
			$('#piratesEndOfTime_'+currt).text(Utils.FormatTimeLengthToStr(ht-$.now(),4));
			if($('#missionEndOfTime_'+currt).length==1) { clearInterval(missionTimer); }
			$('#missionProgressBar').css({'height':'16px'}).after('<div style="display:table;margin:0px auto 0px auto;font-weight:bold;text-shadow: -1px -1px 0 #FFFFFF, 1px -1px 0 #FFFFFF, -1px 1px 0 #FFFFFF, 1px 1px 0 #FFFFFF;text-align:center;position:relative;top:-15px;margin-bottom:-18px">'+(Utils.FormatNumToStr(((duration[pt.mission.level]-((et-$.now())/1000))/duration[pt.mission.level])*100,false,2)+' %')+'</div>');
			$('#missionProgressBar').parent('.progressbar').css({'height':'16px','position':'relative','bottom':'7px','margin':'0px'});
			var missionTimer = $('#missionEndOfTime_'+currt).length==1 ? setInterval(function ()
			{
				var prc = ((duration[pt.mission.level]-((et-$.now())/1000))/duration[pt.mission.level])*100;
				$('#nextcapturepoints').html(cp[pt.mission.level]!==undefined?' + '+Utils.FormatNumToStr(cp[pt.mission.level],false,0)+' = <b>'+Utils.FormatNumToStr(curcpts+cp[pt.mission.level],false,0)+'</b>':'');
				$('#missionEndOfTime_'+currt).html((et>$.now()?Utils.FormatFullTimeToDateString(et)+'<br>('+Utils.FormatTimeLengthToStr(et-$.now(),4)+')':'&nbsp;<br>&nbsp;'));
				$('#missionProgressBar').parent('.progressbar').attr('title',Utils.FormatNumToStr(100-(prc>100?100:prc),false,2)+' %');
				$('#missionProgressBar').attr('title',Utils.FormatNumToStr(prc>100?100:prc,false,2)+' %').parent('.progressbar').css({'height':'16px'});
				$('#missionProgressBar').next().text(Utils.FormatNumToStr(prc>100?100:prc,false,2)+' %');
				if($.now()>et || !$('#missionEndOfTime_'+currt).length) {clearInterval(missionTimer);}
			},1000):-1;
			$('#nextcapturepoints').html(cp[pt.mission.level]!==undefined?' + '+Utils.FormatNumToStr(cp[pt.mission.level],false,0)+' = <b>'+Utils.FormatNumToStr(curcpts+cp[pt.mission.level],false,0)+'</b>':'');
			$('#missionEndOfTime_'+currt).html((et>$.now()?Utils.FormatFullTimeToDateString(et)+'<br>('+Utils.FormatTimeLengthToStr(et-$.now(),4)+')':'&nbsp;<br>&nbsp;'));
			$('#missionEndOfTime_'+currt).css({'position':'relative','width':'122px','right':'3px','text-align':'center','margin':'0px','height':'28px'}).next('a').css({'float':'unset','margin':'0px','vertical-align':'unset'});
			$('#missionEndOfTime_'+currt).prevAll('progressbar').css({'margin-top':'-6px','margin-bottom':'7px'});
			var conversionTimer = $('#conversionEndOfTime_'+currt).length==1 ? setInterval(function()
			{
				$('#nextcrew').text(pt.conversion.points!==undefined && pt.conversion.endtime>moment()?' + '+Utils.FormatNumToStr(pt.conversion.points/10,false,0):'').prev('span').prev('span').text((pt.conversion.points!==undefined && pt.conversion.endtime>moment()?Utils.FormatNumToStr(curcrew,false,0):Utils.FormatNumToStr(curcrew+pt.conversion.points/10,false,0))+' +');
				$('#totalcrew').text(Utils.FormatNumToStr(curcrew+params.bonusCrewPoints+(pt.conversion.points!==undefined && pt.conversion.endtime>moment()?pt.conversion.points/10:0),false,0));
				$('#nextcrew').parent().find('.tooltip-div').html(Utils.format('<table style="color:#000;font-weight:normal;font-size:12px;line-height:18px"><tbody><tr><td style="text-align:left">{0}</td><td><b>:</b></td><td style="text-align:right">{1}</td></tr><tr><td style="text-align:left">{2}</td><td><b>:</b></td><td style="text-align:right">{3}</td></tr><tr style="border-top: 1px solid #CCA569;"><td style="text-align:left">&Sigma;</td><td><b>:</b></td><td style="text-align:right"><b>{4}</b></td></tr>'+(params.bonusCrewPoints>0?'<tr><td style="text-align:left">{5}</td><td><b>:</b></td><td style="text-align:right">{6}</td></tr>':'')+'<tr style="border-top: 1px solid #CCA569;"><td style="text-align:left">&Sigma;</td><td><b>:</b></td><td style="text-align:right"><b>{7}</b></td></tr></tbody></table>',[LD.pirtxt[5],Utils.FormatNumToStr(params.basicCrewPoints),LD.pirtxt[2],Utils.FormatNumToStr(parseInt(params.crewPoints)+(pt.conversion.points!==undefined && pt.conversion.endtime>moment()?0:pt.conversion.points/10)),Utils.FormatNumToStr(params.basicCrewPoints+parseInt(params.crewPoints)+(pt.conversion.points!==undefined && pt.conversion.endtime>moment()?0:pt.conversion.points/10)),LD.pirtxt[6],	Utils.FormatNumToStr(params.bonusCrewPoints),
				Utils.FormatNumToStr(params.basicCrewPoints+parseInt(params.crewPoints)+(pt.conversion.points!==undefined && pt.conversion.endtime>moment()?0:pt.conversion.points/10)+params.bonusCrewPoints)]));
				$('#conversionEndOfTime_'+currt).text('('+Utils.FormatTimeLengthToStr(ct-$.now(),4)+')');
				if($.now()>ct) {clearInterval(conversionTimer);}
			},1000):-1;
			$('#nextcrew').text(pt.conversion.points!==undefined?' + '+Utils.FormatNumToStr(pt.conversion.points/10,false,0):'');
			$('#totalcrew').text(Utils.FormatNumToStr(curcrew+params.bonusCrewPoints+(pt.conversion.points!==undefined?pt.conversion.points/10:0),false,0));
			$('#conversionEndOfTime_'+currt).text('('+Utils.FormatTimeLengthToStr(ct-$.now(),4)+')');
			if($('#pirateCaptureBox > div.content > table > tbody > tr:nth-child(1) > td.action > a').length>0)
			{
				if($('#pirateCaptureBox > div.content > table > tbody > tr:nth-child(1) > td.action > a').attr('class').split(' ')[1]=='capture' || $('#pirateCaptureBox > div.content > form > img.captchaImage').length==0)
				{
					if(pt.auto[0]===true && $('#pirateCaptureBox > div.content > table > tbody > tr:nth-child(1) > td.action > a')[0]!==undefined)
					{
/*						$('#pirateCaptureBox > div.content > table > tbody > tr:nth-child(1) > td.action > a:first').on('click',function(event)
						{
							event.preventDefault();
							event.stopPropagation();
							if($(this).attr('href')!='#')
							{
								$.ajax(
								{
									url: $(this).attr('href'),
									success: function(response)
									{
										console.log('sessionStorage:');
										console.log(unsafeWindow.sessionStorage);
										console.log('localStorage:');
										console.log(unsafeWindow.localStorage);
										console.log('Cookie:');
										console.log(document.cookie);
										console.log('Response:');
										console.log(response);
									}
								});
								return false;
							}
						});*/
						setTimeout(function() { if($('#pirateCaptureBox > div.content > table > tbody > tr:nth-child(1) > td.action > a')[0]!==undefined) { $('#pirateCaptureBox > div.content > table > tbody > tr:nth-child(1) > td.action > a')[0].click(); } },rand);
					}
				}
			}
			if($('#pirateCaptureBox > div.content > form > img.captchaImage').length==1)
			{
				$(document).ready(function()
				{
					var options = {beforeSubmit:showRequest,success:showResponse};
					document.querySelector('#pirateCaptureBox > div.content > form').addEventListener('submit',function(e)
					{
						e.preventDefault();
						const formData = new FormData(this);
						const entires = formData.entries();
						var t = '';
						for (var input of entires)
						{
							t += input[0] + ': ' + input[1] + '\r\n';
						}
//						console.log(t);
						$('#pirateCaptureBox > div.content > form').ajaxSubmit(options);
						return false;
					});
				});
				function showRequest(formData,jqForm,options)
				{
					var queryString = $.param(formData); 
//					console.log('About to submit: \n\n' + queryString); 
					return true; 
				}
				function showResponse(responseText, statusText, xhr, $form)
				{
//					console.log('sessionStorage:');
//					console.log(unsafeWindow.sessionStorage);
//					console.log('localStorage:');
//					console.log(unsafeWindow.localStorage);
//					console.log('status: ');
//					console.log(statusText);
//					console.log('responseText:');
//					console.log(responseText);
//					console.log('XHR:');
//					console.log(xhr);
				}
			}
			render.toast(Utils.format('{0}: {1} {2} {3} {4}',[LD.updated_,LD.pirateFortress,LD.tothe,LD[city.isCapital?'capital':'colony'],LD.leftquot+city._name+LD.rightquot]));
		},
		parseResTradeGood: function(view,data)
		{
			var LD = Constant.LanguageData[database.settings.languageChange.value];
//			console.log(view,data);
			$('#donateForm > div.centerButton.clearfix > input').val(LD.donateforexpansion);
			var ids = ['resource','tradegood'];
			if(ids.indexOf(view)!=-1)
			{
				var start = parseInt(unsafeWindow.ikariam.templateView.script.params.upgradeStart);
				var end = parseInt(unsafeWindow.ikariam.templateView.script.params.upgradeEnd);
			}
			var up = (isNaN(start) && isNaN(end));
			var city = ikariam.getCurrentCity;
			var maxWoodWorkers = Constant.IslandBuildings.forest.workers[city.getForest.level];
			var maxLuxuryWorkers = Constant.IslandBuildings.mine.workers[city.getMine.level];
			$('#js_mainBoxHeaderTitle').text(LD.forminetitle[unsafeWindow.ikariam.templateView.id=='resource'?0:city.getTradeGoodID]);
			$('#'+view).find('div.buildingDescription > h1').text(LD.forminetitle[unsafeWindow.ikariam.templateView.id=='resource'?0:city.getTradeGoodID]);
			$('#'+view).find('div.buildingDescription > p').text(LD.forminetxt[0]);
			$('#setWorkersBox > h3').text(LD.forminetxt[1]);
			$('#valueCitizens').hide().after('<span class="scroll_view" id="empire_valueCitizens">'+Utils.FormatNumToStr(parseInt($('#valueCitizens').text().replace(/\D+/g,'')),false,0)+'</span>');
			$('#valueWorkers').hide().after('<span class="scroll_view" id="empire_valueWorkers">'+Utils.FormatNumToStr(parseInt($('#valueWorkers').text().replace(/\D+/g,'')),false,0)+'</span>');
			$('#valueResource').hide().after('<span class="smallFont" id="empire_valueResource">'+Utils.FormatNumToStr(parseInt($('#valueResource').text().replace(/\D+/g,'')),false,0)+'</span>').next('span').next('span').text(LD.forminetxt[3]);
			$('#valueWorkCosts').hide().after('<span class="smallFont" id="empire_valueWorkCosts">'+Utils.FormatNumToStr(parseInt($('#valueWorkCosts').text()),true,0)+'</span>').next('span').next('img').attr({'alt':LD.plundergold,'title':LD.plundergold}).next('span').text(LD.forminetxt[3]);
			$('#sliderbg_resourceMine').attr('title',function(){return Utils.FormatNumToStr(parseInt($(this).attr('title').replace(/\D+/g,'')),false,0)});
			$('#js_ResourceSlider > a.setMin').attr('title',LD.forminetxt[6]).find('span').text(LD.forminetxt[7]);
			$('#js_ResourceSlider > a.setMax').attr('title',LD.forminetxt[8]).find('span').text(LD.forminetxt[9]);
			$('#inputWorkersSubmit').val(LD.forminetxt[10]);
			$('#gainPoints').prev('span').text(LD.forminetxt[2]+':');
			var b = ['FORESTER','WINERY','STONEMASON','GLASSBLOWER','ALCHEMISTS_TOWER']
//			console.log(data.videoOfferCountdown.countdown.enddate);
			var tip = '<table class="breakdown_table" style="white-space:nowrap"><tbody><tr><td class="description">{0}:</td><td class="value" id="empire_tooltip_basic_production">{1}</td></tr><tr><td class="description">{2}:</td><td class="value" id="empire_tooltip_overload_production">{3}</td></tr>'+(database.getGlobalData.getResearchTopicLevel(Constant.Research.Science.EXPERIMENTS)==1?'<tr><td><b>&#11180;</b> {4}:</td><td class="value">{5}</td></tr>':'')+'<tr><td>{6}:</td><td id="empire_tooltip_premium_production_bonus" class="value">{7}</td></tr><tr><td>{8}:</td><td id="empire_tooltip_adVideo_production_bonus" class="value">{9}</td></tr><tr><td>{10}:</td><td id="empire_tooltip_helios_tower_bonus" class="value">{11}</td></tr>'+(city.getBuildingFromName(Constant.Buildings[b[view=='resource'?0:city.getTradeGoodID]])!=null?'<tr><td>{12}:</td><td class="value">{13}</td></tr>':'')+'<tr><td>{14}:</td><td class="value">{15}</td></tr><tr><td>&nbsp;</td><td></td></tr><tr><td>{16}:</td><td id="empire_tooltip_total_production" class="value">{17}</td></tr></tbody></table>';
			var prc = parseInt($('#js_resource_tooltip_premium_production_bonus').text().replace(/\D+/g,''))+(data.videoOfferCountdown!=undefined?20:0)+parseInt($('#js_resource_tooltip_helios_tower_bonus').text().replace(/\D+/g,''))+(city.getBuildingFromName(Constant.Buildings[b[view=='resource'?0:city.getTradeGoodID]])!=null?city.getBuildingFromName(Constant.Buildings[b[view=='resource'?0:city.getTradeGoodID]]).getLevel*2:0)-city.getCorruption;
			$('#gainPoints + div.gainPerHour + div.tooltip > table.breakdown_table:first').hide().after(Utils.format(tip,[LD.forminetxt[11],Utils.FormatNumToStr(parseInt($('#js_resource_tooltip_basic_production').text().replace(/(\d+)[,.](?=\d{3}(\D|$))/g,'$1')),false,2),LD.forminetxt[12],Utils.FormatNumToStr(parseInt($('#js_resource_tooltip_overload_production').text().replace(/(\d+)[,.](?=\d{3}(\D|$))/g,'$1'))/4,false,2),LD.forminetxt[13],Utils.FormatNumToStr((database.getGlobalData.getGovernmentType=='technokratie'?20:0),true,2)+' %',LD.forminetxt[14],Utils.FormatNumToStr(parseInt($('#js_resource_tooltip_premium_production_bonus').text().replace(/\D+/g,'')),true,2)+' %',LD.forminetxt[15],Utils.FormatNumToStr((data.videoOfferCountdown!=undefined?20:0),true,2)+' %',LD.forminetxt[16],Utils.FormatNumToStr(parseInt($('#js_resource_tooltip_helios_tower_bonus').text().replace(/\D+/g,'')),true,2)+' %',city.getBuildingFromName(Constant.Buildings[b[view=='resource'?0:city.getTradeGoodID]])!=null?LD[city.getBuildingFromName(Constant.Buildings[b[view=='resource'?0:city.getTradeGoodID]]).getName]:'',city.getBuildingFromName(Constant.Buildings[b[view=='resource'?0:city.getTradeGoodID]])!=null?Utils.FormatNumToStr(city.getBuildingFromName(Constant.Buildings[b[view=='resource'?0:city.getTradeGoodID]]).getLevel*2,true,2)+' %':'',LD.forminetxt[17],Utils.FormatNumToStr(-city.getCorruption*100,false,2)+' %',LD.forminetxt[18],Utils.FormatNumToStr(parseInt($('#js_resource_tooltip_total_production').text().replace(/(\d+)[,.](?=\d{3}(\D|$))/g,'$1')),false,0)]));
//			console.log(data);
			$('#workersWrapper').on('blur change click dblclick drag focusin focusout keydown keypress keyup mousedown mouseenter mouseleave mousemove mouseout mouseover mouseup select textInput',function()
			{
				var unskprod = (parseInt($('#valueWorkers').text().replace(/\D+/g,''))<=data.js_ResourceSlider.slider.max_value?0:((parseInt($('#valueWorkers').text().replace(/\D+/g,''))-data.js_ResourceSlider.slider.max_value)/4))*(1+(database.getGlobalData.getGovernmentType=='technokratie'?0.2:0));
				$('#empire_valueCitizens').text(Utils.FormatNumToStr(parseInt($('#valueCitizens').text().replace(/\D+/g,'')),false,0));
				$('#empire_valueWorkers').text(Utils.FormatNumToStr(parseInt($('#valueWorkers').text().replace(/\D+/g,'')),false,0));
				$('#empire_valueResource').text(Utils.FormatNumToStr(parseInt($('#valueResource').text().replace(/\D+/g,'')),false,0));
				$('#empire_valueWorkCosts').text(Utils.FormatNumToStr(parseInt($('#valueWorkCosts').text()),true,0));
				$('#sliderbg_resourceMine').attr('title',function(){return Utils.FormatNumToStr(parseInt($(this).attr('title').replace(/\D+/g,'')),false,0)});
				$('#empire_tooltip_basic_production').text(function(){return Utils.FormatNumToStr(parseInt($('#valueWorkers').text().replace(/\D+/g,''))>data.js_ResourceSlider.slider.max_value?data.js_ResourceSlider.slider.max_value:parseInt($('#valueWorkers').text().replace(/\D+/g,'')),false,2)});
				$('#empire_tooltip_overload_production').text(function(){return Utils.FormatNumToStr(parseInt($('#valueWorkers').text().replace(/\D+/g,''))<=data.js_ResourceSlider.slider.max_value?0:((parseInt($('#valueWorkers').text().replace(/\D+/g,''))-data.js_ResourceSlider.slider.max_value)/4),false,2)});
				$('#empire_tooltip_total_production').text(function(){return Utils.FormatNumToStr(((parseInt($('#valueWorkers').text().replace(/\D+/g,''))>data.js_ResourceSlider.slider.max_value?data.js_ResourceSlider.slider.max_value:parseInt($('#valueWorkers').text().replace(/\D+/g,'')))+unskprod)*(100+prc)/100,false,2)});
			});
			$('#valueWorkCosts').prevAll('span').text(LD.forminetxt[4]+':');
			$('#overchargeMsg').text(LD.forminetxt[5]);
			$('#js_citizensPremiumOffer').find('div.options > div.optionButton').each(function(k,dv)
			{
				$(dv).attr('tooltip',Utils.format(LD.forminetxt[19],[2.5*(k*(k+1)+2)])).on('click',function()
				{
					$('#js_citizensPremiumOffer').find('div.offer > div.tooltip > span').text($('#js_citizensPremiumOffer').find('div.options > div.optionButton.active').attr('tooltip'));
					$('#js_citizensPremiumOffer').find('div.amountAndActiveBox > div.amountBox').text($('#js_citizensPremiumOffer').find('div.options > div.optionButton.active').attr('tooltip'));
				});
			});
			$('#js_citizensPremiumOffer').find('div.offer > div.tooltip > span').text($('#js_citizensPremiumOffer').find('div.options > div.optionButton.active').attr('tooltip'));
			$('#js_citizensPremiumOffer').find('div.amountAndActiveBox > div.amountBox').text($('#js_citizensPremiumOffer').find('div.options > div.optionButton.active').attr('tooltip'));
			$('#js_resourcePremiumOffer').find('div.offer > div.tooltip > span').text(Utils.format(LD.forminetxt[20],[LD.forminetxt[21][view=='resource'?0:city.getTradeGoodID]]));
			$('#js_resourcePremiumOffer').find('div.options > div.optionButton').each(function(k,dv)
			{
				$(dv).attr('tooltip',Utils.format(LD.forminetxt[22],[5*(k*(k+3)+2)])).on('click',function()
				{
					$('#js_resourcePremiumOffer').find('div.amountAndActiveBox > div.amountBox').text($('#js_resourcePremiumOffer').find('div.options > div.optionButton.active').attr('tooltip'));
				});
			});
			$('#js_resourcePremiumOffer').find('div.amountAndActiveBox > div.amountBox').text($('#js_resourcePremiumOffer').find('div.options > div.optionButton.active').attr('tooltip'));
			$('#setWorkersBox').find('div.adVideoPremiumOffer > p').text(LD.forminetxt[23]);
			$('#setWorkersBox').find('div.adVideoPremiumOffer > table > tbody > tr > td:eq(0)').text(LD.forminetxt[24]);
			$('#setWorkersBox').find('div.adVideoPremiumOffer > table > tbody > tr > td:eq(1)').contents().last().each(function(){$(this).replaceWith(' '+LD.forminetxt[25]);});
			$('#videoOfferCountdown').hide().after('<span id="empire_videoOfferCountdown"></span>');
			var theaterinterv = setInterval(function()
			{
				if(data.videoOfferCountdown==undefined || data.videoOfferCountdown.countdown.enddate*1000<moment())
				{
					$('#empire_videoOfferCountdown').text('('+LD.forminetxt[26]+')');
					clearInterval(theaterinterv);
				}
				else
				{
					$('#empire_videoOfferCountdown > span').text(Utils.FormatTimeLengthToStr(data.videoOfferCountdown.countdown.enddate*1000-moment(),3));
				}
			},1000);
			if(data.videoOfferCountdown==undefined || data.videoOfferCountdown.countdown.enddate*1000<moment())
			{
				$('#empire_videoOfferCountdown').text('('+LD.forminetxt[26]+')');
			}
			else
			{
				$('#empire_videoOfferCountdown').html(Utils.FormatFullTimeToDateString(data.videoOfferCountdown.countdown.enddate*1000)+'<br>(<span>'+Utils.FormatTimeLengthToStr(data.videoOfferCountdown.countdown.enddate*1000-moment(),3)+'</span>)');
			}
			$('#setWorkersBox').find('div.adVideoPremiumOffer > table > tbody > tr > td:eq(3) > a > div.tooltip').text(LD.forminetxt[27]);
			$('#resourceUsers > h3').text(LD.forminetxt[28]);
			$('#donationTableContainer > table > thead > tr > th').each(function(k,th)
			{
				if(k==0 || k==4)
				{
					$(th).find('a').text(LD.forminetxt[k+29]);
				}
				else
				{
					$(th).text(LD.forminetxt[k+29]);
				}
			});
			var d = Number($('#donationTableContainer > table > tbody > tr.own.avatar > td.ownerDonation').text().replace(/\D+/g,''));
			var l = Number($('#sidebarWidget > li:nth-child(1) > div > div > div > p.headline_huge.bold').text().replace(/\D+/g,''));
			var a = up ? parseInt($('#donateForm').prev('ul').children('li').text().replace(/\D+/g,'')) : 0;
			var r = Constant.IslandBuildings[view=='resource'?'forest':'mine'].wood[l];
			var wrk = 0;
			$('#setWorkers').on('submit',function()
			{
				wrk = parseInt($('#valueWorkers').text().replace(/(\d+)[,.](?=\d{3}(\D|$))/g, "$1"));
				database.cities[city.getId]['_'+(view=='resource'?'forest':'mine')] = {level:l,workers:wrk,endUpgradeTime:end || 0,donatedResources:d,curwood:a,maxwood:r};
			});
			wrk = parseInt($('#valueWorkers').text().replace(/(\d+)[,.](?=\d{3}(\D|$))/g, "$1"));
			database.cities[city.getId]['_'+(view=='resource'?'forest':'mine')] = {level:l,workers:wrk,endUpgradeTime:end || 0,donatedResources:d,curwood:a,maxwood:r};
			$('#sidebarWidget > li:nth-child(1) > div > div > div > p.headline_huge.bold').prev().text(LD.level);
			$('#sidebarWidget > li:first > a')[0].childNodes[0].textContent = LD.forminetitle[unsafeWindow.ikariam.templateView.id == 'resource' ? 0 : city.getTradeGoodID];
			$('#sidebarWidget > li:nth-child(1) > div > div > h4:nth-child(3)').text(LD.maxwood+':');
			$('#sidebarWidget > li:nth-child(1) > div > div > h4:nth-child(5)').text(LD.curwood+':');
			$('#donateForm > div.donate.center > div').text(LD.donations+':');
			$('#donateForm > div.centerButton.clearfix > input').text(LD.donations+':');
			$('#sidebarWidget > li:eq(1) > a').contents().first().each(function(){$(this).replaceWith(LD.forminetxt[38]);});
			$('#ambrosiaDonateForm > div.donate > div.donate_label').contents().first().each(function(){$(this).replaceWith(LD.forminetxt[38]+':');});
			$('#ambrosiaDonateForm > div.donate > div.donate_label > div').contents().first().each(function(){$(this).replaceWith(' (');});
			$('#ambrosiaDonateForm > div.donate > div.donate_label > div').contents().last().each(function(){$(this).replaceWith(' '+Utils.FormatNumToStr(parseInt($(this).text().replace(/\D+/g,'')))+')');});
			$('#js_resourceDonateAmbrosiaTooltip,#js_resourceDonateAmbrosiaTooltipTouch').css('text-align','justify').text(LD.forminetxt[39]);
			$('#donationResult').hide().after('<div class="donation_result floatleft scroll_view" id="empire_donationResult">0</div>')
			$('#donateWood2,#donateWood2 + span').on('click textInput keyup',function()
			{
				var v = isNaN(parseInt($('#donateWood2').val())) ? 0 : parseInt($('#donateWood2').val());
				$('#empire_donationResult').text(Utils.FormatNumToStr(v*parseInt($('#ambrosiaDonateForm > div.donate > div.donate_label > div')[0].lastChild.nodeValue.replace(/\D+/g,'')),false,0));
			}).next('span').attr('title',LD.forminetxt[40]).text(LD.forminetxt[41]);
			$('#js_ambrosiaDonateButton').text(LD.forminetxt[38]);
			if(database.settings.ctfinder.value)
			{
				$('#donationTableContainer > table > tbody > tr.avatar').each(function(k,tr)
				{
					var uid = $(tr).find('td:nth-child(1) > a').attr('href').split('&')[1].replace(/\D+/g,'');
					if($(tr).find('td:nth-child(1) > a').html()!='&nbsp;')
					{
						if(Object.keys(database.getGlobalData.getMuseumTreaties).indexOf(uid)!=-1)
						{
							$(tr).find('td:nth-child(1) > a').after('<img src="skin/museum/icon32_culturalgood.png" style="width:15px;height:auto;float:right" title="'+LD.ctenabled+'">');
						}
						else if(Object.keys(database.getGlobalData.getPotMuseumTreaties).indexOf(uid)!=-1)
						{
							$(tr).find('td:nth-child(1) > a').after('<img src="skin/museum/icon32_culturalgood.png" style="width:15px;height:auto;float:right;opacity:0.5" title="'+LD.ctrequested[database.getGlobalData.getPotMuseumTreaties[uid].type*0.5-39]+'">');
						}
					}
				});
			}
			if(up)
			{
				var gov = Constant.GovernmentData[database.getGlobalData.getGovernmentType].buildingTime;
				var t = (Math.round((view=='resource' ? 7200 : 14400)*Math.pow(1.1,l+1)-(view=='resource' ? 7200 : 14400))*1000)*(1+gov);
				$('#sidebarWidget > li:nth-child(1) > div > div > ul:nth-child(4) > li').html('<span class="empiretooltip">'+Utils.FormatNumToStr(r,false,0)+'<div class="tooltip-div">'+Utils.FormatQuantityToLoad(r)+'</div></span> <span style="color:green;float:right">'+Utils.FormatTimeLengthToStr(t,3)+'</span>');
				$('#donateForm').prev('ul').children('li').html('<span class="empiretooltip">'+Utils.FormatNumToStr(a,false,0)+'<div class="tooltip-div">'+Utils.FormatQuantityToLoad(a)+'</div></span> <span class="empiretooltip" style="color:red;float:right">('+Utils.FormatNumToStr(a-r,true,0)+')<div class="tooltip-div" style="color:#542C0F">'+Utils.FormatQuantityToLoad(r-a)+'</div></span>');
				$('#donationTableContainer > table > tbody > tr').each(function(k,tr)
				{
					$(tr).find('td.cityLevel').text(function(){return Utils.format(LD.forminetxt[35],[parseInt($(this).text().replace(/\D+/g,''))]);});
					$(tr).find('td.cityWorkers').text(function(){return $(this).text().replace(/\D+/g,'')==''?'':Utils.format(LD.forminetxt[parseInt($(this).text().replace(/\D+/g,''))==1?37:36],[Utils.FormatNumToStr(parseInt($(this).text().replace(/\D+/g,'')),false,0)]);});
					
					$(tr).find('td.ownerDonation').html(function()
					{
//						console.log($(this)[0].firstChild);
						return $(this)[0].firstChild==null||$(this)[0].firstChild.nodeValue.replace(/\D+/g,'')==''?'':Utils.FormatNumToStr(parseInt($(this)[0].firstChild.nodeValue.replace(/\D+/g,'')),false,0)+' <img src="skin/resources/icon_wood.png" width="25" height="20" alt="'+LD.wood_+'" title="'+LD.wood_+'">';
					});
					$(tr).find('td.actions > a').attr('title',LD.CompMsg).find('img').attr({'alt':LD.CompMsg,'title':LD.CompMsg});
				});
				if(database.settings.donationButtons.value)
				{
					var w = [500,1000,5000,10000,50000,100000,500000,1000000,5000000]; // Amount buttons
					var f = [500,1000,2000,5000,15000,45000,100000,200000,400000,700000]; // Favour costs
					var fcost = 0;
					$.each(database.cities,function(k,c) { if(c.isCapital) { fcost = f[Math.ceil(c.getBuildingFromName(Constant.Buildings.TOWN_HALL).getLevel/5)-1]; return false; } });
					var s = ['','K','M','G','T','P','E','Z','Y'];
					if($('#donateForm > div.donate.center > span').length>0)
					{
						var max = parseInt($('#donateForm > div.donate.center > span').attr('onclick').replace(/\D+/g,''));
						$('#donateForm > div.donate.center > span.donate_max').remove();
						var spans = '';
						if(w.indexOf(fcost)==-1) { w.push(fcost); w.sort(function(a,b){return a-b;}); }
						for(var i=0;i<w.length;i++)
						{
							spans += w[i]<=max ? Utils.format('<span class="button" title="{0}'+(w[i]==fcost?' ('+LD.favours[1]+')':'')+'" onclick="var v = parseInt($(\'#donateWood\').val()) || 0;$(\'#donateWood\').val((v+'+w[i]+')>'+max+' ? '+max+' : v+'+w[i]+')"'+(w[i]==fcost?' style="background: rgba(236,207,142,0.7) url(\'skin/resources/favour.png\') no-repeat center / 15px 12px"':'')+'>{3}</span>',[Utils.format(LD.donwoodlogtitle,[Utils.FormatNumToStr(w[i])]),w[i],max,Utils.FormatNumToStr(w[i]/Math.pow(1000,Math.floor(Math.log(w[i])/Math.log(1000))),true)+s[Math.floor(Math.log(w[i])/Math.log(1000))]]) : '';
						}
						$('input#donateWood').after(Utils.format('<span class="button" title="{0}" onclick="$(\'#donateWood\').val({1});">{2}</span><span class="button" title="{3}" onclick="$(\'#donateWood\').val(0);">0</span>{4}',[LD.donwoodlogalltitle,max,LD.donwoodlogall,LD.zeroing,spans]));
					}
				}
				database.cities[city.getId]['_'+(view=='resource'?'forest':'mine')] = {level:l,workers:wrk,endUpgradeTime:end,donatedResources:d,curwood:a,maxwood:r};
			}
			else
			{
				var gov = Constant.GovernmentData[database.getGlobalData.getGovernmentType].buildingTime;
				var t = (Math.round((view=='resource' ? 7200 : 14400)*Math.pow(1.1,l+1)-(view=='resource' ? 7200 : 14400))*1000)*(1+gov);
				var fm = city['get'+(view=='resource'?'Forest':'Mine')];
				$('#upgradeCountDown').after('<div class="center" id="empireupgradeCountDown"></div>');
				$('#upgradeCountDown').hide();
				var ct = $.now();
				$('#upgradeProgress').parent('div').css({'height':'16px'}).after('<div id="upgradePercentage_'+ct+'" style="display:table;margin:0px auto 0px auto;font-weight:bold;text-shadow: -1px -1px 0 #FFFFFF, 1px -1px 0 #FFFFFF, -1px 1px 0 #FFFFFF, 1px 1px 0 #FFFFFF;text-align:center;position:relative;top:-26px;margin-bottom:-18px">'+(Utils.FormatNumToStr((t-(end*1000-ct))/(t)*100,false,2)+' %')+'</div>');
				console.log(end*1000,$.now(),(end*1000-$.now()),(t-(end*1000-$.now())),);
				console.log(t);
				database.cities[city.getId]['_'+(view=='resource'?'forest':'mine')].maxwood = r;
				var interv = setInterval(function()
				{
					if($('#upgradeProgress').length)
					{
						$('#upgradeProgress').parent().prev().prev().html(LD.inprogress+'!');
						$('#upgradeProgress').parent().prev().html(LD.nextlevel+': '+(fm.level+1));
						$('#upgradePercentage_'+ct).html(Utils.FormatNumToStr((t-(end*1000-$.now()))/(t)*100,false,2)+' %');
						$('#empireupgradeCountDown').html(Utils.FormatFullTimeToDateString(end*1000,true)+'<br>('+Utils.FormatTimeLengthToStr(end*1000-$.now(),4,' ')+')');
					}
					if($.now()-end*1000==0)
					{
						var l = fm.level+1;
						wrk = parseInt($('#valueWorkers').text().replace(/(\d+)[,.](?=\d{3}(\D|$))/g, "$1"));
						database.cities[city.getId]['_'+(view=='resource'?'forest':'mine')] = {level:l,workers:wrk,endUpgradeTime:0,donatedResources:d,curwood:0,maxwood:r};
						clearInterval(interv);
					}
				},1000);
			}
			if(database.settings.ambrosiaPay.value) { $('li.accordionItem:has(#ambrosiaDonateForm)').hide(); }
			render.toast(Utils.format('{0}: {1} {2} {3} {4}',[LD.updated_,LD[view],LD.tothe,LD[city.isCapital?'capital':'colony'],LD.leftquot+city._name+LD.rightquot]));
		},
		parseIKMessage: function()
		{
			var LD = Constant.LanguageData[database.settings.languageChange.value];
			if(database.settings.ctfinder.value)
			{
				var opt = $('select#js_treatiesConfirm > option[value="77"]').length;
//				console.log(opt);
				if(!opt)
				{
					if($('form#sendMessageBoxForm > div.mailRecipient > span:nth-child(2) > a').length)
					{
						var rid = $('form#sendMessageBoxForm > div.mailRecipient > span:nth-child(2) > a').attr('href').replace('?view=avatarProfile&avatarId=','');
						if(Object.keys(database.getGlobalData.getMuseumTreaties).indexOf(rid)==-1 && Object.keys(database.getGlobalData.getPotMuseumTreaties).indexOf(rid)==-1 && $('select#js_treatiesConfirm > option[value="78"]').length!=1 && $('select#js_treatiesConfirm > option[value="81"]').length!=1)
						{
							$('select#js_treatiesConfirm > option:first').after('<option value="77">'+LD.sendCTsopt+'</option>');
						}
					}
				}
			}
			render.toast(Utils.format('{0}',[LD.CompMsg]));
		},
		parseInviteFriend: function()
		{
			var LD = Constant.LanguageData[database.settings.languageChange.value];
			$('#js_mainBoxHeaderTitle').text(LD.invfriendtxt[0]);
			$('#friendListEdit').find('div.buildingDescription > h1').text(LD.invfriendtxt[0]);
			$('#friendListEdit').find('div.buildingDescription + div > div.content > p').css('text-align','justify').text(LD.invfriendtxt[1]);
			$('#friendListEdit').find('div.invite > span').text(LD.invfriendtxt[2]+':');
			$('#friendListEdit').find('div.invite').parent().find('p').text(LD.invfriendtxt[3]);
			$('input[type="submit"]').val(LD.invfriendtxt[4]);
			$('li.accordionItem:has(#invitationList) > a')[0].firstChild.textContent = LD.invfriendtxt[5];
		},
		parseFriendList: function()
		{
			var LD = Constant.LanguageData[database.settings.languageChange.value];
			$('td[id^="friedList"][id$="Score"]:not(:empty)').each(function()
			{
				$(this).text(Utils.FormatNumToStr(parseInt($(this).text().replace(/(\d+)[,.](?=\d{3}(\D|$))/g, "$1")),false,0));
			});
			$('a.button_disabled').css({'padding':'2px 0px','height':'14px'});
			$('td[id^="friedList"][id$="Name"] > a > span').remove();
			$('td[id^="friedList"][id$="Name"] > a').after('<span></span>');
			if(database.settings.ctfinder.value)
			{
				$('table#allyMemberList > tbody > tr:not(:first)').each(function(k,tr)
				{
					if($(tr).find('td[id="friedList'+(k+1)+'Name"]').text()!='-')
					{
						var fid = $(tr).find('td[id="friedList'+(k+1)+'Name"] > a').attr('href').split('=')[2];
						if(Object.keys(database.getGlobalData.getMuseumTreaties).indexOf(fid)!=-1)
						{
							$(tr).find('td[id="friedList'+(k+1)+'Name"] > span').html('<img src="skin/museum/icon32_culturalgood.png" style="width:15px;height:auto;float:right" title="'+LD.ctenabled+'">');
						}
						else if(Object.keys(database.getGlobalData.getPotMuseumTreaties).indexOf(fid)!=-1)
						{
							$(tr).find('td[id="friedList'+(k+1)+'Name"] > span').html('<img src="skin/museum/icon32_culturalgood.png" style="width:15px;height:auto;opacity:0.5;float:right" title="'+LD.ctrequested[database.getGlobalData.getPotMuseumTreaties[fid].type*0.5-39]+'">');
						}
					}
				});
				$('a[id^="friedList"][id$="Up"],a[id^="friedList"][id$="Down"]').not('[class$="button_disabled"]').on('click',function()
				{
					setTimeout(function()
					{
						$('td[id^="friedList"][id$="Score"]:not(:empty)').each(function()
						{
							$(this).text(Utils.FormatNumToStr(parseInt($(this).text().replace(/(\d+)[,.](?=\d{3}(\D|$))/g, "$1")),false,0));
						});
						$('a.button_disabled').css({'padding':'2px 0px','height':'14px'});
						$('td[id^="friedList"][id$="Name"] > a > span').remove();
						$('td[id^="friedList"][id$="Name"] > a').after('<span></span>');
						$('table#allyMemberList > tbody > tr:not(:first)').each(function(k,tr)
						{
							if($(tr).find('td[id="friedList'+(k+1)+'Name"]').text()!='-')
							{
								var fid = $(tr).find('td[id="friedList'+(k+1)+'Name"] > a').attr('href').split('=')[2];
								if(Object.keys(database.getGlobalData.getMuseumTreaties).indexOf(fid)!=-1)
								{
									$(tr).find('td[id="friedList'+(k+1)+'Name"] > span').html('<img src="skin/museum/icon32_culturalgood.png" style="width:15px;height:auto;float:right" title="'+LD.ctenabled+'">');
								}
								else if(Object.keys(database.getGlobalData.getPotMuseumTreaties).indexOf(fid)!=-1)
								{
									$(tr).find('td[id="friedList'+(k+1)+'Name"] > span').html('<img src="skin/museum/icon32_culturalgood.png" style="width:15px;height:auto;opacity:0.5;float:right" title="'+LD.ctrequested[database.getGlobalData.getPotMuseumTreaties[fid].type*0.5-39]+'">');
								}
							}
						});
					},500);
				});
			}
			render.toast(Utils.format('{0}: {1}',[LD.updated_,LD.FriendList]));
		},
		parseHighscore: function()
		{
			var LD = Constant.LanguageData[database.settings.languageChange.value];
			if(database.settings.ctfinder.value)
			{
				function showCTPlayers()
				{
					$('#tab_highscore > div:nth-child(2) > table > tbody > tr:not(:first)').each(function(k,tr)
					{
						var fid = $('#tab_highscore > div:nth-child(2) > table > tbody > tr:nth-child('+(k+2)+') > td.name > a').attr('href').replace('?view=avatarProfile&avatarId=','');
						$('#tab_highscore > div:nth-child(2) > table > tbody > tr:nth-child('+(k+2)+') > td.score').text(Utils.FormatNumToStr(parseInt($('#tab_highscore > div:nth-child(2) > table > tbody > tr:nth-child('+(k+2)+') > td.score').text().replace(/(\d+)[,.](?=\d{3}(\D|$))/g, "$1")),false,0));
						$('#tab_highscore > div:nth-child(2) > table > tbody > tr:nth-child('+(k+2)+') > td.name > a').next('span').remove();
						$('#tab_highscore > div:nth-child(2) > table > tbody > tr:nth-child('+(k+2)+') > td.name > a').after('<span></span>');
						if(Object.keys(database.getGlobalData.getMuseumTreaties).indexOf(fid)!=-1)
						{
							$('#tab_highscore > div:nth-child(2) > table > tbody > tr:nth-child('+(k+2)+') > td.name > a').next('span').html('<img src="skin/museum/icon32_culturalgood.png" style="float:right;width:15px;height:auto;" title="'+LD.ctenabled+'">');
						}
						else if(Object.keys(database.getGlobalData.getPotMuseumTreaties).indexOf(fid)!=-1)
						{
							$('#tab_highscore > div:nth-child(2) > table > tbody > tr:nth-child('+(k+2)+') > td.name > a').next('span').html('<img src="skin/museum/icon32_culturalgood.png" style="float:right;width:15px;height:auto;opacity:0.5" title="'+LD.ctrequested[database.getGlobalData.getPotMuseumTreaties[fid].type*0.5-39]+'">');
						}
					});
				}
				if($(window).load()) { showCTPlayers(); }
			}
			else
			{
				$('#tab_highscore > div:nth-child(2) > table > tbody > tr > td.name > a').next('span').remove();
			}
			render.toast(Utils.format('{0}: {1}',[LD.updated_,LD.HighscoreList]));
		},
		parseSafehouse: function(data)
		{
			var LD = Constant.LanguageData[database.settings.languageChange.value];
			var city = ikariam.getCurrentCity;
			$('#js_mainBoxHeaderTitle').text(LD.safehouse);
			$('#safehouse').find('div.buildingDescription > h1').text(LD.safehouse).next('p').css({'text-align':'justify','margin':'0px 15px 10px 0px'}).text(LD.safehousetxt[0]);
			$('#js_tabSafehouse > b').text(LD.safehouse);
			$('#js_tabReports > b').text(LD.safehousetxt[1]);
			$('#js_tabArchive > b').text(LD.safehousetxt[2]);
			if($('#tabSafehouse').length==1)
			{
				$('#buildForm > div > h3').text(LD.safehousetxt[3]);
				$('#buildForm > div > div.content > div.content_left > div.spy_img > h4').text(LD.safehousetxt[3]).next('p').text(LD.safehousetxt[4]);
				$('#buildForm > div > div.content > div.content_left > div.scroll_view').attr('title',function(){return Utils.format(LD.safehousetxt[5],[$(this).text().replace(/\D+/g,'')]);});
				if(city.getBuildingFromName(Constant.Buildings.SAFEHOUSE).getLevel==parseInt($('#buildForm > div > div.content > div.content_left > div.scroll_view').text().replace(/\D+/g,'')))
				{
					$('#buildForm > div > div.content > div.content_right').text(LD.safehousetxt[6]);
				}
				else if(database.getGlobalData.finance.currentGold<150 || city.getResource(Constant.Resources.GLASS).getCurrent<80)
				{
					$('#buildForm > div > div.content > div.content_right').text(LD.safehousetxt[7]);
				}
				else
				{
					$('#buttonBuildSpy').val(LD.safehousetxt[8]);
					$('#textfield_spy').css({'text-align':'center','font-weight':'bold'});
				}
				$('#tabSafehouse > div:nth-child(2) > h3').text(LD.safehousetxt[11]);
				$('#tabSafehouse > div:nth-child(2) > div.content > div > div.spy_stats_content > b').text(Utils.format(LD.safehousetxt[city.getBuildingFromName(Constant.Buildings.SAFEHOUSE).getLevel==1?13:12],[city.getBuildingFromName(Constant.Buildings.SAFEHOUSE).getLevel]));
				var spyonmission = 0;
				$('#tabSafehouse > div:nth-child(2) > div.content > div > div.spy_stats_content > ul > li').each(function(k,li)
				{
					var wt = parseInt($(li).text().replace(/\D+/g,''));
					spyonmission += k==2 ? wt : 0;
					return $(li).html(Utils.format(LD.safehousetxt[(wt==0?16:(wt==1?15:14))+(k*3)],[wt]));
				});
				$('#tabSafehouse > div:nth-child(3) > h3').text(LD.safehousetxt[23]);
				if(spyonmission==0)
				{
					$('#tabSafehouse > div:nth-child(3) > div.content > div').css({'color':'red','text-align':'center','font-weight':'bold'}).text(LD.safehousetxt[24]);
				}
			}
			else if($('#tabReports').length==1 || $('#tabArchive').length==1)
			{
				$('#tabReports,#tabArchive').find('h3.header').text(LD.safehousetxt[1]);
				$('#espionageReports > tbody > tr:nth-child(1) > th:nth-child(3) > a').text(LD.safehousetxt[25]);
				$('#espionageReports > tbody > tr:nth-child(1) > th:nth-child(4) > a').attr('title',LD.safehousetxt[26]).text(LD.safehousetxt[26]);
				$('#espionageReports > tbody > tr:nth-child(1) > th:nth-child(5) > a').text(LD.safehousetxt[27]);
				$('#espionageReports > tbody > tr:nth-child(1) > th:nth-child(7)').text(LD.safehousetxt[28]);
				$('#espionageReports > tbody > tr:nth-child(1) > th:nth-child(8) > img').attr('title',LD.safehousetxt[29]).text(LD.safehousetxt[29]);
				$('#espionageReports > tbody > tr:nth-child(1) > th:nth-child(9) > img').attr('title',LD.safehousetxt[30]).text(LD.safehousetxt[30]);
				$('#espionageReports > tbody > tr:nth-child(1) > th:nth-child(10) > a').css('text-overflow','unset').attr('title',LD.safehousetxt[31]).text(LD.safehousetxt[31]);
				if($('#espionageReports > tbody > tr').length==2) { $('#espionageReports > tbody > tr:nth-child(2) > td').css({'color':'red','text-align':'center','font-weight':'bold'}).text(LD.safehousetxt[32]); }
			}
			var changes = {ondefense:0,inmission:0};
			$('div.spy_stats_content > ul > li').each(function(k,e)
			{
				var match = $(e).text().match(/\d+/);
				if(match)
				{
					if(k==1) { changes.ondefense = parseInt($(e).text().match(/\d+/)[0]); }
					if(k==2) { changes.inmission = parseInt($(e).text().match(/\d+/)[0]); }
				}
			});
			var changed = city.updateSpies(changes);
			var curdur = Math.round(900.12*Math.exp(-0.0513*city.getBuildingFromName(Constant.Buildings.SAFEHOUSE).getLevel))*1000;
			var max = parseInt($('div.sliderinput').find('script').text().match(/maxValue: (\d+)/g)!=null?$('div.sliderinput').find('script').text().match(/maxValue: (\d+)/g)[0].replace(/\D+/,''):0);
			$('#js_spygold').hide().after('<li class="gold" id="empire_spygold">150</li>');
			$('#js_spyglass').hide().after('<li class="glass" id="empire_spyglass">80</li>');
			$('#js_spycompletion').hide().after('<li class="time" id="empire_spycompletion">'+Utils.FormatTimeLengthToStr(curdur)+'</li>');
			if(max>0)
			{
				$('#textfield_spy, #buttonBuildSpy, div.sliderinput').on('blur change click dblclick focus focusin focusout keydown keypress keyup mousedown mouseenter mouseleave mousemove mouseout mouseover mouseup select textInput',function(e)
				{
					var val = parseInt($('#textfield_spy').val())>max?max:parseInt($('#textfield_spy').val());
					$('#empire_spygold').text(Utils.FormatNumToStr(150*(val>0?val:1)));
					$('#empire_spyglass').text(Utils.FormatNumToStr(80*(val>0?val:1)));
					$('#empire_spycompletion').text(Utils.FormatTimeLengthToStr(curdur*(val>0?val:1)));
				});
			}
			$('#js_safehouse_setmin').addClass('empiretooltip').removeAttr('title').append('<div class="tooltip-div" style="display:none;text-align:center">'+LD.safehousetxt[9]+'</div>');
			$('#js_safehouse_setmax').addClass('empiretooltip').removeAttr('title').append('<div class="tooltip-div" style="display:none;text-align:center">'+LD.safehousetxt[10]+'</div>');
			// unsafeWindow.response.responseArray[0][1].time
//			console.log(unsafeWindow);
//			console.log(window);
//			console.log(data);
			render.toast(Utils.format('{0}: {1} {2} {3} {4}',[LD.updated_,LD.safehouse,LD.tothe,LD[city.isCapital?'capital':'colony'],LD.leftquot+city._name+LD.rightquot]));
		},
		parseEmbassy: function(view,data)
		{// 4 views!!!!!
			var LD = Constant.LanguageData[database.settings.languageChange.value];
			var inAlliance = unsafeWindow.hasAlly;
			var city = ikariam.getCurrentCity;
			if(view=='embassy')
			{
				$('#js_mainBoxHeaderTitle').text(LD.embassy);
				$('#embassy').find('div.buildingDescription > h1').text(LD.embassy).next('p').css({'text-align':'justify','margin':'0px 15px 10px 0px'}).text(LD.embassytxt[0]);
				$('#embassy').find('div.buildingDescription + div > p').html(function(){return LD.embassytxt[1]+': <b>'+$(this).text().replace(/\D+/g,'')+'</b>';})
				Utils.waitElem('ul.tabmenu > li.selected',tabs)
				function tabs()
				{
					var active = 0;
					$('#embassy').find('ul.tabmenu > li').each(function(k,t)
					{
						active += $(t)[0].classList.length>1?k:0;
						$(t).find('b').text(LD.embassytxt[k+(inAlliance?2:(k==0?13:4))]);
					});
					$('#embassy').find('script + '+(inAlliance||(!inAlliance&&active==1)?'':'form > ')+'div > h3').text(LD.embassytxt[active+(inAlliance?2:(active==0?13:4))]);
					if(inAlliance && active==0)
					{
						$('#embassy').find('div.content > table > tbody > tr:not(:first)').each(function(i,tr)
						{
							$(tr).find('td:first').attr('title',LD.embassytxt[i+6]).html(LD.embassytxt[i+6]+':');
							if(i==0)
							{
								var d = moment($(tr).find('td:last').text()+'+0100','DD.MM.YYYY HH:mm:ss Z').valueOf()+4.32e7;
								var foundationinterv = setInterval(function()
								{
									$('#foundationage').text('('+Utils.FormatTimeLengthToStr(moment()-d,6)+')');
									if(active!=0) { clearInterval(foundationinterv); }
								},1000);
								$(tr).find('td:last').css('text-align','center').attr('title',Utils.FormatFullTimeToDateString(d)).html(Utils.FormatFullTimeToDateString(d)+'<div id="foundationage">('+Utils.FormatTimeLengthToStr(moment()-d,6)+')</div>');
							}
							else if(i==1)
							{
								$(tr).find('td:last').attr('title',Utils.FormatNumToStr($(tr).find('td:last').text(),false,0)).html(Utils.FormatNumToStr($(tr).find('td:last').text(),false,0));
							}
							else if(i==3)
							{
								var td = $(tr).find('td:last').text().split('(');
								$(tr).find('td:last').attr('title',Utils.FormatNumToStr(td[0].replace(/\D+/g,''),false,0)+' ('+Utils.FormatNumToStr(td[1].replace(/\D+/g,''),false,0)+')').html(Utils.Nth(td[0].replace(/\D+/g,''))+' ('+Utils.FormatNumToStr(td[1].replace(/\D+/g,''),false,0)+')');
							}
						});
					}
					else if(inAlliance && active==1)
					{
						$('table#allyMemberList > tbody > tr').each(function(y,tr)
						{
							switch(y)
							{
								case 0:
									$(tr).find('th:not(:last)').each(function(x,th){$(th).find('a').text(LD.embassytxt[x+29]);});
									$(tr).find('th:last').text(LD.embassytxt[34]);
									break;
								default:
									$(tr).find('td:eq(0)').css('text-align','center').text(function(){return ' '+(moment().diff(moment($(this).text(),'DD.MM.YYYY'),'days')>=2 ? moment($(this).text(),'DD.MM.YYYY').format(LD.dateformatshort) : moment($(this).text(),'DD.MM.YYYY').calendar().split(' ')[0]);});
									$(tr).find('td:eq(1)').css({'white-space':'nowrap','width':'110px'});
									$(tr).find('td:eq(2)').css({'width':'70px'}).find('div:first').css({'margin':'auto','width':'11px'});
									var cids = [];
									$(tr).find('td:eq(2) > div:last > ul > li').each(function(z,c)
									{
										cids.push(parseInt($(c).find('a').attr('href').split('&').pop().split('=').pop()));
									});
									cids.sort(function(a,b){return a-b;});
//									console.log(cids);
									var citylis = '';
									// database.settings.cityOrder.value
									$(tr).find('td:eq(2) > div:last > ul > li').each(function(z,c)
									{
										citylis += $(tr).find('td:eq(2) > div:last > ul > li > a[href$="'+($(tr).hasClass('highlight')?database.settings.cityOrder.value[z]:cids[z])+'"]').parent().prop('outerHTML');
									});
									$(tr).find('td:eq(2) > div:last > ul').html(citylis);
									$(tr).find('td:eq(4)').text(function(){return Utils.FormatNumToStr($(this).text().replace(/\D+/g,''),false,0);});
//									console.log($(tr).find('td:eq(5) > div:last'));
									$(tr).find('td:eq(5) > div > div:eq(3) > a').attr('title',LD.CompMsg);
									break;
							}
						});
					}
					else if(inAlliance && active==3)
					{
						$('#js_searchAllyForm > table:eq(0) > tbody > tr:first > td:first').text(LD.embassytxt[20]+':');
						$('#js_searchAllyForm > table:eq(0) > tbody > tr:first > td:nth-child(3)').text(LD.embassytxt[21]+':');
						$('#js_searchAllyForm > table:last > tbody > tr').each(function(k,tr)
						{
							switch(k)
							{
								case 0:
									$(tr).find('th').each(function(x,th){return $(th).text(LD.embassytxt[x+22]);});
									break;
								default:
									$(tr).find('td:eq(2)').each(function(){return $(this).text(Utils.FormatNumToStr($(this).text().replace(/\D+/g,''),false,0));});
									$(tr).find('td:eq(3)').each(function(){return $(this).text(Utils.FormatNumToStr($(this).text().replace(/\D+/g,''),false,0));});
									$(tr).find('td:eq(4) > a').attr('title',LD.embassytxt[27]);
									break;
							}
						});
					}
					else if(!inAlliance && active==0)
					{
						$('#embassy').find('table').css({'display':'inline-block','width':'650px'}).parent('div.content').css({'text-align':'center'});
						$('#embassy').find('table > tbody > tr').each(function(i,tr)
						{
							if(i<3)
							{
								$(tr).find('td:first'+(i>0?'':' > p')).html(LD.embassytxt[i+14]+(i>0?':':''));
								if(i>0)
								{
									var max = parseInt($(tr).find('td:last > input').attr('maxlength'));
									$(tr).find('td:first').css('width','45%');
									$(tr).find('td:last').css('width','55%');
									if(i==1) { $(tr).find('td:last > input').focus(); }
									$(tr).find('td:last > input').after(' <span id="allytagcnter'+i+'" style="float:right;position:relative;top:8px">(<b>'+max+'</b> '+LD.chrcnt[max==1?1:0]+')</span>');
									$(tr).find('td:last > input').attr({'autocomplete':'off'}).css({'text-align':'center','font':'bold 150% monospace'}).on('keyup',function(event)
									{
										$('#allytagcnter'+i).html('(<b>'+(max-$(tr).find('td:last > input').val().length)+'</b> '+LD.chrcnt[(max-$(tr).find('td:last > input').val().length)==1?1:0]+')');
									});
								}
							}
							else
							{
								$(tr).find('td:first > div > input').val(LD.embassytxt[i+10]);
							}
						});
					}
					else if(!inAlliance && active==1)
					{
						$('#js_searchAllyForm > table:first > tbody > tr').each(function(k,tr)
						{
							switch(k)
							{
								case 0:
									$(tr).find('th').text(LD.embassytxt[17]);
									break;
								case 1:
									$(tr).find('td:first').text(LD.embassytxt[18]);
									$(tr).find('td:last > a').text(LD.embassytxt[19]);
									break;
							}
						});
						$('#js_searchAllyForm > table:eq(1) > tbody > tr:first > td:first').text(LD.embassytxt[20]+':');
						$('#js_searchAllyForm > table:eq(1) > tbody > tr:first > td:nth-child(3)').text(LD.embassytxt[21]+':');
						$('#js_searchAllyForm > table:last > tbody > tr').each(function(k,tr)
						{
							switch(k)
							{
								case 0:
									$(tr).find('th').each(function(x,th){return $(th).text(LD.embassytxt[x+22]);});
									break;
								default:
									$(tr).find('td:eq(2)').each(function(){return $(this).text(Utils.FormatNumToStr($(this).text().replace(/\D+/g,''),false,0));});
									$(tr).find('td:eq(3)').each(function(){return $(this).text(Utils.FormatNumToStr($(this).text().replace(/\D+/g,''),false,0));});
									$(tr).find('td:eq(4) > a:eq(0)').attr('title',LD.embassytxt[27]);
									$(tr).find('td:eq(4) > a:eq(1)').attr('title',LD.embassytxt[28]);
									break;
							}
						});
					}
				}
				if($('#embassyMenu').parent().prev()[0]!=undefined) { $('#embassyMenu').parent().prev()[0].childNodes[0].textContent = LD.embassytxt[35]; }
				$('#embassyMenu').find('ul > li:eq(0) > a').text(LD.embassytxt[36]);
				$('#embassyMenu').find('ul > li:eq(1) > a').text(LD.embassytxt[37]);
				$('#embassyMenu').find('ul > li:eq(2) > a').text(LD.embassytxt[38]);
			}
			else if(view=='diplomacyAllyMemberlist')
			{
				$('#tab_diplomacyAlly > div:nth-child(2) > h3').text(LD.embassytxt[3]);
				$('#tabMenu > li:eq(1) > b').text(function(){return Utils.format(LD.dipladvtxt[0],[Utils.FormatNumToStr(parseInt($(this).text().replace(/\D+/g,'')),false,0)]);});
				$('#tabMenu > li:eq(2) > b').text(function(){return Utils.format(LD.dipladvtxt[1],[Utils.FormatNumToStr(parseInt($(this).text().replace(/\D+/g,'')),false,0)]);});
				$('#tabMenu > li:eq(3) > b').text(LD.dipladvtxt[2]);
				$('#tabMenu > li:eq(4) > b').text(function(){return Utils.format(LD.dipladvtxt[3],[Utils.FormatNumToStr(parseInt($(this).text().replace(/\D+/g,'')),false,0)]);});
				$('#tabMenu > li:eq(5) > b').text(LD.dipladvtxt[4]);
				$('#tabMenu > li:eq(6) > b').text(LD.dipladvtxt[5]);
				$('#tab_diplomacyAlly > div:first > h3')[0].childNodes[0].textContent = LD.dipladvtxt[6]+' ';
				$('#tab_diplomacyAlly > div:first > h3 > a').attr('title',LD.embassytxt[36]).find('span').text(LD.embassytxt[36]);
				$('#tab_diplomacyAlly > div:first > div.content > div.filter > span.filterEntry:eq(0) > a').attr('title',LD.dipladvtxt[62]).find('span.filterEntryButton > span:last').text(function(){return Utils.format(LD.dipladvtxt[63],[Utils.FormatNumToStr(parseInt($(this).text().replace(/\D+/g,'')),false,0)]);});
				$('#tab_diplomacyAlly > div:first > div.content > div.filter > span.filterEntry:eq(1) > a').attr('title',LD.dipladvtxt[64]).find('span.filterEntryButton > span:last').text(LD.dipladvtxt[65]);
				$('#tab_diplomacyAlly > div:first > div.content > div.filter > span.filterEntry:eq(2) > a').attr('title',LD.dipladvtxt[66]).find('span.filterEntryButton > span:last').text(LD.dipladvtxt[66]);
				$('#tab_diplomacyAlly > div:first > div.content > div.filter > span.filterEntry:eq(3) > a').attr('title',LD.dipladvtxt[67]).find('span.filterEntryButton > span:last').text(LD.dipladvtxt[67]);
				if(inAlliance)
				{
					$('table#allyMemberList > tbody > tr').each(function(y,tr)
					{
						switch(y)
						{
							case 0:
								$(tr).find('th:not(:last)').each(function(x,th){$(th).find('a').text(LD.embassytxt[x+29]);});
								$(tr).find('th:eq(1) > a').css('width','100px');
								$(tr).find('th:last').text(LD.embassytxt[34]);
								break;
							default:
								$(tr).find('td:eq(0)').css('text-align','center').text(function(){return ' '+(moment().diff(moment($(this).text(),'DD.MM.YYYY'),'days')>=2 ? moment($(this).text(),'DD.MM.YYYY').format(LD.dateformatshort) : moment($(this).text(),'DD.MM.YYYY').calendar().split(' ')[0]);});
								$(tr).find('td:eq(1)').css({'white-space':'nowrap','width':'110px'});
								$(tr).find('td:eq(2)').css({'width':'70px'}).find('div:first').css({'margin':'auto','width':'11px'});
								var cids = [];
								$(tr).find('td:eq(2) > div:last > ul > li').each(function(z,c)
								{
									$(c).find('a.city').html(function(){return $(this).text().replace(/(\[\d+:\d+\])/,'<span style="float:right">$1</span>')});
									cids.push(parseInt($(c).find('a').attr('href').split('&').pop().split('=').pop()));
								});
								cids.sort(function(a,b){return a-b;});
//								console.log(cids);
								var citylis = '';
								// database.settings.cityOrder.value
								$(tr).find('td:eq(2) > div:last > ul > li').each(function(z,c)
								{
									citylis += $(tr).find('td:eq(2) > div:last > ul > li > a[href$="'+($(tr).hasClass('highlight')?database.settings.cityOrder.value[z]:cids[z])+'"]').parent().prop('outerHTML');
								});
								$(tr).find('td:eq(2) > div:last > ul').html(citylis);
								$(tr).find('td:eq(4)').text(function(){return Utils.FormatNumToStr($(this).text().replace(/\D+/g,''),false,0);});
//								console.log($(tr).find('td:eq(5) > div:last'));
								$(tr).find('td:eq(5) > div > div:eq(3) > a').attr('title',LD.CompMsg);
								break;
						}
					});
				}
				else
				{
					$('#tab_diplomacyAlly > div:nth-child(2) > div.content > p').css({'text-align':'center','font-weight':'bold','color':'red'}).text(LD.embassytxt[39]);
				}
			}
			else if(view=='diplomacyAllyInfo')
			{
				$('#tab_diplomacyAlly > div:nth-child(2) > h3').text(LD.embassytxt[40]);
				$('#tabMenu > li:eq(1) > b').text(function(){return Utils.format(LD.dipladvtxt[0],[Utils.FormatNumToStr(parseInt($(this).text().replace(/\D+/g,'')),false,0)]);});
				$('#tabMenu > li:eq(2) > b').text(function(){return Utils.format(LD.dipladvtxt[1],[Utils.FormatNumToStr(parseInt($(this).text().replace(/\D+/g,'')),false,0)]);});
				$('#tabMenu > li:eq(3) > b').text(LD.dipladvtxt[2]);
				$('#tabMenu > li:eq(4) > b').text(function(){return Utils.format(LD.dipladvtxt[3],[Utils.FormatNumToStr(parseInt($(this).text().replace(/\D+/g,'')),false,0)]);});
				$('#tabMenu > li:eq(5) > b').text(LD.dipladvtxt[4]);
				$('#tabMenu > li:eq(6) > b').text(LD.dipladvtxt[5]);
				$('#tab_diplomacyAlly > div:first > h3')[0].childNodes[0].textContent = LD.dipladvtxt[6]+' ';
				$('#tab_diplomacyAlly > div:first > h3 > a').attr('title',LD.embassytxt[36]).find('span').text(LD.embassytxt[36]);
				$('#tab_diplomacyAlly > div:first > div.content > div.filter > span.filterEntry:eq(0) > a').attr('title',LD.dipladvtxt[62]).find('span.filterEntryButton > span:last').text(function(){return Utils.format(LD.dipladvtxt[63],[Utils.FormatNumToStr(parseInt($(this).text().replace(/\D+/g,'')),false,0)]);});
				$('#tab_diplomacyAlly > div:first > div.content > div.filter > span.filterEntry:eq(1) > a').attr('title',LD.dipladvtxt[64]).find('span.filterEntryButton > span:last').text(LD.dipladvtxt[65]);
				$('#tab_diplomacyAlly > div:first > div.content > div.filter > span.filterEntry:eq(2) > a').attr('title',LD.dipladvtxt[66]).find('span.filterEntryButton > span:last').text(LD.dipladvtxt[66]);
				$('#tab_diplomacyAlly > div:first > div.content > div.filter > span.filterEntry:eq(3) > a').attr('title',LD.dipladvtxt[67]).find('span.filterEntryButton > span:last').text(LD.dipladvtxt[67]);
				if(inAlliance)
				{
					var eid = 0, epos = 0;
					$.each(database.settings.cityOrder.value,function(i,c)
					{
						if(database.getCityFromId(c).isEmbassy)
						{
							eid = c;
							epos = database.getCityFromId(c).getBuildingFromName(Constant.Buildings.EMBASSY).getPosition;
							return false;
						}
					});
					var params = {view:'embassy',activeTab:'tabEmbassyAllyPage',cityId:city.isEmbassy?city.getId:eid,position:city.isEmbassy?city.getBuildingFromName(Constant.Buildings.EMBASSY).getPosition:epos}
	//				ikariam.loadUrl(true,ikariam.mainView, params)
					var txtids = [20,7,6,9,11,12];
					$('#tab_diplomacyAlly > div:nth-child(2) > div.content > table > tbody > tr').each(function(i,tr)
					{
						$(tr).find('td:first').text(LD.embassytxt[txtids[i]]+':');
						switch(i)
						{
							case 0:
								$(tr).find('td:last > b').html(function(){return '<a href="?'+(city.isEmbassy?'':'action=header&amp;function=changeCurrentCity&amp;actionRequest='+unsafeWindow.ikariam.model.actionRequest+'&amp;currentCityId='+ikariam.CurrentCityId+'&amp;oldView='+ikariam.mainView+'&amp;')+'view=embassy&amp;activeTab=tabEmbassyAllyPage&amp;cityId='+(city.isEmbassy?city.getId:eid)+'&amp;position='+(city.isEmbassy?city.getBuildingFromName(Constant.Buildings.EMBASSY).getPosition:epos)+'"onclick="ajaxHandlerCall(this.href);return false;">'+$(this).text()+'</a>'});
								$(tr).find('td:last > a').attr({'class':'allyMailIcon','title':LD.embassytxt[36]}).find('span').text(LD.embassytxt[36]);
								break;
							case 1:
							case 4:
								$(tr).find('td:last').text(function(){return Utils.FormatNumToStr($(this).text(),false,0);});
								break;
							case 2:
								var d = moment($(tr).find('td:last').text()+'+0100','DD.MM.YYYY HH:mm:ss Z').valueOf()+4.32e7;
								var foundationinterv = setInterval(function()
								{
									$('#foundationage').text('('+Utils.FormatTimeLengthToStr(moment()-d,6)+')');
									if(view!='diplomacyAllyInfo') { clearInterval(foundationinterv); }
								},1000);
								$(tr).find('td:last').css('text-align','center').attr('title',Utils.FormatFullTimeToDateString(d)).html(Utils.FormatFullTimeToDateString(d)+'<div id="foundationage">('+Utils.FormatTimeLengthToStr(moment()-d,6)+')</div>');
								break;
							case 3:
								var td = $(tr).find('td:last').text().split('(');
								$(tr).find('td:last').attr('title',Utils.FormatNumToStr(td[0].replace(/\D+/g,''),false,0)+' ('+Utils.FormatNumToStr(td[1].replace(/\D+/g,''),false,0)+')').html(Utils.Nth(td[0].replace(/\D+/g,''))+' ('+Utils.FormatNumToStr(td[1].replace(/\D+/g,''),false,0)+')');
								break;
						}
					});
				}
				else
				{
					$('#tab_diplomacyAlly > div:nth-child(2) > div.content > p').css({'text-align':'center','font-weight':'bold','color':'red'}).text(LD.embassytxt[39]);
				}
			}
			else if(view=='diplomacyAllySearch')
			{
				$('#tab_diplomacyAlly > div:nth-child(2) > h3').text(LD.embassytxt[5]);
				$('#tabMenu > li:eq(1) > b').text(function(){return Utils.format(LD.dipladvtxt[0],[Utils.FormatNumToStr(parseInt($(this).text().replace(/\D+/g,'')),false,0)]);});
				$('#tabMenu > li:eq(2) > b').text(function(){return Utils.format(LD.dipladvtxt[1],[Utils.FormatNumToStr(parseInt($(this).text().replace(/\D+/g,'')),false,0)]);});
				$('#tabMenu > li:eq(3) > b').text(LD.dipladvtxt[2]);
				$('#tabMenu > li:eq(4) > b').text(function(){return Utils.format(LD.dipladvtxt[3],[Utils.FormatNumToStr(parseInt($(this).text().replace(/\D+/g,'')),false,0)]);});
				$('#tabMenu > li:eq(5) > b').text(LD.dipladvtxt[4]);
				$('#tabMenu > li:eq(6) > b').text(LD.dipladvtxt[5]);
				$('#tab_diplomacyAlly > div:first > h3')[0].childNodes[0].textContent = LD.dipladvtxt[6]+' ';
				$('#tab_diplomacyAlly > div:first > h3 > a').attr('title',LD.embassytxt[36]).find('span').text(LD.embassytxt[36]);
				$('#tab_diplomacyAlly > div:first > div.content > div.filter > span.filterEntry:eq(0) > a').attr('title',LD.dipladvtxt[62]).find('span.filterEntryButton > span:last').text(function(){return Utils.format(LD.dipladvtxt[63],[Utils.FormatNumToStr(parseInt($(this).text().replace(/\D+/g,'')),false,0)]);});
				$('#tab_diplomacyAlly > div:first > div.content > div.filter > span.filterEntry:eq(1) > a').attr('title',LD.dipladvtxt[64]).find('span.filterEntryButton > span:last').text(LD.dipladvtxt[65]);
				$('#tab_diplomacyAlly > div:first > div.content > div.filter > span.filterEntry:eq(2) > a').attr('title',LD.dipladvtxt[66]).find('span.filterEntryButton > span:last').text(LD.dipladvtxt[66]);
				$('#tab_diplomacyAlly > div:first > div.content > div.filter > span.filterEntry:eq(3) > a').attr('title',LD.dipladvtxt[67]).find('span.filterEntryButton > span:last').text(LD.dipladvtxt[67]);
				if(inAlliance)
				{
					$('#js_searchAllyForm > table:eq(0) > tbody > tr:first > td:first').text(LD.embassytxt[20]+':');
					$('#js_searchAllyForm > table:eq(0) > tbody > tr:first > td:nth-child(3)').text(LD.embassytxt[21]+':');
					$('#js_searchAllyForm > table:last > tbody > tr').each(function(k,tr)
					{
						switch(k)
						{
							case 0:
								$(tr).find('th').each(function(x,th){return $(th).text(LD.embassytxt[x+22]);});
								break;
							default:
								$(tr).find('td:eq(2)').each(function(){return $(this).text(Utils.FormatNumToStr($(this).text().replace(/\D+/g,''),false,0));});
								$(tr).find('td:eq(3)').each(function(){return $(this).text(Utils.FormatNumToStr($(this).text().replace(/\D+/g,''),false,0));});
								$(tr).find('td:eq(4) > a').attr('title',LD.embassytxt[27]);
								break;
						}
					});
				}
				else
				{
					$('#js_searchAllyForm > table:first > tbody > tr').each(function(k,tr)
					{
						switch(k)
						{
							case 0:
								$(tr).find('th').text(LD.embassytxt[17]);
								break;
							case 1:
								$(tr).find('td:first').text(LD.embassytxt[18]);
								$(tr).find('td:last > a').text(LD.embassytxt[19]);
								break;
						}
					});
					$('#js_searchAllyForm > table:eq(1) > tbody > tr:first > td:first').text(LD.embassytxt[20]+':');
					$('#js_searchAllyForm > table:eq(1) > tbody > tr:first > td:nth-child(3)').text(LD.embassytxt[21]+':');
					$('#js_searchAllyForm > table:last > tbody > tr').each(function(k,tr)
					{
						switch(k)
						{
							case 0:
								$(tr).find('th').each(function(x,th){return $(th).text(LD.embassytxt[x+22]);});
								break;
							default:
								$(tr).find('td:eq(2)').each(function(){return $(this).text(Utils.FormatNumToStr($(this).text().replace(/\D+/g,''),false,0));});
								$(tr).find('td:eq(3)').each(function(){return $(this).text(Utils.FormatNumToStr($(this).text().replace(/\D+/g,''),false,0));});
								$(tr).find('td:eq(4) > a:eq(0)').attr('title',LD.embassytxt[27]);
								$(tr).find('td:eq(4) > a:eq(1)').attr('title',LD.embassytxt[28]);
								break;
						}
					});
				}
			}
			if($('table#allyMemberList').length)
			{
				$('table#allyMemberList > tbody > tr:not(:first)').each(function(k,tr)
				{
					var uranks = $(tr).children('td.smallFont').text().split(', ');
					$('#allyMemberList > tbody > tr:nth-child('+(k+2)+') > td:nth-child(5)').text(Utils.FormatNumToStr(parseInt($('#allyMemberList > tbody > tr:nth-child('+(k+2)+') > td:nth-child(5)').text().replace(/(\d+)[,.](?=\d{3}(\D|$))/g, "$1")),false,0));
					$('#allyMemberList > tbody > tr:nth-child('+(k+2)+') > td:nth-child(5)').css('text-align','right');
					for(var r=0;r<4;r++)
					{
						$.each(uranks,function(i,rnk)
						{
							if(Constant.LanguageData[ikariam.Language()].allyranks.indexOf(rnk.trim())==r)
							{
								database.getGlobalData.getEmbassyData.ranks[r] = {
									id: parseInt($('#allyMemberList > tbody > tr:nth-child('+(k+2)+') > td:nth-child(2) > a').attr('href').split('=')[2]),
									name: $.trim($('#allyMemberList > tbody > tr:nth-child('+(k+2)+') > td:nth-child(2) > a').text()),
									status: $('#allyMemberList > tbody > tr:nth-child('+(k+2)+') > td:first-child').attr('class').split(' ')[1]
								};
							}
						});
					}
					if(database.settings.ctfinder.value)
					{
						var fid = $('#allyMemberList > tbody > tr:nth-child('+(k+2)+') > td:nth-child(2) > a').attr('href').split('=')[2];
						$('#allyMemberList > tbody > tr:nth-child('+(k+2)+') > td:nth-child(2) > a').next('span').remove();
						$('#allyMemberList > tbody > tr:nth-child('+(k+2)+') > td:nth-child(2) > a').after('<span style="float:right"></span>');
						if(Object.keys(database.getGlobalData.getMuseumTreaties).indexOf(fid)!=-1)
						{
							$('#allyMemberList > tbody > tr:nth-child('+(k+2)+') > td:nth-child(2) > a').next('span').html('<img src="skin/museum/icon32_culturalgood.png" style="width:15px;height:auto;" title="'+LD.ctenabled+'">');
						}
						else if(Object.keys(database.getGlobalData.getPotMuseumTreaties).indexOf(fid)!=-1)
						{
							$('#allyMemberList > tbody > tr:nth-child('+(k+2)+') > td:nth-child(2) > a').next('span').html('<img src="skin/museum/icon32_culturalgood.png" style="width:15px;height:auto;opacity:0.5" title="'+LD.ctrequested[database.getGlobalData.getPotMuseumTreaties[fid].type*0.5-39]+'">');
						}
					}
					else
					{
						$('#allyMemberList > tbody > tr:nth-child('+(k+2)+') > td:nth-child(2) > a').next('span').remove();
					}
				});
			}
			else if($('#embassy > div.bd.mainContentScroll > div.mainContent.minimizableContent > div.contentBox01h > div.content > table > tbody > tr:nth-child(1) > td.bold.left').length)
			{
				database.getGlobalData.getEmbassyData.name = $('#embassy > div.bd.mainContentScroll > div.mainContent.minimizableContent > div.contentBox01h > div.content > table > tbody > tr:nth-child(1) > td.bold.left').attr('title');
			}
			database.getGlobalData.getEmbassyData.id = unsafeWindow.dataSetForView.avatarAllyId;
			render.toast(Utils.format('{0}: {1} {2} {3} {4}',[LD.updated_,LD.embassy,LD.tothe,LD[city.isCapital?'capital':'colony'],LD.leftquot+city._name+LD.rightquot]));
		},
		parsePlayerDetails: function(view)
		{
			var LD = Constant.LanguageData[database.settings.languageChange.value];
			if(view=='avatarProfile')
			{
				$('table.profileTable').css('width','60%');
				var regdate = $('#selectTitleForm').parentsUntil('table','tbody').find('tr:nth-child(5) > td:last');
				database.getGlobalData._regDate = moment($(regdate).text()+'+0100','DD.MM.YYYY HH:mm:ss Z').valueOf();
				$(regdate).hide().after('<span id="regDate"></span>');
				$('table.profileTable > tbody > tr:nth-child(4) > td:last').text(Utils.FormatNumToStr($('table.profileTable > tbody > tr:nth-child(4) > td:last').text().replace(/(\d+)[,.](?=\d{3}(\D|$))/g,'$1')));
				setInterval(function() { $('#regDuration').html(Utils.FormatTimeLengthToStr(moment()-database.getGlobalData.getRegDate,6)); },1000);
				$('#regDate').css({'text-align':'center','display':'inline-block'}).html(Utils.FormatFullTimeToDateString(database.getGlobalData.getRegDate)+'<br>(<span id="regDuration">'+Utils.FormatTimeLengthToStr(moment()-database.getGlobalData.getRegDate,6)+'</span>)');
			}
			if(database.settings.ctfinder.value)
			{
				if($('#achievementCategoryTitle > a').length)
				{
					var uid = $('#achievementCategoryTitle > a').attr('href').split('&')[1].replace(/\D+/g,'');
					if(Object.keys(database.getGlobalData.getMuseumTreaties).indexOf(uid)!=-1)
					{
						$('#achievementCategoryTitle > a').before('<img src="skin/museum/icon32_culturalgood.png" style="width:15px;height:auto;" title="'+LD.ctenabled+'">');
					}
					else if(Object.keys(database.getGlobalData.getPotMuseumTreaties).indexOf(uid)!=-1)
					{
						$('#achievementCategoryTitle > a').before('<img src="skin/museum/icon32_culturalgood.png" style="width:15px;height:auto;opacity:0.5" title="'+LD.ctrequested[database.getGlobalData.getPotMuseumTreaties[uid].type*0.5-39]+'">');
					}
				}
			}
		},
		parseTheater: function(data)
		{
			var LD = Constant.LanguageData[database.settings.languageChange.value];
			var city = ikariam.getCurrentCity;
			var type = ['Resource','Tradegood','Favour'];
			$('#js_mainBoxHeaderTitle').text(LD.Cinetheatre);
			$('#cinema').find('div.buildingDescription > h1').text(LD.Cinetheatre);
			$('#cinema').find('div.buildingDescription > p').text(LD.cinetheatretxt[0]);
			$('#cinema').find('div.buildingDescription + div > h3').text(LD.Cinetheatre);
			$('#externAdDisclaimer').css('text-align','justify').html(LD.cinetheatretxt[1]);
			$('#cinemaBoxClose + p').text(LD.cinetheatretxt[2]);
			$('#gameLink').text(LD.cinetheatretxt[3]);
			$('#gameLink + p').text(LD.cinetheatretxt[4]);
			$('#cinema_hideable > p').text(LD.cinetheatretxt[5]);
			$('#VideoRewards > li').each(function(i,li)
			{
				$(li).find('h4').html(LD.cinetheatretxt[(data['js_nextPossible'+type[i]]!=undefined?0:i+1)+6]);
				$(li).find('p:first').html(i<2?Utils.format(LD.cinetheatretxt[(data['js_nextPossible'+type[i]]!=undefined?0:i+1)+9],[LD.cinetheatretxt[12][city.getTradeGood=='glass'?'crystal':city.getTradeGood]]):'&nbsp;');
				if($(li).find('p:last')[0].childNodes[1]!=undefined) { $(li).find('p:last')[0].childNodes[1].textContent = ' '+LD.cinetheatretxt[i<2?13:14]; }
				$('input#'+type[i].toLowerCase()+'SubmitButton').val(LD.cinetheatretxt[15]);
			});
			$('#VideoRewards + div.infobox').css('text-align','justify')[0].childNodes[0].textContent = LD.cinetheatretxt[16];
			$('#VideoRewards + div.infobox > ul > li:eq(0)').css('text-align','justify').html(LD.cinetheatretxt[17]);
			$('#VideoRewards + div.infobox > ul > li:eq(1)').css('text-align','justify').html(LD.cinetheatretxt[18]);
			$('#VideoRewards + div.infobox > ul > li:eq(2)').css('text-align','justify').html(LD.cinetheatretxt[19]);
			$(document).ready(function()
			{
				var ytplayerinterv = setInterval(function()
				{
					if($('iframe#player').length==1)
					{
						$('iframe#player').attr('src',$('iframe#player').attr('src').replace(/(autoplay=)(\d+)/g,'$11')+'&mute=1');
						$('#videoVolume').val(0);
						$('#videoButton').attr('class','volumeMute').trigger('click');
//						console.log($('iframe#player').attr('src'));
						clearInterval(ytplayerinterv);
					}
				},200);
				var ytplayerinterv2 = setInterval(function()
				{
					if($('iframe#player').length==1 && $('#cinemaBoxClose').parent().css('display')=='block')
					{
						$('#cinemaBoxClose').trigger('click');
						clearInterval(ytplayerinterv2);
					}
				},600);
			});
			$('#externPlayerBox').parent().css('min-height','630px');
			$.each(type,function(k,t)
			{
				if(data['js_nextPossible'+t]!=undefined)
				{
					var ctime = database.getGlobalData.premium[k+51]!=undefined ? (moment()<=(database.getGlobalData.premium[k+51].endtime*1000)) : false;
					var cid = database.getGlobalData.premium[k+51]!=undefined ? database.getGlobalData.premium[k+51].cityid : 0;
					database.getGlobalData.setPremiumFeature(k+51,t.toLowerCase()+'Bonus',data['js_nextPossible'+t].countdown.enddate,ctime?cid:0);
				}
			});
			if($('#js_nextPossibleResource').length || $('#js_nextPossibleTradegood').length || $('#js_nextPossibleFavour').length)
			{
				var tp = [Constant.Premium.WOOD_BONUS[1],Constant.Premium.TRADEGOOD_BONUS]
				var serverTimezoneOffset = unsafeWindow.dataSetForView.serverTimezoneOffset;
				var diff = -(moment().utcOffset()*60-serverTimezoneOffset)*1000;
				$('#js_nextPossibleResource').before('<p id="empirePossibleResource"></p>');
				$('#js_nextPossibleTradegood').before('<p id="empirePossibleTradegood"></p>');
				$('#js_nextPossibleFavour').before('<p id="empirePossibleFavour"></p>');
				function tmrs()
				{
					var favsecs = (moment(moment()+diff).add(1,'day').startOf('day')-diff-$.now())/1000;
					if($('#js_nextPossibleResource').length && database.getGlobalData.getPremiumTimeRemaining(tp[0])>0)
					{
						$('#empirePossibleResource').html(database.getGlobalData.hasPremiumFeature(tp[0])?Utils.FormatFullTimeToDateString(database.getGlobalData.getPremiumTimeRemaining(tp[0])+$.now(),false)+'<br>'+Utils.FormatTimeLengthToStr(database.getGlobalData.getPremiumTimeRemaining(tp[0]),3):'');
					}
					if($('#js_nextPossibleTradegood').length && database.getGlobalData.getPremiumTimeRemaining(tp[1])>0)
					{
						$('#empirePossibleTradegood').html(database.getGlobalData.hasPremiumFeature(tp[1])?Utils.FormatFullTimeToDateString(database.getGlobalData.getPremiumTimeRemaining(tp[1])+$.now(),false)+'<br>'+Utils.FormatTimeLengthToStr(database.getGlobalData.getPremiumTimeRemaining(tp[1]),3):'');
					}
					if($('#js_nextPossibleFavour').length && moment(moment()+diff).add(1,'day').startOf('day')-diff>0)
					{
						$('#empirePossibleFavour').html(Utils.FormatFullTimeToDateString(moment(moment()+diff).add(1,'day').startOf('day')-diff,false)+'<br>'+Utils.FormatTimeLengthToStr((favsecs)*1000,3));
					}
				}
				if($('#js_nextPossibleResource').length && database.getGlobalData.getPremiumTimeRemaining(tp[0])>0)
				{
					$('#js_nextPossibleResource').hide();
				}
				if($('#js_nextPossibleTradegood').length && database.getGlobalData.getPremiumTimeRemaining(tp[1])>0)
				{
					$('#js_nextPossibleTradegood').hide();
				}
				if($('#js_nextPossibleFavour').length && moment(moment()+diff).add(1,'day').startOf('day')-diff>0)
				{
					$('#js_nextPossibleFavour').hide();
				}
				tmrs();
				setInterval(tmrs,1000);
			}
			render.toast(Utils.format('{0}: {1} {2} {3} {4}',[LD.updated_,LD.Cinetheatre,LD.tothe,LD[city.isCapital?'capital':'colony'],LD.leftquot+city._name+LD.rightquot]));
		},
		parseTownHall: function(data)
		{
			var LD = Constant.LanguageData[database.settings.languageChange.value];
			var changes = {};
			var city = ikariam.getCurrentCity;
//			console.log(city.getCorruption);
			var cultBon = parseInt(data.js_TownHallSatisfactionOverviewCultureBoniTreatyBonusValue.text) || 0;
			var cultbon = parseInt(data.js_TownHallNoticeBox.text) || 0;
			var priests = parseInt(data.js_TownHallPopulationGraphPriestCount.text.replace(/(\d+)[,.](?=\d{3}(\D|$))/g,'$1')) || 0;
			var researchers = parseInt(data.js_TownHallPopulationGraphScientistCount.text) || 0;
			var sat = parseInt(data.js_TownHallSatisfactionOverviewWineBoniServeBonusValue.text) || 0;
			city.getResource(Constant.Resources.WINE).getCurrLevel = sat / 60;
			changes.culturalGoods = city.updateCulturalGoods(cultBon / 50);
			changes.priests = city.updatePriests(priests);
			changes.research = city.updateResearchers(researchers);
			events(Constant.Events.CITY_UPDATED).pub(ikariam.CurrentCityId, changes);
			$('#js_mainBoxHeaderTitle').text(LD.townHall);
			$('#townHall').find('div.buildingDescription > h1').text(LD.townHall);
			$('#renameCity > form > h3').text(LD.townhalltxt[0]);
			$('#js_oldCityName').prev('span').text(LD.townhalltxt[1]);
			$('#newCityName').prev('label').text(LD.townhalltxt[2]);
			$('#renameCity > form > div.content > div.centerButton > input').val(LD.townhalltxt[3]);
			$('#js_TownHallCityName').html(LD[city.isCapital?'capital':'colony']+' '+LD.leftquot+city._name+LD.rightquot).next('a').text(LD.townhalltxt[4]);
			$('div.stats > img').attr('alt',LD.citizens);
			$('#js_TownHallOccupiedSpace').text(function(){return Utils.FormatNumToStr($(this).text(),false,0);});
			$('#js_TownHallMaxInhabitants').text(function(){return Utils.FormatNumToStr($(this).text(),false,0);});
			$('#js_TownHallOccupiedSpace').parent()[0].childNodes[0].textContent = LD.townhalltxt[5]+': ';
			$('#js_TownHallOccupiedSpace').parent()[0].childNodes[2].textContent = ' / ';
			$('#js_TownHallGarrisonLimitLand').text(function(){return Utils.FormatNumToStr($(this).text(),false,0);});
			$('#js_TownHallGarrisonLimitLand').parent()[0].childNodes[0].textContent = LD.townhalltxt[6]+': ';
			$('#js_TownHallGarrisonLimitSea').text(function(){return Utils.FormatNumToStr($(this).text(),false,0);});
			$('#js_TownHallGarrisonLimitSea').parent()[0].childNodes[0].textContent = LD.townhalltxt[7]+': ';
			$('#js_TownHallActionPointsAvailable').parent()[0].childNodes[0].textContent = LD.townhalltxt[8]+': ';
			$('#js_TownHallActionPointsAvailable').parent()[0].childNodes[2].textContent = ' / ';
			$('#js_TownHallPopulationGrowthValue').text(function(){return Utils.FormatNumToStr($(this).text().replace(/(\d+)[,.](?=\d{3}(\D|$))/g,'$1'),false,2);});
			$('#js_TownHallPopulationGrowthValue').parent()[0].childNodes[0].textContent = LD.townhalltxt[9]+': ';
			$('#js_TownHallPopulationGrowthValue').parent()[0].childNodes[2].textContent = ' '+LD.townhalltxt[10];
			$('#js_TownHallIncomeGoldValue').text(function(){return Utils.FormatNumToStr($(this).text(),false,0);});
			$('#js_TownHallIncomeGoldValue').parent()[0].childNodes[0].textContent = LD.townhalltxt[11]+': ';
			$('#js_TownHallCorruption').text(function(){return Utils.FormatNumToStr($(this).text().replace(/\D+/g,''),false,0)+' %';});
			$('#js_TownHallCorruption').parent()[0].childNodes[0].textContent = LD.corruption+': ';
			$('#js_TownHallHappinessSmallText').text(LD[$('#js_TownHallHappinessSmall').attr('class').split(' ')[1].split('_')[1]]);
			$('#js_citizensPremiumOffer').find('div.tooltip > span, div.amountAndActiveBox > div:first').text(Utils.format(LD.townhalltxt[12],[5]));
			$('#js_citizensPremiumOffer').find('div.options > div').each(function(k,dv)
			{
				$(dv).attr('tooltip',Utils.format(LD.townhalltxt[12],[2.5*k*(k+1)+5])).on('click',function()
				{
					$('#js_citizensPremiumOffer').find('div.tooltip > span, div.amountAndActiveBox > div:first').text($(this).attr('tooltip'));
				});
			});
			$('#populationManagement').prev('h4').text(LD.townhalltxt[13]);
			var wood = $('#populationManagement')[0][5].value;
			var luxury = $('#populationManagement')[0][6].value;
			var scientists = $('#populationManagement')[0][7].value;
			var priests = $('#populationManagement')[0][8].value;
			var maxWoodWorkers = Constant.IslandBuildings.forest.workers[city.getForest.level];
			var maxLuxuryWorkers = Constant.IslandBuildings.mine.workers[city.getMine.level];
			var maxCitizens = parseInt(data.js_TownHallOccupiedSpace.text) || 0;
			$('#js_TownHallPopulationGraphResourceWorkerCount').hide().after('<span id="empire_TownHallPopulationGraphResourceWorkerCount" class="count">'+Utils.FormatNumToStr(wood<=maxWoodWorkers?wood:maxWoodWorkers,false,0)+(wood<=maxWoodWorkers?'':' + '+Utils.FormatNumToStr(wood-maxWoodWorkers,false,0))+'</span>');
			$('#js_TownHallPopulationGraphSpecialWorkerCount').hide().after('<span id="empire_TownHallPopulationGraphSpecialWorkerCount" class="count">'+Utils.FormatNumToStr(luxury<=maxLuxuryWorkers?luxury:maxLuxuryWorkers,false,0)+(luxury<=maxLuxuryWorkers?'':' + '+Utils.FormatNumToStr(luxury-maxLuxuryWorkers,false,0))+'</span>');
			$('#js_TownHallPopulationGraphScientistCount').hide().after('<span id="empire_TownHallPopulationGraphScientistCount" class="count">'+Utils.FormatNumToStr(scientists,false,0)+'</span>');
			$('#js_TownHallPopulationGraphPriestCount').hide().after('<span id="empire_TownHallPopulationGraphPriestCount" class="count">'+Utils.FormatNumToStr(priests,false,0)+'</span>');
			$('#js_TownHallPopulationGraphCitizenCount').hide().after('<span id="empire_TownHallPopulationGraphCitizenCount" class="count">'+Utils.FormatNumToStr(maxCitizens-wood-luxury-scientists-priests,false,0)+'</span>');
			var b = ['FORESTER','WINERY','STONEMASON','GLASSBLOWER','ALCHEMISTS_TOWER'];
			var F = (city.getBuildingFromName(Constant.Buildings.FORESTER)?city.getBuildingFromName(Constant.Buildings.FORESTER).getLevel:0)*0.02;
			var INC = (city.getBuildingFromName(Constant.Buildings[b[city.getTradeGoodID]])?city.getBuildingFromName(Constant.Buildings[b[city.getTradeGoodID]]).getLevel:0)*0.02;
			var B = 0, T = 0;
			if(database.getGlobalData.hasPremiumFeature(Constant.Premium.WOOD_BONUS[0]) && database.getGlobalData.premium[Constant.Premium['WOOD_BONUS'][1]].cityid=='0')
			{
				B += parseFloat(Constant.PremiumData[Constant.Premium['WOOD_BONUS'][0]].bonus);
			}
			else if(database.getGlobalData.hasPremiumFeature(Constant.Premium.WOOD_BONUS[1]) && city.getId==database.getGlobalData.premium[Constant.Premium['WOOD_BONUS'][1]].cityid)
			{
				B += parseFloat(Constant.PremiumData[Constant.Premium['WOOD_BONUS'][1]].bonus);
			}
			if(database.getGlobalData.hasPremiumFeature(Constant.Premium[(city.getTradeGood=='glass'?'crystal':city.getTradeGood).toUpperCase()+'_BONUS']) && database.getGlobalData.premium[Constant.Premium['TRADEGOOD_BONUS']].cityid=='0')
			{
				T += parseFloat(Constant.PremiumData[Constant.Premium[(city.getTradeGood=='glass'?'crystal':city.getTradeGood).toUpperCase()+'_BONUS']].bonus);
			}
			else if(database.getGlobalData.hasPremiumFeature(Constant.Premium.TRADEGOOD_BONUS) && city.getId==database.getGlobalData.premium[Constant.Premium['TRADEGOOD_BONUS']].cityid)
			{
				T += parseFloat(Constant.PremiumData[Constant.Premium['WOOD_BONUS'][1]].bonus);
			}
			var resBon = 1+(database.getGlobalData.getResearchTopicLevel(Constant.Research.Science.PAPER)*0.02)+(database.getGlobalData.getResearchTopicLevel(Constant.Research.Science.INK)*0.04)+(database.getGlobalData.getResearchTopicLevel(Constant.Research.Science.MECHANICAL_PEN)*0.08)+(database.getGlobalData.getResearchTopicLevel(Constant.Research.Science.SCIENTIFIC_FUTURE)*0.02);
			$('#js_TownHallPopulationGraphWoodProduction').hide().after('<div id="empire_TownHallPopulationGraphWoodProduction" class="WoodProduction">'+Utils.FormatNumToStr((wood<=maxWoodWorkers?wood:(maxWoodWorkers+(wood-maxWoodWorkers)*0.25))*(1+F+B)*(1-city.getCorruption),true,0)+'</div>');
			$('#js_TownHallPopulationGraphTradeGoodProduction').hide().after('<div id="empire_TownHallPopulationGraphTradeGoodProduction" class="LuxuryProduction">'+Utils.FormatNumToStr((luxury<=maxLuxuryWorkers?luxury:(maxLuxuryWorkers+(luxury-maxLuxuryWorkers)*0.25))*(1+INC+T)*(1-city.getCorruption),true,0)+'</div>');
			$('#js_TownHallPopulationGraphScientistsResearchCost').hide().after('<div id="empire_TownHallPopulationGraphScientistsResearchCost" class="ScientistsCost">'+Utils.FormatNumToStr(-scientists*3,true,0)+'</div>');
			$('#js_TownHallPopulationGraphScientistsResearchProduction').hide().after('<div id="empire_TownHallPopulationGraphScientistsResearchProduction" class="ScientistsProduction">'+Utils.FormatNumToStr(scientists*resBon,true,0)+'</div>');
			$('#js_TownHallPopulationGraphPriestsGoldProduction').hide().after('<div id="empire_TownHallPopulationGraphPriestsGoldProduction" class="PriestsProduction">'+Utils.FormatNumToStr(-priests*3,true,0)+'</div>');
			$('#js_TownHallPopulationGraphCitizensGoldProduction').hide().after('<div id="empire_TownHallPopulationGraphCitizensGoldProduction" class="CitizensProduction">'+Utils.FormatNumToStr((maxCitizens-wood-luxury-scientists-priests)*3,true,0)+'</div>');
			var evtinterv = setInterval(function()
			{
				$('#populationManagement').on('change click dblclick focusin focusout keydown keypress keyup mousedown mouseenter mouseleave mousemove mouseout mouseover mouseup select textInput','li.assignWood,li.assignLuxury,li.assignScientists,li.assignPriests',function(e)
				{
					wood = $('#populationManagement')[0][5].value;
					luxury = $('#populationManagement')[0][6].value;
					scientists = $('#populationManagement')[0][7].value;
					priests = $('#populationManagement')[0][8].value;
					$('#empire_TownHallPopulationGraphResourceWorkerCount').text(Utils.FormatNumToStr(wood<=maxWoodWorkers?wood:maxWoodWorkers,false,0)+(wood<=maxWoodWorkers?'':' + '+Utils.FormatNumToStr(wood-maxWoodWorkers,false,0)));
					$('#empire_TownHallPopulationGraphSpecialWorkerCount').text(Utils.FormatNumToStr(luxury<=maxLuxuryWorkers?luxury:maxLuxuryWorkers,false,0)+(luxury<=maxLuxuryWorkers?'':' + '+Utils.FormatNumToStr(luxury-maxLuxuryWorkers,false,0)));
					$('#empire_TownHallPopulationGraphWoodProduction').text(Utils.FormatNumToStr((wood<=maxWoodWorkers?wood:(maxWoodWorkers+(wood-maxWoodWorkers)*0.25))*(1+F+B)*(1-city.getCorruption),true,0));
					$('#empire_TownHallPopulationGraphTradeGoodProduction').text(Utils.FormatNumToStr((luxury<=maxLuxuryWorkers?luxury:(maxLuxuryWorkers+(luxury-maxLuxuryWorkers)*0.25))*(1+INC+T)*(1-city.getCorruption),true,0));
					$('#empire_TownHallPopulationGraphScientistCount').text(Utils.FormatNumToStr(scientists,false,0));
					$('#empire_TownHallPopulationGraphScientistsResearchCost').text(Utils.FormatNumToStr(-scientists*3,false,0));
					$('#empire_TownHallPopulationGraphScientistsResearchProduction').text(Utils.FormatNumToStr(scientists*resBon,true,0));
					$('#empire_TownHallPopulationGraphPriestCount').text(Utils.FormatNumToStr(priests,false,0));
					$('#empire_TownHallPopulationGraphPriestsGoldProduction').text(Utils.FormatNumToStr(-priests*3,true,0));
					$('#empire_TownHallPopulationGraphCitizenCount').text(Utils.FormatNumToStr(maxCitizens-wood-luxury-scientists-priests,false,0));
					$('#empire_TownHallPopulationGraphCitizensGoldProduction').text(Utils.FormatNumToStr((maxCitizens-wood-luxury-scientists-priests)*3,true,0));
					if(['mousedown','change','keydown','keypress','keyup','textInput'].indexOf(e.type)!=-1) { clearInterval(evtinterv); }
				});
			},500);
			$('li.assignCitizens > input').val(LD.save);
			$('#js_TownHallNoticeBoxNoNoticeMessage').text(LD.townhalltxt[15]).prev('h4').text(LD.townhalltxt[14]);
			$('#js_TownHallNoticeBox > h5').text(LD.townhalltxt[16]);
			$('#js_TownHallNoticeBox > p').text(Utils.format(LD.townhalltxt[17],[LD.townhalltxt[city.isCapital?19:18]]));
			$('#renameCity + div + div > h3').text(LD.satisfaction);
			$('#renameCity + div + div > div > p').html(LD.townhalltxt[20]);
			$('div.positives > h4').text(LD.townhalltxt[21]);
			$('div.positives > div.basic > h5').text(LD.townhalltxt[22]);
			$('#js_TownHallSatisfactionOverviewBaseBoniBaseBonusValue').text(function(){return Utils.FormatNumToStr(parseInt($(this).text().replace(/\D+/g,'')),true,0)});
			$('#js_TownHallSatisfactionOverviewBaseBoniBaseBonusTooltip').text(LD.townhalltxt[23]);
			$('#js_TownHallSatisfactionOverviewBaseBoniGovernmentBonusValue').text(function(){return Utils.FormatNumToStr(parseInt($(this).text().replace(/\D+/g,'')),true,0)});
			$('#js_TownHallSatisfactionOverviewBaseBoniGovernmentBonusTooltip').text(LD.townhalltxt[24]);
			$('#js_TownHallSatisfactionOverviewBaseBoniResearchBonusValue').text(function(){return Utils.FormatNumToStr(parseInt($(this).text().replace(/\D+/g,'')),true,0)});
			$('#js_TownHallSatisfactionOverviewBaseBoniResearchBonusTooltip').text(LD.townhalltxt[25]);
			$('#js_TownHallSatisfactionOverviewBaseBoniCapitalBonusValue').text(function(){return Utils.FormatNumToStr(parseInt($(this).text().replace(/\D+/g,'')),true,0)});
			$('#js_TownHallSatisfactionOverviewBaseBoniCapitalBonusTooltip').text(LD.townhalltxt[26]);
			$('#js_TownHallSatisfactionOverviewBaseBoniHappeningBonusContainer > h5').text(LD.townhalltxt[27]);
			$('#js_TownHallSatisfactionOverviewBaseBoniHappeningBonusValue').text(function(){return Utils.FormatNumToStr(parseInt($(this).text().replace(/\D+/g,'')),true,0)});
			$('#js_TownHallSatisfactionOverviewBaseBoniHappeningBonusTooltip').text(LD.townhalltxt[28]);
			$('#js_TownHallSatisfactionOverviewBaseBoniTransferBonusContainer > h5').text(LD.townhalltxt[29]);
			$('#js_TownHallSatisfactionOverviewBaseBoniTransferBonusValue').text(function(){return Utils.FormatNumToStr(parseInt($(this).text().replace(/\D+/g,'')),true,0)});
			$('#js_TownHallSatisfactionOverviewBaseBoniTransferCountdown').parent()[0].childNodes[0].textContent = LD.townhalltxt[30]+' ';
			$('#js_TownHallSatisfactionOverviewBaseBoniTransferBonusTooltip').text(LD.townhalltxt[31]);
			$('#js_TownHallSatisfactionOverviewWineBoniTavernBonus').prev('h5').text(LD.townhalltxt[32]);
			$('#js_TownHallSatisfactionOverviewWineBoniTavernBonusValue').text(function(){return Utils.FormatNumToStr(parseInt($(this).text().replace(/\D+/g,'')),true,0)});
			$('#js_TownHallSatisfactionOverviewWineBoniTavernBonusTooltip').text(LD.townhalltxt[33]);
			$('#js_TownHallSatisfactionOverviewWineBoniServeBonusValue').text(function(){return Utils.FormatNumToStr(parseInt($(this).text().replace(/\D+/g,'')),true,0)});
			$('#js_TownHallSatisfactionOverviewWineBoniServeBonusTooltip').text(LD.townhalltxt[34]);
			$('#js_TownHallSatisfactionOverviewWineNoTavernMessage').text(LD.townhalltxt[35]);
			$('#js_TownHallSatisfactionOverviewCultureBoniMuseumBonus').prev('h5').text(LD.townhalltxt[36]);
			$('#js_TownHallSatisfactionOverviewCultureBoniMuseumBonusValue').text(function(){return Utils.FormatNumToStr(parseInt($(this).text().replace(/\D+/g,'')),true,0)});
			$('#js_TownHallSatisfactionOverviewCultureBoniMuseumBonusTooltip').text(LD.townhalltxt[37]);
			$('#js_TownHallSatisfactionOverviewCultureBoniTreatyBonusValue').text(function(){return Utils.FormatNumToStr(parseInt($(this).text().replace(/\D+/g,'')),true,0)});
			$('#js_TownHallSatisfactionOverviewCultureBoniTreatyBonusTooltip').text(LD.townhalltxt[38]);
			$('#js_TownHallSatisfactionOverviewCultureNoMuseumMessage').text(LD.townhalltxt[39]);
			$('#js_TownHallSatisfactionOverviewOverpopulationMalus').prev('h4').text(LD.townhalltxt[40]);
			$('#js_TownHallSatisfactionOverviewOverpopulationMalus > h5').text(LD.townhalltxt[41]);
			$('#js_TownHallSatisfactionOverviewOverpopulationMalusValue').text(function(){return Utils.FormatNumToStr(parseInt($(this).text().replace(/\D+/g,'')),false,0)});
			$('#js_TownHallSatisfactionOverviewCorruptionMalus > h5').text(LD.corruption);
			$('#js_TownHallSatisfactionOverviewCorruptionMalusValue').text(function(){return Utils.FormatNumToStr(parseInt($(this).text().replace(/\D+/g,'')),true,0)});
			$('#js_TownHallSatisfactionOverviewPunishmentMalus > h5').text(LD.townhalltxt[42]);
			$('#js_TownHallSatisfactionOverviewPunishmentMalusValue').text(function(){return Utils.FormatNumToStr(parseInt($(this).text().replace(/\D+/g,'')),true,0)});
			$('#js_TownHallSatisfactionOverviewGovernmentMalus > h5').text(LD.townhalltxt[43]);
			$('#js_TownHallSatisfactionOverviewGovernmentMalusValue').text(function(){return Utils.FormatNumToStr(parseInt($(this).text().replace(/\D+/g,'')),true,0)});
			$('#js_TownHallHappinessLarge > h4').text(LD.townhalltxt[44]);
			$('#js_TownHallHappinessLargeValue').text(function(){return Utils.FormatNumToStr(parseInt($(this).text().replace(/\D+/g,'')),false,0)});
			$('#js_TownHallHappinessLargeText').text(LD[$('#js_TownHallHappinessLarge').attr('class').split(' ')[1].split('_')[1]]);
			if(!city.isCapital)
			{
				$('#abandonSidebar').parent().prev('a')[0].childNodes[0].textContent = LD.townhalltxt[45];
				$('#abandonSidebar > p').css('text-align','justify').text(LD.townhalltxt[46]);
				$('#abandonSidebar > div > a').text(LD.townhalltxt[45]);
			}
			render.toast(Utils.format('{0}: {1} {2} {3} {4}',[LD.updated_,LD.townHall,LD.tothe,LD[city.isCapital?'capital':'colony'],LD.leftquot+city._name+LD.rightquot]));
		},
		parseTradingPost: function(view,data)
		{
			var LD = Constant.LanguageData[database.settings.languageChange.value];
			var city = ikariam.getCurrentCity;
			$('#js_mainBoxHeaderTitle').text(LD.branchOffice);
			$('#'+view).find('div.buildingDescription > h1').text(LD.branchOffice);
			$('#'+view).find('div.buildingDescription > p').css({'text-align':'justify','margin':'0px 15px 10px 0px'}).text(LD.branchOfficetxt[0]);
			$('#js_tab_branchOffice > b').text(LD.branchOfficetxt[1]);
			$('#js_tab_branchOfficeSoldier > b').text(LD.branchOfficetxt[2]);
			$('#js_tab_branchOfficeTradePartners > b').text(LD.branchOfficetxt[3]);
			$('#js_tab_branchOfficeOwnOffers > b').text(LD.branchOfficetxt[4]);
			if(view==Constant.Buildings.TRADING_POST)
			{
				$('#finder > h3').text(LD.branchOfficetxt[5]);
				$('#finder > div.content > table.search > tbody > tr > td:odd').each(function(k,td){$(td).css('text-align','center').text(LD.branchOfficetxt[k+6])});
				$('#searchResource > option').each(function(i,op)
				{
					$(op).attr('title',LD[Object.values(Constant.Resources)[i+1]+'_']).text(LD[Object.values(Constant.Resources)[i+1]+'_']);
					$('#dropDown_js_searchResourceContainer > div.bg > ul > li[selectvalue="'+$(op).val()+'"] > a').text(LD[Object.values(Constant.Resources)[i+1]+'_']);
				});
				$('#finder > div.content > table:last > tbody > tr:first > th').each(function(k,td)
				{
					if(k==1) { $(td).find('a').css('text-overflow','unset'); }
					if(k%3==($('#finder').find('input[name="type"]:checked').val()=='444'?0:2)) { $(td).text(LD.branchOfficetxt[k+($('#finder').find('input[name="type"]:checked').val()=='444'?0:(k>0?1:0))+10]); } else { $(td).find('a').text(LD.branchOfficetxt[k+($('#finder').find('input[name="type"]:checked').val()=='444'?0:(k>0?1:0))+10]); }
				});
				$('#finder > div.content > table:last > tbody > tr:not(:first,:last)').each(function(k,tr)
				{
//					console.log($(tr).find('td:eq(1)').text());
					if($('#finder').find('input[name="type"]:checked').val()=='444')
					{
						$(tr).find('td:eq(1)').text(function(){return Utils.FormatNumToStr(parseInt($(this).text().replace(/\D+/g,'')),false,0)});
						$(tr).find('td:eq(2)').text(function(){return Utils.FormatNumToStr(parseInt($(this).text().replace(/\D+/g,'')),false,0)});
						var r = $(tr).find('td:eq(3) > img').attr('src').split('_')[1].split('.')[0];
						$(tr).find('td:eq(3) > img').attr({'alt':LD[r+'_'],'title':LD[r+'_']});
						$(tr).find('td:eq(4)')[0].lastChild.textContent = ' '+LD.branchOfficetxt[17];
					}
					else if($('#finder').find('input[name="type"]:checked').val()=='333')
					{
						$(tr).find('td:eq(1)').text(function(){return Utils.FormatNumToStr(parseInt($(this).text().replace(/\D+/g,'')),false,0)});
						var r = $(tr).find('td:eq(2) > img').attr('src').split('_')[1].split('.')[0];
						$(tr).find('td:eq(2) > img').attr({'alt':LD[r+'_'],'title':LD[r+'_']});
						$(tr).find('td:eq(3)')[0].lastChild.textContent = ' '+LD.branchOfficetxt[17];
					}
				});
				if($('#finder > div.content > table:last > tbody > tr').length==2)
				{
					$('#finder > div.content > table:last > tbody > tr:last > td').text(LD.branchOfficetxt[18]);
				}
			}
			else if(view==Constant.Buildings.TRADING_POST+'Soldier')
			{
				$('#tab_branchOfficeTradePartners').find('h3.header').text(LD.branchOfficetxt[5]);
				$('#tab_branchOfficeTradePartners').find('div.content > table:first > tbody > tr > td:eq(0)').text(LD.branchOfficetxt[19]+':');
				$('#tab_branchOfficeTradePartners').find('div.content > table:first > tbody > tr > td:eq(3)').text(LD.branchOfficetxt[8]+':');
				$('#tab_branchOfficeTradePartners').find('div.content > table:first > tbody > tr > td:eq(5)').text(LD.branchOfficetxt[20]+':');
				$('#type').find('option:eq(0)').text(LD.branchOfficetxt[21]);
				$('#dropDown_js_typeContainer').find('li:eq(0) > a').text(LD.branchOfficetxt[21]);
				$('#type').find('option:eq(1)').text(LD.branchOfficetxt[22]);
				$('#dropDown_js_typeContainer').find('li:eq(1) > a').text(LD.branchOfficetxt[22]);
				$('#type + span.dropDownButton > a').text($('#type').find('option:selected').text());
				$('#searchResource > option.allResources').text(LD.branchOfficetxt[23]);
				$('#dropDown_js_searchResourceContainer > div.bg > ul > li.allResources > a').text(LD.branchOfficetxt[23]);
				$('#searchResource > option:not(:first)').each(function(k,op)
				{
					$(op).text(LD[Constant.unitIds[parseInt($(op).val())]]);
					$('#dropDown_js_searchResourceContainer > div.bg > ul > li[selectvalue="'+$(op).val()+'"] > a').text(LD[Constant.unitIds[parseInt($(op).val())]]);
				});
				$('#searchResource + span.dropDownButton > a').text($('#searchResource > option.allResources:selected').text());
				$('#currency > option.allResources').text(LD.branchOfficetxt[24]);
				$('#dropDown_js_currencyContainer > div.bg > ul > li.allResources > a').text(LD.branchOfficetxt[24]);
				$('#currency > option:not(:first)').each(function(k,op)
				{
					$(op).text(LD[(k==0?'plundergold':Object.values(Constant.Resources)[k]+'_')]);
					$('#dropDown_js_currencyContainer > div.bg > ul > li:eq('+(k+1)+') > a').text(LD[(k==0?'plundergold':Object.values(Constant.Resources)[k]+'_')]);
				});
				$('#currency + span.dropDownButton > a').text($('#currency > option.allResources:selected').text());
				$('#searchResult > thead > tr > th').each(function(k,td)
				{
					if(k==1) { $(td).find('a').css('text-overflow','unset'); }
					if(k==6) { $(td).text(LD.branchOfficetxt[k+10]); } else { $(td).find('a').text(LD.branchOfficetxt[k==3?25:(k+10)]); }
				});
				$('#searchResult > tbody > tr:not(:last)').each(function(k,tr)
				{
					$(tr).find('td:eq(1)').text(function(){return Utils.FormatNumToStr(parseInt($(this).text().replace(/\D+/g,'')),false,0)});
					$(tr).find('td:eq(3) > div').attr({'title':LD[Constant.unitIds[parseInt($(tr).find('td:eq(3) > div').attr('class').replace(/\D+/g,''))]]});
					$(tr).find('td:eq(4)')[0].firstChild.textContent = Utils.FormatNumToStr(parseInt($(tr).find('td:eq(4)')[0].firstChild.nodeValue.replace(/\D+/g,'')),false,0)+' ';
					$(tr).find('td:eq(4)')[0].lastChild.textContent = ' '+LD.branchOfficetxt[17];
				});
				if($('#searchResult > tbody > tr').length==1)
				{
					$('#searchResult > tbody > tr:last > td').text(LD.branchOfficetxt[18]);
				}
			}
			else if(view==Constant.Buildings.TRADING_POST+'TradePartners')
			{
				$('#tab_branchOfficeTradePartners > form > div > h3').text(LD.branchOfficetxt[26]);
				$('#tab_branchOfficeTradePartners > form > div > div.content > table:first > tbody > tr > td:eq(0)').text(LD.branchOfficetxt[19]+':');
				$('#tab_branchOfficeTradePartners > form > div > div.content > table:first > tbody > tr > td:eq(3)').text(LD.branchOfficetxt[20]+':');
				$('#type').find('option:eq(0)').text(LD.branchOfficetxt[27]);
				$('#dropDown_js_typeContainer').find('li:eq(0) > a').text(LD.branchOfficetxt[27]);
				$('#type').find('option:eq(1)').text(LD.branchOfficetxt[21]);
				$('#dropDown_js_typeContainer').find('li:eq(1) > a').text(LD.branchOfficetxt[21]);
				$('#type').find('option:eq(2)').text(LD.branchOfficetxt[22]);
				$('#dropDown_js_typeContainer').find('li:eq(2) > a').text(LD.branchOfficetxt[22]);
				$('#type + span.dropDownButton > a').text($('#type').find('option:selected').text());
				$('#searchResource > option.allResources').text(LD.branchOfficetxt[23]);
				$('#dropDown_js_searchResourceContainer').css('height','188px').find('div.bg').css('height','188px').find('ul').css('height','188px').find('li.allResources > a').text(LD.branchOfficetxt[23]);
				$('#searchResource > option:not(:first)').each(function(i,op)
				{
					$(op).attr('title',LD[Object.values(Constant.Resources)[i+1]+'_']).text(LD[Object.values(Constant.Resources)[i+1]+'_']);
					$('#dropDown_js_searchResourceContainer > div.bg > ul > li[selectvalue="'+$(op).val()+'"]').css('height','31px').find('a').text(LD[Object.values(Constant.Resources)[i+1]+'_']);
				});
				$('#searchResource + span.dropDownButton > a').text($('#searchResource > option.allResources:selected').text());
				$('#currency > option.allResources').text(LD.branchOfficetxt[24]);
				$('#dropDown_js_currencyContainer > div.bg > ul > li.allResources > a').text(LD.branchOfficetxt[24]);
				$('#currency > option:not(:first)').each(function(k,op)
				{
					$(op).text(LD[(k==0?'plundergold':Object.values(Constant.Resources)[k]+'_')]);
					$('#dropDown_js_currencyContainer > div.bg > ul > li:eq('+(k+1)+') > a').text(LD[(k==0?'plundergold':Object.values(Constant.Resources)[k]+'_')]);
				});
				$('#currency + span.dropDownButton > a').text($('#currency > option.allResources:selected').text());
				$('#tab_branchOfficeTradePartners > form > div > div.content > table:last > tbody > tr:first > th').each(function(k,td)
				{
					if(k==1) { $(td).find('a').css('text-overflow','unset'); }
					if(k==6) { $(td).text(LD.branchOfficetxt[k+10]); } else { $(td).find('a').text(LD.branchOfficetxt[$('#type').find('option:selected').val()=='resource'&&k==3?27:(k+10)]); }
				});
				$('#tab_branchOfficeTradePartners > form > div > div.content > table:last > tbody > tr:not(:first,:last)').each(function(k,tr)
				{
					$(tr).find('td:eq(1)').text(function(){return Utils.FormatNumToStr(parseInt($(this).text().replace(/\D+/g,'')),false,0)});
					$(tr).find('td:eq(2)').text(function(){return Utils.FormatNumToStr(parseInt($(this).text().replace(/\D+/g,'')),false,0)});
					var r = $(tr).find('td:eq(3) > img').attr('src').split('_')[1].split('.')[0];
					$(tr).find('td:eq(3) > img').attr({'alt':LD[r+'_'],'title':LD[r+'_']});
					$(tr).find('td:eq(4)')[0].firstChild.textContent = Utils.FormatNumToStr(parseInt($(tr).find('td:eq(4)')[0].firstChild.nodeValue.replace(/\D+/g,'')),false,0)+' ';
					$(tr).find('td:eq(4)')[0].lastChild.textContent = ' '+LD.branchOfficetxt[17];
				});
				if($('#tab_branchOfficeTradePartners > form > div > div.content > table:last > tbody > tr').length==2)
				{
					$('#tab_branchOfficeTradePartners > form > div > div.content > table:last > tbody > tr:last > td').text(LD.branchOfficetxt[18]);
				}
			}
			else if(view==Constant.Buildings.TRADING_POST+'OwnOffers')
			{
				$('#branchOfficeOwnOffers').find('form > div > h3').text(LD.branchOfficetxt[4]);
				$('#branchOfficeOwnOffers').find('form > div > div.content > table > tbody > tr').each(function(i,tr)
				{
					if(i==0)
					{
						$(tr).html('<th colspan="2">'+LD.branchOfficetxt[28]+'</th><th>'+LD.branchOfficetxt[29]+'</th><th>'+LD.branchOfficetxt[30]+'</th><th>'+LD.branchOfficetxt[31]+'</th>');
					}
					else
					{
						var r = $(tr).find('td:eq(0) > img').attr('src').split('_')[1].split('.')[0];
						$(tr).find('td:eq(0) > img').attr({'alt':LD[r+'_'],'title':LD[r+'_']});
						$(tr).find('td:eq(1) > div > select[id$="TradeType"] > option:first').text(LD.branchOfficetxt[32]);
						$('#dropDown_js_'+($(tr).find('td:eq(1) > div > select[id$="TradeType"]').attr('id').replace('TradeType',''))+'TradeTypeContainer > div.bg > ul > li:first > a').text(LD.branchOfficetxt[32]);
						$(tr).find('td:eq(1) > div > select[id$="TradeType"] > option:last').text(LD.branchOfficetxt[33]);
						$('#dropDown_js_'+($(tr).find('td:eq(1) > div > select[id$="TradeType"]').attr('id').replace('TradeType',''))+'TradeTypeContainer > div.bg > ul > li:last > a').text(LD.branchOfficetxt[33]);
						$(tr).find('td:eq(1) > div > select[id$="TradeType"] + span.dropDownButton > a').text($(tr).find('td:eq(1) > div > select[id$="TradeType"] > option:selected').text());
						$(tr).find('td:eq(3)')[0].lastChild.textContent = ' '+LD.branchOfficetxt[17];
						$(tr).find('td:eq(4)').css('text-align','center').text(function(){return $(this).text().replace(/\s{2,}/g,' ')});
					}
				});
				$('#branchOfficeOwnOffers').find('form > div > div.content > p')[0].firstChild.textContent = LD.branchOfficetxt[34]+': ';
				$('#reservedGold').hide().after('<span id="empire_reservedGold">'+Utils.FormatNumToStr(parseInt($('#reservedGold').text().replace(/\D+/g,'')),false,0)+'</span>');
				var max = parseInt(database.getGlobalData.finance.currentGold);
				$('#js_resourceTradeTypeContainer,#dropDown_js_resourceTradeTypeContainer,#resource,#tradegood1,#tradegood2,#tradegood3,#tradegood4, #tradegood1Price, #tradegood2Price,#tradegood3Price,#tradegood4Price').on('blur change click dblclick focus focusin focusout keydown keypress keyup mousedown mouseenter mouseleave mousemove mouseout mouseover mouseup select textInput',function(e)
				{
					setTimeout(function(){$('#empire_reservedGold').text(Utils.FormatNumToStr($('#reservedGold').text().replace(/\D+/g,''),false,0));},100);
				});
				$('#branchOfficeOwnOffers').find('form > div > div.content > div.centerButton > input').val(LD.branchOfficetxt[35]);
			}
//			console.log(view);
//			console.log(LD.branchOfficetxt);
			render.toast(Utils.format('{0}: {1} {2} {3} {4}',[LD.updated_,LD[view],LD.tothe,LD[city.isCapital?'capital':'colony'],LD.leftquot+city._name+LD.rightquot]));
		},
		parseTakeOffer: function(view,html,data)
		{
			var LD = Constant.LanguageData[database.settings.languageChange.value];
			var city = ikariam.getCurrentCity;
			$('#js_mainBoxHeaderTitle').text(LD.takeoffertxt[0]);
			$('#mission > div.buildingDescription > h1').text(LD.takeoffertxt[0]);
			// Για ολοκλήρωση
//			$('#mission > div.buildingDescription > p').text(LD.takeoffertxt[1]);
//			console.log($('#transportForm > input[name="function"]').val(),$('#transportForm > input[name="type"]').val());
//			console.log(view);
//			console.log(data);
//			console.log(unsafeWindow);
//			console.log(html);
//			console.log(ikariam);
//			console.log(LD.takeoffertxt);
			render.toast(Utils.format('{0}: {1} {2} {3} {4}',[LD.updated_,LD.takeoffertxt[0],LD.tothe,LD[city.isCapital?'capital':'colony'],LD.leftquot+city._name+LD.rightquot]));
		},
		parseWall: function(view)
		{
			var LD = Constant.LanguageData[database.settings.languageChange.value];
			var city = ikariam.getCurrentCity;
			$('#js_mainBoxHeaderTitle').text(LD.wall);
			$('#wall').find('div.buildingDescription > h1').text(LD.wall);
			$('#wall').find('div.buildingDescription > p').css({'text-align':'justify','margin':'0px 15px 10px 0px'}).text(LD.walltxt[0]);
			$('#wall').find('div.buildingDescription + div > h3.header').text(LD.walltxt[1]);
			$('#wall').find('div.weapon > div.bold').text(LD.walltxt[2].split('|')[Math.floor(city.getBuildingFromName(view).getLevel/10)>2?2:Math.floor(city.getBuildingFromName(view).getLevel/10)]);
			$('#wall').find('div.weapon > div.bold + div > div').text(LD.walltxt[3]);
			$('#wall').find('div.weapon > div.bold + div > b').text(function(){return Utils.FormatNumToStr(parseInt($(this).text().replace(/\D+/g,'')),false,0)});
			$('#wall').find('div.weapon > div.bold + div + div > div:first').text(LD.walltxt[4]);
			$('#wall').find('div.weapon + div > div').text(LD.walltxt[5]);
			$('#wall').find('div.weapon + div > b').text(function(){return Utils.FormatNumToStr(parseInt($(this).text().replace(/\D+/g,'')),false,0)});
			$('#wall').find('div.weapon + div + div > div').text(LD.walltxt[6]);
			$('#wall').find('div.weapon + div + div > b').text(function(){return Utils.FormatNumToStr(parseInt($(this).text().replace(/\D+/g,'')),false,0)});
			$('#wall').find('div.weapon + div + div + div > div').text(LD.walltxt[7]);
			$('#wall').find('div.weapon + div + div + div > b').text(function(){return Utils.FormatNumToStr(parseInt($(this).text().replace(/\D+/g,'')),false,0)});
//			console.log(data);
			render.toast(Utils.format('{0}: {1} {2} {3} {4}',[LD.updated_,LD.wall,LD.tothe,LD[city.isCapital?'capital':'colony'],LD.leftquot+city._name+LD.rightquot]));
		},
		parseWonder: function(data)
		{
			var LD = Constant.LanguageData[database.settings.languageChange.value];
			var city = ikariam.getCurrentCity;
			var durs = [[86400,604800],[57600,345600],[129600,777600],[86400,604800],[14400,86400],[43200,259200],[14400,86400],[0,259200]];
			$('#js_mainBoxHeaderTitle').text(LD.wondertxt[13]);
			$('#wonder').find('div.buildingDescription > h1').text(LD.wondertxt[13]);
			$('#wonderBox85h').prev('h3').text(LD.wondertxt[14]);
			var wid = parseInt($('div.wonder_desc').attr('class').replace(/\D+/g,'')) || 0;
			$('div.wonder_desc').parent().prev('h3.header').text(LD.wonders[wid].replace('<br>',' '));
			$('div.wonder_desc > p:first').html(LD.wonderstxt[wid-1][0]);
			$('div.wonder_desc > p:last').css('text-align','justify').text(LD.wonderstxt[wid-1][1]);
			$('div.wonder_desc > table > tbody > tr').each(function(k,tr)
			{
				if(k==0)
				{
					$(tr).html('<th>'+LD.wondertxt[15]+'</th><th>'+LD.wondertxt[16]+'</th><th>'+LD.wondertxt[17]+'</th><th>'+LD.wondertxt[18]+'</th>');
				}
				else
				{
					$(tr).find('td:eq(0)').css('text-align','center');
					$(tr).find('td:eq(1)').css('text-align','justify').html(LD.wonderstxt[wid-1][k+2]);
					$(tr).find('td:eq(2)').css('text-align','center').text(durs[wid-1][0]>0?Utils.FormatTimeLengthToStr(durs[wid-1][0]*1000,4):LD.wondertxt[19]);
					$(tr).find('td:eq(3)').css('text-align','center').text(Utils.FormatTimeLengthToStr(durs[wid-1][1]*1000,4));
				}
			});
			$('#wonderOtherPlayers').parent().prev('h3.header').text(LD.wondertxt[20]);
			$('#wonderOtherPlayers').find('div > table > tbody > tr').each(function(k,tr)
			{
				if(k==0)
				{
					$(tr).find('th').each(function(i,th)
					{
						if(i==0 || i==2)
						{
							$(th).find('a').text(LD.wondertxt[i+21]);
						}
						else
						{
							$(th).html(LD.wondertxt[i+21]);
						}
					});
				}
			});
//			console.log(LD.wonders[wid].replace('<br>',' '));
//			console.log(JSON.parse(data.load_js.params));
//			console.log(LD.wondertxt);
			var flvl = parseInt($('div#wonderLevelDisplay').text().trim()) || 0;
			var cf = parseInt($('#wonderBarPos').attr('class').split(' ').pop().replace(/\D+/g,'')) || 0;
			var wf = parseFloat(parseInt($('#wonderbeliefinfo').css('left')) / 500);
			var don = parseInt($('#wonderOtherPlayers > div > table > tbody > tr.own > td:nth-child(3)').text().replace(',',''));
			wf = wf>=0 ? wf : 0;
			var maxs = 0;
			$('#wonderOtherPlayers > div > table > tbody > tr:not(:first)').each(function(k,tr)
			{
				$(tr).find('td:eq(0)').css('white-space','nowrap');
				$(tr).find('td:eq(1)').css('white-space','nowrap');
				$(tr).find('td:eq(6) > a').text(LD.temple);
				$(tr).find('td:eq(7) > a').attr('title',LD.CompMsg).find('img').attr({'alt':LD.CompMsg,'title':LD.CompMsg});
				if(ikariam.viewIsIsland && database.settings.ctfinder.value)
				{
					var uid = $(tr).find('td:nth-child(1) > a').attr('href').split('&')[1].replace(/\D+/g,'');
					if($(tr).find('td:nth-child(1) > a').html()!='&nbsp;')
					{
						if(Object.keys(database.getGlobalData.getMuseumTreaties).indexOf(uid)!=-1)
						{
							$(tr).find('td:nth-child(1) > a').after('<img src="skin/museum/icon32_culturalgood.png" style="width:15px;height:auto;float:right" title="'+LD.ctenabled+'">');
						}
						else if(Object.keys(database.getGlobalData.getPotMuseumTreaties).indexOf(uid)!=-1)
						{
							$(tr).find('td:nth-child(1) > a').after('<img src="skin/museum/icon32_culturalgood.png" style="width:15px;height:auto;opacity:0.5;float:right" title="'+LD.ctrequested[database.getGlobalData.getPotMuseumTreaties[uid].type*0.5-39]+'">');
						}
					}
				}
				for(var i=3;i<=6;i++)
				{
					var td = $(tr).children('td:nth-child('+i+')');
					var img = i==3 ? $(td).children('img') : '';
					var sx = i>4 ? '%' : '';
					maxs += i==6 ? parseFloat($(td).text())/100 : 0;
					$(td).html(!isNaN(parseFloat($(td).text().replace(',','')))?Utils.FormatNumToStr(parseFloat($(td).text().replace(',','')),false,0)+sx+' ':'').append(img);
				}
			});
			if(ikariam.viewIsCity)
			{
				var changed = city.updateWonder({donatedResources:don});
				$('#wonderbeliefinfo').css('left',(city.getWonder.curislandfaith*500)+'px');
				$('#wonderBarBelief').css('width',(city.getWonder.curislandfaith*500+12)+'px');
				$('div#wonderLevelDisplay').text(city.getWonder.faithlevel);
			}
			if(ikariam.viewIsIsland)
			{
				var changed = city.updateWonder({id:wid,level:cf,donatedResources:don,faithlevel:flvl,curislandfaith:wf,maxislandfaith:maxs});
			}
			events(Constant.Events.CITY_UPDATED).pub(city.getId,changed);
			$('#wonderBeliefTooltip').text(Utils.format(LD.wonderBeliefTooltip,[Utils.FormatNumToStr(city.getWonder.curislandfaith*100.41,false,2)]));
			$('#wonderBeliefInfo2').attr('class',(city.getWonder.curislandfaith<=0.5 ? 'right' : 'left')+'Info').css({'white-space':'nowrap','left':(city.getWonder.curislandfaith<=0.5 ? 24 : -237)+'px'}).text(Utils.format(LD.wonderBeliefInfo2,[Utils.FormatNumToStr(city.getWonder.curislandfaith*100.41,false,2)]));
			$('#sidebarWidget > li > a')[0].firstChild.textContent = LD.wondertxt[0];
			$('#js_buildingUpgrade > div:eq(0)').text(LD.wondertxt[1]);
			$('#js_buildingUpgrade > div:eq(2)')[0].firstChild.textContent = LD.wondertxt[2]+':';
			$('#js_buildingNotUpgrade > div:eq(0) > p:first').text(LD.wondertxt[3]+':');
			$('#maxLevelNotReached > h4:eq(0)').text(LD.wondertxt[4]+':');
			$('#js_donateNextLevel').prev('span.accesshint').text(LD.wondertxt[12]+':');
			$('#maxLevelNotReached > h4:eq(1)').text(LD.wondertxt[5]+':');
			$('#js_donatedResources').prev('span.accesshint').text(LD.wondertxt[6]+':');
			$('#donate > label').text(LD.wondertxt[7]+':');
			$('#donate > div:not(:last) > a').attr('title',LD.wondertxt[8]).text(LD.wondertxt[9]);
			$('#donate > div:last > input').val(LD.wondertxt[10]);
			$('#maxLevelReached > h4').text(LD.wondertxt[11]);
			var dur = [1200,1800,2700,3600];
			var donated = parseInt($('#js_donatedResources').text().replace(/\D+/g,''));
			var required = parseInt($('#js_donateNextLevel').text().replace(/\D+/g,''));
			$('#js_donateNextLevel').addClass('empiretooltip').html(Utils.FormatNumToStr(required,false,0)+'<div class="tooltip-div" style="color:black">'+Utils.FormatQuantityToLoad(required)+'</div>').after('<span id="empire_reqdur" style="color:green;position:absolute;right:10px">('+Utils.FormatTimeLengthToStr(dur[data.nextWonderLevel-2]*1000,3)+')</span>');
			$('#js_donatedResources').addClass('empiretooltip').html(Utils.FormatNumToStr(donated,false,0)+'<div class="tooltip-div" style="color:black">'+Utils.FormatQuantityToLoad(donated)+'</div>').after('<span id="empire_dondiff" class="empiretooltip" style="color:red;position:absolute;right:10px">('+Utils.FormatNumToStr(donated-required,false,0)+')<div class="tooltip-div" style="color:black">'+Utils.FormatQuantityToLoad(required-donated)+'</div></span>');
			$('[id^="tradegood"]').css({'text-align':'center','font-weight':'bold'});
			if(JSON.parse(data.load_js.params).endUpgradeTime!=undefined)
			{
				var enddate = JSON.parse(data.load_js.params).endUpgradeTime;
				$('#js_wonderUpgradeCountDown').hide().after('<div id="empire_wonderUpgradeCountDown" class="smallFont">'+Utils.FormatFullTimeToDateString(enddate*1000)+'<br>(<span>'+Utils.FormatTimeLengthToStr(moment()-enddate*1000)+'</span>)</div>');
				var wonderinterv = setInterval(function()
				{
					$('#empire_wonderUpgradeCountDown > span').text(Utils.FormatTimeLengthToStr(moment()-enddate*1000));
					if(enddate*1000<moment()) { clearInterval(wonderinterv); }
				},1000);
			}
//			console.log($('[id^="tradegood"]'));
			render.toast(Utils.format('{0}: {1}',[LD.updated_,LD.wonders[wid]]));
		},
		parseTemple: function(view,data)
		{
			var LD = Constant.LanguageData[database.settings.languageChange.value];
			var city = ikariam.getCurrentCity;
			var durs = [[86400,604800],[57600,345600],[129600,777600],[86400,604800],[14400,86400],[43200,259200],[14400,86400],[0,259200]];
			var faith = [0,0,0,0,0,0,0,0];
			$.each(database.cities,function(k,c) { faith[c.getWonder.id-1] += parseInt(c.getWonder.faithlevel); });
			$.each(faith,function(k,f){durs[k][1]=(f>5?(5/f):1)*(1-(database.getGlobalData.getGovernmentType==Constant.Government.THEOCRACY?0.2:0))*durs[k][1];});
			$('#js_mainBoxHeaderTitle').text(LD[view]);
			$('#temple').find('div.buildingDescription > h1').text(LD[view]);
			$('#temple').find('div.buildingDescription > p').css({'text-align':'justify','margin':'0px 15px 10px 0px'}).text(LD.templetxt[0]);
			$('#wonderBox85h').prev('h3').text(LD.templetxt[1]);
			$('#wonderBeliefTooltip').text(function(){return Utils.format(LD.templetxt[2],[Utils.FormatNumToStr(parseFloat($(this).text().match(/-?\d+([,.]?\d+)?/g)[0]),false,2)]);});
			var currfaith = parseFloat($('#wonderBeliefInfo2').text().match(/-?\d+([,.]?\d+)?/g)[0]);
			$('#wonderBeliefInfo2').attr('class',(currfaith<=0.5 ? 'right' : 'left')+'Info').css({'white-space':'nowrap','left':(currfaith<=0.5 ? 24 : -237)+'px'}).text(function(){return Utils.format(LD.templetxt[3],[Utils.FormatNumToStr(currfaith,false,2)]);});
			$('#setPriests').find('h3.header').text(LD.templetxt[4]);
			$('#valueCitizens').text(function(){return Utils.FormatNumToStr(parseInt($(this).text().replace(/\D+/g,'')),false,0)});
			$('#valuePriests').text(function(){return Utils.FormatNumToStr(parseInt($(this).text().replace(/\D+/g,'')),false,0)});
			$('#ownConversion').text(function(){return Utils.FormatNumToStr(parseInt($(this).text().replace(/\D+/g,''))/100,false,2)}).parent()[0].firstChild.textContent = LD.templetxt[5]+': ';
			$('#ownConversion').parent()[0].lastChild.textContent = ' %';
			$('#conversionIsland').text(function(){return Utils.FormatNumToStr(parseInt($(this).text().replace(/\D+/g,''))/100,false,2)}).parent()[0].firstChild.textContent = LD.templetxt[6]+': ';
			$('#conversionIsland').parent()[0].lastChild.textContent = ' %';
			$('#valueWorkCosts').text(function(){return Utils.FormatNumToStr(parseInt($(this).text().replace(/(\d+)/g,'$1')),false,0)}).prev('span.smallFont').text(LD.templetxt[7]);
			$('#valueWorkCosts + img').attr({'alt':LD.plundergold,'title':LD.plundergold}).next('span.timeUnit').text(LD.templetxt[8]);
			$('#sliderbg_temple').attr('title',function()
			{
				var val = parseInt($(this).attr('title').replace(/\D+/g,''));
				var changed = city.updatePriests(val);
				events(Constant.Events.CITY_UPDATED).pub(city,{priests:changed});
				return Utils.format(LD.templetxt[val==0?11:(val==1?10:9)],[Utils.FormatNumToStr(val,false,0)]);
			});
			$('#js_TempleSlider > a.setMin').attr('title',LD.templetxt[11]);
			$('#js_TempleSlider > a.setMax').attr('title',LD.templetxt[12]);
			$('#sliderbg_temple,a.setMin,a.setMax,#inputPriests').on('blur change click dblclick drag focus focusin focusout keydown keypress keyup mousedown mouseenter mouseleave mousemove mouseout mouseover mouseup select textInput',function()
			{
				$('#valueCitizens').text(function(){return Utils.FormatNumToStr(parseInt($(this).text().replace(/\D+/g,'')),false,0)});
				$('#valuePriests').text(function(){return Utils.FormatNumToStr(parseInt($(this).text().replace(/\D+/g,'')),false,0)});
				$('#ownConversion').text(function(){return Utils.FormatNumToStr(parseInt($(this).text().replace(/\D+/g,''))/100,false,2)});
				$('#conversionIsland').text(function(){return Utils.FormatNumToStr(parseInt($(this).text().replace(/\D+/g,''))/100,false,2)});
				$('#valueWorkCosts').text(function(){return Utils.FormatNumToStr(parseInt($(this).text().replace(/(\d+)[,.](?=\d{3}(\D|$))/g,'$1')),false,0)});
				$('#sliderbg_temple').attr('title',function()
				{
					var val = parseInt($(this).attr('title').replace(/\D+/g,''));
					return Utils.format(LD.templetxt[val==0?11:(val==1?10:9)],[Utils.FormatNumToStr(val,false,0)]);
				});
			});
			$('#inputWorkersSubmit').val(LD.templetxt[13]);
			$('form#setPriests + div').find('h3.header').text(LD.templetxt[14]);
			var wid = parseInt($('#js_WonderTextHead').parent().attr('class').split(' ').pop().replace(/\D+/g,'')) || 0;
			var flvl = parseInt($('div#wonderLevelDisplay').text().trim()) || 0;
			$('#js_WonderTextHead').text(flvl==0?LD.wonders[wid].replace('<br>',' '):$('#js_WonderTextDuration').length==1?LD.wonders[wid].replace('<br>',' '):Utils.format(LD.templetxt[15],[LD.wonders[wid].replace('<br>',' '),flvl,$('#wonderBarBelief').attr('class').split(' ').pop().replace(/\D+/g,'')]));
			$('#js_WonderTextDesc').css('text-align','justify').html(LD.wonderstxt[wid-1][flvl==0?1:($('#js_WonderTextDuration').length==1||$('#js_WonderTextCooldown').length==1?1:0)]);
			$('#js_WonderTextEffect').css('text-align','justify').html(LD.wonderstxt[wid-1][flvl+2]);
			if(flvl==0)
			{
				$('#js_WonderTextDurationText,#js_WonderTextCooldownText').empty();
			}
			else if(flvl>0 && $('#js_WonderTextDuration').length==0 && $('#js_WonderTextCooldown').length==0)
			{
				$('#js_WonderTextDurationText').html(Utils.format(LD.templetxt[16],[Utils.FormatTimeLengthToStr(durs[wid-1][0]*1000,4)]));
				$('#js_WonderTextCooldownText').html(Utils.format(LD.templetxt[17],[Utils.FormatTimeLengthToStr(durs[wid-1][1]*1000,4)]));
			}
			else if(flvl>0 && $('#js_WonderTextDuration').length==1 && $('#js_WonderTextCooldown').length==0 && data.js_WonderTextDuration.countdown.enddate)
			{
				$('#js_WonderTextDurationText')[0].childNodes[0].textContent = LD.templetxt[18]+' ';
				$('#js_WonderTextDurationText')[0].childNodes[2].textContent = '';
				if(data.js_WonderTextDuration.countdown.enddate)
				{
					var remaintime = data.js_WonderTextDuration.countdown.enddate*1000-moment();
					var elapsedtime = durs[wid-1][0]*1000-remaintime;
					$('#js_WonderTextDuration').hide().after('<span id="empire_WonderTextDuration" style="font-weight:bold">'+Utils.FormatTimeLengthToStr(remaintime,4)+'</span>');
					$('#js_WonderTextDurationText').hide().after('<div style="margin:0 auto;text-align:center;font-weight:bold">'+LD.templetxt[18]+'<div id="empire_WonderTextDurationText" class="progressbar" style="width:200px;height:16px;margin:0 auto;text-align:center;font-weight:bold" title="'+Utils.FormatNumToStr(100-(100*elapsedtime/(durs[wid-1][0]*1000)),false,2)+' %"><div class="bar" style="width:'+(100*elapsedtime/(durs[wid-1][0]*1000))+'%;height:16px;" title="'+Utils.FormatNumToStr(100*elapsedtime/(durs[wid-1][0]*1000),false,2)+' %"></div><div style="display:table;margin:0px auto 0px auto;font-weight:bold;text-shadow: -1px -1px 0 #FFFFFF, 1px -1px 0 #FFFFFF, -1px 1px 0 #FFFFFF, 1px 1px 0 #FFFFFF;text-align:center;position:relative;top:-15px;margin-bottom:-18px">'+Utils.FormatNumToStr(100*elapsedtime/(durs[wid-1][0]*1000),false,2)+' %</div></div><span style="font-weight:bold">'+Utils.FormatFullTimeToDateString(data.js_WonderTextDuration.countdown.enddate*1000)+'</span><br>(<span id="empire_WonderDuration" style="font-weight:bold">'+Utils.FormatTimeLengthToStr(data.js_WonderTextDuration.countdown.enddate*1000-moment(),4)+'</span>)</div>');
					var durinterv = setInterval(function()
					{
						remaintime = data.js_WonderTextDuration.countdown.enddate*1000-moment();
						elapsedtime = durs[wid-1][0]*1000-remaintime;
						$('#empire_WonderTextDuration').text(Utils.FormatTimeLengthToStr(remaintime,4));
						$('#empire_WonderTextDurationText').attr('title',Utils.FormatNumToStr(100-(100*elapsedtime/(durs[wid-1][0]*1000)),false,2)+' %').find('div.bar').css('width',(100*elapsedtime/(durs[wid-1][0]*1000))+'%').attr('title',Utils.FormatNumToStr(100*elapsedtime/(durs[wid-1][0]*1000),false,2)+' %').next('div').text(Utils.FormatNumToStr(100*elapsedtime/(durs[wid-1][0]*1000),false,2)+' %');
						$('#empire_WonderDuration').text(Utils.FormatTimeLengthToStr(data.js_WonderTextDuration.countdown.enddate*1000-moment(),4));
						if(remaintime<0) { $('#empire_WonderTextDurationText').parent().remove(); clearInterval(durinterv); }
					},1000);
				}
				$('td.city_name > span.clickable, td.building > span.clickable, div.city, div.temple, div.pirates, div.spies, div.barracks, div.shipyard, div#HelpTab > span[id^="help"], span.happy, span.growth, span.scientists, [id^="position"], #dropDown_js_citySelectContainer, #js_buildingUpgradeButton').on('click',function(){clearInterval(durinterv);clearInterval(coolinterv);});
			}
			else if(flvl>0 && $('#js_WonderTextDuration').length==0 && $('#js_WonderTextCooldown').length==1 && data.js_WonderTextCooldown.countdown.enddate)
			{
				$('#js_WonderTextCooldownText')[0].childNodes[0].textContent = LD.templetxt[19]+' ';
				if(data.js_WonderTextCooldown.countdown.enddate)
				{
					var remaintime = data.js_WonderTextCooldown.countdown.enddate*1000-moment();
					var elapsedtime = durs[wid-1][1]*1000-remaintime;
					$('#js_WonderTextCooldown').hide().after('<span id="empire_WonderTextCooldown" style="font-weight:bold">'+Utils.FormatTimeLengthToStr(remaintime,4)+'</span>');
					$('#js_WonderTextCooldownText').hide().after('<div style="margin:0 auto;text-align:center;font-weight:bold">'+LD.templetxt[19]+'<div id="empire_WonderTextCooldownText" class="progressbar" style="width:200px;height:16px;margin:0 auto;text-align:center;font-weight:bold" title="'+Utils.FormatNumToStr(100-(100*elapsedtime/(durs[wid-1][1]*1000)),false,2)+' %"><div class="bar" style="width:'+(100*elapsedtime/(durs[wid-1][1]*1000))+'%;height:16px;" title="'+Utils.FormatNumToStr(100*elapsedtime/(durs[wid-1][1]*1000),false,2)+' %"></div><div style="display:table;margin:0px auto 0px auto;font-weight:bold;text-shadow: -1px -1px 0 #FFFFFF, 1px -1px 0 #FFFFFF, -1px 1px 0 #FFFFFF, 1px 1px 0 #FFFFFF;text-align:center;position:relative;top:-15px;margin-bottom:-18px">'+Utils.FormatNumToStr(100*elapsedtime/(durs[wid-1][1]*1000),false,2)+' %</div></div><span style="font-weight:bold">'+Utils.FormatFullTimeToDateString(data.js_WonderTextCooldown.countdown.enddate*1000)+'</span><br>(<span id="empire_WonderCooldown" style="font-weight:bold">'+Utils.FormatTimeLengthToStr(data.js_WonderTextCooldown.countdown.enddate*1000-moment(),4)+'</span>)</div>');
					var coolinterv = setInterval(function()
					{
						remaintime = data.js_WonderTextCooldown.countdown.enddate*1000-moment();
						elapsedtime = durs[wid-1][1]*1000-remaintime;
						$('#empire_WonderTextCooldown').text(Utils.FormatTimeLengthToStr(remaintime,4));
						$('#empire_WonderTextCooldownText').attr('title',Utils.FormatNumToStr(100-(100*elapsedtime/(durs[wid-1][1]*1000)),false,2)+' %').find('div.bar').css('width',(100*elapsedtime/(durs[wid-1][1]*1000))+'%').attr('title',Utils.FormatNumToStr(100*elapsedtime/(durs[wid-1][1]*1000),false,2)+' %').next('div').text(Utils.FormatNumToStr(100*elapsedtime/(durs[wid-1][1]*1000),false,2)+' %');
						$('#empire_WonderCooldown').text(Utils.FormatTimeLengthToStr(data.js_WonderTextCooldown.countdown.enddate*1000-moment(),4));
						if(remaintime<0) { $('#empire_WonderTextCooldownText').parent().remove(); clearInterval(coolinterv); }
					},1000);
					
				}
				$('td.city_name > span.clickable, td.building > span.clickable, div.city, div.temple, div.pirates, div.spies, div.barracks, div.shipyard, div#HelpTab > span[id^="help"], span.happy, span.growth, span.scientists, [id^="position"], #dropDown_js_citySelectContainer, #js_buildingUpgradeButton').on('click',function(){clearInterval(durinterv);clearInterval(coolinterv);});
			}
			$('#js_WonderViewButton').removeAttr('href onclick').after(' <a id="js_WonderViewButton2" class="button">'+LD.wonderViewButton2+'</a>').on('click',function()
			{
				var city = ikariam.getCurrentCity;
				ikariam.loadUrl(true,null,{view:'island',dialog:'wonder',islandId:city.getIslandID});
				return false;
			}).removeClass('button_disabled').html(LD.wonderViewButton).show();
			var cf = parseInt($('#wonderBarPos').attr('class').split(' ').pop().replace(/\D+/g,'')) || 0;
			var wf = (500-(parseInt($('#wonderBarLevel').width()) - parseInt($('#wonderBarBelief').width()))) / 500;
			var is = parseFloat($('#conversionIsland').text().replace(',','.')) / 100;
			$('#js_WonderActivateButton').html(LD.wonderActivateButton).on('click',function()
			{
				clearInterval(durinterv);
				var changed = city.updateWonder({id:wid,level:cf,faithlevel:flvl,curislandfaith:wf,islandshare:is,submittime:$.now()});
				events(Constant.Events.CITY_UPDATED).pub(city.getId,changed);
			});
			$('#js_WonderViewButton2').on('click',function()
			{
				var city = ikariam.getCurrentCity;
				ikariam.loadUrl(true,null,{view:'city',cityId:city.getId,dialog:'wonder',islandId:city.getIslandID});
				return false;
			});
			$('#js_WonderViewButton2 + a').html(LD.wonderActivateButton);
			$('#js_WonderViewButton').before('<div id="empire_wonderbuttons" class="centerButton" style="margin:0 auto"></div>');
			$('#js_WonderViewButton,#js_WonderViewButton2,#js_WonderActivateButton').appendTo('#empire_wonderbuttons');
			var changed = city.updateWonder({id:wid,level:cf,faithlevel:flvl,curislandfaith:wf,islandshare:is});
			events(Constant.Events.CITY_UPDATED).pub(city.getId,changed);
//			console.log(view);
//			console.log(data);
			render.toast(Utils.format('{0}: {1} {2} {3} {4}',[LD.updated_,LD.temple,LD.tothe,LD[city.isCapital?'capital':'colony'],LD.leftquot+city._name+LD.rightquot]));
		},
		parseMilitaryAdvisor: function(view,html,data)
		{// militaryAdvisor,militaryAdvisorCombatList,militaryAdvisorWarList
			var LD = Constant.LanguageData[database.settings.languageChange.value];
			$('#sidebar').hide();
//			console.log(view);
//			console.log(data);
			console.log(unsafeWindow);
			console.log(unsafeWindow.ikariam);
			var city = ikariam.getCurrentCity;
			$('#js_mainBoxHeaderTitle').html(LD.military);
			$('#'+view).find('div.buildingDescription > h1').html(LD.military);
			$('#js_tab_militaryAdvisor > b').html(function(){return Utils.format(LD.militarytxt[0],[Utils.FormatNumToStr(parseInt($(this).text().replace(/\D+/g,'')),false,0)]);});
			$('#js_tab_militaryAdvisorCombatList > b').html(function(){return Utils.format(LD.militarytxt[1],[Utils.FormatNumToStr(parseInt($(this).text().replace(/\D+/g,'')),false,0)]);});
			$('#js_tab_militaryAdvisorWarList > b').html(LD.militarytxt[2]);
			if(view=='militaryAdvisor')
			{
				$('#js_MilitaryMovementsCombatsInProgress > h3').html(LD.militarytxt[3]);
				// $('#js_MilitaryMovementsCombatList')
				$('#js_MilitaryMovementsFleetMovements > h3').html(LD.militarytxt[4]);
				var movlib = {
					hostileMissions: [6,7,9,13,17],	// Κωδικοί αριθμοί εχθρικών αποστολών
					missionStates:
					{
						unknown:0,					// Πειρατεία
						outgoing:1,					// Εξερχόμενη αποστολή (π.χ. Φόρτωση)
						incoming:2,					// Εισερχόμενη αποστολή
						execute:3					// ?????
					},
					missions:
					{
						transport:1,				// Μεταφορά
						sell:2,						// Πώληση
						buy:3,						// Αγορά
						colonization:4,				// Αποικισμός
						defendPort:5,				// Υπεράσπιση λιμένα
						blockade:6,					// Αποκλεισμός λιμένα
						plundering:7,				// Λεηλασία
						defendCity:8,				// Υπεράσπιση πόλης
						occupyCity:9,				// Κατάληψη πόλης
						deployArmy:11,				// Μεταφορά στρατού
						deployFleet:12,				// Μεταφορά στόλου
						attackBarbarianVillage:13,	// Επίθεση βαρβαρικού χωριού
						piracyRaid:16,				// Πειρατεία
						attackBarbarianFleet:17		// Επίθεση βαρβαρικού στόλου
					}
				};
				var tp = [];
				$.ajax({
					success: function()
					{
						$('#militaryMovementsFleetMovementsFilters > div.missionFilter').each(function(k,dv)
						{
							if(k==0)
							{
								$(dv).find('div.mission_icon').html(LD.militarytxt[5]);
							}
							tp.push($(dv).attr('data-filter'));
							$(dv).find('div.amount').html(function(){return Utils.FormatNumToStr(parseInt($(this).text().replace(/\D+/g,'')),false,0);});
							$(dv).on('click',function()
							{
								$.ajax({
									success: function()
									{
										$('#js_MilitaryMovementsFleetMovementsTable > table > tbody > tr').each(function(k,tr)
										{
											if(k==0)
											{
												$(tr).html(Utils.format('<th class="center">{0}</th><th style="width: 65px;">{1}</th><th style="width: 36px;"><img src="skin/premium/premium_jet_s.png" height="12" width="36" title="{2}" alt="{2}"></th><th colspan="2">{3}</th><th>{4}</th><th></th><th>{5}</th><th class="militaryAdvisorActions">{6}</th>',[LD.militarytxt[6],LD.militarytxt[7],LD.militarytxt[8],LD.militarytxt[9],LD.militarytxt[10],LD.militarytxt[11],LD.militarytxt[12]]));
											}
											else
											{
												if($(tr).find('td').length==1)
												{
													$(tr).find('td').attr('colspan',9).html(LD.militarytxt[13]);
												}
												else
												{
													
												}
//												console.log(unsafeWindow.ikariam.TemplateView.viewScripts.militaryAdvisor.militaryMovementsFleetMovements);
											}
										});
									}
								});
							});
						});
						$('#js_MilitaryMovementsFleetMovementsTable > table > tbody > tr').each(function(k,tr)
						{
							if(k==0)
							{
								$(tr).html(Utils.format('<th class="center">{0}</th><th style="width: 65px;">{1}</th><th style="width: 36px;"><img src="skin/premium/premium_jet_s.png" height="12" width="36" title="{2}" alt="{2}"></th><th colspan="2">{3}</th><th>{4}</th><th></th><th>{5}</th><th class="militaryAdvisorActions">{6}</th>',[LD.militarytxt[6],LD.militarytxt[7],LD.militarytxt[8],LD.militarytxt[9],LD.militarytxt[10],LD.militarytxt[11],LD.militarytxt[12]]));
							}
							else
							{
								if($(tr).find('td').length==1)
								{
									$(tr).find('td').attr('colspan',9).html(LD.militarytxt[13]);
								}
								else
								{

								}
//								console.log(unsafeWindow.ikariam.TemplateView);
//								console.log(unsafeWindow.ikariam.TemplateView.viewScripts.militaryAdvisor.militaryMovementsFleetMovements.movements[0]);
//								console.log(JSON.stringify(unsafeWindow.ikariam.TemplateView.viewScripts.militaryAdvisor.militaryMovementsFleetMovements.movements[0]));
							}
						});
//						console.log(tp);
					}
				});
				$('#js_MilitaryMovementsOccupiedCities > h3').html(LD.palacetxt[8]);
				$('#js_MilitaryMovementsOccupiedCitiesTable > table > tbody > tr:first').html('<th class="crown"></th><th>'+LD.city+'</th><th>'+LD.level+'</th><th>'+LD.island+'</th><th>'+LD.luxres+'</th><th>'+LD.action+'</th>');
				if($('#js_MilitaryMovementsOccupiedCitiesTable > table > tbody > tr').length==2)
				{
					$('#js_MilitaryMovementsOccupiedCitiesTable > table > tbody > tr:last > td').attr('colspan',6).html(LD.palacetxt[10]);
				}
				$('#js_MilitaryMovementsOccupiedPorts > h3').html(LD.palacetxt[9]);
				$('#js_MilitaryMovementsOccupiedPortsTable > table > tbody > tr:first').html('<th class="crown"></th><th>'+LD.city+'</th><th>'+LD.level+'</th><th>'+LD.island+'</th><th>'+LD.luxres+'</th><th>'+LD.action+'</th>');
				if($('#js_MilitaryMovementsOccupiedPortsTable > table > tbody > tr').length==2)
				{
					$('#js_MilitaryMovementsOccupiedPortsTable > table > tbody > tr:last > td').attr('colspan',6).html(LD.palacetxt[11]);
				}
			}
			else if(view=='militaryAdvisorCombatList')
			{
				$('#troopsOverview > div > h3').html(LD.militarytxt[14]);
				if($('form#finishedReports').length==0)
				{
					$('#troopsOverview > div > div.content > p').html(LD.militarytxt[15]);
				}
				else
				{
					$('#combatList > thead > tr > th').each(function(k,th)
					{
						if(k<5) { $(th).find('a').html(LD.militarytxt[k+16]); } else { $(th).html(LD.militarytxt[k+16]); }
					});
					$('#combatList > tbody > tr').each(function(k,tr)
					{
						$(tr).find('td:eq(1) > img').attr('title',function(){return LD.militarytxt[22][$(this).attr('src').split('-')[1].split('.')[0]][0]});
						$(tr).find('td:eq(2)').css('text-align','center').html(function(){return moment($(this).text().trim()+'+0200','DD.MM.YYYY HH:mm:ss Z').format(LD.fulldatelong);});
						$(tr).find('td:eq(3)').html(function(){return Utils.FormatNumToStr(parseInt($(this).text().replace(/\D+/g,'')),false,0);});
						$(tr).find('td:eq(4) > a').html(function(){return $(this).text().trim();});
						$(tr).find('td:eq(5) > a').html(function(){return $(this).text().trim();});
						$(tr).find('td:eq(6) > a').attr('title',LD.militarytxt[22][$(tr).find('td:eq(1) > img').attr('src').split('-')[1].split('.')[0]][1]);
					});
					$('#pager + p > a:first').html(LD.militarytxt[23]);
					$('#pager + p > a:last').html(LD.militarytxt[24]);
					$('#js_commandSelect > option:eq(0),#dropDown_js_commandSelectContainer > div.bg > ul > li:eq(0) > a').html(LD.militarytxt[25]);
					$('#js_commandSelect > option:eq(1),#dropDown_js_commandSelectContainer > div.bg > ul > li:eq(1) > a').html(LD.militarytxt[26]);
					$('#js_commandSelect > option:eq(2),#dropDown_js_commandSelectContainer > div.bg > ul > li:eq(2) > a').html(LD.militarytxt[27]);
					$('#js_commandSelect + span.dropDownButton > a').html($('#js_commandSelect > option:selected').text());
					$('#js_commandSelectContainer + input.button').val(LD.militarytxt[28]);
				}
			}
			else if(view=='militaryAdvisorWarList')
			{
				$('#militaryAdvisorWarList').find('ul.tabmenu + div > h3.header').html(LD.militarytxt[2]);
				$('#militaryAdvisorWarList').find('ul.tabmenu + div > div.content > p').html(LD.militarytxt[32]);
				// To be updated with the list of Gaudtler wars
				$('#militaryAdvisorWarList').find('ul.tabmenu + div > div.content > div.centerButton > a').html(LD.militarytxt[30]);
				$('#militaryAdvisorWarList').find('ul.tabmenu + div + div > h3.header').html(LD.militarytxt[29]);
				$('#militaryAdvisorWarList').find('ul.tabmenu + div + div > div.content > p').html(LD.militarytxt[33]);
				// To be updated with the list of Alliance Gaudtler wars
				$('#militaryAdvisorWarList').find('ul.tabmenu + div + div > div.content > div.centerButton > a').html(LD.militarytxt[31]);
			}
			$('#militaryMovementsFleetMovementsFilters').css('text-align','center').find('div.missionFilter').css({'float':'none','display':'inline-block'});
			Utils.waitElem('#js_MilitaryMovementsFleetMovementsTable > table > tbody > tr:not(:first)',MilAdvAct,true);
			$('#militaryMovementsFleetMovementsFilters > div.missionFilter').on('click',function()
			{
				Utils.waitElem('#js_MilitaryMovementsFleetMovementsTable > table > tbody > tr:not(:first)',MilAdvAct);
			});
			function MilAdvAct()
			{
				var movs = unsafeWindow.ikariam.TemplateView.viewScripts.militaryAdvisor.militaryMovementsFleetMovements;
				if(movs!==undefined)
				{
					var filter = movs.currentFilter;
					var hostile = movs.hostileMissions;
					var states = movs.missionStates;
					var missions = movs.missions;
					var movements = movs.movements;
//					console.log(movs);
//					console.log(filter,hostile,states,missions,movements);
				}
				$('#js_MilitaryMovementsFleetMovementsTable > table > tbody > tr:not(:first)').each(function(k,tr)
				{
					$(tr).find('td').css('padding','0px 0px');
					$(tr).find('td:nth-child(4)').attr('colspan','2').css({'width':'250px','height':'40px','text-align':'center'}).empty();
					GM_addStyle('html .icon40 {width:37px;}');
					$(tr).find('td:nth-child(5) > div.infoTip > div').css({'display':'inline-block','width':'auto'}).find('div').each(function(k,div)
					{
						$(div).css({'color':'#542C0F','font-weight':'normal','padding-right':'1px'}).html(Utils.FormatNumToStr(parseInt($(div).text().replace(/(\d+)[,.](?=\d{3}(\D|$))/g,'$1')),false,0));
					});
					$(tr).find('td:nth-child(4)').html($(tr).find('td:nth-child(5) > div.infoTip').html());
					$(tr).find('td:nth-child(4) > a, td:nth-child(4) > h5').remove();
					$(tr).find('td:nth-child(5)').hide();
				});
				var movements = unsafeWindow.ikariam.templateView.viewScripts.militaryAdvisor.militaryMovementsFleetMovements.movements;
				var mymovs = {};
				$.each(movements,function(i,e)
				{
					mymovs[e.event.id] = e;
				});
			}
		},
		parseCityMilitary: function()
		{
			var LD = Constant.LanguageData[database.settings.languageChange.value];
			$('#js_mainBoxHeaderTitle').text(LD.troopstxt[0]);
			$('#cityMilitary').find('div.buildingDescription > h1').text(LD.troopstxt[0]);
			$('#cityMilitary').find('div.buildingDescription > p').text(LD.troopstxt[1]);
//			console.log($('#cityMilitary').find('ul.stats > li.garrisonLimit'));
			$('#cityMilitary').find('ul.stats > li.garrisonLimit')[0].firstChild.textContent = LD.troopstxt[2]+': ';
			$('#cityMilitary').find('ul.stats > li.garrisonLimit')[0].childNodes[2].textContent = ' / ';
			$('#js_TownHallGarrisonLimitLand').after(' ('+Utils.FormatNumToStr(parseInt($('#js_GarrisonLand').text().replace(/\D+/g,''))*100/parseInt($('#js_TownHallGarrisonLimitLand').text().replace(/\D+/g,'')),false,2)+' %)').text(function(){return Utils.FormatNumToStr(parseInt($(this).text().replace(/\D+/g,'')),false,0);});
			$('#js_GarrisonLand').text(function(){return Utils.FormatNumToStr(parseInt($(this).text().replace(/\D+/g,'')),false,0);});
			$('#cityMilitary').find('ul.stats > li.garrisonLimitSea')[0].firstChild.textContent = LD.troopstxt[3]+': ';
			$('#cityMilitary').find('ul.stats > li.garrisonLimitSea')[0].childNodes[2].textContent = ' / ';
			$('#js_TownHallGarrisonLimitSea').after(' ('+Utils.FormatNumToStr(parseInt($('#js_GarrisonSea').text().replace(/\D+/g,''))*100/parseInt($('#js_TownHallGarrisonLimitSea').text().replace(/\D+/g,'')),false,2)+' %)').text(function(){return Utils.FormatNumToStr(parseInt($(this).text().replace(/\D+/g,'')),false,0);});
			$('#js_GarrisonSea').text(function(){return Utils.FormatNumToStr(parseInt($(this).text().replace(/\D+/g,'')),false,0);});
			$('#js_tabUnits > b').text(LD.troopstxt[4]);
			$('#js_tabShips > b').text(LD.troopstxt[5]);
			$('#tabUnits > div:eq(0) > h3').text(LD.troopstxt[6]);
			$('#tabShips > div:eq(0) > h3').text(LD.troopstxt[5]);
//			console.log(LD.barrackstxt);
			$('#premium_btn2 > h3').text(LD.barrackstxt[16]);
			$('#tabUnits #premium_btn2,#tabShips #premium_btn2').find('table.premiumTbl > tbody > tr > td:first').text(LD.barrackstxt[17]);
			$('#tabUnits #premium_btn2,#tabShips #premium_btn2').find('table.premiumTbl > tbody > tr > td:last > a').text(LD.barrackstxt[18]);
			$('#premium_btn2 + div > h3').text(LD.troopstxt[7]);
			$('#premium_btn2 + div > div.content > p').text(LD.troopstxt[8]);
			$('#tabUnits #premium_btn2 + div + div > h3').text(LD.troopstxt[9]).next('div').find('p').text(LD.troopstxt[10]);
			$('#tabShips #premium_btn2 + div + div > h3').text(LD.troopstxt[11]).next('div').find('p').text(LD.troopstxt[12]);
			try
			{
				var city = ikariam.getCurrentCity;
				var names = [];
				var qnts = [];
				$('#tabUnits,#tabShips').find('div:eq(0) > div.content > table').each(function(a,tbl)
				{
					$(tbl).find('tbody > tr').each(function(b,tr)
					{
						if(b==0)
						{
							$(tr).find('th:not(:first)').each(function(c,th)
							{
								var uid = parseInt($(th).find('div').attr('class').replace(/\D+/g,''));
								$(th).find('div > div.tooltip').text(LD[Constant.unitIds[uid]]);
								names.push(Constant.unitIds[uid]);
							});
						}
						else
						{
							$(tr).find('td:not(:first)').each(function(d,td)
							{
								if(b==1)
								{
									qnts.push(parseInt($(td).text().replace(/\D+/g,'')==''?0:$(td).text().replace(/\D+/g,'')));
								}
								$(td).text(function(){return $(this).text().trim()=='-'?'-':Utils.FormatNumToStr(parseInt($(this).text().replace(/\D+/g,'')),false,0);});
							});
						}
					});
				});
				var troops = {};
				var c = {};
				$.each(names,function(i,v){troops[v]=qnts[i];});
				var changes = city.military.updateUnits(troops);
				events(Constant.Events.MILITARY_UPDATED).pub(city.getId, changes);
			} catch(e) { empire.error('parseCityMilitary', e); } finally { }
			render.toast(Utils.format('{0}: {1} {2} {3} {4}',[LD.updated_,LD.troops,LD.tothe,LD[city.isCapital?'capital':'colony'],LD.leftquot+city._name+LD.rightquot]));
		},
		parseDismissUnits: function()
		{
			var LD = Constant.LanguageData[database.settings.languageChange.value];
			$('#js_mainBoxHeaderTitle').text(LD.dismissunits[0]);
			$('#garrisonEdit').find('div.buildingDescription > h1').text(LD.dismissunits[0]);
			$('#js_army > b').text(LD.dismissunits[1]);
			$('#js_fleet > b').text(LD.dismissunits[2]);
			$.ajax(
			{
				success: function()
				{
					var tab = ['army','fleet'].indexOf($('ul.tabmenu > li.selected').attr('id').replace('js_',''));
					$('#js_garrisonEditForm > div:first > h3').text(LD.dismissunits[tab+1]);
					$('ul#units > li').each(function(k,li)
					{
						var name = $(li).attr('class').split(' ').pop();
						$(li).find('div.unitinfo > h4').text(LD[name]);
						$(li).find('div.unitinfo > div.scroll_view').text(function(){return Utils.FormatNumToStr(parseInt($(this).text().replace(/\D+/g,'')),false,0)});
						$(li).find('div.unitinfo > p').css('text-align','justify').html(LD.unitdescs[name]);
						$(li).find('div.sliderinput > a.setMin').attr('title',LD.dismissunits[3]);
						$(li).find('div.sliderinput > a.setMax').attr('title',LD.dismissunits[4]);
						$(li).find('div.forminput > div > div.centerButton > a').attr({'alt':LD.dismissunits[5],'title':LD.dismissunits[5]}).text(LD.dismissunits[5]);
						$(li).find('div.costs > h3').text(LD.dismissunits[6]+':');
						$(li).find('div.costs > ul.resources > li').each(function(i,c)
						{
							$(c).attr('title',LD.dismissunits[7][$(c).attr('class')]).find('span.accesshint').text(LD.dismissunits[7][$(c).attr('class')]+': ');
						});
					});
				}
			});
			$('div.centerButton > a').on('click',function()
			{
				$('#deleteConfirmPopup h3').text(LD.dismissunits[8]);
				var num = parseInt($('#deleteConfirmPopup div.bd > div')[0].firstChild.nodeValue.replace(/\D+/g,''));
				$('#deleteConfirmPopup div.bd > div').contents().first().each(function(){$(this).replaceWith(Utils.format(LD.dismissunits[9]+': <b>{0}</b>',[Utils.FormatNumToStr(num,false,0)]));});
//				console.log($('#deleteConfirmPopup div.bd > div').contents().first()[0].data);
				$('#deleteConfirmPopup div.bd > div > ul.resources > li').each(function(a,t)
				{
					$(t).css('width','auto').attr('title',LD.dismissunits[7][$(t).attr('class')]).find('span.accesshint').text(LD.dismissunits[7][$(t).attr('class')]+': ');
					$(t)[0].lastChild.textContent = Utils.FormatNumToStr(parseInt($(t)[0].lastChild.nodeValue.replace(/\D+/g,'')),false,0);
				});
				$('#js_popupBtn1').text(LD.dismissunits[10]);
				$('#js_popupBtn2').text(LD.dismissunits[11]);
//				console.log($('#deleteConfirmPopup').length);
			});
//			console.log($('div.centerButton > a').length);
		},
		parsePremium: function(data)
		{
			var LD = Constant.LanguageData[database.settings.languageChange.value];
			unsafeWindow.$(document).ajaxSuccess(function(e,xhr)
			{
				if(unsafeWindow.ikariam.TemplateView.viewScripts.inventory!=undefined)
				{
					var mods = unsafeWindow.ikariam.TemplateView.viewScripts.inventory.modifierList.modifiers;
//					console.log(mods);
					if(mods && typeof(mods)=='object' && mods.length>0)
					{
						$.each(mods,function(i,v)
						{
//							console.log(parseInt(v.type),v.cssClass.split(' ')[1],parseInt(v.activeUntil),parseInt(v.cityId));
							database.getGlobalData.setPremiumFeature(parseInt(v.type),v.cssClass.split(' ')[1],parseInt(v.activeUntil),parseInt(v.cityId));
//							console.log(database.getGlobalData.premium);
						});
					}
				}
			});
			var citysort = '';
			$.each(database.settings.cityOrder.value,function(k,c)
			{
				citysort += $('#itemTargetCity > option[value="'+c+'"]').prop('outerHTML')+'\r\n';
			});
//			console.log(citysort);
			$('#itemTargetCity').empty().append(citysort);
			render.toast(LD.updated_+': '+LD.effects);
		},
		parseSeaChartArchive: function(view,data)
		{
			var LD = Constant.LanguageData[database.settings.languageChange.value];
			var city = ikariam.getCurrentCity;
			$('#js_mainBoxHeaderTitle').text(LD[view]);
			$('#marineChartArchive').find('div.buildingDescription > h1').text(LD[view]);
			$('#marineChartArchive').find('div.buildingDescription > p').css({'text-align':'justify','margin':'0px 15px 10px 0px'}).text(LD.SCAtxt[0]);
			$('#js_selectedShip > option').each(function(k,op)
			{
				$(op).text(LD[Constant.unitIds[parseInt($(op).val())]]);
			});
			$('#js_shipSelectContainer > span.dropDownButton > a').text($('#js_selectedShip > option:selected').text());
			$('div.firstcolumn').each(function(i,dv) { $(dv).text(LD.SCAtxt[i+1]); });
			$('[id$="_time_current"],[id$="_next_delta"],[id$="_time_without_delta"]').each(function(a,t)
			{
				$(t).text(function(){return (a%3==0?'':'-')+Utils.FormatTimeLengthToStr(Utils.FormatLocDurToSecs($(this).text().trim().replace('-',''))*1000,6)});
			});
			$('div.firstcolumn:last + div').text(LD.SCAtxt[5]);
			$('#dropDown_js_shipSelectContainer > div.bg > ul > li').each(function(b,li)
			{
				$(li).find('a').text(LD[Constant.unitIds[parseInt($(li).attr('selectvalue'))]]);
			});
			$('#dropDown_js_shipSelectContainer > div.bg > ul').on('click',function(event)
			{
				event.preventDefault();
				$.ajax(
				{
					success: function()
					{
						$('#js_selectedShip > option').each(function(k,op)
						{
							$(op).text(LD[Constant.unitIds[parseInt($(op).val())]]);
						});
						$('[id$="_time_current"],[id$="_next_delta"],[id$="_time_without_delta"]').each(function(a,t)
						{
							$(t).text(function(){return (a%3==0?'':'-')+Utils.FormatTimeLengthToStr(Utils.FormatLocDurToSecs($(this).text().trim().replace('-',''))*1000,6)});
						});
					}
				});
				$('#dropDown_js_shipSelectContainer').hide();

			});
//			Utils.trackEvents('span.dropDownButton,#dropDown_js_shipSelectContainer');
//			console.log(data);
//			console.log(unsafeWindow.ikariam);
			render.toast(Utils.format('{0}: {1} {2} {3} {4}',[LD.updated_,LD.marineChartArchive,LD.tothe,LD[city.isCapital?'capital':'colony'],LD.leftquot+city._name+LD.rightquot]));
		},
		parseWorkshop: function(view,data)
		{
			var LD = Constant.LanguageData[database.settings.languageChange.value];
			var city = ikariam.getCurrentCity;
//			console.log(LD.workshoptxt);
			var startdate = 0, enddate = 0;
			$('script').each(function(i,s)
			{
				var match = $(s).text().match(/getProgressBar\((\{([^}]+)\})/gm);
				if(match)
				{
					match = eval('(' + match[0].replace('getProgressBar(','')+')');
					startdate = match.startdate*1000;
					enddate = match.enddate*1000;
					return false;
				}
			});
			$('#js_mainBoxHeaderTitle').text(LD[view]);
			$('#workshop').find('div.buildingDescription > h1').text(LD[view]);
			$('#workshop').find('div.buildingDescription > p').css({'text-align':'justify','margin':'0px 15px 10px 0px'}).text(LD.workshoptxt[0]);
			var ranks = ['bronze','silber','gold'];
			var type = ['Units','Ships'];
			$.each(type,function(i,t)
			{
				$('#js_tab'+t+' > b').text(LD.workshoptxt[i+1]);
				$('#tab'+t+' > div > h3').text(LD.workshoptxt[i+1]);
				$('#tab'+t+' > div > div > div.units').each(function(k,n)
				{
					var name = $(n).find('div.object > img').attr('src').split('/').pop().split('_')[1];
					var impr = [0,0];
					$(n).find('div.object').attr('title',LD[(i==1?'ship_':'')+name]);
					$(n).find('table.feature_box').each(function(x,box)
					{
						var rank = $(box).find('tbody > tr > td:first > img').attr('src').split('_')[1].split('.')[0];
						impr[x] = ranks.indexOf(rank)+1;
						$(box).find('tbody > tr > td:first > img').attr({'alt':LD.workshoptxt[x+3],'title':LD.workshoptxt[x+3]});
						if($(box).find('tbody > tr > td:last > div.actionButton').length+$(box).find('tbody > tr > td:last > div.info').length>0)
						{
							if(parseInt($(box).find('tbody > tr > td.res > ul > li.gold').text().replace(/\D+/g,''))>database.getGlobalData.finance.currentGold && parseInt($(box).find('tbody > tr > td.res > ul > li.glass').text().replace(/\D+/g,''))<=city.getResource(Constant.Resources.GLASS).getCurrent)
							{
								$(box).find('tbody > tr > td.res > ul > li.gold').css({'font-weight':'bold','color':'red'});
							}
							else if(parseInt($(box).find('tbody > tr > td.res > ul > li.gold').text().replace(/\D+/g,''))<=database.getGlobalData.finance.currentGold && parseInt($(box).find('tbody > tr > td.res > ul > li.glass').text().replace(/\D+/g,''))>city.getResource(Constant.Resources.GLASS).getCurrent)
							{
								$(box).find('tbody > tr > td.res > ul > li.glass').css({'font-weight':'bold','color':'red'});
							}
							else if(parseInt($(box).find('tbody > tr > td.res > ul > li.gold').text().replace(/\D+/g,''))>database.getGlobalData.finance.currentGold && parseInt($(box).find('tbody > tr > td.res > ul > li.gold').text().replace(/\D+/g,''))>city.getResource(Constant.Resources.GLASS).getCurrent)
							{
								$(box).find('tbody > tr > td.res > ul > li.gold').css({'font-weight':'bold','color':'red'});
								$(box).find('tbody > tr > td.res > ul > li.glass').css({'font-weight':'bold','color':'red'});
							}
						}
						$(box).find('tbody > tr > td.res > ul > li').each(function(a,res)
						{
							var rt = a<2? Utils.FormatNumToStr(parseInt($(res).text().replace(/\D+/g,'')),false,0) : Utils.FormatTimeLengthToStr(Utils.FormatLocDurToSecs($(res).text().trim())*1000);
							$(res).css({'text-align':(a<2?'right':'center'),'width':'35px'}).attr('title',Utils.format(LD.workshoptxt[a+5],[rt])).text(rt);
						});
						$(box).find('tbody > tr > td:last')[0].childNodes[0].textContent = LD.militaryupgrades[t][name][x][ranks.indexOf(rank)];
						$(box).find('tbody > tr > td:last > p:first').text(function(){return Utils.format(LD.workshoptxt[x+8],[Utils.FormatNumToStr(parseInt($(this).text().replace(/\D+/g,'')),true,0)]);});
						$(box).find('tbody > tr > td:last > div.actionButton:first > a').attr('title',LD.workshoptxt[x+3]).text(LD.workshoptxt[10]);
						$(box).find('tbody > tr > td:last > div.actionButton:not(:first)').find('a').text(LD.workshoptxt[11]);
						if($(box).find('tbody > tr > td:last > p:not(:first)').length==0) { $(box).find('tbody > tr > td:last').append('<p><span class="bold red smallFont"></span></p>') }
						if($(box).find('tbody > tr > td:last > div.actionButton').length+$(box).find('tbody > tr > td:last > div.info').length==0)
						{
							$(box).find('tbody > tr > td:last > p:not(:first) > span').text(LD.workshoptxt[12]);
						}
						else if($(box).find('tbody > tr > td:last > div.actionButton').length==1)
						{
							if(city.getBuildingFromName(Constant.Buildings.WORKSHOP).isUpgrading)
							{
								$(box).find('tbody > tr > td:last > p:not(:first) > span').text(LD.workshoptxt[13]);
							}
							else if(city.getBuildingFromName(Constant.Buildings.WORKSHOP).getLevel<Constant.UnitData[(i==1?'ship_':'')+name].minWlevel+ranks.indexOf(rank))
							{
								$(box).find('tbody > tr > td:last > p:not(:first) > span').text(LD.workshoptxt[14]);
							}
//							console.log(city.getBuildingFromName(Constant.Buildings.WORKSHOP).getLevel);
						}
						else if($(box).find('tbody > tr > td:last > div.actionButton').length==2)
						{
							if(parseInt($(box).find('tbody > tr > td.res > ul > li.gold').text().replace(/\D+/g,''))>database.getGlobalData.finance.currentGold && parseInt($(box).find('tbody > tr > td.res > ul > li.glass').text().replace(/\D+/g,''))<=city.getResource(Constant.Resources.GLASS).getCurrent)
							{
								$(box).find('tbody > tr > td:last > p:not(:first) > span').text(LD.workshoptxt[15]);
							}
							else if(parseInt($(box).find('tbody > tr > td.res > ul > li.gold').text().replace(/\D+/g,''))<=database.getGlobalData.finance.currentGold && parseInt($(box).find('tbody > tr > td.res > ul > li.glass').text().replace(/\D+/g,''))>city.getResource(Constant.Resources.GLASS).getCurrent)
							{
								$(box).find('tbody > tr > td:last > p:not(:first) > span').text(LD.workshoptxt[16]);
							}
							else if(parseInt($(box).find('tbody > tr > td.res > ul > li.gold').text().replace(/\D+/g,''))>database.getGlobalData.finance.currentGold && parseInt($(box).find('tbody > tr > td.res > ul > li.gold').text().replace(/\D+/g,''))>city.getResource(Constant.Resources.GLASS).getCurrent)
							{
								$(box).find('tbody > tr > td:last > p:not(:first) > span').text(LD.workshoptxt[17]);
							}
						}
						if($(box).find('tbody > tr > td:last > div.info').length==1)
						{
							$('#upgradeProgressPercent').remove();
							var workshopinterv = setInterval(function()
							{
								$('#empire_upgradeCountdown').text(Utils.FormatTimeLengthToStr(enddate-moment(),3));
								$(box).find('tbody > tr > td:last > div.info > div.progressbar > div.bar').attr('title',Utils.FormatNumToStr((moment()-startdate)*100/(enddate-startdate),false,2)+' %');
								if(moment()>enddate) { clearInterval(workshopinterv); }
							},1000);
							$('#upgradeCountdown').hide().after(Utils.FormatFullTimeToDateString(enddate)+'<div class="smallFont" id="empire_upgradeCountdown" style="text-align:center">'+Utils.FormatTimeLengthToStr(enddate-moment(),3)+'</div>');
							$(box).find('tbody > tr > td:last > div.info > div.progressbar > div.bar').attr('title',Utils.FormatNumToStr((moment()-startdate)*100/(enddate-startdate),false,2)+' %');
						}
					});
					database.getGlobalData.updateImprovements((i==1?'ship_':'')+name,isNaN(parseInt(impr[0]))?0:4-parseInt(impr[0]),isNaN(parseInt(impr[1]))?0:4-parseInt(impr[1]));
				});
			});
			render.toast(Utils.format('{0}: {1} {2} {3} {4}',[LD.updated_,LD.workshop,LD.tothe,LD[city.isCapital?'capital':'colony'],LD.leftquot+city._name+LD.rightquot]));
		},
		parsebarbarianVillage: function()
		{
			var LD = Constant.LanguageData[database.settings.languageChange.value];
			var city = ikariam.getCurrentCity;
			var sum = 0;
			$('[id^="js_islandBarbarianResource"]').each(function(k,r)
			{
				var q = parseInt($(r).text().replace(/(\d+)[,.](?=\d{3}(\D|$))/g,'$1'));
				$(r).text(q>0?Utils.FormatNumToStr(q):0);
				sum += $(r).not('[id$="gold"]').length==1?q:0;
			});
			$('div.barbarianCityResources').prepend(sum>0?'<span style="float:right;font-weight:bold">&Sigma;: '+Utils.FormatNumToStr(sum,false,0)+' ('+Utils.FormatQuantityToLoad(sum)+')</span>':'');
		},
		parsepremiumDummy: function()
		{
			var LD = Constant.LanguageData[database.settings.languageChange.value];
			var citymenu = ['',''];
			$.each(database.settings.cityOrder.value,function(k,c)
			{
				citymenu[0] += $('#dropDown_js_dummyCitySelectContainer').find('ul > li[selectvalue="'+c+'"]').removeClass('first-child last-child').addClass((k==0?'first':(k==database.settings.cityOrder.value.length-1?'last':''))+'-child').prop('outerHTML');
				citymenu[1] += $('#dummyCitySelect > option[value="'+c+'"]').prop('outerHTML');
			});
			$('#dropDown_js_dummyCitySelectContainer').find('ul').empty().html(citymenu[0]);
			$('#dummyCitySelect').empty().html(citymenu[1]);
		},
		parseprodBuild: function(view,data)
		{
			var LD = Constant.LanguageData[database.settings.languageChange.value];
//			console.log(data);
			var city = ikariam.getCurrentCity;
			$('#js_mainBoxHeaderTitle').html(LD[view]);
			$('#bonusBuilding > div.buildingDescription > h1').html(LD[view]);
			$('#bonusBuilding > div.buildingDescription > p').css({'text-align':'justify','margin':'0px 15px 10px 0px'}).html(LD.prodBuildtxt[0][view]);
			$('#bonusBuilding').find('div.warning > h5').html(LD.prodBuildtxt[10]);
			$('#bonusBuilding').find('div.warning > p').html(Utils.format(LD.prodBuildtxt[11],[LD.prodBuildtxt[city.isCapital?13:12]]));
			$('#bonusBuilding').find('h3.header').text(Utils.format(LD.prodBuildtxt[1],[LD.prodBuildtxt[14][view]]));
//			console.log(LD.prodBuildtxt);
			var sum = 0, prc = 0;
			var now = moment();
			if(Object.keys(data).length>0)
			{
				var foresterinterv = setInterval(function()
				{
					var ids = Object.keys(data);
					for(var id=0;id<ids.length;id++)
					{
						if(moment()<=(data[ids[id]].countdown.enddate*1000))
						{
							$('#empire_'+ids[id]).text(Utils.FormatTimeLengthToStr(data[ids[id]].countdown.enddate*1000-moment(),3));
						}
						else
						{
							ids.splice(id);
						}
					}
					$('td.city_name > span.clickable, td.building > span.clickable, div.city, div.temple, div.pirates, div.spies, div.barracks, div.shipyard, div#HelpTab > span[id^="help"], span.happy, span.growth, span.scientists, [id^="position"], #dropDown_js_citySelectContainer, #js_buildingUpgradeButton').on('click',function(){clearInterval(foresterinterv);});
					if(ids.length==0) { clearInterval(foresterinterv); }
				},1000);
			}
			$('#bonusBuilding').find('div.content > table > tbody > tr:not(:first,:last)').each(function(k,tr)
			{
				$(tr).find('td:first'+(k>0&&k<4?' > a':'')).css('white-space','nowrap').html(k+2!=6?LD.prodBuildtxt[k+2]:LD[view]+(k>0&&k<4?'':':'));
				$(tr).find('td:first + td').text(function()
				{
					var val = parseFloat($(this).text().replace(/(\d+)[,.](?=\d{3}(\D|$))/g,'$1'));
					sum += val;
					return Utils.FormatNumToStr(val,false,2);
				});
				prc += $(tr).find('td:last > div.barBorder').attr('title')!=undefined ? parseFloat($(tr).find('td:last > div.barBorder').attr('title').replace(/(\d+)[,.](?=\d{3}(\D|$))/g,'$1')) : 0;
				$(tr).find('td:last > div.barBorder').attr('title',function(){return Utils.FormatNumToStr(parseFloat($(this).attr('title').replace(/(\d+)[,.](?=\d{3}(\D|$))/g,'$1')),k==0?false:true,2)+' %';}).find('span.bar_countdown').hide().after(function(){return '<span class="bar_countdown" id="empire_'+$(this).attr('id').replace('Count','Cool')+'">'+Utils.FormatTimeLengthToStr(data[$(this).attr('id').replace('Count','Cool')].countdown.enddate*1000-moment(),3)+'</span>';});
			});
			$('span#premiumCountdown').parents('tr').find('td:first > a').html(LD.prodBuildtxt[3]);
			$('span#adVideoCountdown').parents('tr').find('td:first > a').html(LD.prodBuildtxt[4]);
			$('span#heliosCountdown').parents('tr').find('td:first > a').html(LD.prodBuildtxt[5]);
			if(city.getCorruption>0) { $('span#heliosCountdown').parents('tr').next().next().find('td:first').html(LD.prodBuildtxt[7]); }
			$('#bonusBuilding').find('div.content > table > tbody > tr:last > td:nth-child(2) > span > b').text(Utils.FormatNumToStr(sum,false,2));
			$('#bonusBuilding').find('div.content > table > tbody > tr:last > td:last > div').attr('title',Utils.FormatNumToStr(prc,false,2)+' %');
			$('#informationSidebar > table > tbody > tr:first').html('<th class="info center">'+LD.prodBuildtxt[8]+'</th><th class="info center">'+LD.prodBuildtxt[9]+'</th>');
			$('#informationSidebar > table > tbody > tr:last > td:last').text(Utils.FormatNumToStr((city.getBuildingFromName(view).getLevel+1)*2,true,0)+' %');
			render.toast(Utils.format('{0}: {1} {2} {3} {4}',[LD.updated_,LD[view],LD.tothe,LD[city.isCapital?'capital':'colony'],LD.leftquot+city._name+LD.rightquot]));
		},
		parseReductBuild: function(view)
		{
			var LD = Constant.LanguageData[database.settings.languageChange.value];
			var rd = (database.getGlobalData.getResearchTopicLevel(Constant.Research.Economy.PULLEY)?2:0)+(database.getGlobalData.getResearchTopicLevel(Constant.Research.Economy.GEOMETRY)?4:0)+(database.getGlobalData.getResearchTopicLevel(Constant.Research.Economy.SPIRIT_LEVEL)?8:0);
			var city = ikariam.getCurrentCity;
			$('#js_mainBoxHeaderTitle').html(LD[view]);
			$('#reductionBuilding > div.buildingDescription > h1').html(LD[view]);
			$('#reductionBuilding > div.buildingDescription > p').css({'text-align':'justify','margin':'0px 15px 10px 0px'}).html(LD.reductBuildtxt[0][view]);
			$('#reductionBuilding > div:not(.buildingDescription)').each(function(k,dv)
			{
				$(dv).find('h3.header').html(Utils.format(LD.reductBuildtxt[k+2],[LD.reductBuildtxt[1][view]]));
				var rows = $(dv).find('div.content > table > tbody > tr:not(:first)').length;
				$(dv).find('div.content > table > tbody > tr:not(:first)').each(function(i,tr)
				{
//					console.log($(tr).find('td.left').text());
					if(i==0)
					{
						$(tr).find('td.left').html(LD.reductBuildtxt[7]+':');
						$(tr).find('td.left + td > span').attr('title',LD.total_).find('b').text(Utils.FormatNumToStr(100,false,2)+' %');
						$(tr).find('td.bar_cell > div').attr('title',LD.reductBuildtxt[9]);
					}
					else if(i==rows-1)
					{
						$(tr).find('td.left').css('white-space','nowrap').html('<b>-</b> '+LD[view]+' ('+Utils.FormatNumToStr(city.getBuildingFromName(view).getLevel,false,2)+' %):');
						$(tr).find('td.left + td > span').attr('title',LD.total_).find('b').text(Utils.FormatNumToStr(100-rd-city.getBuildingFromName(view).getLevel,false,2)+' %');
//						console.log($(tr).find('td.bar_cell > div').attr('title'),LD.reductBuildtxt[10],Utils.format(LD.reductBuildtxt[10],[LD.reductBuildtxt[1][view]]));
						$(tr).find('td.bar_cell > div,td.bar_cell > div > div').attr('title',Utils.format(LD.reductBuildtxt[10],[LD.reductBuildtxt[1][view]]));
//						$(tr).find('td.last > div').attr('title',Utils.format(LD.reductBuildtxt[14],[LD.reductBuildtxt[1][view]]));
					}
					else
					{
						$(tr).find('td.left').css('white-space','nowrap').html('<b>-</b> '+LD.reductBuildtxt[8]+' ('+Utils.FormatNumToStr(rd,false,2)+' %):');
						$(tr).find('td.left + td > span').attr('title',LD.total_).find('b').text(Utils.FormatNumToStr(100-rd,false,2)+' %');
						$(tr).find('td.bar_cell > div,td.bar_cell > div > div').attr('title',Utils.format(LD.reductBuildtxt[10],[LD.reductBuildtxt[1][view]]));
					}
				});
			});
			$('#informationSidebar > table > tbody > tr:first > th:first').html(LD.reductBuildtxt[11]);
			$('#informationSidebar > table > tbody > tr:first > th:last').html(LD.reductBuildtxt[9]);
			$('#informationSidebar > table > tbody > tr:last > td:last').html(Utils.FormatNumToStr(-(city.getBuildingFromName(view).getLevel+1),false,2)+' %');
//			console.log(view);
//			console.log(LD.reductBuildtxt);
			render.toast(Utils.format('{0}: {1} {2} {3} {4}',[LD.updated_,LD[view],LD.tothe,LD[city.isCapital?'capital':'colony'],LD.leftquot+city._name+LD.rightquot]));
		},
		FetchAllTowns: function()
		{
			var _relatedCityData = unsafeWindow.ikariam.model.relatedCityData;
			var _cityId = null;
			var city = null;
			var order = database.settings.cityOrder.value;
			if (!order.length) order = [];
			if(_relatedCityData)
			{
				for(_cityId in _relatedCityData)
				{
					if(_cityId != 'selectedCity' && _cityId != 'additionalInfo')
					{
						var own = (_relatedCityData[_cityId].relationship == 'ownCity');
						var deployed = (_relatedCityData[_cityId].relationship == 'deployedCities');
						var occupied = (_relatedCityData[_cityId].relationship == 'occupiedCities');
						if(own)
						{
							if(database.cities[_relatedCityData[_cityId].id] == undefined)
							{
								(database.cities[_relatedCityData[_cityId].id] = database.addCity(_relatedCityData[_cityId].id)).init();
								city = database.cities[_relatedCityData[_cityId].id];
								city.updateTradeGoodID(parseInt(_relatedCityData[_cityId].tradegood));
								city.isOwn = own;
							}
							city = database.cities[_relatedCityData[_cityId].id];
							city.updateName(_relatedCityData[_cityId].name);
							var coords = _relatedCityData[_cityId].coords.match(/(\d+)/g);
//							console.log(coords);
							city.updateCoordinates(coords[0],coords[1]);
							if($.inArray(city.getId, order) == -1)
							{
								order.push(city.getId);
							}
						}
					}
				}
				for(var cID in database.cities)
				{
					var ghost = true;
					for(_cityId in _relatedCityData)
					{
						if(_relatedCityData[_cityId].id == cID || !database.cities[cID].isOwn)
						{
							ghost = false;
						}
					}
					if(ghost)
					{
						delete database.cities[cID];
					}
				}
			}
			database.settings.cityOrder.value = order;
		},
		get currentShips()
		{
			if(this.$freeTransporters == undefined)
			{
				this.$freeTransporters = $('#js_GlobalMenu_freeTransporters');
			}
			return parseInt(this.$freeTransporters.text());
		}
	};
/************************************************
******************* Constants *******************
************************************************/
	var Constant = {
		PremiumData:
		{
			11:
			{
				name:'marbleBonus',
				bonus:0.2,
				icon:'//gf2.geo.gfsrv.net/cdn14/1b17bf4e92442b3489c6e9b42a6c1c.png',
				ipos:5
			},
			12:
			{
				name:'sulfurBonus',
				bonus:0.2,
				icon:'//gf2.geo.gfsrv.net/cdn14/1b17bf4e92442b3489c6e9b42a6c1c.png',
				ipos:6
			},
			13:
			{
				name:'crystalBonus',
				bonus:0.2,
				icon:'//gf2.geo.gfsrv.net/cdn14/1b17bf4e92442b3489c6e9b42a6c1c.png',
				ipos:7
			},
			14:
			{
				name:'wineBonus',
				bonus:0.2,
				icon:'//gf2.geo.gfsrv.net/cdn14/1b17bf4e92442b3489c6e9b42a6c1c.png',
				ipos:4
			},
			15:
			{
				name:'premiumAccount',
				bonus:0.2,
				icon:'// gf2.geo.gfsrv.net/cdn14/1b17bf4e92442b3489c6e9b42a6c1c.png',
				ipos:1
			},
			16:
			{
				name:'resourceBonus',
				bonus:0.2,
				icon:'// gf2.geo.gfsrv.net/cdn14/1b17bf4e92442b3489c6e9b42a6c1c.png',
				ipos:3
			},
			17:
			{
				name:'safeCapacityBonus',
				bonus:1,
				icon:'//gf2.geo.gfsrv.net/cdn14/1b17bf4e92442b3489c6e9b42a6c1c.png',
				ipos:8
			},
			18:
			{
				name:'researchPointsBonus',
				bonus:0.2,
				icon:'//gf2.geo.gfsrv.net/cdn14/1b17bf4e92442b3489c6e9b42a6c1c.png',
				ipos:10
			},
			33:
			{
				name:'storageCapacityBonus',
				bonus:1,
				icon:'//gf2.geo.gfsrv.net/cdn14/1b17bf4e92442b3489c6e9b42a6c1c.png',
				ipos:9
			},
			51:
			{
				name:'resourceBonus',
				bonus:0.2,
				icon:'// gf2.geo.gfsrv.net/cdn14/1b17bf4e92442b3489c6e9b42a6c1c.png',
				ipos:6
			},
			52:
			{
				name:'tradegoodBonus',
				bonus:0.2,
				icon:'//gf2.geo.gfsrv.net/cdn14/1b17bf4e92442b3489c6e9b42a6c1c.png',
				ipos:35
			},
			802:
			{
				name:['barbarianAdvisor','femaleAdvisor'],
				bonus:1,
				icon:'//gf2.geo.gfsrv.net/cdn14/1b17bf4e92442b3489c6e9b42a6c1c.png',
				ipos:[68,64]
			},
			805:
			{
				name:'badTaxAccountant',
				bonus:0.2,
				icon:'//gf2.geo.gfsrv.net/cdn14/1b17bf4e92442b3489c6e9b42a6c1c.png',
				ipos:25
			}
		},
		Premium:
		{
			MARBLE_BONUS:11,
			SULFUR_BONUS:12,
			CRYSTAL_BONUS:13,
			WINE_BONUS:14,
			PREMIUM_ACCOUNT:15,
			WOOD_BONUS:[16,51],
			SAFECAPACITY_BONUS:17,
			RESEARCH_POINTS_BONUS:18,
			STORAGECAPACITY_BONUS:33,
			TRADEGOOD_BONUS:52,
			FEMALE_ADVISOR:802,
			BARBARIAN_ADVISOR:802,
			GOLD_BONUS:805
		},
		Events:
		{
			BUILDINGS_UPDATED: 'buildingsUpdated',
			GLOBAL_UPDATED   : 'globalDataUpdated',
			MOVEMENTS_UPDATED: 'movementsUpdated',
			RESOURCES_UPDATED: 'resourcesUpdated',
			CITY_UPDATED	 : 'cityData',
			MILITARY_UPDATED : 'militaryUpdated',
			LOCAL_STRINGS_AVAILABLE : 'localisationAvailable',
			MODEL_AVAILABLE : 'modelAvailable',
			CITYDATA_AVAILABLE: 'cityDataAvailable',
			DATABASE_LOADED: 'databaseLoaded',
			TAB_CHANGED : 'tabChanged',
			PREMIUM_UPDATED : 'premiumUpdated',
		},
		Settings:
		{
			CITY_ORDER:				'cityOrder',
			FULL_ARMY_TABLE:		'fullArmyTable',
			PLAYER_INFO:			'playerInfo',
			HIDE_WORLD:				'hideOnWorldView',
			HIDE_ISLAND:			'hideOnIslandView',
			HIDE_CITY:				'hideOnCityView',
			SHOW_ON_TOP:			'onTop',
			WINDOW_TENNIS:			'windowTennis',
			AUTO_UPDATE:			'autoUpdates',
			DONATION_BUTTONS:		'donationButtons',
			CT_FINDER:				'ctfinder',
			XY_SHOW:				'ΧΥshow',
			SMALLER_FONT:			'smallFont',
			GOLD_LONG:				'GoldShort',
			NEWS_TICKER:			'newsTicker',
			EVENT:					'event',
			LOGIN_POPUP:			'logInPopup',
			BIRD_SWARM:				'birdSwarm',
			WALKERS:				'walkers',
			NO_PIRACY:				'noPiracy',
			NO_THEATER:				'noTheater',
			CONTROL_CENTER:			'controlCenter',
			WITHOUT_FABLE:			'withoutFable',
			AMBROSIA_PAY:			'ambrosiaPay',
			QUANTITY_LOADS:			'quantityLoads',
			DEFAULT_BUILDINGS:		'defaultBuildingList',
			ALTERNATIV_BUILDINGS:	'alternativeBuildingList',
			COMPRESS_BUILDINGS:		'compressedBuildingList',
			HOURLY_RESS:			'hourlyRess',
			WINE_OUT:				'wineOut',
			DAILY_BONUS:			'dailyBonus',
			WINE_WARNING:			'wineWarning',
			WINE_WARNING_TIME:		'wineWarningTime',
			LANGUAGE_CHANGE:		'languageChange'
		},
		SettingData:
		{
			cityOrder:{type:'array', default:[], categories:'ignore'},
			fullArmyTable:{type:'boolean', default:false, categories:'army_category'},
			playerInfo:{type:'boolean', default:false, categories:'army_category'},
			hideOnWorldView:{type:'boolean', default:false, categories:'visibility_category'},
			hideOnIslandView:{type:'boolean', default:false, categories:'visibility_category'},
			hideOnCityView:{type:'boolean', default:false, categories:'visibility_category'},
			onTop:{type:'boolean', default:false, categories:'display_category'},
			windowTennis:{type:'boolean', default:false, categories:'display_category'},
			autoUpdates:{type:'boolean', default:false, categories:'global_category'},
			smallFont:{type:'boolean', default:false, categories:'display_category'},
			GoldShort:{type:'boolean', default:false, categories:'display_category'},
			newsTicker:{type:'boolean', default:false, categories:'display_category'},
			event:{type:'boolean', default:false, categories:'display_category'},
			logInPopup:{type:'boolean', default:false, categories:'display_category'},
			birdSwarm:{type:'boolean', default:false, categories:'display_category'},
			walkers:{type:'boolean', default:false, categories:'display_category'},
			noPiracy:{type:'boolean', default:false, categories:'display_category'},
			noTheater:{type:'boolean', default:false, categories:'display_category'},
			controlCenter:{type:'boolean', default:false, categories:'display_category'},
			withoutFable:{type:'boolean', default:false, categories:'display_category'},
			ambrosiaPay:{type:'boolean', default:false, categories:'display_category'},
			quantityLoads:{type:'boolean', default:false, categories:'display_category'},
			defaultBuildingList:{type:'boolean', default:true, categories:'building_category'},
			alternativeBuildingList:{type:'boolean', default:false, categories:'building_category'},
			compressedBuildingList:{type:'boolean', default:false, category:'building_category'},
			donationButtons:{type:'boolean', default:false, categories:'tweaks_category'},
			ctfinder:{type:'boolean', default:false, categories:'tweaks_category'},
			ΧΥshow:{type:'boolean', default:false, categories:'tweaks_category'},
			hourlyRess:{type:'boolean', default:false, categories:'resource_category'},
			wineOut:{type:'boolean', default:false, categories:'resource_category'},
			dailyBonus:{type:'boolean', default:false, categories:'resource_category'},
			wineWarning:{type:'boolean', default:false, categories:'resource_category'},
			wineWarningTime:{type:'number', default:0, choices:[0,12,24,36,48,96], categories:'resource_category'},
			languageChange:{type:'language', default:ikariam.Language(), selection:['en','de','el'], categories:'language_category'}
		},
		SettingCategories:
		{
			VISIBILITY: 'visibility_category',
			DISPLAY   : 'display_category',
			OTHER	 : 'global_category',
			ARMY	  : 'army_category',
			TWEAKS	: 'tweaks_category',
			BUILDING  : 'building_category',
			RESOURCE  : 'resource_category',
			LANGUAGE  : 'language_category',
		},
		LanguageData:
		{
			en:
			{
				allyranks: ['Leader','Home Secretary','General','Diplomat'],
				advisors: ['Trade Advisor','Millitary Advisor','Research Advisor','Diplomacy Advisor'],
				adequacy:'Adequacy',
				level:'Level',
				in_level:'in level {0}',
				upgrade:'Upgrade',
				inqueue:'In Queue',
				downgrade:'Demolish',
				upbtntitle:'Upgrade is not possible at the moment',
				qubtntitle:'Upgrade can be placed in queue',
				downbtntitle:['Demolition is not possible!','Demolition is possible!'],
				buildings: 'Buildings',
				economy: 'Economy',
				military: 'Military',
				greek: 'Greek',
				empire: 'Empire',
				overview: 'Overview',
				troops: 'Troops',
				fleet: 'Fleet',
				ships: 'Ships',
				units: 'Units',
				towns: 'Towns',
				city: 'City',
				townHall: 'Town Hall',
				colony: 'Colony',
				colony_: 'Colony',
				capital: 'Capital',
				capital_: 'Capital',
				palace: 'Palace',
				palaceColony: 'Governor&apos;s Residence',
				government: 'Current form of government',
				anarchie:'Anarchy',
				xenokratie:'Xenocracy',
				ikakratie:'Ikacracy',
				aristokratie:'Aristocracy',
				diktatur:'Dictatorship',
				demokratie:'Democracy',
				nomokratie:'Nomocracy',
				oligarchie:'Oligarchy',
				technokratie:'Techocracy',
				theokratie:'Theocracy',
				from_government: 'from government',
				tavern: 'Tavern',
				miracle: 'Wonders',
				MirTxts: ['','This miracle was activated recently. Reuse'],
				world_miracle: 'World miracle',
				priests: 'Priests at the temple',
				conversion: 'Faith conversion rate',
				curislandfaith: 'Island <b>Faith</b>',
				maxislandfaith: 'Maximum Island <b>Faith</b>',
				percentage: 'Island percentage faith is',
				cooldown: 'cooldown (Activated recently)',
				to_temple: '(to the temple of towns)',
				to_wonder: '(to the monuments of islands)',
				favours: ['Favours','Favour'],
				tasks: 'Tasks',
				renew: 'Renew',
				zeroingtasks: 'Reset all tasks',
				zeroingvaluation: 'Time remaining before valuation',
				pirates: 'Pirates<br>Overview',
				museum: 'Museum',
				academy: 'Academy',
				workshop: 'Workshop',
				temple: 'Temple',
				workers: 'Workers',
				unskilled: 'Unskilled',
				embassy: 'Embassy',
				warehouse: 'Warehouse',
				dump: 'Depot',
				port: 'Trading Port',
				branchOffice: 'Trading Post',
				wall: 'Town Wall',
				safehouse: 'Hideout',
				barracks: 'Barracks',
				shipyard: 'Shipyard',
				forester: 'Forester&apos;s House',
				carpentering: 'Carpenter&apos;s Workshop',
				winegrower: 'Winery',
				vineyard: 'Wine Press',
				stonemason: 'Stonemason',
				architect: 'Architect&apos;s Office',
				glassblowing: 'Glassblower',
				optician: 'Optician',
				alchemist: 'Alchemist&apos;s Tower',
				fireworker: 'Firework Test Area',
				pirateFortress: 'Pirate Fortress',
				blackMarket: 'Black Market',
				marineChartArchive: 'Sea Chart Archive',
				tavern_level: 'Tavern Level',
				corruption: 'Corruption',
				cultural_treaty: 'Cultural Treaties',
				cultural: 'Cultural Treaties',
				pCTs:['No request','Request','Requests','Cultural Treaty'],
				cultinfo:['Places','Partners','Empty','Requests','Distribution per city','Cultural Treaties in the museum of the city "{0}"','By exhibiting other people&apos;s cultural goods in your museum, you will please your educated citizens. Form cultural treaties with other players in order to gain more exhibits.','Cultural goods in this museum','Your citizens are admiring the many treasures of the museum!<br>The satisfaction rating in this town will increase by: <span class="bold green">{0}</span> (<b>{1}</b> from level,<b>{2}</b> from partners)','Username','Alliance','Capital','Actions','Withdraw cultural treaty request','Reject cultural treaty request','Cultural Partners','Cancel Cultural Treaty','Distribution of Cultural Treaties','You have a total of <b>{0}</b> cultural goods treaties. You can distribute these amongst your museums giving the citizens in your empire more satisfaction. You should distribute all cultural goods!','max','Confirm changes','No cultural treaty','Fullfill with cultural goods','outraged','angry','neutral','happy','euphoric','Attention! You did not distribute all your cultural goods!','At the museum your citizens are able to see how other nations try to copy our excellent culture. In order to host larger exhibitions you should upgrade your museum. After each museum expansion, you can display one additional cultural good.'],
				cultural_r: 'From form of Government',
				ctenabled: 'A Cultural Treaty has been established',
				ctrequested: ['A Cultural Treaty request from you','A Cultural Treaty has been requested to you'],
				playersearch:'Search player',
				Page: 'Page',
				CompMsg: 'Compose Message',
				FriendList: 'Friends List',
				HighscoreList: 'Highscore List',
				population: 'Population',
				citizens: 'Citizens',
				scientists: 'Scientists',
				scientists_max: 'max. Scientists',
				scientists_employed: 'Employed',
				options: 'Options',
				help: 'Help',
				dailytasks: 'Daily Tasks',
				agora: 'to Agora',
				to_world: 'Show World',
				to_island: 'Show Island',
				army_cost: 'Army Cost',
				fleet_cost: 'Fleet Cost',
				army_supply: 'Army Supply',
				fleet_supply: 'Fleet Supply',
				qltxts: ['Full load','Full loads','ship','ships'],
				research_cost: 'Research Cost',
				research_hp: 'City Hour production',
				income: 'Income',
				badtax: 'Increased (Tax)',
				expenses: 'Expenses',
				balances: 'Balances',
				diplomacy: 'Diplomacy',
				dammy_packages: 'Dummy packages',
				espionage: 'View Espionage Reports',
				send_out_spy: 'Send out spy',
				inventory: 'Inventory',
				effects: '[Effects] - Inventory',
				location: 'Location',
				contracts: 'View Treaties',
				treaty: 'Treaty',
				treaties_: 'Treaties',
				sendCTsopt: 'Send cultural goods treaty request',
				altreat: 'Alliance treaties',
				generalAllyView: ['No General Rank in Alliance','General Rank<br>Alliance Military Actions'],
				combat: 'View Combat Reports',
				dismiss_unit: 'Dismiss unit(s)',
				dismiss_fleet: 'Dismiss fleet(s)',
				edit_route: 'Creat trade route',
				satisfaction: 'Satisfaction',
				total_ : 'Total',
				total_cargo: 'Total Cargo',
				currenttotal_ : 'Current<br>Total',
				max_Level: 'max. Level',
				max_Level_complete: 'Highest level reached!',
				max_Level_tocomplete: 'Highest level to be reached!',
				actionP : 'Action Points',
				researchP : 'Research Points',
				research : 'Research',
				from_researchs : 'through Research (bonus)',
				potion : 'Potion of Wisdom',
				research_field : 'Field of Research',
				finances_ : 'Finances',
				free_ground : 'free Building Ground',
				trpart : 'Offers from trade partners',
				wood_ : 'Building Material',
				wine_ : 'Wine',
				marble_ : 'Marble',
				crystal_ : 'Crystal Glass',
				glass_ : 'Crystal Glass',
				sulphur_ : 'Sulphur',
				sulfur_ : 'Sulphur',
				luxury_good: 'Luxury Goods',
				angry: 'angry',
				unhappy: 'unhappy',
				neutral: 'neutral',
				happy: 'happy',
				euphoric: 'euphoric',
				bonuses: 'Overview of Bonuses<br>(Satisfied Citizens)',
				bonustiptxt:['City establishment (basic)','Museum (level+Cultural Treaties)','from Form of government','Tavern (level+wine distribution)','through Research+Capital bonus','due to Priests (with Theocracy)','due to Corruption','Total Happiness (balances)','Current Population','Available Happiness','Corruption average'],
				growth: 'Growth',
				housing_space: 'max. Housing space',
				free_Citizens: 'free Citizens',
				free_housing_space: 'free Housing space',
				level_tavern: 'Level Tavern',
				maximum: 'maximum',
				used: 'used',
				foruse: 'for use',
				branchreserved: 'To branch office',
				current: 'current',
				missing: 'missing',
				currcap: 'Current<br>capacity',
				currquant: 'Current<br>quantity',
				plundergold: 'Gold',
				garrison: 'Garrison limit',
				spy: 'Espionage',
				Sea: 'Sea',
				spytiptxt: ['In defense','On mission','Spies','For training','Spies&apos; places'],
				Inland: 'Inland',
				full: 'FULL',
				off: 'off',
				currentunits: 'current',
				time_to_full: 'to full',
				time_to_empty: 'to empty',
				sum_aftertranfer: 'after trasfer',
				capacity: 'Capacity',
				safe: 'Safe',
				resources_lootable: 'Lootable',
				shortbuildingtime: ['Shorten building time','End building time'],
				training: 'Training',
				theatertxts: {active: 'Active',inactive: 'Inactive',status: 'Status',resource: 'Drama<br>Wood production',tradegood: 'Comedy<br>{0} production',favour: 'Cultural<br>show',wood: 'Wood',wine: 'Wine',marble: 'Marble',glass: 'Crystal',sulfur: 'Sulphur',tip: 'Available show for +20 % {0}',luxury: 'Luxury resource'},
				plundering: 'Plundering',
				constructing: 'Expansion in Progress',
				constructing_mine:'In Progress',
				forminetitle:['Saw mill','Vineyard','Quarry','Crystal mine','Sulphur pit'],
				resourcelevel: 'Forest Level',
				tradegoodlevel: 'Mine Level',
				curwood: 'Available wood',
				maxwood: 'Required wood',
				diffwood: 'Rest wood',
				next_Level: 'Needed for Level',
				destination: 'Destination',
				origin: 'Origin',
				transport: 'Transports',
				from: 'from town',
				after_transport: 'After transports',
				in_transit: 'Transport',
				mission: 'Mission',
				subsum: 'Sub Sum',
				convert: 'Conversion',
				classify: 'Classification',
				dailyreset: 'Daily Refresh',
				finalevaluation: 'Final Evaluation',
				loading: 'loading',
				en_route: 'en route',
				arrived: 'arrived',
				arrival: 'Arrival',
				arrival_time: 'Time of arrival',
				speed: 'Speed',
				time_: 'Building time',
				time_remaining: 'Remaining time',
				total_ : 'Total',
				total_cargo: 'Total cargo',
				cargo: 'Cargo',
				duration:'Duration',
				currenttotal_ : 'Current<br>Total',
				to_town_hall: 'to Town Hall of {0} {1}',
				to_saw_mill: 'to Saw Mill of {0} {1}',
				to_mine: 'to Mine of {0} {1}',
				to_barracks: 'to Barracks of {0} {1}',
				to_shipyard: 'to Shipyard of {0} {1}',
				resource: 'Saw Mill in Forest',
				tradegood: 'Quarry on Mine',
				nextlevel: 'Next level',
				inprogress: 'In progress',
				member: 'View Alliance Member list',
				friendlist: 'View Friend list',
				transporting: 'Transport to {0} {1}',
				transtip: 'Move to the resource town and click here<br>to transfer the resources to this town',
				transporting_units: 'Deploying troops to {0} {1}',
				transporting_fleets: 'Moving fleet to {0} {1}',
				triton_engines: 'Triton Engines',
				troop_movements: 'Fleet / Troop Movements',
				station_army: 'Station troops',
				station_fleets: 'Station fleets',
				target: 'Target',
				today: 'Today',
				per_: 'per',
				at: 'at',
				in_: 'in',
				tomorrow: 'Tomorrow',
				yesterday: 'Yesterday',
				second: 's',
				minute: 'm',
				hour: 'h',
				day: 'D',
				week: 'W',
				month: 'M',
				year: 'Y',
				hour_long: 'Hour',
				day_long: 'Day',
				week_long: 'Week',
				ika_world: 'Search on Ikariam-World',
				charts: 'Show Charts',
				wonders: ['No Temple!','Hephaistos&apos; Forge','Hades&apos; Holy Grove','Demeter&apos;s gardens','Athena&apos;s Parthenon','Temple of Hermes','Ares&apos; stronghold','Temple of Poseidon','Colossus'],
				wonderstxt: [['Godly Equipment','Hephaestus, God of blacksmiths, can bless the work of his blacksmiths. Their armour becomes really strong and their swords becomes incredibly sharp for a few hours, so that it is almost as if they have been personally forged by a God.','After praying for a miracle, Hephaestus sent our high priest a blunt sword and told us that the quality of his work depends on the quality of our work. He obviously is not very happy about the inhabitants&apos; faith on this island!','All combat units receive 0 more armour and cause <b>10 %</b> more damage.','All combat units receive 1 more armour and cause <b>10 %</b> more damage.','All combat units receive 1 more armour and cause <b>15 %</b> more damage.','All combat units receive 2 more armour and cause <b>15 %</b> more damage.','All combat units receive 2 more armour and cause <b>20 %</b> more damage.'],['Gorgon Guard','The mighty Hades, ruler of the underworld, can send out terrible Gorgons, who can turn advancing enemies into stone with their stares. However, this does have the pleasant side effect that we always have enough stone at the end of a battle to rebuild our town wall.<br>Barbarians are not affected by this miracle.','It look like Elysium is still a long way away for you. After we requested a miracle from Hades, he said that it would be better for him to send his dog out to spread faith than to spend his time relying on our priests.','<b>20 %</b> of the resource costs for all units that die during fights in their own cities are credited back as marble units.','<b>30 %</b> of the resource costs for all units that die during fights in their own cities are credited back as marble units.','<b>40 %</b> of the resource costs for all units that die during fights in their own cities are credited back as marble units.','<b>50 %</b> of the resource costs for all units that die during fights in their own cities are credited back as marble units.','<b>80 %</b> of the resource costs for all units that die during fights in their own cities are credited back as marble units.'],['Blessed harvest','Demeter, Goddess of earth and crop can bless your people with a fertile ground and a fantastic harvest. Your population will also increase a lot faster - but only if there is enough housing space for more inhabitants.','Demeter, in her endless wisdom, has demanded that we sow some seeds of belief before we try harvesting miracles. She is worried that we do not know enough about agriculture to appreciate her gifts.','The population of your cities is increasing by <b>2</b> per hour.','The population of your cities is increasing by <b>4</b> per hour.','The population of your cities is increasing by <b>6</b> per hour.','The population of your cities is increasing by <b>8</b> per hour.','The population of your cities is increasing by <b>12</b> per hour.'],['Secured homeland','Athena, the tireless, the invincible, the protector. As protection goddess of your cities and of the craftsmen, she can reinforce your warehouses&apos; walls to hide more resources from pillaging enemies.','We should not aggravate goddesses like Athena. Praying for a miracle with such little faith could be interpreted as arrogance. After all, she does have the habit of turning people into animals!','<b>+ 40 %</b> secure resources in all warehouses.','<b>+ 80 %</b> secure resources in all warehouses.','<b>+ 160 %</b> secure resources in all warehouses.','<b>+ 240 %</b> secure resources in all warehouses','<b>+ 400 %</b> secure resources in all warehouses'],['Faster than lightning','Hermes, God of travelling salesmen and of transport, cannot stand the sight of stationary ships and unused goods. He fulfils your salesmen&apos;s wishes to get to places faster by giving dockworkers superhuman powers. This means that every ship only has to spend a fraction of the normal time loading its cargo at the harbour.','It is an honour that Hermes will helps us mortals if we pay homage to him, but it would even insult the God of thieves if we demanded help without giving him something in return. That kind of defraud would just be too... direct.','The goods&apos; loading speed is increased by <b>40 %</b>.','The goods&apos; loading speed is increased by <b>80 %</b>.','The goods&apos; loading speed is increased by <b>120 %</b>.','The goods&apos; loading speed is increased by <b>160 %</b>.','The goods&apos; loading speed is increased by <b>200 %</b>.'],['Massacre','Ares, the detested God of savage warfare, blood-lust and of massacre, fills the hearts of all warriors in the vicinity of your cities with pure hate. These warriors will then charge into bloody combat without a second thought to their own healths, until no man is left standing.','The priests are quivering in their boots. Nobody wants to talk to Ares at the moment, because if his attention is drawn to this small friendly island, he will overrun it with war and terror, so that the humans have to pay homage to him during battle and death.','<b>+ 100</b> morale per round for all armies stationed at your cities - even for enemy troops!','<b>+ 200</b> morale per round for all armies stationed at your cities - even for enemy troops!','<b>+ 400</b> morale per round for all armies stationed at your cities - even for enemy troops!','<b>+ 600</b> morale per round for all armies stationed at your cities - even for enemy troops!','<b>+ 2,000</b> morale per round for all armies stationed at your cities - even for enemy troops!'],['Sailors&apos; blessing','Poseidon, God of the seas, has sent many a disrespectful sailor on ludicrous odysseys. But those who render homage to him, can expect that their ship will sail over calm waters and will be led through perfect winds and onto their destination harbour. Poseidon shortens the travel time of all the ships that begin their journey while the miracle is activated .','At this moment in time, it would be foolish to aggravate Poseidon by asking him for a miracle. If an island&apos;s belief is not strong enough for him, he likes sending out terrible sea monsters to remind the inhabitants that they should respect the sea.','<b>10 %</b> increased speed for warships and transporters.','<b>30 %</b> increased speed for warships and transporters.','<b>50 %</b> increased speed for warships and transporters.','<b>70 %</b> increased speed for warships and transporters.','<b>100 %</b> increased speed for warships and transporters.'],['Stone Guard','The Colossus is a statue of the sun god Helios. He can let the sun shine out Colossus&apos; torch. The glaring, blazing light, which can be seen throughout Greece, symbolises a threat from the mighty God and ensures chaotic escape and confusion amongst your opponents.','Helios may be a competent and friendly god, but his power is equal to Zeus&apos;. If we do not put enough faith and belief in him, he probably will not continue to give us the time of day and stop his chariot of the sun just to dedicate his precious time to our requests.','<b>10 %</b> of all enemy troops and ships that are fighting against your troops in your towns have been driven away. The scatter time of <b>4h</b> has increased by <b>30m</b>.','<b>20 %</b> of all enemy troops and ships that are fighting against your troops in your towns have been driven away. The scatter time of <b>4h</b> has increased by <b>1h</b>.','<b>30 %</b> of all enemy troops and ships that are fighting against your troops in your towns have been driven away. The scatter time of <b>4h</b> has increased by <b>1h 30m</b>.','<b>50 %</b> of all enemy troops and ships that are fighting against your troops in your towns have been driven away. The scatter time of <b>4h</b> has increased by <b>2h</b>.','<b>100 %</b> of all enemy troops and ships that are fighting against your troops in your towns have been driven away. The scatter time of <b>4h</b> has increased by <b>3h</b>.']],
				wonderViewButton: 'Go to Monument<br>(Island view)',
				wonderViewButton2: 'Go to Monument<br>(City view)',
				wonderActivateButton: 'Miracle<br>activation',
				wonderlevel: 'Monument level',
				faithlevel: 'Faith level',
				islandshare: 'Island Faith Share',
				miraclecompletion: 'Miracle in action',
				cooldowncompletion: 'Cooldown completion',
				wonderdonations: 'Personal donations',
				donations: 'Donations',
				donateforexpansion: 'Donate to upgrade',
				wonderBeliefTooltip: 'This island has a faith of {0} %.',
				wonderBeliefInfo2: 'Island faith percentage is {0} %.',
				cityOrder : 'cityOrder',
				fullArmyTable :  'Show all military units',
				hideOnWorldView : 'Force hide on world view',
				hideOnIslandView : 'Force hide on island view',
				hideOnCityView : 'Force hide on city view',
				onTop : 'Show on top of Ikariam windows',
				windowTennis : 'Show above ikariam on mouseover',
				autoUpdates : 'Automaticly check for updates',
				smallFont : 'Use smaller font size',
				goldShort : 'Reduce total gold display',
				defaultBuildingList : 'Use default building list',
				alternativeBuildingList : 'Use alternative building list',
				compressedBuildingList : 'Use compressed building list',
				wineOut : 'Disable Ambrosia feature "Out of Wine"',
				dailyBonus : 'Automatically confirm the daily bonus',
				unnecessaryTexts : 'Removes unnecessary descriptions',
				ambrosiaPay : 'Deactivate new Ambrosia buying options',
				quantityLoads : 'View Full Loads + ships for quantities',
				wineWarning : 'Hide tooltip "wine warning"',
				wineWarningTime : 'Wine remaining warning',
				languageChange : 'Change language',
				current_Version : 'Current Version<b>:</b>',
				ikariam_Version : 'Ikariam Version<b>:</b>',
				reset : 'Reset all settings to default',
				resetbtn : 'Reset',
				zeroing: 'Reset to zero',
				zeroingtasks: 'Reset all tasks',
				remainingtime: 'Remaining time',
				goto_website : 'Goto the scripts greasyfork.org website',
				website : 'Website',
				Check_for_updates : 'Force a check for updates',
				check : 'Check for updates',
				Report_bug : 'Report a bug in the script',
				report : 'Report Bug',
				save : 'Save',
				save_settings : 'Save settings<b>!</b>&nbsp;',
				newsticker : 'Hide news ticker',
				event : 'Hide events',
				logInPopup : 'Hide the Info Window when login',
				birdswarm : 'Hide the bird swarm',
				walkers : 'Hide animated citizens',
				noPiracy : 'No Piracy',
				noTheater : 'No Cinetheater',
				donationButtons : 'Standard Donation Amounts Buttons',
				donwoodlogalltitle: 'All wood units for Donation',
				donwoodlogall: 'All available quantity',
				donwoodlogtitle: '{0} wood units for Donation',
				ctfinder: 'Cultural Treaties Finder',
				ΧΥshow: 'Show island coordinates',
				hourlyRes : 'Hide hourly resources',
				playerInfo : 'Show information about player',
				control: 'Hide Control center',
				alert: 'Please choose only one option!',
				alert_palace: 'Please visit your capital city first',
				alert_palace1: 'There is still no palace present in your city.\nPlease explore expansion and build a palace.',
				alert_toast: 'Data Reset, reloading the page in a few seconds',
				alert_error: 'An error occurred while checking for updates: ',
				alert_noUpdate: 'No update is available for "',
				alert_update: 'There is an update available for the Greasemonkey script "',
				alert_update1: 'Would you like to go to the install page now?',
				alert_daily: 'Please enable "Automatically confirm the daily bonus"',
				alert_wine: 'Warning wine > ',
				en : 'English',
				el : 'Hellenic',
				phalanx : 'Hoplite',
				steamgiant : 'Steam Giant',
				spearman : 'Spearman',
				swordsman : 'Swordsman',
				slinger : 'Slinger',
				archer : 'Archer',
				marksman : 'Sulphur Carabineer',
				ram : 'Battering Ram',
				catapult : 'Catapult',
				mortar : 'Mortar',
				gyrocopter : 'Gyrocopter',
				bombardier : 'Ballon-Bombardier',
				cook : 'Cook',
				medic : 'Doctor',
				spartan : 'Spartan',
				ship_transport: 'Merchant Ship',
				ship_ram : 'Ram Ship',
				ship_flamethrower : 'Fire Ship',
				ship_steamboat : 'Steam Ram',
				ship_ballista : 'Ballista Ship',
				ship_catapult : 'Catapult Ship',
				ship_mortar : 'Mortar Ship',
				ship_submarine : 'Diving Boat',
				ship_paddlespeedship : 'Paddle Speedboat',
				ship_ballooncarrier : 'Ballon Carrier',
				ship_tender : 'Tender',
				ship_rocketship : 'Rocket Ship',
				barbarian: 'Barbarian Axe Swinger',
				barbarianClub: 'Barbarian Clubman',
				barbarianKnive: 'Barbarian Knifeman',
				barbarianAxethrow: 'Barbarian Axe Thrower',
				barbarianWalker: 'Barbarian War Walker',
				barbarianRam: 'Barbarian Ram',
				barbarianCatapult: 'Barbarian Catapult',
				barbarianFighter: 'Barbarian Fighter',
				barbarianZeppelin: 'Barbarian Dirigible',
				ship_barbarian_light_battleship: 'Deckwrecker',
				ship_barbarian_light_ranged: 'Sail Shredder',
				ship_barbarian_heavy_battleship: 'Pyroboat',
				ship_barbarian_heavy_ranged: 'Boulder Catapult',
				ship_barbarian_heavy_battleship_II: 'Wedge Paddler',
				ship_barbarian_heavy_ranged_II: 'Powder Pitcher',
				ship_barbarian_first_strike_I: 'Terror of the Deep',
				ship_barbarian_first_strike_II: 'Dragonfire',
				ship_barbarian_anti_carrier: 'Dirigible Igniter',
				ship_barbarian_carrier: 'Barbarian Nest',
				cityOrder_description : 'cityOrder_description',
				fullArmyTable_description : 'Show all possible army units on the Army tab',
				hideOnWorldView_description : 'Hide by default on world view',
				hideOnIslandView_description : 'Hide by default on island view',
				hideOnCityView_description : 'Hide by default on city view',
				onTop_description : 'Show board on top of Ikariam windows',
				windowTennis_description : 'Bring board to the top on mouseover<br>Send behind ikariam windows on mouseout<br>Ignores "on top" option',
				autoUpdates_description : 'Enable automatic update checking<br>(Once every 24hrs)',
				smallFont_description : 'Use a smaller font for the data tables',
				goldShort_description : 'Total gold display shorten on the Board',
				defaultBuildingList_description : 'Use default building table',
				alternativeBuildingList_description : 'Use alternative building table',
				compressedBuildingList_description : 'Use condensed building table<br>Groups luxury resource production buildings<br>Groups palace/govenors residence',
				wineOut_description : 'Disables the Ambrosia option to buy "Out of Wine"',
				dailyBonus_description : 'The daily bonus will be automatically confirmed<br>and the window is no longer displayed',
				unnecessaryTexts_description: 'Removes unnecessary descriptions in buildings,<br>the building list of buildings, minimize scrolling',
				ambrosiaPay_description : 'Disables the new Ambrosia buying options,<br>click on the button cancels the action',
				quantityLoads_description : 'Display the full loads and extra ships for the related quantities',
				wineWarning_description : 'Hide tooltip "wine warning"',
				wineWarningTime_description : 'Wine remaining time turns, "red" at this point',
				languageChange_description : 'Change the language',
				newsticker_description : 'Hide news ticker in the GF-toolbar',
				event_description : 'Hide events under the advisers',
				logInPopup_description : 'Hide the Info Window when login',
				birdswarm_description : 'Hide the bird swarm in island and city view',
				walkers_description : 'Hide animated citizens and transport ships in island and city view',
				noPiracy_description : 'Removes the Pirate Plot',
				noTheater_description : 'Removes the Cinetheater',
				donationButtons_description : 'Adds standard amount for donation buttons (0,500,+1K,+10K,+100K,+500K,+1M) for expansion',
				ctfinder_description : 'Displays a icon next to the player&apos;s name, if you have a CT with him/her.<br>If the player hasn&apos;t accepted your request yet, the icon is half transparent.',
				ΧΥshow_description : 'Displays the coordinates ([X:Y]) of the island next to the city name.',
				hourlyRes_description : 'Hide hourly resources in the infobar',
				playerInfo_description : 'View information from the players in the island view',
				control_description: 'Hide the Control center in world, island and city view',
				visibility_category : '<b>Board Visibility</b>',
				display_category : '<b>Display Settings</b>',
				global_category : '<b>Global Settings</b>',
				army_category : '<b>Army Settings</b>',
				tweaks_category : '<b>Tweaks Settings</b>',
				building_category : '<b>Building Settings</b>',
				resource_category : '<b>Resource Settings</b>',
				language_category : '<b>Language Settings</b>',
				Initialize_Board : '<b>Initialize Board</b>',
				helpSteps: ['on your Town Hall and go through each town with this window open','on Research Advisor and then click on each of the 4 research tabs to the left panel','on your Capital\'s Palace','to the Museum','to the Cultural Treaty Partners List','to the Alliance Members List (go to ALL the available pages)','on your Finance tab','on the Inventory','on the "Troops in town" tab and go through each town with this view open'],
				on_your_Town_Hall : 'on your Town Hall and go through each town with that view open',
				on_the_Troops : 'on the "Troops in town" tab on left side and go through each town with that view open',
				on_Research_Advisor : 'on Research Advisor and then click on each of the 4 research tabs in the left window',
				on_your_Palace : 'on your Palace',
				on_your_Finance : 'on your Finance tab',
				on_the_Ambrosia : 'on the "Ambrosia shop"',
				Re_Order_Towns : '<b>Re-Order Towns</b>',
				Reset_Position : '<b>Reset Position</b>',
				On_any_tab : 'On any tab, drag the resource icon to the left of the town name',
				Right_click : 'Right click on the empire menu button on the left side page menu',
				Navigate : '1, 2, 3 ... 0, -, = <b>:&nbsp;&nbsp;</b> Navigate to town 1 to 12',
				Navigate_to_City : 'SHIFT + 1/2/3/4/5/4/5 <b>:&nbsp;&nbsp;</b> Navigate to City/ Building/ Army/ Setting/ Help tab',
				Navigate_to : 'Q, W, E, R <b>:&nbsp;&nbsp;</b> Navigate to City/ Military/ Research/ Diplomacy advisor',
				Navigate_to_World : 'SHIFT + Q, W, E <b>:&nbsp;&nbsp;</b> Navigate to World/ Island/ City view',
				Spacebar : 'Spacebar<b>:&nbsp;&nbsp;</b> Minimise/ Maximise the board',
				Hotkeys : '<b>Hotkeys</b>',
				updated_: 'Updated',
				tothe: 'to the',
				addtransport: 'Movement added',
				zones: ['Area "Seafaring"','Area "Economy"','Area "Science"','Area "Military"'],
				researchzones: ['Seafaring','Economy','Science','Military'],
				movements: 'Movements',
				shop: 'Shop',
				cinetheatre: 'to Cinetheatre',
				Cinetheatre: 'Cinetheatre',
				fulldatelong: 'dddd, Do MMMM YYYY H:mm:ss', // based on momentjs (untranslated)
				fulldateshort: 'dddd, D/M/YYYY H:mm', // based on momentjs (untranslated)
				dateformat: 'dddd, Do MMMM YYYY', // based on momentjs (untranslated)
				dateformatshort: 'dddd, D/M/YYYY', // based on momentjs (untranslated)
				timeformat: 'H:mm:ss', // based on momentjs (untranslated)
				timeformatshort: 'H:mm', // based on momentjs (untranslated)
				thousandSeperator : ',',
				decimalPoint:'.',
				leftquot: '&quot;',
				rightquot: '&quot;',
				ordinal: ['th','st','nd','rd'],
				pirtxt: ['Pirate Fortress','Capture Run','Crew Strength','Capture Points','Time remaining before valuation','Base Crew Strength','Crew Strength Bonus','Position','Daily highscore for capture points, next update at {0}','Send crew out on a capture run','Your crew is carring out a {0}. While this is the case, you cannot order another raid or capture run.','Duration','Cancel','Target','Reward','Action','Capture','Available from level','Smugglers','Fishing Boat','Wine Transport','Merchant Ship','Ram Ship','Diving Boat','Diplomat Ship','Castaways','Phoenicians','Convert capture points into crew strength','Requires at least 10 capture points','Conversion has a basic duration','As long as you have at least {0} capture points in your account, you will receive {1} bonus to your crew strength.','Confirm','A threatening pirate banner flies over your town&apos;s Pirate Fortress. The pirate who accumulates the most loot during a capture run can secure grandiose rewards. So that your capture points are not robbed from you until the day of the position calculation, you should strengthen your crew.','There is a base time of {0} for the conversion','Please enter the security word into the box below to carry out the activity. You do not need to take upper and lower case spelling into account when entering it. It&apos;s a security measure against dishonest pirates.','Security word','raid','capture run','Range for Raids','New Capture Run','Smugglers&apos; mission auto-repeat','No change','Position','Positions','Out of range from<br>{0} "<b>{1}</b>"','Current','Previous','Position difference','Time to reach target','Total raid time','Reach','Return','No reward','Rewards with current highscore list','Highscore difference','Current difference','Missions','Missions duration','Player','Copies to clipboard the current Pirate Highscore list.','The Pirate Highscore list has been copied to clipboard!'],
				financestxt: ['Balances','Amount of gold','Increased Gold Receipts','Amount'],
				researchtxt: {1010:'Deck Weapons',1020:'Ship maintenance',1030:'Expansion',1040:'Foreign Cultures',1050:'Pitch',1060:'Greek Fire',1070:'Counterweight',1080:'Diplomacy',1090:'Sea maps',1100:'Paddle Wheel Engine',1110:'Mortar Attachment',1120:'Architecture',1130:'Draft',1140:'Caulking',1150:'Massive Ram',1160:'Offshore Base',1170:'Piracy',1999:'Seafaring Future',2010:'Conservation',2020:'Pulley',2030:'Wealth',2040:'Wine culture',2050:'Culinary Specialities',2060:'Geometry',2070:'Market',2080:'Relaxation holiday',2090:'Helping hands',2100:'Spirit Level',2110:'Bureaucracy',2120:'Utopia',2130:'Improved resource gathering',2140:'Wine Press',2150:'Carpentry',2160:'Depot',2170:'Legislation',2180:'Soldier Exchange',2999:'Economic Future',3010:'Well construction',3020:'Paper',3030:'Espionage',3040:'Polytheism',3050:'Ink',3060:'Cultural Exchange',3070:'Anatomy',3080:'Optics',3081:'Experiments',3090:'Mechanical Pen',3100:'Bird`s Flight',3110:'Letter Chute',3120:'Pressure Chamber',3130:'The Archimedean Principle',3140:'Invention',3150:'Government Formation',3160:'State Religion',3170:'Archiving',3999:'Scientific Future',4010:'Dry-Dock',4020:'Maps',4030:'Professional Army',4040:'Siege',4050:'Code of Honour',4060:'Ballistics',4070:'Law of the Lever',4080:'Governor',4090:'Logistics',4100:'Gunpowder',4110:'Robotics',4120:'Cannon Casting',4130:'Pyrotechnics',4999:'Militaristic Future'},
				branchOfficetxt: ['Merchants and traders do their business at the trading post. There is always a deal to make or a bargain to hunt. Merchants from far away usually head for big and well known trading posts! Range and capacity of your trading post are increased with every second expansion.','Goods Trade','Soldier Exchange','Trade Treaty','Own Offers','Bargain hunter','Buy goods','Sell goods','Search radius','Islands within radius','Town','Goods per minute','Piece','Resource','Purchase price','Distance','Trade?','per piece','There are no offers at the moment.','Search for','Currency','Land Units','Sea Units','All','All','Unit','Offers from trade partners','Resources','Offer type','Quantity','Price','Limits','Buy','Sell','Reserved gold for acquisitions','Update offers'],
				servertimetip: '<b>World time (server)</b><br>{0}<br><b>Local time</b><br>{1}',
				summertime: 'Summer time',
				wintertime: 'Winter time',
				viewCityMenu: {image_troops:'Troops in town',image_espionage:'Espionage',image_resourceShop:'Λήψη αγαθών!',image_trader:'Premium trader',image_friends:'Invite friends',image_constructionlist:'Building construction list',image_fireunit:'Dismiss units',image_toggle:'Display building names',empire_Menu:'Empire overview'},
				dipladvtxt: ['Messages ({0})','Agora ({0})','Treaties','Alliance ({0})','Search player','Ignored players','Alliance','Inbox','Outbox','Inbox Archive','Outbox Archive','Inbox Archive','Outbox Archive','Action','Sender','Subject','Town','Date','Click here to expand/hide the message','Go to sender&aposs town','Reply to sender','Reply','Delete','Report','Ignore','Reply to all','This function forwards insults and offences to the Game Operator.\nDo you really want to forward this message to the GO?','Messages sent by this player will no longer be displayed.','Sure?','Yes','Cancel','No messages.','next','previous','All','Unread','Read','None','Mark as read','Delete','Influence','Diplomacy points: {0}','Receiver','New post','Agora','There are no messages on the Agora at the moment. Contact your town neighbours now by creating a new post.','Accept','Reject','Trade treaties','Partner','Cities','Status','Action','Cancel trade treaty','{0} towns','{0} town','Location','Name','Luxury<br>good','Cultural treaties {0}','Go to museum','Distribute cultural goods ({0})','Alliance forum','Alliance forum ({0})','Alliance information','Alliance information','Menbers list','Search alliance','Subforum','Threads','Last thread','Actions','Threads: {0}','Title','Replies','Create thread','Reply','Return to top','Report','Quote','Title','Submit','<b>{0}</b> characters remain','<b>{0}</b> character remains','No more characters are remaining','Username','Search','Θέση','Title','Username','Alliance','Ranks','Actions','No player found on this research.','Players you ignore','No entries','Title','Name','Alliance','Action','Player will no longer be ignored.','Delete','You can write a new post for the Agora here, which all islanders will be able to read.','Subject','Message','Create new thread','Back','{0} characters','{0} character','No more characters'],
				action: 'Action',
				museumlvl: 'Museum level',
				embassytxt: ['The embassy is a busy place: diplomats from all over the world negotiate contracts here, forge treaties and found alliances. In order to get a larger alliance you need to upgrade your embassy. Every expansion level of your embassy increases your diplomacy points.','Diplomacy Points','Alliance','Members list','Alliance Internal Page','Search alliance','Founding date (Age)','Members','Short description','Placement (Points)','Alliance homepage','Diplomatic Influence','Your rank','Founding an Alliance','In the embassy you can manage and lead your alliance or redistribute your ranks.','Tag (up to <b>5</b> characters)','Alliance name (up to <b>15</b> characters)','Become a member of an existent alliance','An alliance can be suggested that suits your place on the highscore list.','Alliance suggestion','Name','Abbreviation','Abbreviation','Name','Members','Points','Actions','Display Alliance page','Join the alliance','Last connection','Name','Towns','Rank','Points','Actions','Actions','Send message to the members of your alliance','Alliance treaties','Withdraw','You are not a member of an alliance','Alliance information'],
				resadvtxt: ['No scientist available','Available in {0}','Available','per Hour','Basic production','Premium Bonus','Not enough research points','Already researched.','Immediately','Requirement(s)','Costs','Available in'],
				researchshortdesc: {1010:'Building of ballista ships in the shipyard',1020:'2 % less upkeep for ships',1030:'Building of palaces, founding of colonies, overseas trading',1040:'Construction of Embassies.',1050:'4 % less upkeep for ships',1060:'Building of flame ships in the shipyard',1070:'Building of catapult-ships at the shipyard',1080:'Garrison right',1090:'8 % less upkeep for ships',1100:'Construction of paddle speedboats in the shipyard',1110:'Building of mortar ships in the shipyard.',1120:'Building of an architect&aposs office.',1130:'Quicker ships with a lighter load.',1140:'Construction of tenders in the shipyard',1150:'Construction of steam rams in the shipyard',1160:'Construction of balloon carriers in the shipyard.',1170:'Construction of Pirate Fortresses, Capture Runs, Raids, participation in the Capture Points Highscores',1999:'2 % ess upkeep for ships for each future level.',2010:'Building of warehouses.',2020:'2 % less building costs.',2030:'Allows the production of luxury goods, the construction of trading posts and gives you 130 units of each luxury good.',2040:'Building of taverns.',2050:'Training of chefs in the barracks.',2060:'4 % less building costs.',2070:'Treaties, form of government: Democracy.',2080:'Increases the satisfaction and maximum population in all towns.',2090:'Overloading of resources.',2100:'8 % less cost for the construction of buildings.',2110:'An additional building space in the towns.',2120:'+200 housing space, +200 satisfaction in the capital.',2130:'Construction of Forester Houses, Stonemasons, Wineries, Glassblowers and Alchemists&apos Towers.',2140:'Building of wine cellars.',2150:'Building of Carpentries.',2160:'Allows you to build depots.',2170:'Form of government: Nomocracy.',2180:'Building the Black Market.',2999:'+10 satisfaction and +20 max. inhabitants in every town for each future level.',3010:'+50 housing space, +50 happiness in the capital.',3020:'2 % more research points.',3030:'Building of hideouts.',3040:'Temples and Miracles.',3050:'4 % more research points.',3060:'Building of museums, cultural goods treaties, Phoenician merchant ships.',3070:'Recruiting of doctors in the barracks.',3080:'Building of an optician&aposs.',3081:'Purchase of research points for crystal glass, form of government: technocracy.',3090:'8 % more research points.',3100:'Construction of Gyrocopter in the barracks.',3110:'3 Gold upkeep cost less per scientist.',3120:'Building of submersibles in the shipyard.',3130:'Building of bombardiers in the barracks.',3140:'Building of workshops.',3150:'Start of a revolution, forms of government: dictatorship and oligarchy.',3160:'Form of government: theocracy.',3170:'Building a Sea Chart Archive.',3999:'2 % more research points for each future level.',4010:'Construction of a second trading port, shipyard.',4020:'2 % less upkeep for soldiers.',4030:'Recruiting of swordsmen and hoplites at the barracks.',4040:'Building of battering rams in the barracks.',4050:'4 % less upkeep costs and allows the form of government: aristocracy.',4060:'Training of archers in the barracks.',4070:'Building of catapults in the barracks.',4080:'Occupation.',4090:'8 % less upkeep for soldiers.',4100:'Construction of carabineers in the barracks and rocket ships in the shipyard.',4110:'Building of steam giants in the barracks.',4120:'Building of mortars in the barracks.',4130:'Building of firework test area.',4999:'2 % less upkeep for units for each future level.'},
				researchdesc: {1010:'A rotating attachment for our warships on which we can mount huge weapons! For a start our inventors have mounted a huge crossbow on it. But we assume that the attachment will be able to bear other machines, too. So as soon as one of our scientists has an idea we can install it on our ships without a problem.<br><br><b>Allows:</b> Building of [[v:u,s:213,h:10|ballista ships]] in the [[v:b,b:5,h:1|shipyard]].',1020:'If we always keep our ships nice and clean, they won&apos;t have to be repaired that often. It will also keep up the morale of the crew when they sing songs together from time to time while scrubbing the deck or mending the sail cloths.<br><br><b>Effect:</b> 2 % less upkeep for [[v:u,s:210,h:10|ships]].',1030:'There is a lot more than just an ocean out there! More islands await being discovered. We are not alone! We can gain ground on one of the newly discovered islands, tap new resources and get to know other nations! Our clerks are eager to administer even more, our traders ready to travel to new lands!<br><br><b>Allows:</b> Building of [[v:b,b:11,h:1|palaces]], founding of [[v:i,h:0,sh:6|colonies]], [[v:i,h:0,sh:3|overseas trading]].',1040:'If we get to know other nations, it will help us to make progress ourselves. Regular talks and warm exchanges can work true wonders and lead to new alliances and friendships. Of course we need a pretty and comfortable building for all the ambassadors and the feasts we will hold in their honour!<br><br><b>Allows:</b> Construction of [[v:b,b:12,h:1|Embassies]].',1050:'That is some tough and bad smelling liquid our scientists have found there! But since we have started sticking it onto our ships there are hardly any holes we have to mend!<br><br><b>Effect:</b> 4 % less upkeep for [[v:u,s:210,h:10|ships]].',1060:'A fire that can&apos;t be extinguished with water! With this mixture from many secret ingredients we can now set fire to ships and sink them! Soon we will conquer the seas with ships that have the breath of a dragon!<br><br><b>Allows:</b> Building of [[v:u,s:211,h:10|flame ships]] in the [[v:b,b:5,h:1|shipyard]].',1070:'Our scientists have improved the weapon attachment for our ships, so that they don&apos;t tear apart when we fling huge rocks towards our enemies. And thanks to the counterweight our catapult stays on board now and doesn&apos;t launch itself anymore.<br><br><b>Allows:</b> Building of [[v:u,s:214,h:10|catapult-ships]] at the [[v:b,b:5,h:1|shipyard]].',1080:'One of our philosophers has written down wise things about war and peace. He has advised us to confederate with other nations so that we can fight our enemies together!<br><br><b>Allows:</b> [[v:i,h:14|Garrison right]].',1090:'Our voyages will be much safer if we write down where all the dangerous currents and treacherous shallows are! Then our seamen won&apos;t have to be afraid of any jagged rocks, deadly maelstroms or seductive sirens any more.<br><br><b>Effect:</b> 8% less upkeep for [[v:u,s:210,h:10|ships]].',1100:'Great news for our seamen: A steam driven paddle wheel allows our ships to move much faster than they ever could with oarsmen. Now we can teach our enemies to fear us with our mighty paddle wheel rams.<br><br><b>Allows:</b> Construction of [[v:u,s:218,h:10|paddle speedboats]] in the [[v:b,b:5,h:1|shipyard]].',1110:'This mortar is so huge, that not even Hercules could drag it along. Only an armoured steam ship is strong enough to carry it and all the huge cannon balls it can fire at our enemies.<br><br><b>Allows:</b> Building of [[v:u,s:215,h:10|mortar ships]] in the [[v:b,b:5,h:1|shipyard]].',1120:'A good house can withstand the harshest elements. It can withstand them even better when a clever mind takes care of it with a lot of drawings and a little mathematics before hand, so that all the walls are straight and the roof is tight. Thanks to angles and compasses our buildings will be much more stable and well protected from the rain. An architect&apos;s office would spare us a lot of marble, just think about the savings we could make in constructing a new building!<br><br><b>Allows:</b> Building of an [[v:b,b:24,h:1|architect&apos;s office]].',1130:'Our scientists have found out that our ships have less water resistance when their load is smaller. This means that we can put larger sails on the mast and travel more quickly.<br><br><b>Allows:</b> Quicker ships with a lighter load.',1140:'With this technology, our engineers can seal leaky ships. Caulking in and in front of the port is a complicated undertaking, but gives our fleets the chance to get ready for battle between two attacks.<br><br><b>Allows:</b> Construction of [[v:u,s:220,h:10|tenders]] in the [[v:b,b:5,h:1|shipyard]].',1150:'One of the most dangerous sea units can be built with the ram. This masterpiece of engineering ingenuity is attached to the ship&apos;s bow and can inflict massive amounts of damage onto other ships.<br><br><b>Allows:</b> Construction of [[v:u,s:216,h:10|steam rams]] in the [[v:b,b:5,h:1|shipyard]].',1160:'We can use this research to build some of the largest ships in the shipyard. These are equipped with balloons that bomb opponents on the high seas.<br><br><b>Allows:</b> Construction of [[v:u,s:219,h:10|balloon carriers]] in the [[v:b,b:5,h:1|shipyard]].',1170:'A powerful Pirate Fortress with a strong crew eager for your orders. They are looking to loot capture points and gold. Fame and enormous amounts of resources beckon the most successful pirates. From here you can start raids on other Pirate Fortresses.<br><br><b>Allows:</b> construction of [[v:b,b:30,h:1|Pirate Fortresses]], [[v:i,h:19,sh:2|Capture Runs]], [[v:i,h:19,sh:5|Raids]], participation in the [[v:i,h:19,sh:6|Capture Points Highscores]].',1999:'The secrets of the oceans are finally ours! Our ships are constantly becoming tougher and faster! There are almost no ships on this ocean capable of competing with ours.<br><br><b>Effect:</b> 2% less upkeep for [[v:u,s:210,h:10|ships]].',2010:'We have learned how to store and protect our resources in the long term from wind and weather. Additionally a part of our resources is safe from pirates and other villains, who might want to steal from us!<br><br><b>Allows:</b> Building of [[v:b,b:7,h:1|warehouses]].',2020:'A brilliant idea: A rope that is pulled over a roll gives a simple man the strength of Hercules. So now our workers can lift up huge blocks of stone on their own and construct our buildings even faster!<br><br><br><b>Effect:</b> 2% less building costs.',2030:'The earth is full of valuable treasures! We have learned how to mine sulphur and crystal and how to chisel marble off rocks. We are also growing wonderful vines on the fertile land on our hills which produce delicious wine!<br>A new era of prosperity will dawn on us when we start using these treasures. We can then sell goods at a trading post and buy what we need from foreign traders.<br><br><b>Effect:</b> Allows the production of [[v:i,h:6|luxury goods]], the construction of [[v:b,b:13,h:1|trading posts]] and gives you 130 units of each luxury good.',2040:'A happy population needs festivals in which they can spend hours revelling and drinking our fantastic free-flowing wine. Dionysus loves seeing us enjoying what he has given us!<br><br><b>Allows:</b> Building of [[v:b,b:9,h:1|taverns]].',2050:'Our culture is truly rich in delicious treats! If we have cooks joining our soldiers in battle the delicious smell will be enough to remind them of their kitchen at home and surely strengthen their fighting spirit. And it shouldn&apos;t be forgotten, that a hearty meal has always brought a man back onto his feet. And of course a cook has a sharp knife that he can jump into the fight with.<br><br><b>Allows:</b> Training of [[v:u,u:310,h:9|chefs]] in the [[v:b,b:6,h:1|barracks]].',2060:'Right angles, triangles, circles – a few bright minds can calculate how we can construct our buildings even better and more beautifully. And soon our towns will serve as examples to the whole world!<br><br><b>Effect:</b> 4% less building costs.',2070:'The most unusual goods arrive at the market here from distant islands. You can form treaties with merchants here so that we get all the resources that we need.<br><br><b>Allows:</b> [[v:i,h:14|treaties]], [[v:i,h:18,sh:0|form of government:]] [[v:f,f:2,h:18,sh:3|democracy]].',2080:'A worker who has had a good rest is much more eager to work than an exhausted one. That&apos;s why every citizen should have one day off per week. This will make all our citizens happier!<br><br><b>Effect:</b> Increases the [[v:i,h:3|satisfaction]] and maximum population in all towns.',2090:'If our citizens help out a little underground instead of tanning themselves on the beach, we’ll get more raw materials and they’ll get less sunburn. There’s always a need for help down the mines, saw mills and vineyards.<br><br><b>Allows:</b> Overloading of [[v:i,h:5|resources]].',2100:'Water is always even. We should use this knowledge so that our buildings become even, too! Our town will become even more beautiful and we will use less stone and wood for constructing our buildings!<br><br><b>Effect:</b> 8% less cost for the construction of buildings.',2110:'Now our palace has even more shelves, boxes and drawers, more piles of records and forms as well as clerks who can understand it all. Finally we can afford to build and administer an additional building in our towns!<br>But due to the increased administration burden and the meticulous documentation of all processes, we cannot smuggle goods in or out of occupied towns anymore, as our occupier is also well informed about our records.<br><br><b>Allows:</b> An additional [[v:i,h:0,sh:1|building space]] in the towns.',2120:'Our citizens are living in wealth and prosperity. They are happy and healthy and have very little to worry about. Yes, one could say we are living in one of those places that you can only find in the scriptures from one of the great philosophers.<br><br><b>Effect:</b> +200 housing space, +200 satisfaction in the capital.',2130:'Some time has passed since we learned how to use the treasures of our island for our own needs. We should now educate our workers and let every forest, quarry or vineyard, every sulphur pit or crystal mine be administered by men who are not only strong but also skilful. This way we will gather even more income and our civilization will get richer than ever!<br><br><b>Allows:</b> Construction of [[v:b,b:18,h:1|Forester Houses]], [[v:b,b:19,h:1|Stonemasons]], [[v:b,b:21,h:1|Wineries]], [[v:b,b:20,h:1|Glassblowers]] and [[v:b,b:22,h:1|Alchemists&apos; Towers]].',2140:'What an event those annual wine fêtes are! The whole town is there when the best grapes in town are stomped into wine and when the liquid gold splashes around, the kids have the most fun! With a wine press though, handled by an experienced winemaker, we would lose much less. The winemaker could also organise proper storage that allows us to let the wine age and mature well!<br><br><b>Allows:</b> Building of [[v:b,b:26,h:1|wine cellars]].',2150:'Our island&apos;s forests provide us with excellent building material so that we can create strong woodwork for the roofs of our buildings. But to ensure that this is the case, lumber must be carefully selected and handled properly! A carpenter in our town would take care of this and would use up a lot less building material!<br><br><b>Allows:</b> Building of [[v:b,b:23,h:1|Carpentries]].',2160:'As our warehouses cannot handle the increasing amount of goods, we will need alternatives in the long run. Advanced methods of sealed tarpaulins and covers should enable us to store large amounts of goods in the open air.<br><br><b>Effect:</b> Allows you to build [[v:b,b:29,h:1|depots]].',2170:'We think it&apos;s a good idea to define the rules of living together on paper. This means that every island inhabitant can look up what&apos;s allowed and what isn&apos;t - meaning they&apos;ll be no more room for excuses!<br><br><b>Allows:</b> [[v:i,h:18,sh:0|Form of government]]: [[v:f,f:4,h:18,sh:5|Nomocracy]].',2180:'Our battle-tested warriors in their shiny armour, and our progressive war machines have become legendary. Now it&apos;s time to make a profit from them. Other leaders will be eager to purchase these troops.<br><br><b>Allows:</b> building the [[v:b,b:31,h:1|Black Market]].',2999:'Our citizens are wealthy and the marketplace is spilling over with delicacies from all over the world! The streets are clean and developed, making it easier for building material to reach the building site more quickly.<br><br><b>Effect:</b> +10 [[v:i,h:3|satisfaction]] and +20 max. inhabitants in every town per level of this future research.',3010:'Eureka! A well in our settlement! Now we don&apos;t have to wait for it to rain all the time. Our citizens will be much better off and the fields won&apos;t have to stay dry for very long!<br><br><b>Effect:</b> +50 housing space, +50 [[v:i,h:3|happiness]] in the capital.',3020:'We have found a better way to archive our knowledge! Now we have scriptures made from the papyrus plant, so we don&apos;t have to chisel our words into the heavy stones anymore in order to fill our library!<br><br><b>Effect:</b> 2% more research points.',3030:'When some of our citizens settle down in other towns, they can help us to keep an eye on our neighbours. We could keep ourselves informed when a neighbour makes a discovery or what kind of resources he has in stock.<br><br><b>Allows:</b> Building of [[v:b,b:16,h:1|hideouts]].',3040:'Man cannot rationally explain everything that happens in the world. And whenever he cannot explain it, the answer is sought from the gods. Gods are like humans on the one hand, but are very different on the other hand. After all, what other kind of rational explanation can the unexplainable have?<br><br><b>Allows:</b> [[v:b,b:28,h:1|Temples]] and [[v:i,h:15,sh:3|Miracles]].',3050:'Nature gives us everything we need to write: The birds give us their feathers and eight-armed fish out of the sea provide us with their black ink! Now we can write down our ideas even more easily!<br><br><br><b>Effect:</b> 4% more research points.',3060:'Our citizens should really have the chance to look at the cultural achievements of other people. And surely, in exchange, they will be interested in learning from us and exhibiting some of our great works of art in their museums.<br><br><b>Allows:</b> Building of [[v:b,b:10,h:1|museums]], [[v:i,h:14|cultural goods treaties]], Phoenician merchant ships.',3070:'We have learned a lot about the human body! Now we can send doctors into battle to help the wounded soldiers to quickly get back on their feet again. Of course they can mix the right tinctures and some doctors even know a secret recipe for a mixture that makes our fighters even braver.<br><br><b>Allows:</b> Recruiting of [[v:u,u:311,h:9|doctors]] in the [[v:b,b:6,h:1|barracks]].',3080:'When our scientists invent new things, many a glass can break. Or it gets lost in the infinite vastness of our laboratories, as keeping them tidy isn&apos;t really the primal virtue of the academy. If an optician would take care of not only the quality, but also that all the lenses and glasses are put back where they belong, we would use far less crystal glass!<br><br><b>Allows:</b> Building of an [[v:b,b:25,h:1|optician&apos;s]].',3081:'Our scientists would like to test their theories in practice. These kinds of attempts will probably accelerate the research, but it does mean we will need a certain amount of additional laboratory equipment. <br><br><b>Allows:</b> Purchase of research points for crystal glass, [[v:i,h:18,sh:0|form of government]]: [[v:f,f:6,h:18,sh:7|technocracy]].',3090:'A brilliant little apparatus: A smart inventor has managed to teach writing to a machine. Now we can copy our scriptures easily and our academies can quickly exchange their ideas with each other! <br><br><b>Effect:</b> 8% more research points.',3100:'We have learned how to fly like the birds! Now we can build a machine that can lift a man up into the skies and can whizz above the heads of our enemies with breath-taking speed, shooting arrows far behind the front lines.<br><br><b>Allows:</b> Construction of [[v:u,u:312,h:9|Gyrocopter]] in the [[v:b,b:6,h:1|barracks]].',3110:'A marvel: We can now shoot scrolls through pipes, so that they reach our scientists even faster! This saves us long errands and we have to pay less gold for our scientists!<br><br><b>Effect:</b> 3 Gold upkeep cost less per scientist.',3120:'Now we can let our ships sail under water, without them sinking! The oceans are ours! No enemy will see us, when we stalk them under water and sink them before they notice us!<br><br><b>Allows:</b> Building of [[v:u,s:212,h:10|submersibles]] in the [[v:b,b:5,h:1|shipyard]].',3130:'We have managed to get a machine to fly! Now even the sky isn&apos;t a limit anymore! We can let huge balloons fly over the heads of our enemies and throw fire or bee-hives at them from above!<br><br><b>Allows:</b> Building of [[v:u,u:309,h:9|bombardiers]] in the [[v:b,b:6,h:1|barracks]].',3140:'There has recently been a number of incidents relating to exploding powder and other substances. That&apos;s why we have set up an own workshop for all the nosy scientists, so that all the explosions don&apos;t disturb the work in the academy any more. It also has stronger walls and can&apos;t burn down as easily.<br><br><b>Allows:</b> Building of [[v:b,b:15,h:1|workshops]].',3150:'We have been thinking about the fact that a different form of government could give us special advantages. To do so there would be quite a lot to organise and we would possibly have to cut down on some staff, but it would be great to have that kind of government. <br><br><b>Allows:</b> Start of a revolution, [[v:i,h:18,sh:0|forms of government]]: [[v:f,f:3,h:18,sh:4|dictatorship]] and [[v:f,f:5,h:18,sh:6|oligarchy]].',3160:'Actually we don&apos;t need any secular laws - the religious ones are more than enough. And while we&apos;re at it: we don&apos;t actually need all our civil servants. <br><br><b>Allows:</b> [[v:i,h:18,sh:0|Form of government]]: [[v:f,f:7,h:18,sh:8|theocracy]].',3170:'We should probably archive our treasured sea charts. This will allow our sailors to always find the maps they need and save time on their journeys.<br><br><b>Allows:</b> building a [[v:b,b:32,h:1|Sea Chart Archive]].',3999:'The smartest brains in the world are working to answer the big question: Why are we here? Why is everything the way it is? And once again we are one step closer to enlightenment.<br><br><b>Effect:</b> 2% more research points.',4010:'A basin at the sea where water can be drained makes it so much easier for us to build ships and set sail. May a mighty fleet arise that teaches our enemies the true meaning of fear! <br><br><b>Allows:</b> Construction of a second [[v:b,b:3,h:1|trading port]], [[v:b,b:5,h:1|shipyard]].',4020:'These long marches over the hills and through the swamps mean that our material will wear out very fast. If we write down, how our soldiers can travel over land without always getting stuck in the undergrowth or sinking into the mud, the soldiers will have to mend their uniforms a lot less often.<br><br><b>Effect:</b> 2% less upkeep for [[v:u,u:301,h:9|soldiers]].',4030:'Chasing away pirates, barbarians and other villains will be much easier with some professional soldiers! It might be more expensive than just making our citizens into soldiers in the event of war, but in exchange our troops will be able to handle sword, spear and shield much better!<br><br><b>Allows:</b> Recruiting of [[v:u,u:302,h:9|swordsmen]] and [[v:u,u:303,h:9|hoplites]] at the [[v:b,b:6,h:1|barracks]].',4040:'With a ram&apos;s head made of metal and the strength of ten men we can even tear down town walls. Now it will be easy for our soldiers to conquer other towns!<br><br><b>Allows:</b> Building of [[v:u,u:307,h:9|battering rams]] in the [[v:b,b:6,h:1|barracks]].',4050:'Our soldiers are proud of serving their unit and their island kingdom. They are even taking better care of their uniforms, so that we don&apos;t have to mend and repair them as often.<br><br><b>Effect:</b> 4% less upkeep costs and allows the [[v:i,h:18,sh:0|form of government]]: [[v:f,f:1,h:18,sh:2|aristocracy]].',4060:'Now we know how to shoot arrows at our enemies. We should start right now to train our soldiers with these skills, so we can have archers joining our army in battle soon!<br><br><b>Allows:</b> Training of [[v:u,u:313,h:9|archers]] in the [[v:b,b:6,h:1|barracks]].',4070:'With this technology we can unleash powers that can even let huge rocks fly through the air! And if the rocks are large enough, they can even tear down town walls!<br><br><b>Allows:</b> Building of [[v:u,u:306,h:9|catapults]] in the [[v:b,b:6,h:1|barracks]].',4080:'If we employ a civil servant, we can then not only pillage our enemies&apos; towns, but also use and manage them. In no time we will be able to occupy foreign towns with our army from which we can then carry out further missions to increase our wealth and prosperity.<br><br><b>Allows:</b> [[v:i,h:8,sh:8|Occupation]].',4090:'Our soldiers can fight much better if they don&apos;t have to drag that much. And their equipment will last much longer on the long marches, so we won&apos;t have to mend it that often.<br><br><b>Effect:</b> 8% less upkeep for [[v:u,u:301,h:9|soldiers]].',4100:'This black mixture from the alchemist&apos;s kitchen can spark a fire with a loud bang and do truly devilish things! Now we can fill iron pipes with this powder to shoot heavy cannon balls through the air. <br><br><b>Allows:</b> Construction of [[v:u,u:304,h:9|carabineers]] in the [[v:b,b:6,h:1|barracks]] and [[v:u,s:217,h:10|rocket ships]] in the [[v:b,b:5,h:1|shipyard]].',4110:'Our scientists have built a mechanical giant with muscles made of metal and a steaming heart! Only the keenest and most skilled soldiers can steer such a colossus, but it will strike fear into everyone on the battlefield!<br><br><b>Allows:</b> Building of [[v:u,u:308,h:9|steam giants]] in the [[v:b,b:6,h:1|barracks]].',4120:'Our iron is getting heavier and harder: now we can even build barrels through which we can fire huge cannon balls at our enemies! If we can even fire bombs from a long distance our enemies and their town walls will tremble in fear!<br><br><b>Allows:</b> Building of [[v:u,u:305,h:9|mortars]] in the [[v:b,b:6,h:1|barracks]].',4130:'Sulphur is a really is a work of the devil! And with every new mixture, we can get even more impact from this precious resource. A safe practice ground would allow our blasters to test their inventions, without including the surrounding buildings as involuntary targets into their experiments.<br><br><b>Allows:</b> Building of [[v:b,b:27,h:1|firework test area]].',4999:'Our war machines are stronger and mightier than ever before and our armies are perfectly organised! Our civil servants managing the military have everything under control and thus the upkeep costs can be lowered.<br><br><b>Effect:</b> 2% less upkeep for [[v:u,u:301,h:9|units]].'},
				troopstxt: ['Troops in town','Inspect troops that are stationed in the town.','Inland garrison limit','Sea garrison limit','Units','Ships','Garrison','Defender','There are no allied units stationed in this town!','Occupying Forces','There are no units from an enemy occupation force stationed here!','Blocking fleets','There are no enemy troops stationed in this town.',''],
				barrackstxt: ['In the barracks the boisterous youth is instructed to become keen fighters. Your soldiers know how to handle swords, spears and slings and are also able to lead the mightiest war machines safely over the field. The troops are trained more quickly when you expand your barracks.','Occupation disadvantage','This town is being occupied by foreign troops.<br>New units can only be trained for double the cost!','Units Scheduled for Training','No units have been selected','No citizens are required','citizens','citizen','No unit is required','units','unit','No upkeep is required','No training duration',{wood:'wood',wine:'wine',marble:'marble',crystal:'crystal',sulfur:'sulfur',upkeep:'upkeep',time:'Required training duration'},'Completion:','Population Pack','Dummy packages','The different dummy packages allow you to fool opposing spies about your real troop strength.','Select a package','Recruit Units','To the description of unit "{0}"','Reset entry','Recruit as many as possible','max','Upkeep cost per hour. Can be reduced through forms of government and research.','Upkeep cost per hour','Training time','What would an island empire be without its fleet? At the shipyard, mighty warships are launched and made ready for long journeys over the oceans. May the seven seas tremble before them! Larger shipyards can build ships more quickly.','This town is being occupied by foreign troops. New units can only be trained for double the cost!','Ships Scheduled for Construction','No ships have been selected','No construction duration','Required construction duration','Ships construction','To the description of ship "{0}"','Reset entry','Construction duration per ship','Training','Construction','The building is upgrading!','Level <b>{0}</b> of building is required','Quantities not enough'],
				regGiftstxt: ['Registration Gifts','To welcome you as you deserve it, your citizens have collected some donations. You can collect a gift from here every day for a week. Welcome to Ikariam.','{0} Day','{0} Gold','{0} Research Points','{0} Spearmen',['{0} Gold','{0} Research Points'],'{0} Wine','{0} Crystal','{0} Gold','Receive!','Received!','You still have <b>{0}</b> ({1}) to receive your gifts.','You have received all the gifts. The window will remain available for <b>{0}</b> ({1}).','Ends at {0} ({1})'],
				wondertxt: ['Monument upgrade','Upgrade in progress','Next Level','Level','Required for next Level','Donated','Donated resources','Donations','Donate maximum quantity','maximum','Donate to upgrade','Maximum upgrade is completed!','Required resources','Wonder monument','Faith barometer','Level','Effect','Active duration','Cooldown duration','instantly','Players on this island','Player','Town','Donation quantity','Priests','Conve<br>rsion','Share','Go to','Actions'],
				forminetxt: ['Wood from the nearby forest is sawed into boards at the saw mill. It is then used as a material for constructing buildings and much more. The saw mill is extended by all inhabitants of the island together. The larger it is, the more workers you can employ there.','Assign Workers','Capacity','per hour','Town income','Overload!','No worker','Minimum','Maximum number of workers','Maximum','Confirm','Workers production','Unskilled production','Technocracy','Premium Bonus','Cinetheater','Helios Tower','Corruction','Total','{0} Citizens','Increased {0} Production',['wood','wine','marble','crystal','sulphur'],'{0} Days','Motivated workers','Motivate your workers in the Cinetheatre.','+ 20 % for 12 hours','Inactive','Go to Cinetheater','Players on this island','Player','Town','Level','Workers','Donated wood','Actions','Level {0}','{0} Workers','{0} Worker','Ambrosia Donation','Tutorial Ambrosia cannot be used on its own for this function. The donation will be displayed as a normal wood donation in the donation list.','Donate as much as possible','max',''],
				townhalltxt: ['Rename town','Old town name','New town name','Apply town name','Eename','Housing space','Inland garrison limit','Sea garrison limit','Action Points','Growth','per hour','Net Gold','{0} Citizens','Population and production','Notices','There are no special incidents! Congratulations, everything in your town is going fine!','There is corruption in this town!','The productivity and satisfaction in this town are reduced! Upgrade {0} to reduce corruption.','your Governor&apos;s Residence','your Palace','Your town&apos;s satisfaction is composed of lots of different elements. This chart can help you to identify problems and possibilities.','Bonuses','Basic bonuses','basic bonus','Form of Government','from research','capital bonus','Event bonus','Event bonus','Extra bonus','Still active for','from account transfer','Wine','from tavern level','from serving wine','There is no tavern available in this town yet.','Culture','from museum level','from cultural treaties','There is no museum available in this town.','Deductions','Population','Revolt','Form of Government','Total satisfaction','Abandon colony','You can give up your colony. However, all resources, citizens and units will be lost.'],
				taverntxt: ['After a hard day&apos;s work there is nothing more pleasant than a cool jug of wine. That&apos;s why your citizens love to meet at the tavern. And when the last old songs have been sung at the end of the day, they set out merrily and cheerful to their homes. Every expansion of your tavern allows you to serve more wine.','Serving of drinks','Serve wine','You can determine exactly how much wine is served to your population. The more wine you provide at the tavern, the happier your citizens will be. Attention: Every time you reallocate a large amount of wine you&apos;ll have to give your innkeeper an hour&apos;s ration.','Reset <br>entry','Serve as much<br>as possible','satisfied citizens','satisfied citizen','No wine','{0} craters of wine / hour','{0} crater of κρασιού / ώρα','The wine press saves you','craters of wine per hour','wine per hour','Cheers!'],
				academytxt: ['The academy is a sublime place full of knowledge which combines old traditions with modern technology. The wisest heads of your town await entrance! Consider that every scientist needs his own laboratory which costs money. The larger the academy the more scientists you can employ at the same time.','Assign Scientists','Research achievement','per Hour','Town income','Basic Production','Premium Bonus','Research','Form of Government','Corruption','Total','Overloaded','No<br>Scientists','maximum amount<br>of Scientists','Confirm','Conduct experiment','Our scientists have been experimenting for a long time and have finally discovered a way to create {0} research points. We need {1} crystal to conduct the experiments. But beware! The chemical reactions that happen during these experiments are quite loud and impressive. Thus the scientists need <b>4h</b> to clear up their laboratory afterwards so that they can carry on experimenting with crystal.','Current quantity is not enough','Research achievement','Cost','Conduct experiment','The scientists are still in the process of clearing up the mess that occurred after the last experiment.<br>Cleaning process:','To conduct the experiment<br>you need {0} more.','With the current quantity of crystal,<br>you can conduct up to {0}.','crystal','crystals','experiment','experiments','Each experiment, with current production, reduces<br>the duration for the availability of researches by <br><b>{0}<b>','The experiment is in progress','The quantity can be produced as follows:{0}','You have no crystal production in the crystal {0} you own!','You have no crystal towns!','{0}<br>of crystal','Hourly<br>production','Production<br>duration'],
				mayortxt: ['Mayor','Town News','Trade Routes','Current events ({0})','All','Military','Goods','Production','Espionage','Diplomacy','News','Piracy','Location','Date','Subject','Jump to the town "{0}"','previous 10...','...next 10'],
				porttxt: ['The port is your gateway to the world. You can hire merchant ships and get them ready for long journeys here. You can also receive precious goods from far away places. Larger ports can load ships faster. You can build another port that increases your loading speed as soon as you have researched the Dry-Dock.','Transport','Buy Merchant Ships','Trade Routes','Send out merchant ship','Transport to {0} {1}','Your up to 11 towns will be displayed here during the course of the game. You can select a town and choose how many goods should be sent to each town with your merchant ships.','How can I found new towns?','Fleets being loaded','Own merchant ships','Foreign ships','Incoming Traders','Raids','No ships registered with the port master.','Target town','Quantity','Mission','Status','Cargo on board','Transport','is being loaded','Accelerate loading process','Origin','Quantity','Mission','Arrival','Withdraw fleet!','','','','','','Loading speed','The loading speed shows how fast merchant ships can be loaded and unloaded in your port.','Trading Port (Level {0})','{0} Goods per minute','Form of Government','Temple of Hermes','Buy Merchant Ships','Merchant ships are your island kingdom&apos;s most important asset. You use them to transport your goods and units.','Learn more about Merchant Ships...','Maximum reached','Cost','Buy Merchant Ships','You don&apos;t have enough gold! You still need <b>{0}</b> Gold!','Maximum reached!','You are purchasing one of 40 additional Phoenician merchant ships. Every ship can transport up to 500 goods or a corresponding amount of land units. With every purchase of a Phoenician merchant ship, the Ambrosia price of the next one changes.','Purchase Phoenician Merchant Ship','{0} Ambrosia is missing','{0} Ambrosia is missing','Acquire now!!','Bonus Merchant Ships','Friend list','Form of Government','7 day bonus','Merchant ships','Phoenician Merchant Ships','Edit trade routes','Maximum reached','<p>A trade route allows you to send transports between two of your kingdom&apos;s towns every day. This way you can supply all of your settlements with wine or other goods. You have one free trade route available and can add more for a bit of Ambrosia.<br><br>Please make sure that there are always enough goods and merchant ships available at the allotted times during all trips on the trading routes and that the involved towns&apos; harbours are free of enemy fleets.</p>','Trade Route','Duration: 7 days','Not active','activate','Save changes','Delete','create new trade route','Another<br>{0}','extend','Extend automatically','You can automatically extend this feature by ticking the box. In the last three hours of the seven day runtime it will be extended by another 7 days.','End extension','If you untick the box the automatic extension will end immediately.','',''],
				traderoutestxt: ['Trade Routes','Choose source town','Choose destination town'],
				palacetxt: ['The palace is an excellent place to lead your empire into the future! It also provides a gorgeous view of the sea. Every expansion of your capital&apos;s palace allows you to set up an additional colony.','Current form of government: {0}','Towns in your empire',{anarchie:'Anarchy is a situation where there is no ruler. This form of government is established only during revolution period.',ikakratie:'Ikacracy is the leadership of the benevolent island ruler.',aristokratie:'Aristocracy is a government ruled by elite noble families.',demokratie:'Democracy is a government ruled by the people.',diktatur:'Dictatorship is a government ruled by a single military commander.',nomokratie:'Nomocracy is a form of government ruled by law in which the rulers themselves cannot easily change the laws.',oligarchie:'Oligarchy is a form of government in which power rests with a small number of people. In Ikariam these are the rich merchant families.',technokratie:'Technocracy is a government ruled by experts - at Ikariam these are the scientists and researchers.',theokratie:'Theocracy is a government ruled by the clergy.'},'Change form of government',{anarchie:['','25% additional corruption in all towns|All land units and warships will return home if they are stationed in foreign towns or are en route. If they are in the middle of a battle, they will automatically be scattered (exception: fights in own towns or ports).|No unit movements possible|No unit training possible|No espionage missions possible'],ikakratie:['None','None'],aristokratie:['-20% Building construction time|+20% Counter-espionage','+3% Corruption in all towns, apart from the capital city'],demokratie:['+75 Satisfaction in all towns|+1 Research point per hour for each cultural goods treaty issued','-20% Counter-espionage|+5% Building time for land units'],diktatur:['-2% Upkeep costs for land units|-2% Upkeep costs for navy units|-2% Building time for land units|-2% Building time for navy units|+2 Additional merchant ships','-75 Satisfaction in all towns'],nomokratie:['-5% Corruption in all towns|+20% Counter-espionage','+5% Building time for land units.|+5% Building time for navy units|+50% Loading time in your own ports'],oligarchie:['+5 Range of all trading posts|+10% speed for merchant ships|-2% Upkeep costs for navy units|+2 Additional merchant ships','+20% Building construction time|+3% Corruption in all towns'],technokratie:['+5% Research points per hour|+20% Unskilled labourers productivity','+1 Upkeep per scientist'],theokratie:['-20% Miracle cooldown|Satisfaction in all towns with a temple is increased by +2 times the conversion rate.<br>The maximum bonus is +150.|+1 gold production per priest','-5% Research points per hour|-20 Satisfaction in all towns without temples']},'Advantages','Disadvantages','Occupied cities','Occupied ports','You have not occupied any cities.','You have not occupied any ports.','If you want to switch your form of government, it will cost you <b>{0}</b> Gold for every town that you own (in total: <b>{1}</b> Gold). Until the new form of government is established, anarchy will rule. This will last for a certain time (<b>{2}</b> times the number of towns that you own, in total: <b>{3}</b>).','Researched forms of government','Not enough gold','Change form of government to',''],
				island: 'Island',
				luxres: 'Luxury resource',
				palaceColonytxt: ['A governor in your colony guarantees that all the daily administrative tasks are done properly. He also lowers the level of corruption in your colony. The governor&apos;s residence can be upgraded to a palace if you ever want to move your capital.','Towns in your empire','Relocate capital','You can declare this colony to your capital. With it, your governor&apos;s residence will be transformed into a palace of the same level and therefore this town will become your empire&apos;s capital. However, the palace in your old capital will be completely destroyed - so you will have to regain law and order by building a new governor&apos;s residence!','<p>You <b>can&apos;t</b> declare this colony your capital yet - the governor&apos;s residence needs to have the same level as your <b>amount of colonies</b> is first in order to be able to manage all colonies!</p><p class="red">You have to expand your governor&apos;s residence by another <b>{0}</b> in order to move your capital here.</p>','Declare this town your capital','The building is upgrading!'],
				levelcnt: ['levels','level'],
				incr: '#',
				workshoptxt: ['The most skilled men of our town serve at the workshop. They use the latest inventions to improve the equipment of our troops and warships, such that they become even better and stronger! Every expansion level allows you to get more upgrades for troops and ships.','Units','Ships','Improve offensive power','Improve defence strength','Cost: {0} units of Gold','Cost: {0} units of crystal','Duration: {0}','Damage: {0}','Armour: {0}','Improve!','Get resources!','Highest level reached!','The building is upgrading!','Insufficient building level!','Insufficient gold quantity!','Insufficient crystal quantity!','Insufficient gold and crystal quantity!','','',''],
				militaryupgrades: {Units: {archer:[['Iron Arrowhead','Steel Arrowhead','Fire Arrowhead'],['Leather Armour','Reinforced Leather Armour','Studded Leather Armour']],bombardier:[['Fire-Bomb','HellFire-Bomb','Inferno-Bomb'],['Leather Basket','Reinforced Leather Basket','Studded Leather Basket']],catapult:[['Fire-Missile','HellFire-Missile','Inferno-Missile'],['Bronze Plating','Iron Plating','Steel Plating']],gyrocopter:[['Crossbow','Double Crossbow','Rapid Fire Crossbow'],['Bronze Plating','Iron Plating','Steel Plating']],marksman:[['Bronze Musket','Iron Musket','Steel Musket'],['Leather Armour','Reinforced Leather Armour','Studded Leather Armour']],mortar:[['Thunder Grenade','Great Thunder Grenade','Armageddon Grenade'],['Bronze Wall','Iron Wall','Steel Wall']],phalanx:[['Steel Spear','Iron Spear','Steel Spear'],['Bronze Shield','Iron Shield','Steel Shield']],ram:[['Bronze Head','Iron Head','Steel Head'],['Bronze Roof','Iron Roof','Steel Roof']],slinger:[['Bronze Balls','Iron Balls','Steel Balls'],['Leather Clothing','Reinforced Leather Clothing','Studded Leather Clothing']],spearman:[['Steel Spear','Iron Spear','Steel Spear'],['Leather Armour','Reinforced Leather Armour','Studded Leather Armour']],steamgiant:[['Bronze Fist','Iron Fist','Steel Fist'],['Bronze Plating','Iron Plating','Steel Plating']],swordsman:[['Bronze Sword','Iron Sword','Steel Sword'],['Bronze Helmet','Iron Helmet','Steel Helmet']]},Ships: {ballista:[['Ballista','Double Ballista','Triple Ballista'],['Bronze Plating','Iron Plating','Steel Plating']],ballooncarrier:[['Fire-Bomb','Hellfire Bomb','Inferno-Bomb'],['Single Bulkhead','Double Bulkhead','Triple Bulkhead']],catapult:[['Fire-Missile','Hellfire-Missile','Inferno Missile'],['Single Bulkhead','Double Bulkhead','Triple Bulkhead']],flamethrower:[['Fire-Spewer','HellFire Spewer','Inferno Spewer'],['Bronze Plating','Iron Plating','Steel Plating']],mortar:[['Thunder-Grenade','Great Thunder Grenade','Armageddon Grenade'],['Single Bulkhead','Double Bulkhead','Triple Bulkhead']],paddlespeedship:[['Bronze spur','Iron spur','Steel spur'],['Bronze Plating','Iron Plating','Steel Plating']],ram:[['Bronze spur','Iron spur','Steel spur'],['Bronze Plating','Iron Plating','Steel Plating']],rocketship:[['Fire Rocket','Hellfire Rocket','Inferno Rocket'],['Single Bulkhead','Double Bulkhead','Triple Bulkhead']],steamboat:[['Bronze ram spur','Iron ram spur','Steel ram spur'],['Single Bulkhead','Double Bulkhead','Triple Bulkhead']],submarine:[['Clockwork Torpedoes','Automaton Torpedoes','Machine Torpedoes'],['Single Bulkhead','Double Bulkhead','Triple Bulkhead']]}},
				templetxt: ['The temple is a place of faith, belief and reflection. Priests live here, paying homage to their God and spreading his word throughout the island. You can also request a miracle from him, if you pay him enough respect.','Faith Barometer','This island has a faith of {0} %.','Island faith percentage is {0} %.','Assign priests','Conversion rate of your population','Island conversion percentage','Town income','per Hour','{0} priests','{0} priest','No priest','Maximum number of priests','Confirm','Miracle','{0} (Level {1}/{2})','Duration: {0}','Cooldown: {0}','Completion of miracle effect','Completion of cooldown'],
				warehousetxt: ['A depot enables you to store large amounts of goods. Every extension level of the depot can hold 32,000 units of each type of good. However, the depot is not protected from pillagers.','Some of your supplies are protected from pillagers at the warehouse. It keeps rain, birds and other pests away. The warehouse keeper is also always well informed about your supplies. Expanding your warehouse allows you to protect and store more resources.','Town goods overview','100% increased theft security','Not active','Active','100% increased storage capacity','Safe','Resource','Safe<br>quantity','Capacity'],
				lootable: 'Lootable',
				blackmarkettxt: ['The Black Market allows you to sell military units for gold or another resource. Upgrade the building to enable you to sell more types of units and reduce the tax rate for this trade. Other leaders will see your offers in their Trading Post.','Offer units','My offers','Offer units: {0} / {1}','Tax break: {0} %','Your current tax rate is <b>{0} %</b>. The taxes are deducted from each of your sales.','While there is combat going on at the city, no soldier exchange is possible.','As a member of an alliance, you can put <b>4</b> additional offers up for sale.','Unit type','Amount','Currency','Limits','Price per unit','max','Add','My offers: {0} / {1}','You currently have no offers on sale in the Black Market.','Units','Amount','Price / unit','Tax','Profit / unit','Action','Cancel offer'],
				SCAtxt: ['Valuable sea charts are archived in the Sea Chart Archive. This allows our sailors to navigate the seven seas even faster. The higher the building level and the more distant the destination, the greater the time saving for the journey there and back.','5 Islands','20 Islands','50 Islands','Distance','Current duration (next level&apos;s saving / current saving)'],
				walltxt: ['The town wall protects your citizens against your enemies and the sun. Beware! Enemies will try to tear holes into your wall or to climb over it. Every level increases the resistance of your town wall.','Information','Ballista|Catapult|Bombs','Damage','Accuracy','Hit points','Armour','Garrison limit'],
				safehousetxt: ['A wise leader always keeps an eye on both his allies and his enemies. The hideout allows you to hire spies who can provide you with information from inside other towns. A larger hideout provides space for more spies.','Espionage reports','Archive','Train spy','This citizen is loyal and discreet. An ideal candidate for a spy. Training time for a spy:','{0} are currently working in the defence','Maximum number of spies has been reached!','Ανεπαρκής ποσότητα αγαθών','Εκπαίδευση','Επαναφορά<br>αριθμού<br>κατασκόπων','Εκπαίδευση<br>μέγιστου αριθμού<br>κατασκόπων','Info','You can train {0} spies','You can train {0} spy','<b>{0}</b> are waiting for their training','<b>{0}</b> is waiting for his training','No citizen is waiting for training','<b>{0}</b> are currently working in the defence','<b>{0}</b> is currently working in the defence','No spy is currently working in the defence','<b>{0}</b> are currently on a mission','<b>{0}</b> is currently on a mission','No spy on a mission','Spy on a mission','None of your spies are currently on a mission!','Owner','Target','Mission','Results','Agents','Decoys','Date','No espionage reports!'],
				unitdescs: {slinger:'Slings are light and cheap weapons. They cannot inflict much damage on well-armed opponents, but at least their munition is readily available.',swordsman:'Sword fighters are usually barely armoured and fight without shields to retain their mobility. Thus they can circulate around the immobile Phalanx formation and attack from the flanks.',phalanx:'Hoplites are heavily armoured spearmen from the towns&apos; middle classes. They form the heart of every Greek army. In the so-called "Phalanx" formation they push forward in an unstoppable wall of spears and shields.',marksman:'Shots from the sulphur carbine can penetrate even the most durable armour. However, due to its sight line, only a single row of carabineers can fire, while the rest have to reload.',mortar:'The mortar fires explosive shells against the walls of a besieged city. No building can withstand this destructiveness. However, the rare munition for it has to be brought along additionally, so shots fired need to be very well-targeted.',catapult:'Catapults sling huge rocks against opponents&apos; defence facilities and thus they can destroy even the strongest stone walls. However they are less useful for defence against enemy armed forces.',ram:'Powerful men swing the massive tree trunk against the enemy gates, until they give way and the men run for cover under the roof. It might only be useful for gates and walls, but at least it does not need any munition.',steamgiant:'This powerful machine moves like a person on the battlefield, but has a superhuman hit strength. Stones, arrows and swords simply bounce off it. Woe betide anyone who dares to oppose it!',bombardier:'Our inventors have discovered that the sun is so hot because it attracts warm air. That is why a balloon filled with hot air also rises in direction of the sun and our soldiers can throw explosive shells down on our enemies from up there.',cook:'Your army&apos;s cooks know exactly how to give new courage to the warriors and heroes in the encampment: A glass of wine and a stew, just like mum used to make! If they take the evening to remember what they are fighting for, enemies will find it very hard to wear them down.',medic:'These doctors have voluntarily enlisted to help tend to the wounds of those on the battle front. They can remove arrow heads, bandage up sword wounds and have enough ice available for soldiers&apos; heads should enemies attack with slingshots.',gyrocopter:'A novel flying machine that is fast, versatile and not dependant on the direction of the wind - we can hunt cowardly enemies that want to attack us from the skies with it!',archer:'Bows are a very popular hunting equipment, so it is very easy to recruit archers amongst citizens. Military training turns simple citizens into formidable long-range combat troops.',spearman:'Spearmen are conscripts from the rural population, that go into battle with light armour and basic spears. They do not usually have a chance against professional soldiers.',spartan:'He is born for battle. His trade is that of war. He only fights on the front line on the field.',ship_ram:'Equipped with a simple ram at the stable bow, this ship is the primary warship of the navy. A dozen strong rowers power it in order to ram the spur against the opposing hull. That alone is often enough to make an enemy ship sink.',ship_flamethrower:'At the fire ship&apos;s bow there is flame thrower, which sprays Greek fire over the sea. Even on the ocean&apos;s surface, the mixture keeps on burning and creates a bed of flames. A terrifying close combat ship',ship_submarine:'A boat that sails below the water&apos;s surface is the ultimate sea weapon. It can slip past enemy lines almost unnoticed and cause massive amounts of damage.',ship_ballista:'This ship contains a ballista, which was originally meant for firing grappling hooks. However, the ballista is also very valuable as a precise long-range combat weapon, as it hits the enemy under the waterline, even though it does not cause a large amount of damage.',ship_catapult:'The catapult at the deck of the ship is smaller than its counterpart on land due to a lack of space. The ocean waves make it very imprecise, but it does fire clay jugs of burning oil, which leave dangerous little oil slicks behind at sea.',ship_mortar:'The mortar ship has an especially large hull with a high water displacement, so that it can withstand the enormous recoil of the mortar. If the fuse of a missile is correctly measured, the powerful projectile explodes just over the enemy deck.',ship_steamboat:'Just like the ram ship, the steam ram is fully equipped with a ram spur at its bow. However, it is a considerably more advanced version. Due to its steam engine, this ship can accelerate even more speedily and can therefore inflict a larger amount of damage on the enemy. The steam ram is probably the most dangerous ship at the front line.',ship_rocketship:'Thanks to our research, our scientists have managed to store large amounts of explosive power in wooden devices that can be blasted several hundred meters over the water&apos;s surface and can cause a huge explosion if thrust on opposing ships. The enemy should be afraid - very afraid - of this lethal weapon!',ship_paddlespeedship:'An invention that would have even astounded Heron: the paddle speedboat uses the impulse of a giant aeolipile as well as paddle wheels to drive into opposing ships with a huge amount of power and speed. The ship barely needs any crew.',ship_ballooncarrier:'The balloon carrier is an enormous floating stronghold. With the balloons on it we can attack our enemy in the skies at sea too.',ship_tender:'Tenders are designed for the support and maintenance of ships. Trained engineers and divers can repair minor damage in the dock immediately, allowing these units to return to the front lines. They also supply the sailors with food and wine.'},
				prodBuildtxt: [{forester:'The strong lumberjacks can chop down even the largest trees. But they also know that a forest must be cultivated and new trees planted so that we can continue to use only the best timber for our houses. The production of building material is increased by <b>2 %</b> for every level of expansion.',winegrower:'A winegrower only chooses the most sunny hills of the surrounding area to cover them with the comforting green of the vines. That&apos;s how the vineyards produce plump fruits that make for a much better harvest. Every level of the winegrower&apos;s expansion increases your wine production by <b>2 %</b>.',stonemason:'A trained stonemason always quarries the right blocks of marble with his strong arms. Thus less is broken and our builders always have the material they need. For every level of expansion this building increases the marble production by <b>2 %</b>.',glassblowing:'True masters of their art create sparkling pieces at the glassblower&apos;s house. The blow tubes, glass and all sorts of other apparatuses are only understood by our scientists. And they are so nimble, that barely anything ever gets broken. Every level of expansion increases your production of crystal glass by <b>2 %</b>.',alchemist:'When the wind blows from the west, a smell fills the streets around the tower and not many citizens are seen leaving the house without a peg on their nose. Our alchemists work restlessly on finding the perfect mixture and ensuring that we can get the maximum amount of sulphur from the pit. For every level of the building your sulphur production is increased by <b>2 %</b>.'},'{0} production','Basic Production','Premium Bonus','Cinetheater','Helios&apos; Tower','Ξυλοκόπος','Corruption','Resource','Bonus','There is corruption in this town!','Productivity and satisfaction in this town are rapidly decreasing! Upgrade {0} to reduce the corruption.','your Governor&apos;s Residence','your Palace',{forester:'Wood',winegrower:'Wine',stonemason:'Marble',glassblowing:'Crystal',alchemist:'Sulphur'}],
				reductBuildtxt: [{carpentering:'Only the best lumber is used at the carpenter&apos;s workshop. Therefore our handy craftsmen are able to build a solid framework and our houses do not have to be repaired all the time. Every level of the carpenter&apos;s workshop lowers your demand for building material by <b>1 %</b> of the basic value.',vineyard:'Only the purest wines mature in the town&apos;s deep and cool cellars. The cellarer ensures that not a drop goes to waste and that all the wine can run down the throats of your citizens. The demand for wine in your town will be reduced by <b>1 %</b> for each building level.',architect:'Angle, Compass and Yardstick: The architects&apos; office provides everything you need for building straight walls and stable roofs. And a well-planned house needs a lot less marble than a skew one. The demand for marble in your town will be reduced by <b>1 %</b> for each building level.',optician:'Lenses and magnifying glasses don&apos;t just help our scientists to see clearly and to find important papers on their desk, but they are also necessary in order to invent all those new technologies that make us so proud. The optician keeps everything we need carefully stored in boxes, so that less things get lost. The demand for crystal glass is reduced by <b>1 %</b> per building level.',fireworker:'Constant tests with fireworks don&apos;t just light up the skies but sometimes also the surrounding buildings. However our scientists can only optimise the demand for sulphur, when they keep testing new mixtures. The demand for sulphur in your town will be reduced by <b>1 %</b> for each building level.'},{carpentering:'Wood',vineyard:'Wine',architect:'Marble',optician:'Crystal',fireworker:'Sulphur'},'{0} cost reduction for building','{0} cost reduction for Units','{0} cost reduction for Ships','{0} cost reduction for Experiments','{0} cost reduction for Unit and Ship Improvements','Basic Cost','Research','Cost','{0} cost reduction','Resource'],
				militarytxt: ['Troop movements ({0})','Combat reports ({0})','Gauntlet Wars','Current battles','Fleet / Troop Movements','All','Mission','Arrival time','Speed','Units','Origin','Target','Action','Currently there are no troop movements for you to see!','Combat reports','There are no combat reports available at the moment.','Type','Last round','Rounds','Town','Owner','Action',{groundfight:['Battle','Display battle'],seafight:['Sea battle','Display sea battle']},'All','Reverse selection','-- Select action --','Delete','Mark as read','OK','Alliance Gauntlet Wars','Concluded Gauntlet Wars','Concluded Alliance Gauntlet Wars','You aren&apos;t currently involved in any Gauntlet Wars','Your alliance isn&apos;t currently involved in any Gauntlet Wars'],
				dismissunits: ['Dismiss units-ships','Dismiss unit(s)','Dismiss ship(s)','Reset entry','Dismiss as many as possible','Dismiss!','Costs',{citizens:'Citizens',wood:'Wood',wine:'Wine',sulfur:'Sulfur',upkeep:'Upkeep cost per hour',glass:'Crystal'},'Confirm','Number of units to dismiss','Yes','Cancel'],
				dailytaskstxt: ['Here you can find the list of tasks which you can complete to please the gods each day.<br>For each task completed, you&apos;ll receive a certain amount of favour. You can then select one or more rewards for this favour.<br><br>The tasks are available again every day, whilst the favour earned expires each week.','Tasks','Rewards','Tasks completed today: {0} / {1} ({2})','Successfully raid barbarian village','Trade goods','Spend Ambrosia','Improve something in the workshop','Conduct capture runs','Produce warships','Research something','Donate to upgrade a miracle','Donate to upgrade of resource deposit','Train troops','Commission building work','Pillage another player&apos;s town','Start pirate raid','Unlock an achievement','Screen the cultural feature in the Cinetheatre','Resources',{wood:'wood',wine:'wine',marble:'marble',glass:'crystal',sulfur:'sulphur',gold:'gold',research:'research points',spearman:'spearmen',slinger:'slingers',phalanx:'hoplites',swordsman:'swordsmen',archer:'archers',steamgiant:'Steam Giants',marksman:'Sulphur Carabineers',bombardier:'Ballon-Bombardier',premium:'24 hours Premium Account',resourceBonus:'24 hours Steam Saw',wineBonus:'24 hours Steam Wine Press',marbleBonus:'24 hours Steam Hammer',sulfurBonus:'24 hours Steam Sulphur Paddle Wheel',crystalBonus:'24 hours Steam Crystal Drill'},'Redeem','Not enought favours.','Display Cinetheater'],
				cinetheatretxt: ['The comedies and dramas of the Cinetheatre make your workers happy and motivate them. Afterwards they will labour all the more. The cultural feature does not interest your workers in the slightest, yet it is the most favourite of the Gods! They will give you favour for it.','Should you have any <b>problems</b> displaying a video or activating your bonus, please check whether you currently have an <b>ad-blocker</b>, <b>script blocker</b> or other <b>script</b> active in your browser. Let the video play through completely so that you can be certain of receiving your bonus. You will receive a <b>town advisor message</b> once it activates.','Did you enjoy that?','Play now!','Your bonus is now active.','Which feature would you like to show?','No feature available<br>at this time.','Drama','Comedy','Cultural Feature','Wood Production','{0} Production',{wine:'Wine',marble:'Marble',crystal:'Crystal',sulfur:'Sulphur'},'+20 % for 12 hrs','50 Favours','Show feature','You can earn production bonuses and favour here by watching videos from other Gameforge titles.','You must watch the video to the end in order to get the bonus.','The production bonuses last <b>12 hours</b> and only apply to the town where you watched the video. So think carefully about where you&apos;re going to visit the theatre.','You can only earn favour here once per day. It resets every midnight (server time).'],
				abandoncitytxt: ['Abandon of {0} {1}','Abandon colony','You can give up your colony. However, all resources, citizens and units will be lost. So make sure that all are safe before making this step. Are you sure you want to abandon your colony?','Please enter the security word from the picture below into the box provided to confirm the colony&apos;s deletion.','Security word'],
				chrcnt: ['characters','character'],
				am: 'am',
				pm: 'pm',
				ambrosia: 'Ambrosia',
				ambrosiaFountain: 'Divine Ambrosia Fountain',
				ambrosiaFountaintxt: ['{0} Ambrosia is missing','{0} Ambrosia is missing','Acquire now!!','This palatial fountain incorporates the effigies of two deities holding aloft a cornucopia. Ambrosia once flowed unabated from this horn into the pool below, but since then the fountain seems to have dried up.','This spring has divine origins. If we pay homage to the gods and offer them gifts, we can make this fountain shine in great splendour once more.','If we pray at the fountain often enough and regularly empty the pool of Ambrosia, our efforts will be well rewarded!','If you log in several days in a row, the amount of Ambrosia to be collected will continuously increase. From <b>8<sup>th</sup></b> day, the amounts will repeat those from days <b>5<sup>th</sup></b> to <b>7<sup>th</sup></b>.','The fountain can be used on <b>365</b> consecutive days.','If you don&apos;t log in for a day, you won&apos;t receive any Ambrosia and the count will start again from scratch.'],
				deploying_troops: 'Deploying troops',
				deploymentarmy: 'Deploying units',
				deploymentfleet: 'Deploying ships',
				army_movement: 'Army movement',
				capture: 'Capture',
				raid: 'Raid',
				demolitiontxt: ['Confirm downgrading of building','Attention','By confirming this action your building will be downgraded by one level. Should it reach level 0 it will then be completely torn down and the building space will become available again. Are you really sure you want to reduce the building level by one level?','The following resources will be returned by demolishing','Yes, I am sure','No, better not'],
				deploying: 'Deploying',
				invfriendtxt: ['Invite friends','You can get in touch with players that are in your friend list more quickly and you can also both see when the other is online. If a player founds a colony, all his friends will receive a gold bonus. If a player completes a research topic, all his friends will receive a small bonus from the invested research points.','Add Ikariam players','Username','Add','Existing invitations'],
				takeoffertxt: ['Offer management','Choose which goods or units you want to buy from the player with name {0}. Also, set the amount of gold you intend to pay.','From here you can send fleets to sell goods on player with name {0}. The exchange will be completed only when your fleets arrive to their destination. For this, you can set the minimum price for your goods, if the owner reduces the offer meanwhile.'],
				notEnCap: ['Insufficient storage capacity','Go to the {0}','Go to the {0}','Go to<br>the {0} or the {1}'],
				click_:'<b>Click</b>'
			},
			el:
			{
				allyranks: ['Αρχηγός','Υπουργός Εσωτερικών','Στρατηγός','Διπλωμάτης'],
				advisors: ['Σύμβουλος Εμπορίου','Σύμβουλος Στρατεύματος','Σύμβουλος Έρευνας','Σύμβουλος Διπλωματίας'],
				adequacy:'Επάρκεια',
				level:'Επίπεδο',
				in_level:'στο επίπεδο {0}',
				upgrade:'Αναβάθμιση',
				inqueue:'Στην ουρά',
				downgrade:'Κατεδάφιση',
				upbtntitle:'Η αναβάθμιση δεν είναι δυνατή προς το παρόν',
				qubtntitle:'Η αναβάθμιση μπορεί να τοποθετηθεί στην ουρά',
				downbtntitle:['Η κατεδάφιση δεν είναι δυνατή!','Η κατεδάφιση είναι δυνατή!'],
				buildings: 'Κτήρια',
				economy: 'Οικονομία',
				military: 'Στράτευμα',
				greek: 'Ελληνική',
				empire: 'Αυτοκρατορία',
				overview: 'Επισκόπηση',
				ships: 'Πλοία',
				units: 'Μονάδες',
				troops: 'Στρατεύματα',
				fleet: 'Στόλος',
				towns: 'Πόλεις',
				townHall: 'Δημαρχείο',
				city: 'Πόλη',
				capital: 'Πρωτεύουσα',
				capital_: 'Πρωτεύουσας',
				colony: 'Αποικία',
				colony_: 'Αποικίας',
				palace: 'Παλάτι',
				palaceColony: 'Κυβερνείο',
				tavern: 'Ταβέρνα',
				renew: 'Απομένων χρόνος<br>σημερινών αποστολών',
				museum: 'Μουσείο',
				academy: 'Ακαδημία',
				workshop: 'Εργαστήριο',
				temple: 'Ναός',
				workers: 'Εργάτες',
				unskilled: 'Ανειδίκευτοι',
				embassy: 'Πρεσβεία',
				warehouse: 'Αποθήκη',
				dump: 'Αλάνα',
				port: 'Λιμάνι',
				branchOffice: 'Εμπορικό Ανταλλακτήριο',
				wall: 'Τείχος',
				safehouse: 'Κρησφύγετο',
				barracks: 'Στρατώνες',
				shipyard: 'Ναυπηγείο',
				forester: 'Ξυλοκόπος',
				carpentering: 'Ξυλουργείο',
				winegrower: 'Οινοποιείο',
				vineyard: 'Αποστακτήριο',
				stonemason: 'Λατομείο',
				architect: 'Αρχιτεκτονικό γραφείο',
				glassblowing: 'Υαλουργείο',
				optician: 'Οπτικός',
				alchemist: 'Πύργος Αλχημιστή',
				fireworker: 'Περιοχή Δοκιμών Πυροτεχνημάτων',
				pirateFortress: 'Πειρατικό φρούριο',
				blackMarket: 'Μαύρη αγορά',
				marineChartArchive: 'Αρχείο Ναυτικών χαρτών',
				tavern_level: 'Επίπεδο ταβέρνας',
				miracle: 'Θαύματα',
				MirTxts: ['','Ενεργοποιήσατε πρόσφατα αυτό το θαύμα. Επαναχρησιμοποίηση'],
				world_miracle: 'Παγκόσμιο θαύμα',
				priests: 'Iερείς',
				conversion: 'Ποσοστό μετατροπής πίστης',
				percentage: '<b>Ποσοστό</b> της <b>πίστης</b> στη Νήσο',
				curislandfaith: 'Πίστη Νήσου',
				maxislandfaith: 'Μέγιστή Πίστη Νήσου',
				cooldown: '<b>Ηρεμία</b> ( ενεργοποιείτε ξανά σε )',
				to_temple: '(προς τους ναούς των πόλεων)',
				to_wonder: '(προς τα μνημεία των νήσων)',
				favours: ['Εύνοιες','Εύνοια'],
				tasks: 'Αποστολές',
				dailytasks: 'Ημερήσιες Αποστολές',
				renew: 'Απομένων χρόνος <br> σημερινών αποστολών',
				pirates: 'Επισκόπιση<br>Πειρατείας',
				zeroingtasks: 'Επαναφορά όλων των αποστολών',
				zeroingvaluation: 'Υπόλοιπος Χρόνος<br>Ως την Αξιολόγηση',
				remainingtime: 'Απομένων χρόνος',
				corruption: 'Διαφθορά',
				cultural_treaty: 'Πολιτιστικές Συνθήκες',
				cultural: 'Πολιτιστικά αγαθά',
				pCTs:['Κανένα αίτημα','Αίτημα','Αιτήματα','Πολιτιστικής Συνθήκης'],
				cultinfo:['Θέσεις','Συνάψεις','Κενές','Αιτήματα','Κατανομή ανά πόλη','Πολιτιστικές Συνθήκες στο μουσείο της πόλης «{0}»','Με την έκθεση πολιτιστικών αγαθών άλλων παικτών στο μουσείο σας, θα ευχαριστηθούν οι μορφωμένοι πολίτες σας. Συνάψτε πολιτιστικές συνθήκες με άλλους παίκτες για να αποκτήσετε περισσότερα εκθέματα και κατά συνέπεια περισσότερους ευχαριστημένους πολίτες στις πόλεις σας.','Πολιτιστικά αγαθά σε αυτό το μουσείο','Οι πολίτες σας θαυμάζουν τους αναρίθμητους θησαυρούς του μουσείου!<br>H ικανοποίηση στην πόλη έχει αυξηθεί κατά: <span class="bold green">{0}</span> (<b>{1}</b> από επίπεδο,<b>{2}</b> από συνάψεις)','Όνομα χρήστη','Συμμαχία','Πρωτεύουσα','Ενέργειες','Απόσυρση αιτήματος πολιτιστικής συνθήκης','Απόρριψη αιτήματος πολιτιστικής συνθήκης','Συναφθείσες Πολιτιστικές Συνθήκες','Ακύρωση Πολιτιστικής Συνθήκης','Κατανομή Πολιτιστικών Συνθηκών','Έχετε συνάψει <b>{0}</b> πολιτιστικές συνθήκες. Μπορείτε να τις κατανέμετε μεταξύ των μουσείων προσφέροντας περισσότερη ικανοποίηση στους πολίτες σας σε όλες σας τις πόλεις. Πρέπει να κατανέμετε όλες τις πολιτιστικές σας συνθήκες!','μέγ.','Επιβεβαίωση αλλαγών','Καμιά πολιτιστική συνθήκη','Πλήρωση με πολιτιστικά αγαθά','εξοργισμένοι','θυμωμένοι','ουδέτεροι','ευτυχισμένοι','σε ευφορία','Προσοχή! Πρέπει να διανείμετε όλα τα πολιτιστικά αγαθά!','Στο μουσείο, οι πολίτες της πόλης σας μπορούν να δουν τα πολιτιστικά επιτεύγματα άλλων λαών και να μάθουν ο ένας από τον άλλο! Για να υποδέχεστε μεγαλύτερες εκθέσεις, πρέπει να επεκτείνετετο μουσείο σας. Κάθε νέα επέκταση του μουσείου σας επιτρέπει να εκθέτετε ένα επιπλέον πολιτισμικό αγαθό.'],
				cultural_r: 'Από το πολίτευμα',
				ctenabled: 'Έχετε συνάψει πολιτιστική συνθήκη',
				ctrequested: ['Υπάρχει αίτημα πολιτιστικής συνθήκης από εσάς','Υπάρχει αίτημα πολιτιστικής συνθήκης προς εσάς'],
				playersearch:'Αναζήτηση παίκτη',
				Page: 'Σελίδα',
				CompMsg: 'Σύνταξη μηνύματος',
				FriendList: 'Πίνακας Φίλων',
				HighscoreList: 'Πίνακας Βαθμολογίας',
				government: 'Τρέχον πολίτευμα',
				anarchie:'Αναρχία',
				xenokratie:'Ξενοκρατία',
				ikakratie:'Ικακρατία',
				aristokratie:'Αριστοκρατία',
				diktatur:'Δικτατορία',
				demokratie:'Δημοκρατία',
				nomokratie:'Νομοκρατία',
				oligarchie:'Ολιγαρχία',
				technokratie:'Τεχνοκρατία',
				theokratie:'Θεοκρατία',
				from_government: 'από πολίτευμα',
				population: 'Πληθυσμός',
				citizens: 'Πολίτες',
				scientists: 'Επιστήμονες',
				scientists_max: 'Θέσεις Ερευνητών',
				scientists_employed: 'Ερευνητές',
				options: 'Ρυθμίσεις-Επιλογές',
				help: 'Βοήθεια',
				dailytasks: 'Ημερήσιες Αποστολές',
				agora: 'Μετάβαση στην Αγορά',
				to_world: 'Προβολή Παγκόσμιου Χάρτη',
				to_island: 'Προβολή Νησιωτικού Χάρτη',
				army_cost: 'Κόστος στρατού',
				fleet_cost: 'Κόστος στόλου',
				army_supply: 'Προμήθεια στρατού',
				fleet_supply: 'Προμήθεια στόλου',
				qltxts: ['Πλήρες φορτίο','Πλήρη φορτία','πλοίο','πλοία'],
				research_cost: 'Κόστος Επιστημόνων',
				research_hp: 'Ωριαία παραγωγή',
				income: 'Έσοδα',
				badtax: 'Έσοδα Φόρου',
				expenses: 'Δαπάνες',
				balances: 'Ισοζύγια',
				espionage: 'Αναφορές Κατασκοπείας',
				send_out_spy: 'Αποστολή κατασκόπου',
				diplomacy: 'Διπλωματία',
				dammy_packages: 'Πακέτα ομοιωμάτων',
				inventory: 'Υπάρχοντα',
				effects: '[Επιδράσεις] - Υπάρχοντα',
				location: 'Τοποθεσία',
				treaty: 'Συνθήκη',
				treaties_: 'Συνθήκες',
				contracts: 'Προβολή Συνθηκών',
				sendCTsopt: 'Αποστολή αιτήματος σύναψης πολιτιστικής συνθήκης',
				altreat: 'Συνθήκες Συμμαχίας<br>Συνεργάτης συνθήκης',
				generalAllyView: ['Δεν έχετε βαθμίδα Στρατηγού στη Συμμαχία','Βαθμίδα Στρατηγού<br>Στρατιωτικές κινήσεις Συμμαχίας'],
				combat: 'Αναφορές μάχης',
				dismiss_unit: 'Απόλυση μονάδων',
				dismiss_fleet: 'Απόλυση στόλων',
				edit_route: 'Δημιουργία Εμπορικού δρομολογίου',
				satisfaction: 'Ικανοποίηση',
				max_Level: 'Μέγιστο Eπίπεδο',
				max_Level_complete: 'Η Μέγιστη αναβάθμιση επετεύχθηκε!',
				max_Level_tocomplete: 'Το Μέγιστο επίπεδο προς ολοκλήρωση!',
				actionP : 'Πόντοι Δράσης',
				researchP : 'Πόντοι Έρευνας',
				research : 'Έρευνα',
				from_researchs : 'Από στάδια έρευνας',
				potion : 'Φίλτρο Σοφίας',
				research_field : 'Τομέας Έρευνας',
				finances_ : 'Oικονομικά',
				free_ground : 'Ελεύθερος Χώρος Οικοδόμησης',
				trpart : 'Προσφορές από εμπορικούς συνεργάτες',
				wood_ : 'Ξύλο',
				wine_ : 'Kρασί',
				marble_ : 'Μάρμαρο',
				crystal_ : 'Kρύσταλλο',
				glass_ : 'Kρύσταλλο',
				sulphur_ : 'Θείο',
				sulfur_ : 'Θείο',
				luxury_good: 'Αγαθά Πολυτελείας',
				angry: 'Θυμωμένοι',
				unhappy: 'Δυστυχισμένοι',
				neutral: 'Ουδέτεροι',
				happy: 'Χαρούμενοι',
				euphoric: 'Πανευτυχείς',
				bonuses: 'Επισκόπηση επιβραβεύσεων<br>(Ικανοποιημένοι πολίτες)',
				bonustiptxt:['Ίδρυση πόλης (βασική)','Μουσείο (επίπεδο+Πολιτιστικές Συνθήκες)','από Μορφή πολιτεύματος','Ταβέρνα (επίπεδο+σερβίρισμα κρασιού)','μέσω Έρευνας+ικανοποίηση πρωτεύουσας','λόγω ύπαρξης Ιερέων (με Θεοκρατία)','λόγω Διαφθοράς','Συνολική ικανοποίηση (ισοζύγια)','Τρέχων Πληθυσμός','Διαθέσιμη ικανοποίηση','Μέση διαφθορά'],
				growth: 'Ανάπτυξη',
				housing_space: 'Θέσεις πολιτών',
				free_Citizens: 'Διαθέσιμοι Πολίτες',
				free_housing_space: 'Διαθέσιμος χώρος',
				level_tavern: 'Eπίπεδα Ταβέρνας',
				maximum: 'Μέγιστη',
				used: 'Στην αποθήκη',
				foruse: 'Για χρήση',
				branchreserved: 'Στο ανταλλακτήριο',
				missing: 'Διαθέσιμη',
				current: 'Τρέχουσα',
				currcap: 'Τρέχουσα<br>χωρητικότητα',
				currquant: 'Τρέχουσα<br>ποσότητα',
				plundergold: 'Χρυσός',
				garrison: 'Όριο Φρουράς',
				Sea: 'Θάλασσας',
				spytiptxt: ['Στην άμυνα','Σε αποστολή','Κατάσκοποι','Για εκπαίδευση','Θέσεις κατασκόπων'],
				Inland: 'Ξηράς',
				spy: 'Kατασκoπεία',
				full: 'Πλήρες',
				off: 'Χωρίς',
				currentunits: 'τρέχουσες',
				time_to_full: 'Για γέμισμα',
				time_to_empty: 'Για άδειασμα',
				sum_aftertranfer: 'μετά τη μεταφορά',
				capacity: 'Χωρητικότητα',
				safe: 'Ασφαλές',
				resources_lootable: 'Λεηλατήσιμα',
				training: 'Εκπαίδευση',
				theatertxts: {active: 'Ενεργό',inactive: 'Ανενεργό',status: 'Κατάσταση',resource: 'Δράμα<br>Παραγωγή ξύλου',tradegood: 'Κωμωδία<br>Παραγωγή {0}',favour: 'Πολιτιστική<br>παράσταση',wood: 'ξύλου',wine: 'κρασιού',marble: 'μαρμάρου',glass: 'κρύσταλλου',sulfur: 'θείου',tip: 'Διαθέσιμη προβολή για +20 % {0}',luxury: 'πόρου πολυτελείας'},
				shortbuildingtime: ['Μείωση χρόνου κατασκευής','Μηδενισμός διάρκειας κατασκευής'],
				deploying: 'Εγκατάσταση',
				plundering: 'Λεηλασίες',
				constructing: 'Κατασκευή σε εξέλιξη!',
				constructing_mine: 'Αναβάθμιση σε εξέλιξη!',
				forminetitle:['Πριονιστήριο','Αμπελώνας','Λατομείο','Ορυχείο κρυστάλλου','Ορυχείο Θείου'],
				resourcelevel: 'Επίπεδο Δάσους',
				tradegoodlevel: 'Επίπεδο Ορυχείου',
				curwood: 'Δωρηθέν ξύλο',
				maxwood: 'Απαιτητό ξύλο',
				diffwood: 'Υπολειπόμενο ξύλο',
				next_Level: 'Απαιτήσεις για επίπεδο',
				destination: 'Προορισμός',
				origin: 'Προέλευση',
				action: 'Ενέργεια',
				transport: 'Μεταφορές',
				from: 'από',
				after_transport: 'Μετά τη μεταφορά',
				in_transit: 'Μεταφορά',
				mission: 'Αποστολή',
				capture: 'Κούρσεμα',
				raid: 'Έφοδος',
				subsum: 'Μερικό Σύνολο',
				convert: 'Μετατροπή',
				classify: 'Κατάταξη',
				dailyreset: 'Επόμενη ανανέωση',
				finalevaluation: 'Τελική αξιολόγηση',
				loading: 'Φόρτωση',
				en_route: 'Καθ&apos;οδόν',
				arrived: 'Αφίχθη',
				arrival: 'Άφιξη',
				arrival_time: 'Ώρα άφιξης',
				speed: 'Ταχύτητα',
				time_: 'Χρόνος κατασκευής',
				time_remaining: 'Υπόλοιπος χρόνος',
				total_: 'Σύνολο',
				total_cargo: 'Συνολικό Φορτίο',
				cargo: 'Φορτίο',
				duration:'Διάρκεια',
				currenttotal_ : 'Τρέχον<br>Σύνολο',
				to_town_hall: 'προς το Δημαρχείο <br> από την {0} <b>{1}<b>',
				member: 'Προβολή Λίστας Μελών Συμμαχίας',
				friendlist: 'Προβολή Λίστας Φίλων',
				to_saw_mill: 'προς το Πριονιστήριο από την {0} {1}',
				to_mine: 'προς το Ορυχείο από την {0} {1}',
				to_barracks: 'προς τους Στρατώνες της <br> {0}ς <b>{1}<b>',
				to_shipyard: 'προς το Ναυπηγείο της <br> {0}ς <b>{1}<b>',
				resource: 'Πριονιστήριο στο Δάσος',
				tradegood: 'Λατομείο στο Ορυχείο',
				nextlevel: 'Επόμενο επίπεδο',
				inprogress: 'Σε εξέλιξη',
				transporting: 'Μεταφορά αγαθών προς την <br> {0} <b>{1}<b>',
				transtip: 'Μεταβείτε πρώτα στην πόλη προέλευσης<br>για να πατήσετε εδω μεταφορές αγαθών',
				transporting_units: 'Μετακίνηση μονάδων προς την <br> {0} <b>{1}<b>',
				transporting_fleets: 'Μετακίνηση στόλων προς την <br> {0} <b>{1}<b>',
				triton_engines: 'Τουρμπίνες Τρίτωνα',
				deploying_troops: 'Παράταξη στρατευμάτων',
				deploymentarmy: 'Παράταξη μονάδων',
				deploymentfleet: 'Παράταξη στόλων',
				army_movement: 'Κίνηση στρατέυματος',
				troop_movements: 'Κινήσεις Στόλου / Στρατευμάτων',
				station_army: 'Εγκατάσταση στρατευμάτων',
				station_fleets: 'Εγκατάσταση στόλων',
				target: 'Στόχος',
				today: 'Σήμερα',
				tomorrow: 'Αύριο',
				yesterday: 'Χθες',
				in_: 'σε',
				per_: 'ανά',
				at: 'στις',
				am: 'π.μ.',
				pm: 'μ.μ.',
				second: 'δ',
				minute: 'λ',
				hour: 'ω',
				day: 'Η',
				week: 'Eβδ',
				month: 'Μ',
				year: 'Ε',
				hour_long: 'Ώρα',
				day_long: 'Ημέρα',
				week_long: 'Εβδομάδα',
				ika_world: 'Αναζήτηση στο Ikariam-World',
				charts: 'Προβολή Διαγραμμάτων',
				updated_: 'Ενημέρωση',
				tothe: 'στην',
				zones: ['Τομέας «Ναυτιλίας»','Τομέας «Οικονομίας»','Τομέας «Επιστήμης»','Τομέας «Στρατού»'],
				researchzones: ['Ναυτιλία','Οικονομία','Επιστήμη','Στρατός'],
				addtransport: 'Προσθήκη μετακίνησης',
				movements: 'Μετακινήσεις',
				wonders: ['Κανένας Ναός!','Σιδηρουργείο<br>του Ήφαιστου','Ιερό Άλσος του Άδη','Κήποι της Δήμητρας','Παρθενώνας της Αθηνάς','Ναός του Ερμή','Φρούριο του Άρη','Ναός του Ποσειδώνα','Κολοσσός'],
				wonderstxt: [['Θεϊκή πανοπλία','Ήφαιστος, ο θεός των σιδηρουργών, μπορεί να ευλογήσει την δουλειά τους. Η πανοπλία τους γίνετε πραγματικά δυνατή και τα σπαθιά τους τρομερά κοφτερά για λίγες ώρες, έτσι ώστε να είναι σχεδόν σαν να έχουν σφυρηλατηθεί προσωπικά από τον Θεό.','Αφού προσευχηθείτε για ένα θαύμα, ο Ήφαιστος έστειλε στον ιερέα σας ένα αμβλύ ξίφος και σας είπε ότι η ποιότητα της δουλειάς του εξαρτάται από την ποιότητα της δουλειάς σας. Προφανώς δεν είναι ευχαριστημένος από την πίστη των κατοίκων του νησιού αυτού!','Όλες οι στρατιωτικές μονάδες <b>δεν</b> αποκτούν περισσότερο εξοπλισμό αλλά προκαλούν <b>10 %</b> περισσότερη ζημιά.','Όλες οι στρατιωτικές μονάδες αποκτούν <b>1</b> περισσότερο εξοπλισμό και προκαλούν <b>10 %</b> περισσότερη ζημιά.','Όλες οι στρατιωτικές μονάδες αποκτούν <b>1</b> περισσότερο εξοπλισμό και προκαλούν <b>15 %</b> περισσότερη ζημιά.','Όλες οι στρατιωτικές μονάδες αποκτούν <b>2</b> περισσότερο εξοπλισμό και προκαλούν <b>15 %</b> περισσότερη ζημιά.','Όλες οι στρατιωτικές μονάδες αποκτούν <b>2</b> περισσότερο εξοπλισμό και προκαλούν <b>20 %</b> περισσότερη ζημιά.'],['Φρουρά Γοργόνων','Ο παντοδύναμος Άδης, κυρίαρχος του κάτω κόσμου, μπορεί να στείλει τρομερές μέδουσες, οι οποίες μπορούν να μετατρέψουν προωθημένους εχθρούς σε πέτρα, μόνο με το βλέμμα τους. Αυτό έχει σαν συνέπεια να έχετε πάντα αρκετή πέτρα στο τέλος μιας μάχης για να μπορέσετε να ξαναχτίσετε τα τείχη της πόλης σας.<br>Οι Βάρβαροι δεν επηρεάζονται από αυτό το θαύμα.','Φαίνεται ότι τα Ηλύσια πεδία είναι ακόμα μακριά. Αφού ζητήσετε ένα θαύμα από τον Άδη, είπε ότι είναι καλύτερα να στείλει το σκύλο του να εξαπλώσει την πίστη του από το να βασιστεί στους ιερείς σας.','<b>20 %</b> του κόστους από όλες τις μονάδες που πέθαναν κατά την διάρκεια μαχών στις πόλεις τους, πιστώθηκαν σαν μονάδες μαρμάρου.','<b>30 %</b> του κόστους από όλες τις μονάδες που πέθαναν κατά την διάρκεια μαχών στις πόλεις τους, πιστώθηκαν σαν μονάδες μαρμάρου.','<b>40 %</b> του κόστους από όλες τις μονάδες που πέθαναν κατά την διάρκεια μαχών στις πόλεις τους, πιστώθηκαν σαν μονάδες μαρμάρου.','<b>50 %</b> του κόστους από όλες τις μονάδες που πέθαναν κατά την διάρκεια μαχών στις πόλεις τους, πιστώθηκαν σαν μονάδες μαρμάρου.','<b>80 %</b> του κόστους από όλες τις μονάδες που πέθαναν κατά την διάρκεια μαχών στις πόλεις τους, πιστώθηκαν σαν μονάδες μαρμάρου.'],['Ευλογημένη συγκομιδή','Η Δήμητρα, η θεά της γης και των σιτηρών μπορεί να ευλογήσει τους ανθρώπους σας με ένα γόνιμο έδαφος και μια εξαιρετική σοδειά. Ο πληθυσμός σας θα αυξάνεται πιο γρήγορα - αλλά μόνο αν υπάρχει αρκετός χώρος και για άλλους πολίτες.','Η Δήμητρα, με την ατελείωτη σοφία της, απαιτεί να κόψετε κάποια δέντρα πίστης πριν προσπαθήσετε να καλλιεργήσετε θαύματα. Ανησυχεί ότι δεν γνωρίζετε αρκετά από γεωργία για να εκτιμήσετε τα δώρα της.','Η αύξηση του πληθυσμού στις πόλεις σας αυξάνεται κατά <b>2</b> ανά ώρα.','Η αύξηση του πληθυσμού στις πόλεις σας αυξάνεται κατά <b>4</b> ανά ώρα.','Η αύξηση του πληθυσμού στις πόλεις σας αυξάνεται κατά <b>6</b> ανά ώρα.','Η αύξηση του πληθυσμού στις πόλεις σας αυξάνεται κατά <b>8</b> ανά ώρα.','Η αύξηση του πληθυσμού στις πόλεις σας αυξάνεται κατά <b>12</b> ανά ώρα.'],['Ασφαλής πατρίδα','Αθηνά, η ακούραστη, η αόρατη, η προστάτης. Σαν θεά της προστασίας των πόλεων σας και των τεχνιτών, μπορεί να ενισχύσει τα τείχη των αποθηκών ώστε να μπορείτε να κρύψετε περισσότερα υλικά από εχθρούς που έρχονται για λεηλασία.','Δεν πρέπει να εκνευρίζετε θέες σαν την Αθηνά. Προσευχόμενοι για ένα θαύμα με τόσο λίγη πίστη μπορεί να εκληφθεί ως αλαζονεία. Παρόλα αυτά, έχει τη συνήθεια να μετατρέπει τους ανθρώπους σε ζώα!','<b>+ 40 %</b> ασφαλή αγαθά σε όλες τις αποθήκες.','<b>+ 80 %</b> ασφαλή αγαθά σε όλες τις αποθήκες.','<b>+ 160 %</b> ασφαλή αγαθά σε όλες τις αποθήκες.','<b>+ 240 %</b> ασφαλή αγαθά σε όλες τις αποθήκες.','<b>+ 400 %</b> ασφαλή αγαθά σε όλες τις αποθήκες.'],['Πιο γρήγορος από την αστραπή','Ερμής, θεός των ταξιδευτών και των μεταφορών, δεν αντέχει να βλέπει πλοία εν στάση και ανεκμετάλλευτα αγαθά. Εκπληρώνει τις ευχές των πωλητών να φτάσετε σε τόπους γρηγορότερα δίνοντας στους λιμενεργάτες υπεράνθρωπες δυνάμεις. Αυτό σημαίνει ότι κάθε πλοίο περιμένει να περάσει ένα τμήμα του κανονικού χρόνου φόρτωσης του φορτίου του στο λιμάνι.','Αποτελεί τιμή που ο Ερμής θα βοηθήσει εσάς τους θνητούς αν τον τιμήσετε, αλλά θα προσβληθεί ο θεός των κλεφτών αν απαιτήσετε βοήθεια χωρίς να του το ανταποδώσετε πριν. Αυτή η εξαπάτηση είναι πολύ... άμεση.','Η ταχύτητα φόρτωσης αγαθών αυξάνεται κατά <b>40 %</b>.','Η ταχύτητα φόρτωσης αγαθών αυξάνεται κατά <b>80 %</b>.','Η ταχύτητα φόρτωσης αγαθών αυξάνεται κατά <b>120 %</b>.','Η ταχύτητα φόρτωσης αγαθών αυξάνεται κατά <b>160 %</b>.','Η ταχύτητα φόρτωσης αγαθών αυξάνεται κατά <b>200 %</b>.'],['Σφαγή','Άρης, ο θεός του άγριου πολέμου, της αίματο-λαγνείας και της σφαγής, γεμίζει τις καρδιές όλων των πολεμιστών στην περιοχή των πόλεων σας με καθαρό μίσος. Αυτοί οι πολεμιστές θα ξεχυθούν στην μάχη χωρίς να σκεφτούν την δική τους υγεία, μέχρι κανείς να μην μείνει όρθιος.','Οι ιερείς τρέμουν από το φόβο τους. Κανείς δεν θέλει να μιλήσει στον Άρη προς το παρόν, γιατί αν η προσοχή του στραφεί σε αυτό το μικρό φιλήσυχο νησί, θα το κατακλύσει με πόλεμο και φόβο ώστε οι άνθρωποι να πρέπει να υποταχθούν σε αυτόν μέσω της μάχης και του θανάτου.','<b>+ 100</b> ηθική ανά γύρο για όλες τις μονάδες στρατού που βρίσκονται σταθμευμένες στην πόλη σας - ακόμα και για τις εχθρικές!','<b>+ 200</b> ηθική ανά γύρο για όλες τις μονάδες στρατού που βρίσκονται σταθμευμένες στην πόλη σας - ακόμα και για τις εχθρικές!','<b>+ 400</b> ηθική ανά γύρο για όλες τις μονάδες στρατού που βρίσκονται σταθμευμένες στην πόλη σας - ακόμα και για τις εχθρικές!','<b>+ 600</b> ηθική ανά γύρο για όλες τις μονάδες στρατού που βρίσκονται σταθμευμένες στην πόλη σας - ακόμα και για τις εχθρικές!','<b>+ 2.000</b> ηθική ανά γύρο για όλες τις μονάδες στρατού που βρίσκονται σταθμευμένες στην πόλη σας - ακόμα και για τις εχθρικές!'],['Ευλογία για τους ναυτικούς','Ο Ποσειδώνας, Θεός της θάλασσας, έστειλε πολλούς ασεβείς ναύτες σε αστείες οδύσσειες. Αλλά εκείνοι που αποθέτουν φόρο τιμής σε αυτόν, περιμένουν τα καράβια τους να πλέουν σε ήρεμα νερά με ούριους ανέμους και προς τα λιμάνια των προορισμών τους.','Αυτές τις στιγμές, θα ήταν ανόητο να προκαλέσετε τον Ποσειδώνα ζητώντας του ένα θαύμα. Αν η πίστη ενός νησιού δεν είναι αρκετή, του αρέσει να στέλνει τέρατα της θάλασσας για να υπενθυμίζει στους κατοίκους του ότι πρέπει να σέβονται τη θάλασσα.','<b>10 %</b> αυξημένη ταχύτητα για πολεμικά κι εμπορικά πλοία.','<b>30 %</b> αυξημένη ταχύτητα για πολεμικά κι εμπορικά πλοία.','<b>50 %</b> αυξημένη ταχύτητα για πολεμικά κι εμπορικά πλοία.','<b>70 %</b> αυξημένη ταχύτητα για πολεμικά κι εμπορικά πλοία.','<b>100 %</b> αυξημένη ταχύτητα για πολεμικά κι εμπορικά πλοία.'],['Πέτρινος φύλακας','Ο Κολοσσός είναι ένα άγαλμα του θεού Ήλιου. Αφήνει τον ήλιο να φωτίζει μέσα από τον πυρσό του. Το λαμπερό φως, το οποίο φαίνεται από όλη την Ελλάδα, συμβολίζει μια απειλή από τον παντοδύναμο θεό και εξασφαλίζει χαοτική φυγή και σύγχυση στους αντιπάλους σας.','Ο Ήλιος μπορεί να είναι ένας θεός ικανός και φιλικός, αλλά η δύναμή του είναι παρόμοια με του Δία. Αν δεν δώσετε αρκετή πίστη και πεποίθηση, δεν θα συνεχίσει να σας δίνει το φως της ημέρας και θα σταματήσει το άρμα του από τον ήλιο μόνο να αφιερώνει τον πολύτιμο χρόνο του για τα αιτήματά σας.','<b>10 %</b> όλων των εχθρικών πλοίων και στρατιών που μάχονται με τις στρατιές σας στις πόλεις σας, θα τραπούν σε φυγή. Ο χρόνος σκορπίσματος <b>4 ωρών</b> αυξάνεται κατά <b>30 λεπτά</b>.','<b>20 %</b> όλων των εχθρικών πλοίων και στρατιών που μάχονται με τις στρατιές σας στις πόλεις σας, θα τραπούν σε φυγή. Ο χρόνος σκορπίσματος <b>4 ωρών</b> αυξάνεται κατά <b>1 ώρα</b>.','<b>30 %</b> όλων των εχθρικών πλοίων και στρατιών που μάχονται με τις στρατιές σας στις πόλεις σας, θα τραπούν σε φυγή. Ο χρόνος σκορπίσματος <b>4 ωρών</b> αυξάνεται κατά <b>1 ώρα 30 λεπτά</b>.','<b>50 %</b> όλων των εχθρικών πλοίων και στρατιών που μάχονται με τις στρατιές σας στις πόλεις σας, θα τραπούν σε φυγή. Ο χρόνος σκορπίσματος <b>4 ωρών</b> αυξάνεται κατά <b>2 ώρες</b>.','<b>100 %</b> όλων των εχθρικών πλοίων και στρατιών που μάχονται με τις στρατιές σας στις πόλεις σας, θα τραπούν σε φυγή. Ο χρόνος σκορπίσματος <b>4 ωρών</b> αυξάνεται κατά <b>3 ώρες</b>.']],
				wonderViewButton: 'Μετάβαση στο μνημείο<br>(Προβολή στη νήσο)',
				wonderViewButton2: 'Μετάβαση στο μνημείο<br>(Προβολή στην πόλη)',
				wonderActivateButton: 'Ενεργοποίηση<br>θαύματος',
				wonderBeliefTooltip: 'Αυτό το νησί πιστεύει κατά {0} %.',
				wonderBeliefInfo2: 'Το ποσοστό πίστης του νησιού είναι {0} %.',
				wonderlevel: 'Επίπεδο μνημείου',
				faithlevel: 'Επίπεδο πίστης',
				islandshare: 'Κοινή Πίστη Νήσου',
				miraclecompletion: '<b>Ολοκλήρωση θαύματος</b><br>(Το θαύμα Ενεργοποιήθηκε)',
				cooldowncompletion: '<b>Ολοκλήρωση ηρέμησης</b><br>(Ενεργοποιήθηκε πρόσφατα)',
				wonderdonations: 'Ατομικές δωρεές',
				donations: 'Δωρεές',
				donateforexpansion: 'Δωρεά για αναβάθμιση',
				cityOrder : 'Ταξινόμηση πόλεων',
				fullArmyTable : 'Προβολή όλων των στρατιωτικών μονάδων',
				hideOnWorldView : 'Απόκρυψη στον παγκόσμιο χάρτη',
				hideOnIslandView : 'Αποκρυψη στον νησιωτικό χάρτη',
				hideOnCityView : 'Αποκρυψη στον αστικό χάρτη',
				onTop : 'Προβολή σε πρώτο πλάνο',
				windowTennis : 'Προβολή σε πρώτο πλάνο με την ένδειξη ποντικιού',
				autoUpdates : 'Αυτόματος έλεγχος ενημερώσεων',
				smallFont : 'Χρήση γραμματοσειράς μικρότερου μεγέθους',
				goldShort : 'Σύντμηση προβολής συνολικού εισοδήματος',
				defaultBuildingList : 'Χρηση προεπιλεγμένης λίστας κτηρίων',
				alternativeBuildingList : 'Χρηση εναλλακτικής λίστας κτηρίων',
				compressedBuildingList : 'Χρήση συμπιεσμένης λίστας κτηρίων',
				wineOut : 'Απενεργοποίηση χαρακτηριστικού Αμβροσίας «Χωρίς κρασί»',
				dailyBonus : 'Αυτόματη επιβεβαίωση ημερήσιου δώρου',
				unnecessaryTexts : 'Απομάκρυνση μη απαραίτητων περιγραφών',
				ambrosiaPay : 'Απενεργοποίηση νέων επιλογών αγοράς Αμβροσίας',
				quantityLoads : 'Προβολή Πλήρων Φορτίων και πλοίων στις ποσότητες',
				wineWarning : 'Απόκρυψη επεξήγησης «προειδοποίησης κρασιού»',
				wineWarningTime : 'Προειδοποίηση υπολοιπόμενου κρασιού',
				languageChange : 'Αλλαγή γλώσσας',
				current_Version : 'Τρέχουσα Έκδοση<b>:</b>',
				ikariam_Version : 'Έκδοση Ikariam<b>:</b>',
				reset : 'Επαναφορά ρυθμίσεων στις προεπιλεγμένες',
				resetbtn : 'Επαναφορά',
				zeroing: 'Επαναφορά στο μηδέν',
				zeroingtasks: 'Επαναφορά όλων των αποστολών',
				remainingtime: 'Απομένων χρόνος',
				goto_website : 'Επισκεφτείτε τη σελίδα greasyfork.org',
				website : 'Ιστοσελίδα',
				Check_for_updates : 'Χειροκίνητος έλεγχος για Ενημερώσεις',
				check : 'Ελεγχος για Ενημερώσεις',
				Report_bug : 'Αναφορά σφάλματος στον κώδικα',
				report : 'Αναφορά σφάλματος',
				save : 'Αποθήκευση',
				save_settings : 'Αποθήκευση ρυθμίσεων<b>!</b>&nbsp;',
				newsticker : 'Απόκρυψη καρτέλας νέων',
				event : 'Απόκρυψη συμβάντων',
				logInPopup : 'Απόκρυψη Παραθύρου Πληροφοριών κατά τη σύνδεση',
				birdswarm : 'Απόκρυψη του σμήνους πουλιών',
				walkers : 'Απόκρυψη κινούμενων πολιτών',
				noPiracy : 'Απόκρυψη πειρατικού φρουρίου',
				noTheater : 'Απόκρυψη Κινηματοθεάτρου',
				donationButtons : 'Κουμπιά ποσών δωρεών αναβάθμισης',
				donwoodlogalltitle: 'Όλες οι μονάδες ξυλείας για Δωρεά',
				donwoodlogall: 'Όλο το απόθεμα',
				donwoodlogtitle: '{0} μονάδες ξυλείας για Δωρεά',
				ctfinder : 'Ανίχνευση Πολιτιστικών Συνθηκών',
				ΧΥshow: 'Προβολή συντεταγμένων νήσου',
				hourlyRes : 'Απόκρυψη ωριαίας παραγωγής αγαθών',
				playerInfo : 'Προβολή πληροφοριών για τον παίκτη',
				control: 'Απόκρυψη κέντρου Ελέγχου',
				alert: 'Επιλέξτε μόνο μια επιλογή!',
				alert_palace: 'Επισκεφθείτε πρωτίστως την πρωτεύουσά σας',
				alert_palace1: 'Δεν υπάρχει παλάτι στην πόλη σας.\nΕξερευνήστε την επέκταση και χτίστε ένα παλάτι.',
				alert_toast: 'Επαναφορά Δεδομένων, θα ανανεωθεί η σελίδα σε λίγα δευτερόλεπτα',
				alert_error: 'Παρουσιάστηκε σφάλμα κατά τον έλεγχο των ενημερώσεων: ',
				alert_noUpdate: 'Καμιά ενημέρωση δεν είναι διαθέσιμη για τον κώδικα «{0}».',
				alert_update: 'Υπάρχει διαθέσιμη ενημέρωση για τον κώδικα «{0}».\nΘέλετε να μεταβείτε στη σελίδα εγκατάστασης τώρα;',
				alert_update1: 'Θέλετε να μεταβείτε στη σελίδα εγκατάστασης τώρα;',
				alert_daily: 'Ενεργοποιήστε την «Αυτόματη επιβεβαίωση του ημερήσιου δώρου»',
				alert_wine: 'Προειδοποίηση κρασιού > ',
				en : 'Αγγλικά',
				el : 'Eλληνικά',
				phalanx: 'Οπλίτης',
				steamgiant: 'Γίγαντας Ατμού',
				spearman: 'Λογχοφόρος',
				swordsman: 'Ξιφομάχος',
				slinger: 'Εκτοξευτής',
				archer: 'Τοξότης',
				marksman: 'Πυροβολητής Θείου',
				ram: 'Κριός',
				catapult: 'Καταπέλτης',
				mortar: 'Κανόνι',
				gyrocopter: 'Γυροκόπτερο',
				bombardier: 'Βομβαρδιστικό αερόστατο',
				cook: 'Μάγειρας',
				medic: 'Ιατρός',
				spartan: 'Σπαρτιάτης',
				ship_transport: 'Εμπορικό πλοίο',
				ship_ram: 'Σκάφος-Έμβολο',
				ship_flamethrower: 'Φλογοβόλο',
				ship_steamboat: 'Έμβολο ατμού',
				ship_ballista: 'Βαλλιστροφόρο',
				ship_catapult: 'Καταπελτοφόρο',
				ship_mortar: 'Κανονιοφόρο',
				ship_submarine: 'Βάρκα Κατάδυσης',
				ship_paddlespeedship: 'Κωπήλατη τορπιλάκατος',
				ship_ballooncarrier: 'Μεταφορικό αερόστατων',
				ship_tender: 'Βοηθητικό',
				ship_rocketship: 'Πυραυλάκατος',
				barbarian: 'Βάρβαρος ταλαντευτής τσεκουριού',
				barbarianClub: 'Βάρβαρος Ροπαλοφόρος',
				barbarianKnive: 'Βάρβαρος Μαχαιροβγάλτης',
				barbarianAxethrow: 'Βάρβαρος Τσεκουροβόλος',
				barbarianWalker: 'Βάρβαρος Πολεμοβάτης',
				barbarianRam: 'Βάρβαρος Κριός',
				barbarianCatapult: 'Βάρβαρος Καταπέλτης',
				barbarianFighter: 'Βαρβαρικό Μαχητικό',
				barbarianZeppelin: 'Βαρβαρικό Αερόπλοιο',
				ship_barbarian_light_battleship: 'Σανιδοσπάστης',
				ship_barbarian_light_ranged: 'Ιστιοσχίστης',
				ship_barbarian_heavy_battleship: 'Πυράκατος',
				ship_barbarian_heavy_ranged: 'Μπαζοσφεντόνα',
				ship_barbarian_heavy_battleship_II: 'Σφήνα',
				ship_barbarian_heavy_ranged_II: 'Καταπέλτης σκόνης',
				ship_barbarian_first_strike_I: 'Βυθοτρόμος',
				ship_barbarian_first_strike_II: 'Δρακοφωτιά',
				ship_barbarian_anti_carrier: 'Αναφλεκτήρας Ζέπελιν',
				ship_barbarian_carrier: 'Βαρβαρική φωλιά',
				cityOrder_description : 'cityOrder_description',
				fullArmyTable_description : 'Προβολή όλων των πιθανών μονάδων στρατού στην καρτέλα Στρατός',
				hideOnWorldView_description : 'Απόκρυψη από προεπιλογή στον παγκόσμιο χάρτη',
				hideOnIslandView_description : 'Απόκρυψη από προεπιλογή στο νησιωτικό χάρτη',
				hideOnCityView_description : 'Απόκρυψη από προεπιλογή στον αστικό χάρτη',
				onTop_description : 'Προβολή πίνακα σε πρώτο πλάνο από τα παράθυρα του Ikariam',
				windowTennis_description : 'Μεταφορά σε πρώτο πλάνο με το πέρασμα του ποντικιού<br>Επαναφορά πίσω από τα παράθυρα Ikariam με απομάκρυνση του ποντικιού<br>Αγνοείται η επιλογή «Σε πρώτο πλάνο»',
				autoUpdates_description : 'Ενεργοποίηση του αυτόματου ελέγχου ενημερώσεων<br>(Μια φορά κάθε 24 ώρες)',
				smallFont_description : 'Χρήση μικρότερης γραμματοσειράς για τους πίνακες δεδομένων',
				goldShort_description : 'Η προβολή του συνολικού εισοδήματος αλλάζει σε χιλιάδες ή εκατομμύρια στον Πίνακα',
				defaultBuildingList_description : 'Χρήση προεπιλεγμένου πίνακα κτηρίων',
				alternativeBuildingList_description : 'Χρήση εναλλακτικού πίνακα κτηρίων',
				compressedBuildingList_description : 'Χρήση συμπιεσμένου πίνακα κτηρίων<br>Ομαδοποιεί τα κτήρια παραγωγής πολυτελών πόρων<br>Ομαδοποιεί το Παλάτι και τα Κυβερνεία',
				wineOut_description : 'Απενεργοποιεί την επιλογή Αμβροσίας για αγορά του «Χωρίς Κρασί»',
				dailyBonus_description : 'Το ημερήσιο δώρο θα επιβεβαιώνεται αυτόματα<br>και το παράθυρο δεν θα προβάλεται πλέον.<br> Αν έχει επιλεγεί η «Απόκρυψη του Παραθύρου Πληροφοριών κατά τη σύνδεση»,<br>η ρύθμιση επιλέγεται και απενεργοποιείται για να μην μπορεί να αλλαχτεί.',
				unnecessaryTexts_description: 'Απομακρύνει μη απαραίτητες περιγραφές στα κτήρια,<br>τη λίστα κατασκευής των κτηρίων, ελαχιστοποιεί την κήλιση',
				ambrosiaPay_description : 'Απενεργοποιεί τις νέες επιλογές αγοράς Αμβροσίας,<br>πατώντας στο κουμπί ακυρώνει την ενέργεια',
				quantityLoads_description : 'Προβάλει τα πλήρη φορτία και τα επιπλέον πλοία που αντιστοιχούν στις ποσότητες',
				wineWarning_description : 'Απενεργοποιεί την επεξήγηση «προειδοποίησης κρασιού»',
				wineWarningTime_description : 'Ο απομένων χρόνος κατανάλωσης κρασιού<br>«κοκκινίζει» σε αυτό το σημείο',
				languageChange_description : 'Αλλάζει τη γλώσσα προβολής του Κώδικα',
				newsticker_description : 'Αποκρύπτει τα νέα στη γραμμή GameForge',
				event_description : 'Αποκρύπτει τα συμβάντα κάτω από τους συμβούλους',
				logInPopup_description : 'Αποκρύπτει το Παράθυρο Πληροφοριών κατά τη σύνδεση.<br>Επιλέγοντάς το, επιλέγετε αυτόματα και<br> η «Αυτόματη επιβεβαίωση ημερήσιου δώρου»',
				birdswarm_description : 'Αποκρύπτει το σμήνος πουλιών στη νησιωτική και αστική προβολή',
				walkers_description : 'Αποκρύπτει τους κινούμενους πολίτες και τα εμπορικά πλοία στη νησιωτική και αστική προβολή',
				noPiracy_description : 'Απομακρύνει το Πειρατικό Φρούριο',
				noTheater_description : 'Απομακρύνει το Κινηματοθέατρο',
				hourlyRes_description : 'Αποκρύπτει την ωριαία παραγωγή των πόρων στη γραμμή πληροφοριών',
				donationButtons_description : 'Προσθέτει κουμπιά με σταθερά ποσά δωρεάς (0,+500,+1K,+10K,+100K,+500K,+1M) για αναβάθμιση.',
				ctfinder_description : 'Εμφανίζει ένα εικονίδιο δίπλα στο όνομα του/της παίκτη/τριας, αν έχετε συνάψει μαζί του/της Πολιτιστική συνθήκη.<br>Αν ο/η παίκτης/τρια δεν έχει αποδεχτεί ακόμα το αίτημα σας το εικονίδιο είναι ημιδιαφανές.',
				ΧΥshow_description : 'Εμφανίζει τις συντεταγμένες ([X:Y]) της νήσου δίπλα στο όνομα της πόλης.',
				playerInfo_description : 'Προβολή πληροφοριών από τους παίκτες στη νησιωτική προβολή',
				control_description: 'Απόκρυψη του κέντρου Ελέγχου σε παγκόσμια, νησιωτική και αστική προβολή',
				visibility_category : '<b>Ορατότητα πίνακα</b>',
				display_category : '<b>Επιλογές Εμφάνισης</b>',
				global_category : '<b>Γενικές ρυθμίσεις</b>',
				tweaks_category : '<b>Βελτιώσεις</b>',
				army_category : '<b>Στρατιωτικές ρυθμίσεις</b>',
				building_category : '<b>Επιλογές εμφάνισης λίστας κτηρίων</b>',
				resource_category : '<b>Ρυθμίσεις πόρων</b>',
				language_category : '<b>Ρυθμίσεις γλώσσας</b>',
				Initialize_Board : '<b>Εκκίνηση Πίνακα</b>',
				helpSteps: ['στο Δημαρχειο και μετάβαση σε όλες τις πόλεις με ανοιχτό αυτό το παράθυρο','στο Σύμβουλο έρευνας και μετάβαση και στις 4 κατηγορίες ερευνών στο αριστερό παράθυρο','στο Παλάτι της Πρωτεύουσάς σας','στο Μουσείο','στον Πίνακα Εταίρων με σύναψη Πολιτιστικής Συνθήκης (μετάβαση σε ΌΛΕΣ τις σελίδες του πίνακα)','στον Πίνακα μελών της Συμμαχίας','στην καρτέλα Οικονομικά','στα Υπάρχοντα','στην καρτέλα «Στρατεύματα στην πόλη» και μετάβαση σε όλες τις πόλεις με ανοιχτό αυτό το παράθυρο'],
				on_your_Town_Hall : 'στο Δημαρχειο και μεταβείτε σε όλες σας τις πόλεις με ανοιχτό αυτό το παράθυρο',
				on_the_Troops : 'στην καρτέλα «Στρατεύματα στην πόλη» στα αριστερά και μεταβείτε σε όλες σας τις πόλεις με ανοιχτό αυτό το παράθυρο',
				on_Research_Advisor : 'στο Σύμβουλο έρευνας και μετά στο αριστερό παράθυρο και διάλεξε τις 4 κατηγορίες ερευνών',
				on_your_Palace : 'στο Παλάτι σας',
				on_your_Finance : 'στην καρτέλα Οικονομικά',
				on_the_Ambrosia : 'στο «Κατάστημα Αμβροσίας»',
				Re_Order_Towns : '<b>Επανατακτοποίηση πόλεων</b>',
				Reset_Position : '<b>Επαναφορά Θέσης</b>',
				On_any_tab : 'Σε οποιαδήποτε καρτέλα, σύρετε απο το εικονίδιο πόρου στα αριστερά του ονόματος της πόλης',
				Right_click : 'Δεξί κλικ στο κουμπί μενού του προγράμματος στα μενού της αριστερής πλευράς',
				Navigate : '1,2,3,4,5,6,7,8,9,0,-,=<b>:</b> Μετάβαση από πόλη σε πόλη (1η έως 12η)',
				Navigate_to_City : 'SHIFT+1,2,3,4,5<b>:</b> Μετάβαση στις καρτέλες του πίνακα (πόλεις, κτήρια, στρατός, ρυθμίσεις και Βοήθεια',
				Navigate_to : 'Q,W,E,R<b>:</b> Μετάβαση στους Συμβούλους (Δήμαρχος, Στρατηγός, Επιστήμονας, Διπλωμάτης)',
				Navigate_to_World : 'SHIFT+Q,W,E<b>:</b> Μετάβαση σε Παγκόσμια, Νησιωτική και Αστική προβολή',
				Spacebar : 'ΔΙΑΣΤΗΜΑ-(SPACE)<b>:</b> Εμφάνιση / Απόκρυψη του Πίνακα',
				Hotkeys : '<b>Πλήκτρα συντόμευσης</b>',
				shop: 'Κατάστημα',
				cinetheatre: 'προς το Κινηματοθέατρο',
				Cinetheatre: 'Κινηματοθέατρο',
				fulldatelong: 'dddd, Do MMMM YYYY H:mm:ss', // based on momentjs (untranslated)
				fulldateshort: 'dddd, D/M/YYYY H:mm', // based on momentjs (untranslated)
				dateformat: 'dddd, Do MMMM YYYY', // βασισμένο στο momentjs (untranslated)
				dateformatshort: 'dddd, D/M/YYYY', // based on momentjs (untranslated)
				timeformat: 'H:mm:ss', // βασισμένο στο momentjs (untranslated)
				timeformatshort: 'H:mm', // based on momentjs (untranslated)
				thousandSeperator : '.',
				decimalPoint:',',
				leftquot: '«',
				rightquot: '»',
				ordinal: 'η',
				ambrosia: 'Αμβροσία',
				ambrosiaFountain: 'Σιντριβάνι Αμβροσίας',
				ambrosiaFountaintxt: ['Λείπουν {0} μονάδες Αμβροσίας','Λείπει {0} μονάδα Αμβροσίας','Αγορά τώρα!','Αυτή η μεγαλοπρεπής κρήνη απεικονίζει δυο θεότητες, που κρατούν μαζί το χρυσό Κέρας της Αμάλθειας. Κάποτε κυλούσε από αυτή άφθονη Αμβροσία και συγκεντρωνόταν στην δεξαμενή από κάτω, αλλά φαίνεται πως η κρήνη έχει πλέον στερέψει.','Αυτή η πηγή είναι θεϊκής προέλευσης. Μπορείτε να ανακαινίσετε την κρήνη, αν κάνετε θυσίες στους θεούς και τους προσκυνήσετε.','Αν προσευχόσαστε αρκετά συχνά στο πηγάδι και αδειάζετε συστηματικά τη δεξαμενή Αμβροσίας, οι θυσίες σας θα εισακουστούν!','Αν συνδέεστε κάθε μέρα για ένα διάστημα, η ποσότητα Αμβροσίας που θα μπορείτε να συλλέξετε, θα αυξάνεται. Από την <b>8<sup>η</sup></b> ημέρα θα επαναλαμβάνονται οι ποσότητες από την <b>5<sup>η</sup></b> έως την <b>7<sup>η</sup></b> ημέρα.','Η κρήνη θα είναι ενεργή για <b>365</b> ημέρες.','Αν δεν συνδεθείτε μια ημέρα, δεν θα λάβετε Αμβροσία και η μέτρηση θα ξεκινήσει πάλι από την αρχή.'],
				dailytaskstxt: ['Εδώ βλέπετε την λίστα των αποστολών που μπορείτε να ολοκληρώσετε καθημερινά, ώστε να εντυπωσιάσετε τους θεούς.<br>Για κάθε ολοκληρωμένη αποστολή αποκτάτε μια συγκεκριμένη ποσότητα εύνοιας. Με αυτήν την εύνοια μπορείτε να διαλέξετε μια ή περισσότερες ανταμοιβές.<br><br>Οι αποστολές ανανεώνονται καθημερινά, ενώ η συνολική εύνοια λήγει κάθε εβδομάδα μεσάνυχτα Κυριακής προς Δευτέρα (ώρα διακομιστή).','Αποστολές','Ανταμοιβές','Αποστολές που ολοκληρώθηκαν σήμερα: {0} / {1} ({2})','Επιτυχής επιδρομή βαρβαρικού χωριού','Εμπόριο πρώτων υλών','Κατανάλωση Αμβροσίας','Έναρξη βελτίωσης στο εργαστήριο','Διενέργεια ταξιδιού κουρσέματος','Κατασκευή μονάδων θαλάσσης','Διενέργεια έρευνας','Δωρεά για αναβάθμιση θαύματος','Δωρεά για αναβάθμιση μονάδας παραγωγής','Εκπαίδευση μονάδων ξηράς','Κατασκευή ή Αναβάθμιση κτηρίου','Λεηλασία πόλης','Έναρξη πειρατικής εφόδου','Λήψη επιτεύγματος','Προβολή πολιτιστικής προβολής στο Κινηματοθέατρο','Πόροι',{wood:'Μονάδες ξύλου',wine:'Μονάδες κρασιού',marble:'Μονάδες μαρμάρου',glass:'Μονάδες κρύσταλλου',sulfur:'Μονάδες θείου',gold:'Μονάδες χρυσού',research:'Ερευνητικοί πόντοι',spearman:'Λογχοφόροι',slinger:'Εκτοξευτές',phalanx:'Οπλίτες',swordsman:'Ξιφομάχοι',archer:'Τοξότες',steamgiant:'Ατμογίγαντες',marksman:'Πυροβολητές θείου',bombardier:'Βομβαρδιστικά',premium:'24 ώρες Προνομιούχου λογαριασμού',resourceBonus:'24 ώρες Ατμοκίνητο Πριόνι',wineBonus:'24 ώρες Ατμοκίνητο Πιεστήριο κρασιού',marbleBonus:'24 ώρες Ατμοκίνητο Σφυρί',sulfurBonus:'24 ώρες Ατμοκίνητος Τροχός Θείου με πτερύγια',crystalBonus:'24 ώρες Ατμοκίνητο Τρυπάνι κρύσταλλου'},'Ανταλλαγή','Δεν έχετε αρκετές Εύνοιες.','Άνοιγμα Κινηματοθέατρου'],
				cinetheatretxt: ['Οι κωμωδίες και τα δράματα στο Κινηματοθέατρο κάνουν τους εργάτες σας χαρούμενους και τους δίνουν δύναμη, για να δουλεύουν με μεγαλύτερο ζήλο. Η πολιτιστική παράσταση δεν ενδιαφέρει καθόλου τους εργάτες σας, αλλά αρέσει πολύ στους θεούς! Έτσι θα κερδίζετε την εύνοιά τους.','Σε περίπτωση που αντιμετωπίσετε <b>προβλήματα</b> κατά την προβολή κάποιου βίντεο ή την ενεργοποίηση της βράβευσης σας, ελέγξτε μήπως υπάρχει ενεργοποιημένο κάποιο <b>πρόγραμμα αποκλεισμού διαφημίσεων</b>, <b>πρόγραμμα αποκλεισμού κώδικα</b> ή <b>κώδικας</b>. Αφήστε τα βίντεο να παίξουν μέχρι τέλους, ώστε να λάβετε σίγουρα την επιβράβευσή σας. Μόλις ενεργοποιηθεί, θα λάβετε ένα <b>μήνυμα του σύμβουλου της πόλης</b>.','Σας άρεσε;','Παίξτε τώρα!','Η επιβράβευσή σας έχει ενεργοποιηθεί.','Ποια προβολή θέλετε να δείτε;','Δεν υπάρχει προβολή<br>αυτή τη στιγμή.','Δράμα','Κωμωδία','Πολιτιστική προβολή','Παραγωγή ξύλου','Παραγωγή {0}',{wine:'κρασιού',marble:'μαρμάρου',crystal:'κρύσταλλου',sulfur:'θείου'},'+20 % για 12 ώρες','50 Εύνοιες','Προβολή','Εδώ μπορείτε να αποκτήσετε επιβραβεύσεις παραγωγής και Εύνοια, βλέποντας βίντεο άλλων παιχνιδιών της Gameforge.','Πρέπει να ολοκληρώσετε την προβολή, για να λάβετε την επιβράβευση.','Οι επιβραβεύσεις παραγωγής ισχύουν για <b>12 ώρες</b> μετά τη ολοκλήρωση της προβολής και ισχύουν μόνο για την πόλη στην οποία παρακολουθήσατε το βίντεο.<br>Σκεφτείτε λοιπόν καλά πού θέλετε να παρακολουθήσετε τα βίντεο.','Μπορείτε να αποκτήσετε Εύνοια μόνο μια φορά ανά ημέρα. Ανανεώνεται τα μεσάνυχτα (ώρα διακομιστή).'],
				pirtxt: ['Πειρατικό φρούριο','Ταξίδια κουρσέματος','Δύναμη πληρώματος','Πόντοι κουρσέματος','Υπόλοιπος χρόνος ως την αξιολόγηση','Βασική Δύναμη','Επιβράβευση','Θέση','Επόμενη ανανέωση κατάταξης βάσει πόντων κουρσέματος στις {0}','Αποστολή πληρώματος σε ταξίδι κουρσέματος','Το πλήρωμά σας ξεκίνησε {0}. Όσο γίνεται αυτό, δεν μπορεί να γίνει άλλη έφοδος ή ταξίδι κουρσέματος.','Διάρκεια','Ακύρωση','Στόχος','Ανταμοιβή','Ενέργεια','Κούρσεμα','Διαθέσιμο από επίπεδο','Λαθρέμποροι','Ψαρόβαρκα','Μεταφορά κρασιού','Εμπορικό πλοίο','Σκάφος-Έμβολο','Βάρκα Κατάδυσης','Διπλωματικό πλοίο','Ναυαγοί','Φοίνικες','Μετατροπή πόντων κουρσέματος σε δύναμη πληρώματος','Απαιτούνται τουλάχιστον 10 πόντοι κουρσέματος.','Η μετατροπή έχει μια βασική διάρκεια','Όσο έχεις τουλάχιστον {0} στον λογαριασμό σου, αποκτάς {1} επιβράβευση στη δύναμη πληρώματος.','Επιβεβαίωση','Μια απειλητική πειρατική σημαία ανεμίζει πάνω από το πειρατικό φρούριο στην πόλη σου. Ο πειρατής που θα μαζέψει τη μεγαλύτερη λεία στα ταξίδια κουρσέματος του, θα αποκτήσει μια γενναιόδωρη ανταμοιβή. Για να μην κλαπούν οι πόντοι κουρσέματος σου ως την ημέρα της αξιολόγησης, πρέπει να ενισχύσεις το πλήρωμά σου.','Η μετατροπή έχει μια βασική διάρκεια {0}','Εισάγετε τη λέξη ασφαλείας μέσα στο πλαίσιο παρακάτω για να συνεχίσετε. Δεν χρειάζεται να λάβετε υπόψη το ταίριασμα μικρών-κεφαλαίων γραμμάτων κατά την εισαγωγή. Είναι μέτρο ασφαλείας για την αντιμετώπιση ανέντιμων πειρατών','Λέξη ασφαλείας','έφοδο','ταξίδι κουρσέματος','Εμβέλεια για Εφόδους','Νέο Ταξίδι Κουρσέματος','Αυτόματη επανάληψη αποστολής Λαθρεμπόρων','Χωρίς μεταβολή','Θέση','Θέσεις','Εκτός εμβέλειας από<br>την {0} «<b>{1}</b>»','Τρέχουσα','Προηγούμενη','Διαφορά θέσης','Χρόνος προσέγγισης','Συνολικός χρόνος εφόδου','Προσέγγιση','Επιστροφή','Χωρίς ανταμοιβή','Ανταμοιβές με την τρέχουσα κατάταξη','Διαφορά κατάταξης','Τρέχουσα διαφορά','Αποστολές','Διάρκεια αποστολών','Παίκτης','Αντιγράφει στο πρόχειρο τη τρέχουσα λίστα κατάταξης.','Η λίστα κατάταξης της πειρατείας αντιγράφτηκε στο πρόχειρο!'],
				porttxt: ['Ο λιμένας είναι η πύλη σας προς τον κόσμο. Εδώ μπορείτε να μισθώσετε εμπορικά πλοία και να τα ετοιμάσετε για μακρινά ταξίδια. Μπορείτε επίσης να παραλάβετε πολύτιμα αγαθά από μέρη μακρινά. Οι μεγαλύτεροι λιμένες εμπορικών συναλλαγών μπορούν να φορτώσουν τα πλοία γρηγορότερα. Μπορείτε να χτίσετε άλλο ένα λιμάνι, που θα αυξήσει την ταχύτητα φόρτωσής σας, μόλις ολοκληρώσετε την έρευνα «Δεξαμενή καθαρισμού».','Μεταφορά','Αγορά εμπορικών πλοίων','Εμπορικά Δρομολόγια','Αποστολή εμπορικών πλοίων','Μεταφορά στην {0} {1}','Εδώ εμφανίζονται κατά τη διάρκεια του παιχνιδιού οι επιπλέον πόλεις που έχετε ιδρύσει (έως 11). Μπορείτε να επιλέξετε μια από τις πόλεις, για να μεταφέρετε απευθείας με τα εμπορικά σας πλοία τα διάφορα αγαθά.','Πώς ιδρύονται νέες πόλεις;','Στόλοι που φορτώνονται','Εξερχόμενα εμπορικά πλοία','Ξένα εμπορικά πλοία','Εισερχόμενα εμπορικά πλοία','Εχθρικά πλοία (Λεηλασίες)','Δεν υπάρχουν καταχωρημένα πλοία στον Λιμενάρχη.','Προορισμός','Πλοία','Αποστολή','Κατάσταση','Είδη και ποσότητες φορτίων','Μεταφορά','Φόρτωση','Επιτάχυνση φόρτωσης','Προέλευση','Πλοία','Αποστολή','Άφιξη','Απόσυρση στόλου!','','','','','','Ταχύτητα φόρτωσης','Η ταχύτητα φόρτωσης καθορίζει πόσο γρήγορα μπορούν να φορτωθούν και να ξεφορτωθούν τα εμπορικά σας πλοία στο εμπορικό σας λιμάνι.','Λιμένας ({0}o Επίπεδο)','{0} μονάδες ανά λεπτό','Πολίτευμα','Ναός του Ερμή','Αγορά εμπορικών πλοίων','Τα εμπορικά σας πλοία είναι τα πιο σημαντικά αποκτήματα της νησιώτικης σας αυτοκρατορίας. Με αυτά μεταφέρετε αγαθά και μονάδες.','Μάθετε περισσότερα σχετικά με τα Εμπορικά σας Πλοία...','Ο μέγιστος αριθμός εμπορικών πλοίων<br>που μπορείτε να αγοράσετε<br>με χρυσό έχει επιτευχθεί.','Κόστος','Αγορά Εμπορικών Πλοίων','Δεν έχετε αρκετή ποσότητα χρυσού! Χρειάζεστε ακόμα <b>{0}</b> χρυσό!','Το μέγιστο έχει επιτευχθεί!','Μπορείτε να αγοράσετε από <b>1</b> έως <b>40</b> επιπλέον Φοινικικά εμπορικά πλοία.<br>Κάθε τέτοιο πλοίο μπορεί να μεταφέρει έως <b>500</b> αγαθά ή αντίστοιχη ποσότητα μονάδων ξηράς.<br>Με κάθε σας αγορά Φοινικικού εμπορικού πλοίου, η τιμή του επόμενου, σε Αμβροσία, αλλάζει.','Αγορά Φοινικικού<br>Εμπορικού Πλοίου','Λείπουν {0} μονάδες Αμβροσίας','Λείπει {0} μονάδα Αμβροσίας','Αγοράστε τώρα!','Πρόσθετα Εμπορικά Πλοία','Λίστα φίλων','Πολίτευμα','Επιβράβευση 7 ημερών','Εμπορικά Πλοία','Φοινικικά Εμπορικά Πλοία','Επεξεργασία εμπορικών δρομολογίων','Ο μέγιστος αριθμός εμπορικών πλοίων<br>που μπορείτε να αγοράσετε<br>με αμβροσία έχει επιτευχθεί.','Ένα εμπορικό δρομολόγιο επιτρέπει καθημερινές μεταφορές αγαθών μεταξύ των πόλεων της αυτοκρατορίας σας. Έτσι μπορείτε, για παράδειγμα, να προμηθεύετε τις πόλεις σας με κρασί. Έχετε ένα δωρεάν εμπορικό δρομολόγιο και μπορείτε να δημιουργήσετε και άλλα χρησιμοποιώντας Αμβροσία.<br><br>Να ελέγχετε πάντα να υπάρχουν αρκετά αγαθά και ελεύθερα εμπορικά πλοία για τις ώρες που έχετε επιλέξει τα εμπορικά δρομολόγια. Να προσέχετε να μην υπάρχουν εχθρικοί στόλοι στα λιμάνια των πόλεων που επιλέξατε.','Εμπορικό δρομολόγιο','Διάρκεια: 7 ημέρες','Ανενεργό','Ενεργοποίηση','Αποθήκευση αλλαγών','Διαγραφή δρομολογίου','Δημιουργία νέου δρομολογίου','Ακόμα<br>{0}','Επέκταση','Αυτόματη επέκταση','Μπορείτε να επεκτείνετε αυτόματα τη διάρκεια αυτού του δρομολογίου πατώντας στο τετράγωνο. Τις τελευταίες <b>3 ώρες</b> του <b>7ημέρου</b> θα γίνεται επέκταση για άλλες <b>7</b> ημέρες.','Άρση αυτόματης επέκτασης','Αν πατήσετε ξανά το τετράγωνο, η αυτόματη επέκταση θα τερματιστεί αυτόματα.','',''],
				regGiftstxt: ['Δώρα εγγραφής','Για να σας καλωσορίσουν όπως σας αξίζει, οι πολίτες σας μάζεψαν κάποιες δωρεές. Μπορείτε να παραλάβετε ένα δώρο από εδώ κάθε μέρα για μια εβδομάδα. Καλωσορίσατε στο Ikariam.','{0} Ημέρα','{0} Χρυσός','{0} Πόντοι έρευνας','{0} Λογχοφόροι',['{0} Χρυσός','{0} Πόντοι έρευνας'],'{0} Κρασί','{0} Κρύσταλλο','{0} Χρυσός','Παραλαβή!','Το έχετε παραλάβει!','Έχετε ακόμα <b>{0}</b> ({1}) για την παραλαβή των δώρων σας.','Έχετε παραλάβει όλα τα δώρα. Η καρτέλα θα παραμείνει διαθέσιμη για <b>{0}</b> ({1}).','Λήξη σε {0} ({1})'],
				financestxt: ['Ισολογισμός','Ποσότητα χρυσού','Αυξημένα έσοδα χρυσού','Ποσό','Αποτέλεσμα'],
				militarytxt: ['Μεταφορές ({0})','Αναφορές μαχών ({0})','Βεντέτες','Τρέχουσες μάχες','Εμπορικές / Στρατιωτικές μεταφορές','Όλες','Αποστολή','Ώρα άφιξης','Ταχύτητα','Μονάδες','Προέλευση','Προορισμός','Ενέργεια','Δεν υπάρχουν μεταφορές για προβολή!','Αναφορές μαχών','Δεν υπάρχουν διαθέσιμες αναφορές μάχης.','Είδος','Τελευταίος γύρος','Γύροι','Πόλη','Κάτοχος','Ενέργεια',{groundfight:['Μάχη','Προβολή μάχης'],seafight:['Ναυμαχία','Προβολή ναυμαχίας']},'Όλες','Αντιστροφή επιλογής','-- Επιλογή ενέργειας --','Διαγραφή','Επισήμανση ως αναγνωσμένα','Εντάξει','Βεντέτες συμμαχίας','Ολοκληρωμένες βεντέτες','Ολοκληρωμένες βεντέτες συμμαχίας','Δεν εμπλέκεστε σε κάποια βεντέτα','Η συμμαχία σας δεν εμπλέκεται σε κάποια βεντέτα'],
				researchtxt: {1010:'Όπλα Καταστρώματος',1020:'Συντήρηση πλοίων',1030:'Επέκταση',1040:'Ξένοι Πολιτισμοί',1050:'Πίσσα',1060:'Υγρό Πυρ',1070:'Αντίβαρο',1080:'Διπλωματία',1090:'Θαλάσσιοι Χάρτες',1100:'Μηχανή ατμοκίνητων τροχών',1110:'Εγκατάσταση κανονιού',1120:'Αρχιτεκτονική',1130:'Βύθισμα',1140:'Καλαφάτισμα',1150:'Συμπαγής Κριός',1160:'Πλωτή βάση',1170:'Πειρατεία',1999:'Ναυτικό Μέλλον',2010:'Συντήρηση',2020:'Τροχαλία',2030:'Πλούτος',2040:'Κρασί',2050:'Μαγειρικές ειδικότητες',2060:'Γεωμετρία',2070:'Αγορά',2080:'Διακοπές',2090:'Χέρια βοηθείας',2100:'Αλφάδι',2110:'Γραφειοκρατία',2120:'Ουτοπία',2130:'Βελτιωμένη συλλογή προμηθειών',2140:'Αποστακτήριο',2150:'Ξυλουργική Τέχνη',2160:'Αλάνα',2170:'Νομοθεσία',2180:'Εμπόριο στρατιωτών',2999:'Οικονομικό Μέλλον',3010:'Κατασκευή Πηγαδιού',3020:'Χαρτί',3030:'Κατασκοπεία',3040:'Πολυθεϊσμός',3050:'Μελάνι',3060:'Πολιτιστική Ανταλλαγή',3070:'Ανατομία',3080:'Οπτική',3081:'Πειράματα',3090:'Μηχανικό στυλό',3100:'Πέταγμα Πουλιού',3110:'Ρίψη Επιστολών',3120:'Αίθουσα πίεσης',3130:'Η Αρχιμήδεια Αρχή',3140:'Εφεύρεση',3150:'Σχηματισμός κυβέρνησης',3160:'Θρησκεία κράτους',3170:'Αρχειοθέτηση',3999:'Επιστημονικό μέλλον',4010:'Δεξαμενή καθαρισμού',4020:'Χάρτες',4030:'Επαγγελματικός στρατός',4040:'Πολιορκία',4050:'Κώδικας Τιμής',4060:'Βαλλιστική',4070:'Νόμος του μοχλού',4080:'Κυβερνήτης',4090:'Οργάνωση',4100:'Πυρίτιδα',4110:'Ρομποτική',4120:'Χυτήριο κανονιών',4130:'Πυροτεχνουργία',4999:'Στρατιωτικό μέλλον'},
				researchdesc: {1010:'Ένα περιστρεφόμενο εξάρτημα για τα πολεμικά σκάφη σας, στο οποίο μπορείτε να τοποθετήσετε τεράστια όπλα! Για αρχή οι εφευρέτες σας τοποθέτησαν σε αυτό μια τεράστια βαλλίστρα. Υποτίθεται ότι το εξάρτημα θα αντέξει και άλλες μηχανές. Έτσι, μόλις ένας από τους επιστήμονές σας έχει μια ιδέα, μπορείτε να την εγκαταστήσετε στα σκάφη σας χωρίς πρόβλημα.<br><br><b>Επιτρέπει:</b> Κατασκευή [[v:u,s:213,h:10|βαλλιστροφόρων]] στο [[v:b,b:5,h:1|Ναυπηγείο]].',1020:'Αν κρατάτε πάντα σε τάξη τα σκάφη σας, δεν είναι απαραίτητο να τα επισκευάζετε συχνά. Το ηθικό του πληρώματος είναι επίσης καλύτερο όταν τραγουδάνε πού και πού όλοι μαζί σφουγγαρίζοντας το κατάστρωμα ή ράβοντας τα πανιά.<br><br><b>Επίδραση:</b> 2% μικρότερο κόστος συντήρησης για τα [[v:u,s:210,h:10|πλοία]].',1030:'Πέρα από το νησί σας υπάρχει κάτι περισσότερο από τη θάλασσα! Υπάρχουν κι άλλα νησιά που περιμένουν να ανακαλυφθούν. Δεν είσαστε μόνοι! Μπορείτε να κερδίσετε έδαφος σε ένα από τα πρόσφατα ανακαλυφθέντα νησιά, να ανακαλύψετε νέους πόρους και να γνωρίσετε άλλους λαούς! Οι υπάλληλοί σας είναι πρόθυμοι να διαχειριστούν ακόμη περισσότερα και οι έμποροι να ταξιδέψουν σε μακρινές χώρες!<br><br><b>Επιτρέπει:</b> Χτίσιμο [[v:b,b:11,h:1|παλατιών]], ίδρυση [[v:i,h:0,sh:6|αποικιών]], [[v:i,h:0,sh:3|εμπόριο με μακρινές χώρες]].',1040:'Αν γνωρίσετε καλύτερα τους άλλους λαούς, θα προοδέψετε κι εσείς. Οι συχνές συζητήσεις και τα θερμά λόγια μπορούν να κάνουν θαύματα και να οδηγήσουν σε νέες συμμαχίες και φιλίες. Φυσικά χρειαζόσαστε ένα όμορφο και άνετο κτίριο για όλους τους πρέσβεις και τις γιορτές που θα κάνετε προς τιμήν τους!<br><br><b>Επιτρέπει:</b> Κατασκευή [[v:b,b:12,h:1|Πρεσβειών]].',1050:'Οι επιστήμονές σας εφηύραν ένα παχύρρευστο και βρωμερό υγρό. Από τότε που αλείφετε τα πλοία σας με αυτό, δεν υπάρχουν πια τρύπες για μπάλωμα.<br><br><b>Επίδραση:</b> 4% λιγότερη συντήρηση για [[v:u,s:210,h:10|πλοία]].',1060:'Μια φωτιά που δεν μπορεί να σβηστεί με το νερό! Με αυτό το μείγμα από πολλά μυστικά συστατικά μπορείτε να βάλετε φωτιά σε σκάφη και να τα βυθίσετε! Σύντομα θα κατακτήσετε τις θάλασσες με το σκάφος που έχει την αναπνοή ενός δράκου!<br><br><b>Επιτρέπει:</b> Κατασκευή [[v:u,s:211,h:10|Φλογοβόλων]] στο [[v:b,b:5,h:1|Ναυπηγείο]].',1070:'Οι επιστήμονές σας έχουν βελτιώσει τη σύνδεση όπλων στα σκάφη σας, έτσι ώστε να μη διαλύονται όταν πετάτε τεράστιους βράχους στους εχθρούς σας. Χάρη στο αντίβαρο, ο καταπέλτης σας τώρα μένει στο σκάφος αντί να τινάζεται προς τα πίσω.<br><br><b>Επιτρέπει:</b> Κατασκευή [[v:u,s:214,h:10|καταπελτοφόρων]] στο [[v:b,b:5,h:1|Ναυπηγείο]].',1080:'Ένας από τους φιλοσόφους σας έχει γράψει σοφά πράγματα για τον πόλεμο και την ειρήνη. Σας συμβουλεύει να συμμαχήσετε με άλλους λαούς, ώστε να πολεμήσετε τους κοινούς εχθρούς μαζί!<br><br><b>Επιτρέπει:</b> [[v:i,h:14|Στρατιωτικές Συνθήκες]].',1090:'Τα ταξίδια σας θα είναι πολύ ασφαλέστερα αν καταγράφατε όλα τα επικίνδυνα ρεύματα και αβαθή! Έτσι οι ναυτικοί σας δεν θα χρειάζεται να φοβούνται τους υφάλους, τις θανάσιμες δίνες και τις σαγηνευτικές σειρήνες.<br><br><b>Επίδραση:</b> 8% λιγότερη συντήρηση για [[v:u,s:210,h:10|πλοία]].',1100:'Μεγάλες ειδήσεις για τους ναυτικούς σας: Ένας ατμοκίνητος τροχός επιτρέπει στα καράβια σας να κινούνται γρηγορότερα απ΄ ό,τι με κουπιά. Τώρα μπορείτε να κάνετε τους εχθρούς σας να τρέμουν με τις Κωπήλατες τορπιλάκατους!<br><br><b>Επιτρέπει:</b> Κατασκευή [[v:u,s:218,h:10|Κωπήλατων τορπιλάκατων]] στο [[v:b,b:5,h:1|Ναυπηγείο]].',1110:'Αυτό το κανόνι είναι τόσο τεράστιο, που ούτε ο Ηρακλής δε θα μπορούσε να το σύρει. Μόνο ένα θωρακισμένο ατμόπλοιο είναι αρκετά ισχυρό για να μεταφέρει αυτό και όλες τις τεράστιες σφαίρες που μπορεί να εκτοξεύσει στους εχθρούς σας.<br><br><b>Επιτρέπει:</b> Ναυπήγηση των κανονιοφόρων στο [[v:b,b:5,h:1|Ναυπηγείο]].',1120:'Ένα γερό σπίτι μπορεί να αντέξει ακόμα και στα πιο άγρια φαινόμενα της φύσης. Μπορεί να αντέξει ακόμα καλύτερα, όταν έναν έξυπνος νους έχει φροντίσει, μέσα από πολλά σχέδια και λίγα μαθηματικά, ότι όλοι του οι τοίχοι είναι ίσιοι και η στέγη του σταθερή. Ευτυχώς με τα μοιρογνωμόνια και τους διαβήτες τα κτίριά σας θα είναι πολύ πιο σταθερά και πιο προστατευμένα από τη βροχή. Ένα αρχιτεκτονικό γραφείο θα σας βοηθούσε να κάνετε οικονομία στο μάρμαρο στην κατασκευή νέων κτιρίων!<br><br><b>Επιτρέπει:</b> Κατασκευή [[v:b,b:24,h:1|Αρχιτεκτονικού Γραφείου]].',1130:'Οι επιστήμονές σας ανακάλυψαν ότι τα σκάφη σας έχουν μικρότερη αντίσταση στο νερό, όταν έχουν μικρότερο φορτίο. Έτσι μπορείτε να βάλετε μεγαλύτερα πανιά στο κατάρτι και να πλεύσετε πιο γρήγορα.<br><br><b>Επιτρέπει&gt;</b> γρηγορότερα καράβια με μικρότερο φορτίο.',1140:'Με τη βοήθεια αυτής της τεχνικής οι μηχανικοί σας μπορούν να σφραγίσουν πλοία που δεν είναι στεγανά. Το καλαφάτισμα είναι μια δύσκολη υπόθεση εντός λιμανιού ή και έξω από το λιμάνι, αλλά δίνει στους στόλους σας τη δυνατότητα να ετοιμάζουν τα πλοία για τη μάχη μεταξύ δυο επιθέσεων.<br><br><b>Επιτρέπει:</b> την κατασκευή [[v:u,s:220,h:10|Βοηθητικών]] στο [[v:b,b:5,h:1|Ναυπηγείο]].',1150:'Με τη βοήθεια του Κριού μπορεί να κατασκευαστεί η πιο επικίνδυνη θαλάσσια μονάδα. Αυτό το αριστοτέχνημα της μηχανολογίας εγκαθίσταται στην πλώρη του πλοίου και μπορεί να προκαλέσει μεγάλες ζημιές σε άλλα πλοία.<br><br><b>Επιτρέπει:</b> κατασκευή [[v:u,s:216,h:10|Εμβόλων ατμού]] στο [[v:b,b:5,h:1|Ναυπηγείο]].',1160:'Με τη βοήθεια αυτής της έρευνας θα μπορείτε να κατασκευάσετε στο ναυπηγείο τα μεγαλύτερα πλοία. Αυτά θα έχουν αερόστατα με τα οποία θα βομβαρδίζουν τους εχθρούς στα ανοιχτά.<br><br><b>Επιτρέπει:</b> την κατασκευή [[v:u,s:219,h:10|Μεταφορικών αερόστατων]] στο [[v:b,b:5,h:1|Ναυπηγείο]].',1170:'Ένα ισχυρό πειρατικό φρούριο με ένα δυνατό πλήρωμα που περιμένει τις διαταγές σας. Θέλει να αποκτήσει χρυσό και πόντους κουρσέματος. Οι πιο πετυχημένοι πειρατές θα αποκτήσουν φήμη και τεράστιες ποσότητες πρώτων υλών. Από εδώ μπορείτε να ξεκινήσετε εφόδους σε άλλα πειρατικά φρούρια.<br><br><b>Επιτρέπει:</b> Χτίσιμο [[v:b,b:30,h:1|πειρατικού φρουρίου]], [[v:i,h:19,sh:2|ταξίδια κουρσέματος]], [[v:i,h:19,sh:5|εφόδους]], συμμετοχή στην [[v:i,h:19,sh:6|κατάταξη πόντων κουρσέματος]].',1999:'Τα μυστικά των ωκεανών είναι επιτέλους δικά σας! Τα σκάφη σας γίνονται συνεχώς δυνατότερα και γρηγορότερα! Δεν υπάρχει σχεδόν κανένα σκάφος σε αυτόν τον ωκεανό που να είναι ικανότερο από τα δικά σας.<br><br><b>Επίδραση:</b> 2% μικρότερο κόστος συντήρησης [[v:u,s:210,h:10|πλοίων]].',2010:'Μάθατε πώς να αποθηκεύετε τους πόρους σας για να προστατεύονται καλά και μακροπρόθεσμα. Επίσης, ένα μέρος των πόρων σας είναι ασφαλές από τους πειρατές και άλλους κακοποιούς που θέλουν να κλέψουν από σας!<br><br><b>Επιτρέπει:</b> Οικοδόμηση των [[v:b,b:7,h:1|αποθηκών εμπορευμάτων]].',2020:'Μια λαμπρή ιδέα: Ένα σχοινί που τραβιέται πάνω από ένα ρολό, δίνει σε ένα απλό άτομο τη δύναμη του Ηρακλή. Έτσι τώρα οι εργαζόμενοί σας μπορούν να ανυψώσουν τεράστια κομμάτια πέτρας από μόνοι τους και να κατασκευάσουν τα κτίριά σας ακόμα γρηγορότερα!<br><br><br><b>Επίδραση:</b> 2% μικρότερες δαπάνες κτιρίου.',2030:'Η γη είναι γεμάτη από πολύτιμους θησαυρούς! Έχετε μάθει πώς να σκάβετε για θείο και κρύσταλλο και πώς να λαξεύετε το μάρμαρο από τους βράχους. Επίσης, καλλιεργείτε όμορφα αμπέλια στα εύφορα εδάφη των λόφων σας, τα οποία παράγουν απολαυστικό κρασί!<br>Μία νέα εποχή ευημερίας θα ανατείλει για σας όταν αρχίσετε να χρησιμοπείτε αυτούς τους θησαυρούς. Μετά θα μπορείτε να πουλάτε αγαθά στη θέση εμπορικών συναλλαγών και να αγοράζετε ό,τι χρειαζόσαστε από ξένους εμπόρους.<br><br><b>Επίδραση:</b> Επιτρέπει την παραγωγή [[v:i,h:6|αγαθών πολυτελείας]], την κατασκευή [[v:b,b:13,h:1|θέσεων εμπορικών συναλλαγών]] και δίνει 130 από κάθε αγαθό πολυτελείας.',2040:'Ένας ευτυχής πληθυσμός χρειάζεται φεστιβάλ, στα οποία μπορεί να περάσει την ώρα του διασκεδάζοντας και πίνοντας το φανταστικό κρασί σας που ρέει άφθονο. Στο Διόνυσο αρέσει να σας βλέπει να απολαμβάνετε όσα σας έχει δώσει!<br><br><b>Επιτρέπει:</b> Οικοδόμηση των [[v:b,b:9,h:1|ταβερνών]].',2050:'Ο πολιτισμός σας είναι πλούσιος σε εύγευστες απολαύσεις! Αν οι μάγειρες συνοδεύουν τους στρατιώτες σας στη μάχη, οι μυρωδιές θα τους θυμίζουν την εγχώρια κουζίνα και το ηθικό τους θα ενισχύεται. Μην ξεχνάτε ότι ένα καλό γεύμα δίνει και δύναμη... Και φυσικά κάθε μάγειρας έχει ένα αιχμηρό μαχαίρι, με το οποίο μπορεί να πάρει μέρος στη μάχη, αν χρειαστεί.<br><br><b>Επιτρέπει:</b> Εκπαίδευση [[v:u,u:310,h:9|Μαγείρων]] στους [[v:b,b:6,h:1|Στρατώνες]].',2060:'Ορθές γωνίες, τρίγωνα, κύκλοι... Μερικά φωτεινά μυαλά μπορούν πλέον να υπολογίσουν πώς να κατασκευάσετε τα κτίριά σας ακόμα καλύτερα και ομορφότερα. Σύντομα οι πόλεις σας θα είναι παραδείγματα για όλο τον κόσμο!<br><br><b>Επίδραση:</b> 4% μικρότερες δαπάνες για την οικοδόμηση κτιρίων.',2070:'Στις αγορές σας φτάνουν τα πιο περίεργα αγαθά από μακρινά νησιά. Εδώ μπορείτε να κλείσετε εμπορικές συνθήκες με εμπόρους, ώστε να προμηθευόσαστε με ασφάλεια όλα τα υλικά που χρειαζόσαστε.<br><br><b>Επιτρέπει:</b> [[v:i,h:14|Εμπορικές συνθήκες]], [[v:i,h:18,sh:0|Πολίτευμα:]] [[v:f,f:2,h:18,sh:3|Δημοκρατία]].',2080:'Ένας ξεκούραστος εργαζόμενος είναι προθυμότερος να εργαστεί από έναν εξαντλημένο, γι&apos; αυτό κάθε πολίτης πρέπει να έχει μια ημέρα αδείας την εβδομάδα. Αυτό θα κάνει όλους τους πολίτες σας πιο ευτυχισμένους!<br><br><b>Επίδραση:</b> Αυξάνει την [[v:i,h:3|ικανοποίηση]] και το μέγιστο όριο πολιτών σε όλες τις πόλεις.',2090:'Αν οι πολίτες σας βοηθήσουν λίγο στα ορυχεία αντί να μαυρίζουν στην παραλία, θα έχετε περισσότερες πρώτες ύλες και οι πολίτες λιγότερα εγκαύματα από τον ήλιο. Υπάρχει πάντα ανάγκη για μια χείρα βοηθείας στα ορυχεία, τα πριονιστήρια και τα αμπέλια.<br><br><b>Επιτρέπει:</b> Υπερφόρτωση των [[v:i,h:5|πηγών πρώτων υλών]].',2100:'Το νερό είναι πάντα επίπεδο. Μπορετε να χρησιμοποιήσετε αυτήν την ιδιότητα για να κάνετε και τα κτίριά σας επίπεδα! Η πόλη σας θα γίνει ομορφότερη και θα χρησιμοποιείτε λιγότερη πέτρα και ξύλο στο χτίσιμο!<br><br><b>Επίδραση:</b> 8% μικρότερες δαπάνες για την οικοδόμηση κτιρίων.',2110:'Τώρα το παλάτι σας έχει ακόμα περισσότερα ράφια, παράθυρα και συρτάρια, ακόμα περισσότερους σωρούς από αρχεία και έγγραφα και υπαλλήλους που τα καταλαβαίνουν κιόλας. Επιτέλους μπορείτε να χτίσετε και να διαχειριστείτε ένα ακόμη σημαντικό κτίριο στις πόλεις σας! Λόγω της περίπλοκης διαχείρισης και του ακριβέστερου καθορισμού όλων των διαδικασιών, το λαθρεμπόριο από κατειλημμένες πόλεις είναι πλέον αδύνατο, επειδή και οι κατακτητές αποκτούν λεπτομερείς πληροφορίες μέσω των αρχείων σας.<br><br><b>Επιτρέπει:</b> Έναν πρόσθετο [[v:i,h:0,sh:1|οικοδομικό χώρο]] στις πόλεις.',2120:'Οι πολίτες σας ζουν στον πλούτο και την ευημερία. Είναι ευτυχείς και υγιείς και έχουν πολύ λίγα προβλήματα. Ναι, θα μπορούσατε να πείτε ότι ζείτε σε ένα από εκείνα τα μέρη που βρίσκει κανείς σε γραφές των μεγάλων φιλοσόφων.<br><br><b>Επίδραση:</b> χώρος στέγασης +200, ικανοποίηση στην πρωτεύουσα +200.',2130:'Ξέρετε εδώ κι αρκετό καιρό πώς να εκμεταλλευόσαστε τους θησαυρούς του νησιού σας για να καλύψετε τις ανάγκες σας. Πρέπει τώρα να μορφώσετε τους πολίτες σας ώστε κάθε πριονιστήριο, λατομείο, αμπελώνας, ορυχείο κρυστάλλου ή λάκκος θείου να διοικείται από άντρες δυνατούς αλλά και επιδέξιους. Με αυτό τον τρόπο θα έχετε μεγαλύτερη παραγωγή και ο πολιτισμός σας θα γίνει πιο πλούσιος από ποτέ!<br><br><b>Επιτρέπει:</b> Οικοδόμηση [[v:b,b:18,h:1|Σπιτιών Ξυλοκόπου]], [[v:b,b:19,h:1|Κτιρίων Λατομείου]], [[v:b,b:21,h:1|Οινοποιείων]], [[v:b,b:20,h:1|Υαλουργείων]] και [[v:b,b:22,h:1|Πύργων Αλχημιστή]].',2140:'Αυτές οι γιορτές κρασιού είναι το γεγονός της χρονιάς! Μαζεύεται όλη η πόλη όταν πατιούνται τα καλύτερα σταφύλια της πόλης και τα παιδιά χαίρονται πολύ όταν ο «υγρός χρυσός» ρέει άφθονος! Με ένα πιεστήριο σταφυλιών, χειριζόμενο από έναν έμπειρο οινοποιό, θα είχατε όμως λιγότερη ζημία. Ο οινοποιός θα φρόντιζε και για την κατάλληλη αποθήκευση, που θα επέτρεπε στο κρασί να ωριμάσει καλύτερα!<br><br><b>Επιτρέπει:</b> Κατασκευή [[v:b,b:26,h:1|Αποστακτηρίων]].',2150:'Τα δάση των νησιών σας προσφέρουν ιδανικό οικοδομικό υλικό. Μπορείτε να κατασκευάσετε σταθερά δοκάρια για τις σκεπές των πιο μεγαλοπρεπών κτιρίων σας. Για να γίνει αυτό, πρέπει να γίνει σωστή επιλογή και επεξεργασία του ξύλου. Ένας ξυλουργός στην πόλη θα φροντίσει να καταναλώνετε λιγότερο οικοδομικό υλικό!<br><br><b>Επιτρέπει:</b> Κατασκευή [[v:b,b:23,h:1|Ξυλουργείων]].',2160:'Εφόσον οι αποθήκες σας δεν μπορούν να ανταπεξέλθουν μακροπρόθεσμα στις προμήθειες που αυξάνονται, χρειαζόσαστε εναλλακτικές λύσεις. Με μοντέρνα αδιάβροχα σκεπάσματα θα μπορέσετε να αποθηκεύσετε μεγάλες ποσότητες αγαθών έξω.<br><br><b>Επίδραση:</b> Επιτρέπει την κατασκευή [[v:b,b:29,h:1|αλάνας]].',2170:'Εϊναι μια καλή ιδέα το να καταγράψετε όλους τους κανόνες της συμβίωσης. Έτσι οι κάτοικοι του νησιού θα μπορούν να διαβάζουν ανά πάσα στιγμή τι επιτρέπεται και τι απαγορεύεται. Δεν υπάρχει πια λόγος για φθηνές δικαιολογίες!<br><br><b>Επιτρέπει:</b> [[v:i,h:18,sh:0|πολίτευμα]] [[v:f,f:4,h:18,sh:5|Νομοκρατία]].',2180:'Οι δοκιμασμένοι πολεμιστές σας, με τις γυαλιστερές πανοπλίες και τις εξελιγμένες πολεμικές σας μηχανές, είναι πλέον θρυλικοί. Ήρθε η ώρα να βγάλετε κέρδος από αυτούς. Οι άλλοι κυρίαρχοι θα έκαναν τα πάντα για να αποκτήσουν τις στρατιές σας.<br><br><b>Επιτρέπει:</b> Χτίσιμο της [[v:b,b:31,h:1|Μαύρης αγοράς]].',2999:'Οι πολίτες σας ζουν σε ευημερία και οι αγορές είναι γεμάτες από πολύτιμα αγαθά από όλον τον κόσμο! Οι δρόμοι είναι αναπτυγμένοι και καθαροί κι έτσι το οικοδομικό υλικό φτάνει στα εργοτάξια πιο γρήγορα.<br><br><b>Επίδραση:</b> +10 [[v:i,h:3|Ικανοποίηση]] και +20 μέγιστο όριο πολιτών σε κάθε πόλη ανά επίπεδο της έρευνας «Οικονομικό Μέλλον».',3010:'Εύρηκα! Ένα πηγάδι στην πόλη σας! Τώρα δεν χρειάζεται να περιμένετε να βρέξει. Οι πολίτες σας νιώθουν καλύτερα και τα χωράφια δεν μένουν ξερά για πολύ!<br><br><b>Επίδραση:</b> χώρος στέγασης +50, [[v:i,h:3|ικανοποίηση]] στην πρωτεύουσα +50.',3020:'Έχετε βρει έναν τρόπο να αρχειοθετήσετε καλύτερα τη γνώση σας! Χάρη στους παπύρους, δεν είναι πια απαραίτητο να κοπιάζετε σμιλεύοντας τις λέξεις σας στις βαριές πέτρες για να γεμίσετε τη βιβλιοθήκη σας!<br><br><b>Επίδραση:</b> 2% περισσότεροι πόντοι έρευνας.',3030:'Όταν μερικοί από τους πολίτες σας εγκαθίστανται σε άλλες πόλεις, μπορούν να σας βοηθούν για να προσέχετε τους γείτονές σας. Μπορείτε να μένετε ενημερωμένοι για το πότε ένας γείτονας κάνει μια ανακάλυψη ή ποιους πόρους έχει.<br><br><b>Επιτρέπει:</b> Χτίσιμο [[v:b,b:16,h:1|κρησφύγετων]].',3040:'Ο άνθρωπος δεν μπορεί πάντα να εξηγήσει με τη λογική ό,τι συμβαίνει στον κόσμο και τότε η απάντηση αναζητείται στους θεούς. Οι θεοί από την μία πλευρά είναι σαν τους ανθρώπους, αλλά από την άλλη είναι και πολύ διαφορετικοί. Εξάλλου, τι είδους λογική εξήγηση μπορεί να έχει το ανεξήγητο;<br><br><b>Επιτρέπει:</b> [[v:b,b:28,h:1|Ναούς]] και [[v:i,h:15,sh:3|Θαύματα]].',3050:'Η φύση σας δίνει ό,τι χρειαζόσαστε για να γράψετε: Τα πουλιά σας δίνουν τα φτερά τους και οι σουπιές από τη θάλασσα το μαύρο μελάνι τους! Τώρα μπορείτε να καταγράψετε τις ιδέες σας ακόμα πιο εύκολα!<br><br><b>Επίδραση:</b> 4% περισσότεροι πόντοι έρευνας.',3060:'Οι πολίτες σας πρέπει να μπορούν να ρίξουν μια ματιά στα πολιτιστικά επιτεύγματα άλλων λαών. Και σίγουρα θα ενδιαφερθούν και οι άλλοι λαοί να μάθουν από σας και να εκθέσουν μερικά από τα μεγάλα έργα τέχνης σας στα μουσεία τους.<br><br><b>Επιτρέπει:</b> Οικοδόμηση [[v:b,b:10,h:1|μουσείων]], [[v:i,h:14|Εμπορική συνθήκη]], Φοινικικά εμπορικά πλοία.',3070:'Έχετε μάθει πολλά για το ανθρώπινο σώμα! Τώρα μπορείτε να στείλετε τους γιατρούς στη μάχη για να βοηθήσετε τους πληγωμένους στρατιώτες για να σταθούν γρήγορα στα πόδια τους. Μπορούν να αναμείξουν τα σωστά βάμματα και μερικοί γιατροί ξέρουν ακόμα και μια μυστική συνταγή για ένα μείγμα που κάνει τους μαχητές σας ακόμα γενναιότερους.<br><br><b>Επιτρέπει:</b> Στρατολόγηση [[v:u,u:311,h:9|γιατρών]] στους [[v:b,b:6,h:1|Στρατώνες]].',3080:'Όταν οι ερευνητές σας εφευρίσκουν νέα αντικείμενα, μπορεί να σπάσει πολύ κρύσταλλο. Μπορεί να χαθεί και πολύ κρύσταλλο, επειδή η τάξη δεν είναι η ανώτατη αρετή στην ακαδημία σας. Όταν ένας οπτικός φροντίζει να έχετε την καλύτερη ποιότητα, αλλά και να επιστρέφετε το κρύσταλλο και τους φακούς στη θέση τους, καταναλώνετε πολύ λιγότερο κρύσταλλο.<br><br><b>Επιτρέπει:</b>Κατασκευή [[v:b,b:25,h:1|Εργαστηρίου Οπτικού]].',3081:'Οι ερευνητές σας έχουν την επιθυμία να δοκιμάζουν τις θεωρίες τους και στην πράξη. Αυτά τα πειράματα σίγουρα θα επιταχύνουν κατά πολύ τις έρευνες, συνεπάγονται όμως και επιπλέον εξοπλισμό εργαστηρίου. <br><br><b>Επιτρέπει:</b> Αγορά πόντων έρευνας έναντι κρυστάλλου, [[v:i,h:18,sh:0|πολίτευμα:]] [[v:f,f:6,h:18,sh:7|Τεχνοκρατία]].',3090:'Μια λαμπρή συσκευή: Ένας έξυπνος εφευρέτης κατάφερε να διδάξει το γράψιμο σε μια μηχανή. Τώρα μπορείτε να αντιγράψετε τις γραφές σας ευκολότερα και οι ακαδημίες σας μπορούν να ανταλλάσσουν ιδέες γρηγορότερα!<br><br><b>Επίδραση:</b> 8% περισσότεροι ερευνητικοί πόντοι.',3100:'Έχετε μάθει να πετάτε σαν πουλιά! Τώρα μπορείτε να κατασκευάσετε μια μηχανή που μπορεί να υψώσει ένα άτομο στον ουρανό και να σφυρίζει πάνω από τα κεφάλια των εχθρών πετώντας τα μεγάλης ταχύτητας βέλη πίσω από τις πρώτες γραμμές.<br><br><b>Επιτρέπει:</b> Κατασκευή [[v:u,u:312,h:9|Γυροκόπτερων]] στους [[v:b,b:6,h:1|Στρατώνες]].',3110:'Ένα θαύμα: Μπορείτε πλέον να εκτοξεύσετε τους παπύρους από σωλήνες, ώστε να φτάνουν στους επιστήμονές σας ακόμα γρηγορότερα! Αυτό κάνει περιττές τις διαδρομές αγγελιοφόρων και πιο οικονομικές τις έρευνες!<br><br><b>Επίδραση:</b> -3 κόστος συντήρησης σε χρυσό ανά επιστήμονα.',3120:'Τώρα μπορείτε να αφήσετε τα σκάφη σας να πλεύσουν κάτω από το νερό, χωρίς να βυθίζονται! Οι ωκεανοί είναι δικοί σας! Κανένας εχθρός δε σας βλέπει, όταν τον καταδιώκετε κάτω από το νερό και τον βυθίζετε προτού σας παρατηρήσει!<br><br><b>Επιτρέπει:</b> Κατασκευή [[v:u,s:212,h:10|υποβρυχίων]] στο [[v:b,b:5,h:1|Ναυπηγείο]].',3130:'Έχετε κατορθώσει να κάνετε μια μηχανή να πετάξει! Τώρα, ούτε ο ουρανός δεν είναι πια όριο! Μπορείτε να αφήσετε τα τεράστια μπαλόνια να πετάξουν πάνω από τα κεφάλια των εχθρών σας και να τους ρίξουν φωτιά ή κυψέλες με μέλισσες από ψηλά!<br><br><b>Επιτρέπει:</b> Κατασκευή των [[v:u,u:309,h:9|βομβαρδιστικών]] στους [[v:b,b:6,h:1|Στρατώνες]].',3140:'Υπήρξαν τώρα τελευταία διάφορα γεγονότα με την εκρηκτική σκόνη και άλλες ουσίες. Έχετε οργανώσει ένα εργαστήριο για όλους τους περίεργους επιστήμονες, έτσι ώστε οι συχνές εκρήξεις να μην ενοχλούν πια τη διδασκαλία στην ακαδημία. Το εργαστήριο έχει και ισχυρότατους τοίχους και δεν μπορεί να καεί εύκολα.<br><br><b>Επιτρέπει:</b> Οικοδόμηση των [[v:b,b:15,h:1|εργαστηρίων]].',3150:'Σκεφτήκατε ότι μια άλλη μορφή πολιτεύματος θα μπορούσε να σας προσφέρει προτερήματα. Για να γίνει αυτό, πρέπει να οργανωθούν κάποια πράγματα και ίσως και να διοριστούν κάποια άτομα, όμως μια κυβέρνηση είναι κάτι πολύ ωραίο.<br><br><b>Επιτρέπει:</b> Επανάσταση, [[v:i,h:18,sh:0|πολιτεύματα]] [[v:f,f:3,h:18,sh:4|Δικτατορία]] και [[v:f,f:5,h:18,sh:6|Ολιγαρχία]].',3160:'Δεν χρειαζόσαστε νόμους, οι θρησκευτικοί νόμοι είναι παραπάνω από αρκετοί. Και με την ευκαιρία, δεν χρειαζόσαστε ούτε όλους αυτούς τους υπαλλήλους. <br><br><b>Επιτρέπει:</b> [[v:i,h:18,sh:0|μορφή πολιτεύματος]] [[v:f,f:7,h:18,sh:8|Θεοκρατία]].',3170:'Καλύτερα να αρχειοθετήσετε τους πολύτιμους ναυτικούς χάρτες σας. Έτσι οι ναύτες σας θα έχουν πάντα τον σωστό χάρτη, που θα εξοικονομεί χρόνο στα ταξίδια τους.<br><br><b>Επιτρέπει:</b> Χτίσιμο του [[v:b,b:32,h:1|Αρχείου ναυτικών χαρτών]].',3999:'Οι πιο έξυπνοι εγκέφαλοι στον κόσμο δουλεύουν για να απαντήσουν τις μεγάλες ερωτήσεις: Γιατί είσαστε εδώ; Γιατί είναι όλα έτσι όπως είναι; Πλησιάσατε άλλο ένα βήμα στο Διαφωτισμό.<br><br><b>Επίδραση:</b> 2% περισσότεροι πόντοι έρευνας.',4010:'Μια δεξαμενή στη θάλασσα, την οποία μπορείτε να αδειάζετε. Τώρα είναι απλό να φτιάξετε πλοία και να τα ρίχνετε στη θάλασσα. Ας δημιουργηθεί λοιπόν ένας δυνατός πολεμικός στόλος, που θα μάθει στους εχθρούς σας να τρέμουν!<br><br><b>Επιτρέπει:</b> κατασκευή δεύτερου [[v:b,b:3,h:1|εμπορικού λιμανιού]], [[v:b,b:5,h:1|ναυπηγείου]].',4020:'Αυτές οι μεγάλες πορείες πάνω από τα βουνά και μέσα από τα έλη σημαίνουν ότι το υλικό σας θα φθαρεί πολύ γρήγορα. Αν καταγράψετε πώς κάνουν πορείες οι στρατιώτες σας χωρίς να πεδικλώνονται στα χαμόκλαδα ή να βυθίζονται στη λάσπη, οι στρατιώτες θα πρέπει να επιδιορθώνουν τις στολές τους πιο σπάνια.<br><br><b>Επίδραση:</b> 2% λιγότερη συντήρηση για τους [[v:u,u:301,h:9|στρατιώτες]].',4030:'Η αναχαίτιση των πειρατών, των βαρβάρων και άλλων κακοποιών θα είναι πολύ ευκολότερη με επαγγελματίες στρατιώτες! Μπορεί να είναι ακριβότερο από το να κάνετε τους πολίτες σας στρατιώτες μόνο σε περίπτωση πολέμου, αλλά ως αντάλλαγμα, τα στρατεύματά σας θα εκπαιδευτούν πολύ καλύτερα στο ξίφος, τη λόγχη και την ασπίδα!<br><br><b>Επιτρέπει:</b> Στρατολόγηση [[v:u,u:302,h:9|ξιφομάχων]] και [[v:u,u:303,h:9|οπλιτών]] στους [[v:b,b:6,h:1|Στρατώνες]].',4040:'Με το κεφάλι ενός κριού φτιαγμένο από μέταλλο και τη δύναμη δέκα ατόμων μπορείτε να γκρεμίσετε ακόμη και τα τείχη μιας πόλης. Τώρα θα είναι εύκολο για τους στρατιώτες σας να κατακτήσουν άλλες πόλεις!<br><br><b>Επιτρέπει:</b> Κατασκευή [[v:u,u:307,h:9|κριών]] στους [[v:b,b:6,h:1|Στρατώνες]].',4050:'Οι στρατιώτες σας είναι περήφανοι που μπορούν να υπηρετούν το στρατό και την πατρίδα τους. Φροντίζουν καλύτερα και τις στολές τους κι έτσι δεν χρειάζεται να τις ράβετε και να τις μπαλώνετε συχνά.<br><br><b>Επίδραση:</b> 4% μικρότερο κόστος συντήρησης και επιτρέπει το [[v:i,h:18,sh:0|πολίτευμα]] [[v:f,f:1,h:18,sh:2|Αριστοκρατία]].',4060:'Τώρα ξέρετε πώς να πετυχαίνετε με βέλη τους εχθρούς σας. Πρέπει να ξεκινήσετε αμέσως να εκπαιδεύσετε τους στρατιώτες σας σε αυτήν τη δεξιότητα, ώστε να έχετε σύντομα τοξότες στη μάχη!<br><br><b>Επιτρέπει:</b> Εκπαίδευση [[v:u,u:313,h:9|Τοξοτών]] στους [[v:b,b:6,h:1|Στρατώνες]].',4070:'Με αυτήν την τεχνολογία έχετε τη δύναμη να πετάξετε στον αέρα ακόμη και τεράστιους βράχους! Αν οι βράχοι είναι αρκετά μεγάλοι, μπορούν ακόμη και να γκρεμίσουν τα τείχη μιας πόλης!<br><br><b>Επιτρέπει:</b> Κατασκευή [[v:u,u:306,h:9|καταπελτών]] στους [[v:b,b:6,h:1|Στρατώνες]].',4080:'Αν προσλάβετε έναν δημόσιο υπάλληλο, μπορείτε όχι μόνο να λεηλατήσετε τις πόλεις των εχθρών σας, αλλά και να τις διαχειριστείτε, ώστε να τις χρησιμοποιήσετε για τον εαυτό σας. Σύντομα θα μπορείτε να καταλάβετε άλλες πόλεις με τον στρατό σας και από &apos;κει να αυξήσετε τον πλούτο σας εκτελώντας αποστολές.<br><br><b>Επιτρέπει:</b> [[v:i,h:8,sh:8|Κατάληψη]].',4090:'Οι στρατιώτες σας μπορούν να πολεμήσουν πολύ καλύτερα αν δεν χρειάζεται να κουβαλάνε τόσα πολλά. Ο εξοπλισμός τους θα αντέχει πολύ περισσότερο στις μακρινές πορείες, έτσι δεν θα χρειάζεται να τον επιδιορθώνετε τόσο συχνά.<br><br><b>Επίδραση:</b> 8% λιγότερη συντήρηση για τους [[v:u,u:301,h:9|στρατιώτες]].',4100:'Αυτό το μαύρο μείγμα από την κουζίνα των αλχημιστών μπορεί να προκαλέσει πυρκαγιά με έναν δυνατό κρότο και να δημιουργήσει χάος. Τώρα μπορείτε να γεμίσετε με αυτό σιδερένιους σωλήνες και να εκτοξεύσετε βαριές σφαίρες.<br><br><b>Επιτρέπει:</b> Εκπαίδευση [[v:u,u:304,h:9|Πυροβολητών]] στους [[v:b,b:6,h:1|Στρατώνες]] και κατασκευή [[v:u,s:217,h:10|Πυραυλάκατων]] στο [[v:b,b:5,h:1|Ναυπηγείο]].',4110:'Οι επιστήμονές σας έχουν χτίσει έναν μηχανικό γίγαντα με μυς φτιαγμένους από μέταλλο και καρδιά από ατμό! Μόνο οι πιο δυνατοί και πιο ειδικευμένοι στρατιώτες μπορούν να οδηγήσουν έναν τέτοιο κολοσσό, αλλά θα προκαλέσει φόβο και τρόμο στο πεδίο της μάχης!<br><br><b>Επιτρέπει:</b> Εκπαίδευση [[v:u,u:308,h:9|γιγάντων ατμού]] στους [[v:b,b:6,h:1|Στρατώνες]].',4120:'Το σίδερό σας γίνεται βαρύτερο και σκληρότερο. Τώρα μπορείτε να φτιάξετε και κάννες μέσω των οποίων μπορείτε να εκτοξεύσετε τεράστιες σφαίρες στους εχθρούς σας! Αν μπορείτε να εκτοξεύσετε βόμβες από μεγάλη απόσταση, οι εχθροί σας και τα τείχη της πόλης τους θα τρέμουν από φόβο!<br><br><b>Επιτρέπει:</b> Κατασκευή [[v:u,u:305,h:9|κανονιών]] στους [[v:b,b:6,h:1|Στρατώνες]].',4130:'Το Θείο είναι πραγματικό έργο του διαβόλου! Με κάθε νέο μείγμα μπορείτε να έχετε και καλύτερα αποτελέσματα με αυτό το πολύτιμο αγαθό. Ένας χώρος για ασφαλή πειράματα θα επέτρεπε στους πυροτεχνουργούς σας να δοκιμάζουν τις εφευρέσεις τους, χωρίς να χρησιμοποιούν άθελά τους ως στόχους τα τριγύρω κτίρια!<br><br><b>Επιτρέπει:</b> Κατασκευή [[v:b,b:27,h:1|Εργαστηρίου Πυροτεχνουργού]].',4999:'Οι πολεμικές μηχανές σας είναι ισχυρότερες και δυνατότερες από ποτέ άλλοτε και ο στρατός σας είναι τέλεια οργανωμένος! Οι δημόσιοι υπάλληλοι που διαχειρίζονται τους στρατιωτικούς τα έχουν όλα υπό έλεγχο και έτσι χαμηλώνουν τις δαπάνες συντήρησης.<br><br><b>Επίδραση:</b> 2% λιγότερη συντήρηση για [[v:u,u:301,h:9|μονάδες]].'},
				researchshortdesc: {1010:'Επιτρέπει την κατασκευή βαλλιστροφόρων στο Ναυπηγείο.',1020:'2 % λιγότερο κόστος συντήρησης για τα πλοία.',1030:'Επιτρέπει το χτίσιμο παλατιών, την ίδρυση αποικιών και το εμπόριο με μακρινές χώρες.',1040:'Επιτρέπει την κατασκευή Πρεσβειών.',1050:'4 % λιγότερο κόστος συντήρησης για τα πλοία.',1060:'Επιτρέπει την κατασκευή Φλογοβόλων στο Ναυπηγείο.',1070:'Επιτρέπει την κατασκευή καταπελτοφόρων στο Ναυπηγείο.',1080:'Επιτρέπει τις Στρατιωτικές Συνθήκες.',1090:'8 % λιγότερο κόστος συντήρησης για τα πλοία.',1100:'Επιτρέπει την κατασκευή Κωπήλατων τορπιλακάτων στο Ναυπηγείο.',1110:'Επιτρέπει την κατασκευή Κανονιοφόρων στο Ναυπηγείο.',1120:'Επιτρέπει την κατασκευή Αρχιτεκτονικού Γραφείου.',1130:'Επιτρέπει γρηγορότερα καράβια με μικρότερο φορτίο.',1140:'Επιτρέπει την κατασκευή Βοηθητικών στο Ναυπηγείο.',1150:'Επιτρέπει την κατασκευή Εμβόλων ατμού στο Ναυπηγείο.',1160:'Επιτρέπει την κατασκευή Μεταφορικών αερόστατων στο Ναυπηγείο.',1170:'Επιτρέπει το χτίσιμο πειρατικού φρουρίου, τα ταξίδια κουρσέματος, τις εφόδους, τη συμμετοχή στην κατάταξη πόντων κουρσέματος.',1999:'2 % λιγότερο κόστος συντήρησης για τα πλοία για κάθε επίπεδο μέλλοντος.',2010:'Επιτρέπει την κατασκευή των αποθηκών εμπορευμάτων.',2020:'2 % λιγότερες ποσότητες υλικών για την κατασκευή κτιρίων.',2030:'Επιτρέπει την παραγωγή αγαθών πολυτελείας, την κατασκευή θέσεων εμπορικών συναλλαγών και δίνει 130 από κάθε αγαθό πολυτελείας.',2040:'Επιτρέπει την κατασκευή ταβερνών.',2050:'Επιτρέπει την εκπαίδευση Μαγείρων στους Στρατώνες.',2060:'4 % λιγότερες ποσότητες υλικών για την κατασκευή κτιρίων.',2070:'Επιτρέπει τις Εμπορικές συνθήκες και το Πολίτευμα «Δημοκρατία».',2080:'Αυξάνει την ικανοποίηση και το μέγιστο όριο πολιτών σε όλες τις πόλεις.',2090:'Επιτρέπει την Υπερφόρτωση των πηγών πρώτων υλών.',2100:'8 % λιγότερες ποσότητες υλικών για την κατασκευή κτιρίων.',2110:'Δημιουργεί ένα πρόσθετο οικοδομικό χώρο στις πόλεις.',2120:'Χώρος στέγασης +200, ικανοποίηση στην πρωτεύουσα +200.',2130:'Επιτρέπει την κατασκευή Σπιτιών Ξυλοκόπου, Κτιρίων Λατομείου, Οινοποιείων, Υαλουργείων και Πύργων Αλχημιστή.',2140:'Επιτρέπει την κατασκευή Αποστακτήριων.',2150:'Επιτρέπει την κατασκευή Ξυλουργείων.',2160:'Επιτρέπει την κατασκευή Αλάνας.',2170:'Επιτρέπει το πολίτευμα Νομοκρατία.',2180:'Επιτρέπει την κατασκευή Μαύρης αγοράς.',2999:'+10 Ικανοποίηση και +20 μέγιστο όριο πολιτών σε κάθε πόλη για κάθε επίπεδο μέλλοντος.',3010:'Χώρος στέγασης +50, ικανοποίηση στην πρωτεύουσα +50.',3020:'2 % περισσότεροι πόντοι έρευνας.',3030:'Επιτρέπει την κατασκευή κρησφύγετων.',3040:'Επιτρέπει την κατασκευή Ναών και τη χρήση Θαυμάτων.',3050:'4 % περισσότεροι πόντοι έρευνας.',3060:'Επιτρέπει την κατασκευή μουσείων, τη σύναψη Εμπορικών Συνθηκών και την αγορά Φοινικικών εμπορικών πλοίων.',3070:'Επιτρέπει την εκπαίδευση γιατρών στους Στρατώνες.',3080:'Επιτρέπει την κατασκευή Εργαστηρίου Οπτικού.',3081:'Επιτρέπει την Αγορά πόντων έρευνας έναντι κρύσταλλου και το πολίτευμα Τεχνοκρατία.',3090:'8 % περισσότεροι πόντοι έρευνας.',3100:'Επιτρέπει την κατασκευή Γυροκόπτερων στους Στρατώνες.',3110:'-3 κόστος συντήρησης σε χρυσό ανά επιστήμονα.',3120:'Επιτρέπει την κατασκευή υποβρυχίων στο Ναυπηγείο.',3130:'Επιτρέπει την κατασκευή βομβαρδιστικών στους Στρατώνες.',3140:'Επιτρέπει την κατασκευή εργαστηρίων.',3150:'Επιτρέπει την Επανάσταση και τα πολιτεύματα Δικτατορία και Ολιγαρχία.',3160:'Επιτρέπει το πολίτευμα Θεοκρατία.',3170:'Επιτρέπει την κατασκευή Αρχείου ναυτικών χαρτών.',3999:'2 % περισσότεροι πόντοι έρευνας για κάθε επίπεδο μέλλοντος.',4010:'Επιτρέπει την κατασκευή δεύτερου εμπορικού λιμανιού ή ναυπηγείου.',4020:'2 % λιγότερο κόστος συντήρησης για τους στρατιώτες.',4030:'Επιτρέπει την εκπαίδευση ξιφομάχων και οπλιτών στους Στρατώνες.',4040:'Επιτρέπει την κατασκευή κριών στους Στρατώνες.',4050:'4 % λιγότερο κόστος συντήρησης για τους στρατιώτες και επιτρέπει το πολίτευμα Αριστοκρατία.',4060:'Επιτρέπει την εκπαίδευση Τοξοτών στους Στρατώνες.',4070:'Επιτρέπει την κατασκευή καταπελτών στους Στρατώνες.',4080:'Επιτρέπει την Κατάληψη.',4090:'8 % λιγότερο κόστος συντήρησης για τους στρατιώτες.',4100:'Επιτρέπει την εκπαίδευση Πυροβολητών στους Στρατώνες και την κατασκευή Πυραυλάκατων στο Ναυπηγείο.',4110:'Επιτρέπει την εκπαίδευση Γιγάντων ατμού στους Στρατώνες.',4120:'Επιτρέπει την κατασκευή κανονιών στους Στρατώνες.',4130:'Επιτρέπει την κατασκευή Εργαστηρίου Πυροτεχνουργού.',4999:'2 % λιγότερο κόστος συντήρησης για τους στρατιώτες για κάθε επίπεδο μέλλοντος.'},
				resadvtxt: ['Κανένας διαθέσιμος επιστήμονας','Διαθέσιμη σε {0}','Διαθέσιμη','ανά Ώρα','Βασική παραγωγή','Προνομιούχα Επιβράβευση','Ανεπαρκής ποσότητα πόντων έρευνας','Έχει ήδη ερευνηθεί.','Άμεσα','Απαίτηση(εις)','Κόστη','Διαθέσιμη σε'],
				dipladvtxt: ['Μηνύματα ({0})','Αγορά ({0})','Συνθήκες','Συμμαχία ({0})','Αναζήτηση παίκτη','Αγνοημένοι παίκτες','Συμμαχία','Εισερχόμενα','Εξερχόμενα','Αρχείο εισερχομένων','Αρχείο εξερχομένων','Αρχείο εισερχ.','Αρχείο εξερχ.','Ενέργεια','Αποστολέας','Θέμα','Πόλη','Ημερομηνία','Πατήστε για εμφάνιση/απόκρυψη του μηνύματος','Μετάβαση στην πόλη του αποστολέα','Απάντηση στον αποστολέα','Απάντηση','Διαγραφή','Αναφορά','Αγνόηση','Απάντηση σε όλους','Αυτή η λειτουργία προωθεί προσβολές και επιθέσεις στον Διαχειριστή του παιχνιδιού (GO).\nΘέλετε να προωθήσετε αυτό το μήνυμα στον Διαχειριστή του παιχνιδιού (GO);','Τα μηνύματα που θα αποστέλλονται από τον συγκεκριμένο παίκτη, δεν θα προβάλλονται πλέον.','Σίγουρα;','Ναι','Ακύρωση','Κανένα διαθέσιμο΄μήνυμα.','επόμενα','προηγούμενα','Όλα','Μη αναγνωσμένα','Αναγνωσμένα','Κανένα','Σήμανση ως αναγνωσμένα','Διαγραφή','Επίδραση','Πόντοι διπλωματίας: {0}','Παραλήπτης','Νέα δημοσίευση','Αγορά','Δεν υπάρχουν στην Αγορά μηνύματα επί του παρόντος. Επικοινωνήστε με τους γείτονές σας τώρα δημιουργώντας μια νέα δημοσίευση.','Αποδοχή','Απόρριψη','Εμπορικές συνθήκες','Συνέταιρος','Πόλεις','Κατάσταση','Ενέργεια','Ακύρωση εμπορικής συνθήκης','{0} πόλεις','{0} πόλη','Θέση','Ονομασία','Πόρος<br>πολυτελείας','Πολιτιστικές συνθήκες {0}','Μετάβαση στο μουσείο','Κατανομή πολιτιστικών αγαθών ({0})','Συζήτηση συμμαχίας','Συζ. συμμαχίας ({0})','Πληροφορίες συμμαχίας','Πληρ. συμμαχίας','Λίστα μελών','Αναζήτηση συμμαχίας','Υποσυζήτηση','Θέματα','Τελευταία δημοσίευση','Ενέργειες','Θέματα: {0}','Τίτλος','Απαντήσεις','Δημιουργία θέματος','Απάντηση','Επιστροφή στην κορυφή','Αναφορά','Παράθεση','Τίτλος','Υποβολή','Απομένουν <b>{0}</b> χαρακτήρες','Απομένει <b>{0}</b> χαρακτήρας','Δεν απομένει κανένας χαρακτήρας','Όνομα χρήστη','Αναζήτηση','Θέση','Τίτλος','Όνομα χρήστη','Συμμαχία','Βαθμοί','Ενέργειες','Κανένας παίκτης δεν βρέθηκε για αυτή την αναζήτηση.','Παίκτες που αγνοείτε','Καμιά εισαγωγή','Τίτλος','Όνομα','Συμμαχία','Ενέργεια','Δεν θα αγνοείτε πλέον αυτόν τον παίκτη.','Διαγραφή','Εδώ μπορείτε να γράψετε μια νέα δημοσίευση στην αγορά του νησιού, η οποία θα μπορεί να διαβαστεί από όλους τους κατοίκους του.','Θέμα','Μήνυμα','Δημιουργία νέας δημοσίευσης','Επιστροφή','{0} χαρακτήρες','{0} χαρακτήρας','Κανένας χαρακτήρας'],
				forminetxt: ['Το ξύλο από το κοντινό δάσος πριονίζεται σε κομμάτια στο πριονιστήριο. Έπειτα χρησιμοποιείται ως υλικό για την κατασκευή των κτηρίων και πολλών άλλων. Το πριονιστήριο επεκτείνεται από όλους τους κατοίκους του νησιού. Όσο μεγαλύτερο είναι, τόσο περισσότερους εργαζόμενους μπορείτε να απασχολήσετε εκεί.','Διορισμός εργατών','Χωρητικότητα','ανά ώρα','Εισόδημα πόλης','Υπερφόρτωση!','Κανένας εργάτης','Ελάχιστο','Μέγιστος αριθμός εργατών','Μέγιστο','Επιβεβαίωση','Παραγωγή εργατών','Παραγωγή ανειδίκευτων','Τεχνοκρατία','Προνομιούχα Επιβράβευση','Κινηματοθέατρο','Πύργος του Ήλιου','Διαφθορά','Σύνολο','{0} Πολίτες','Επαυξημένη παραγωγή {0}',['ξύλου','κρασιού','μαρμάρου','κρύσταλλου','θείου'],'{0} Ημέρες','Παρακινημένοι εργάτες','Δώστε κίνητρο στους εργάτες σας στο Κινηματοθέατρο.','+ 20 % για 12 ώρες','Ανενεργή','Προβολή','Παίκτες σε αυτό το νησί','Παίκτης','Πόλη','Επίπεδο','Εργάτες','Δωρηθέν ξύλο','Ενέργειες','Επίπεδο {0}','{0} Εργάτες','{0} Εργάτης','Δωρεά Αμβροσίας','Αυτή η λειτουργία δεν μπορεί να χρησιμοποιηθεί αν έχετε Αμβροσία που προέρχεται μόνο από τον οδηγό. Η δωρεά εμφανίζεται στη λίστα δωρητών ως κανονική δωρεά ξυλείας.','Μέγιστη δωρεά','μέγ.',''],
				academytxt: ['Η ακαδημία είναι ένας θαυμάσιος τόπος γνώσης, που συνδυάζει τις παλιές παραδόσεις με τη σύγχρονη τεχνολογία. Τα σοφότερα κεφάλια της πόλης σας περιμένουν πώς και πώς να μπουν μέσα! Έχετε υπόψη ότι κάθε επιστήμονας χρειάζεται το εργαστήριό του, που κοστίζει χρήματα. Όσο μεγαλύτερη είναι η ακαδημία, τόσο περισσότεροι επιστήμονες μπορούν να απασχολούνται συγχρόνως.','Διορισμός επιστημόνων','Επίτευγμα έρευνας','ανά Ώρα','Έσοδα πόλης','Βασική Παραγωγή','Προνομιούχα Επιβράβευση','Έρευνα','Μορφή Πολιτεύματος','Διαφθορά','Σύνολο','Υπερφόρτωση','Κανένας<br>επιστήμονας','Μέγιστος αριθμός<br>επιστημόνων','Επιβεβαίωση','Διενέργεια πειράματος','Οι επιστήμονες σας πειραματίζονται εδώ και πολύ καιρό και επιτέλους ανακάλυψαν έναν τρόπο να δημιουργήσουν {0} πόντους έρευνας. Χρειαζόσαστε {1} κρύσταλλο για να διεξάγετε το κάθε πείραμα. Αλλά προσέξτε! η χημική αντίδραση που συμβαίνει κατά την διάρκεια αυτών των πειραμάτων είναι δυνατή και εντυπωσιακή. Γι&apos; αυτό και οι επιστήμονες χρειάζονται <b>4 ώρες</b> για να καθαρίσουν το εργαστήριο τους έτσι ώστε να μπορέσουν να συνεχίσουν να πειραματίζονται με τον κρύσταλλο.','Η διαθέσιμη χωρητικότητα δεν επαρκεί','Επίτευγμα πειράματος','Κόστος','Εκτέλεση πειράματος','Οι επιστήμονες είναι ακόμα στη διαδικασία καθαρισμού του εργαστηρίου μετά την εκτέλεση του πειράματος. Ολοκλήρωση του καθαρισμού:','Για να εκτελέσετε το πείραμα<br>απαιτούνται ακόμα {0}.','Με την τρέχουσα ποσότητα κρυστάλλου που έχετε,<br>μπορείτε να πραγματοποιήσετε έως και {0}.','κρύσταλλο','κρύσταλλα','πείραμα','πειράματα','Κάθε πείραμα, με την τρέχουσα παραγωγή,<br>μειώνει το χρόνο ολοκλήρωσης των ερευνών κατά<br><b>{0}<b>','Το πείραμα είναι σε εξέλιξη','Η ποσότητα μπορεί να παραχθεί ως εξής:{0}','Έχετε μηδενική παραγωγή στις {0} κρυστάλλου που έχετε!','Δεν έχετε πόλεις κρυστάλλου!','{0}<br>κρυστάλλου','Ωριαία<br>παραγωγή','Διάρκεια<br>παραγωγής'],
				barrackstxt: ['Η ατίθαση νεολαία εκπαιδεύεται στους στρατώνες για να αποτελέσει ένα δυνατό στρατιωτικό δυναμικό. Οι στρατιώτες σας ξέρουν πώς να χειριστούν τα ξίφη, τις λόγχες και τους καταπέλτες και είναι επίσης ικανοί να οδηγήσουν τις δυνατότερες πολεμικές μηχανές με ασφάλεια στο πεδίο της μάχης. Τα στρατεύματα εκπαιδεύονται γρηγορότερα όταν επεκτείνετε τους στρατώνες σας.','Μειονέκτημα κατοχής','Αυτή η πόλη είναι υπό κατοχή από ξένα στρατεύματα.<br>Νέες μονάδες μπορούν να εκπαιδευτούν αλλά με διπλάσιο κόστος!','Μονάδες προγραμματισμένες για εκπαίδευση','Δεν έχουν επιλεγεί μονάδες','Δεν απαιτείται κανένας πολίτης','πολίτες','πολίτης','Δεν απαιτείται καμία μονάδα','μονάδες','μονάδα','Δεν απαιτείται κόστος συντήρησης','Δεν υπάρχει διάρκεια εκπαίδευσης',{wood:'ξύλου',wine:'κρασιού',marble:'μαρμάρου',crystal:'κρύσταλλου',sulfur:'θείου',upkeep:'Κόστος συντήρησης',time:'Απαιτούμενη διάρκεια εκπαίδευσης'},'Ολοκλήρωση:','Πακέτο πληθυσμού','Πακέτα ομοιωμάτων','Τα πακέτα ομοιωμάτων σας επιτρέπουν να εξαπατάτε τους κατασκόπους των άλλων παικτών σχετικά με τον πραγματικό αριθμό των μονάδων που έχετε στο στρατό σας.','Επιλογή πακέτου','Εκπαίδευση μονάδων','Στην περιγραφή της μονάδας «{0}»','Επαναφορά (μηδενισμός) αριθμού μονάδων','Επιλογή όλων των διαθέσιμων πολιτών','Μέγιστο','Κόστος συντήρησης ανά ώρα. Μπορεί να μειωθεί με την αλλαγή πολιτεύματος και την έρευνα.','Κόστος συντήρησης ανά ώρα','Διάρκεια εκπαίδευσης ανά μονάδα','Τι θα ήταν μια αυτοκρατορία νησιών χωρίς τον στόλο της; Στο ναυπηγείο κατασκευάζονται δυνατά σκάφη μάχης και ρίχνονται στο νερό για μακρινά ταξίδια. Ας τα τρέμουν οι επτά θάλασσες! Μεγαλύτερα ναυπηγεία μπορούν να ναυπηγήσουν τα σκάφη γρηγορότερα.','Αυτή η πόλη είναι υπό κατοχή από ξένα στρατεύματα.<br>Νέα πλοία μπορούν να κατασκευαστούν αλλά με διπλάσιο κόστος!','Πλοία προγραμματισμένα για κατασκευή','Δεν έχουν επιλεγεί πλοία','Δεν υπάρχει διάρκεια κατασκευής','Απαιτούμενη διάρκεια κατασκευής','Κατασκευή πλοίων','Στην περιγραφή του πλοίου «{0}»','Επαναφορά (μηδενισμός) αριθμού πλοίων','Διάρκεια κατασκευής ανά πλοίο','Εκπαίδευση','Κατασκευή','Το κτήριο αναβαθμίζεται!','Απαιτείται επίπεδο κτηρίου <b>{0}</b>','Οι ποσότητες δεν επαρκούν'],
				unitdescs: {slinger:'Οι σφεντόνες είναι ελαφρύ και φτηνό όπλο. Στο πεδίο της μάχης μετά βίας θα προκαλέσουν βλάβη σε αντιπάλους με θωράκιση, αλλά τουλάχιστον εκπαιδεύονται γρήγορα και η συντήρησή τους είναι πολύ φτηνή.',swordsman:'Οι ξιφομάχοι είναι ελαφρά θωρακισμένοι και πολεμούν χωρίς τις ασπίδες τους ώστε να διατηρούν την κινητικότητα τους. Έτσι μπορούν να κυκλοφορούν γύρω από το ακίνητο σχηματισμό Φάλαγγας και να επιτίθενται από τα πλευρά.',phalanx:'Οι Οπλίτες είναι βαριά οπλισμένοι λογχοφόροι από τις μεσαίες τάξεις των πολιτών σας. Είναι η καρδιά κάθε Ελληνικού στρατού. Κατά τον σχηματισμό «Φάλαγγας» προχωρούν ως συμπαγής τοίχος από ασπίδες και δόρατα.',marksman:'Βολές από όπλο θείου μπορούν να διεισδύσουν και την πιο ανθεκτική πανοπλία. Παρόλα αυτά, λόγο γραμμής ορατότητας, μόνο μια σειρά μπορεί να πυροβολήσει, ενώ οι υπόλοιποι θα πρέπει να γεμίζουν ξανά τα όπλα τους.',mortar:'Το κανόνι εκτοξεύει εκρηκτικούς κάλυκες στα τείχη μιας πολιορκημένης πόλης. Κανένα κτίριο δεν μπορεί να αντισταθεί στην καταστροφική του δύναμη. Τα σπάνια πυρομαχικά του όμως πρέπει μεταφέρονται μαζί του, γι&apos; αυτό οι βολές πρέπει να είναι καλά στοχευμένες.',catapult:'Οι καταπέλτες εκτοξεύουν τεράστιους βράχους ενάντια σε αντίπαλες αμυντικές εγκαταστάσεις και έτσι μπορούν να καταστρέψουν και το πιο δυνατό πέτρινο τείχος. Παρόλα αυτά είναι λιγότερο χρήσιμοι για άμυνα ενάντια σε εχθρικές μονάδες.',ram:'Δυνατοί άντρες ταλαντώνουν τον τεράστιο κορμό δέντρου ενάντια στις εχθρικές πύλες, μέχρι να υποχωρήσουν και οι άντρες να κρυφτούν κάτω από τις σκεπές για κάλυψη. Μπορεί να είναι χρήσιμο μόνο ενάντια σε πύλες και τείχους, αλλά τουλάχιστον δεν χρειάζεται πυρομαχικά.',steamgiant:'Αυτός ο τεράστιος μηχανισμός κινείται στο πεδίο μάχης σαν άνθρωπος, αλλά χτυπά με υπεράνθρωπη δύναμη. Πέτρες, βέλη και σπαθιά αναπηδούν στην επιφάνειά του. Αλίμονο σε όποιον τον αντιμετωπίσει!',bombardier:'Οι εφευρέτες μας ανακάλυψαν ότι ο ήλιος είναι τόσο καυτός, επειδή ελκύει καυτό αέρα. Γι&apos; αυτό κι ένα μπαλόνι γεμάτο με ζεστό αέρα ανυψώνεται προς την κατεύθυνση του ήλιου και οι στρατιώτες μας μπορούν να ρίχνουν εκρηκτικούς κάλυκες στους αντιπάλους από ψηλά.',cook:'Οι μάγειρες του στρατού γνωρίζουν ακριβώς πώς να δώσουν θάρρος στους πολεμιστές και ήρωες του στρατοπέδου: Ένα ποτήρι κρασί και λίγο στιφάδο, όπως συνήθιζε να τους δίνει η μητέρα τους! Αν θυμηθούν τον λόγο για τον οποίο αγωνίζονται, οι εχθροί θα δυσκολευτούν πολύ να τους φθείρουν.',medic:'Αυτοί οι γιατροί ζήτησαν εθελοντικά να βοηθήσουν στην προστασία των τραυματισμένων που προέρχονται από το μέτωπο της μάχης. Μπορούν να αφαιρέσουν κεφαλές από βέλη, να φροντίσουν πληγές από σπαθί και έχουν αρκετό πάγο για τα κεφάλια των στρατιωτών που χτυπήθηκαν από σφεντόνες.',gyrocopter:'Μια ιπτάμενη μηχανή που είναι γρήγορη, ευέλικτη και δεν εξαρτάται από την κατεύθυνση του ανέμου - μπορείτε με αυτήν να κυνηγήσετε δειλούς εχθρούς που θέλουν να σας επιτεθούν από τον ουρανό!',archer:'Τα τόξα είναι πολύ δημοφιλή όπλα κυνηγιού, έτσι είναι εύκολο να επιλέξουμε τοξότες ανάμεσα στους κατοίκους. Η στρατιωτική εκπαίδευση μετατρέπει τους απλούς κατοίκους σε μάχιμες μονάδες μεγάλης εμβέλειας.',spearman:'Οι λογχοφόροι είναι κληρωτοί από τον αγροτικό πληθυσμό, οι οποίοι πάνε στην μάχη με ελαφριά πανοπλία και απλά δόρατα. Συνήθως δεν έχουν ελπίδα ενάντια σε επαγγελματίες στρατιώτες.',spartan:'Γεννήθηκε για τη μάχη. Η τέχνη του είναι η τέχνη του πολέμου. Μάχεται στην πρώτη γραμμή.',ship_ram:'Εξοπλισμένο με έναν απλό κριό στην πλώρη, το συγκεκριμένο πλοίο είναι το πιο βασικό πλοίο του πολεμικού ναυτικού. Μια ντουζίνα ισχυροί κωπηλάτες του δίνουν δύναμη προκειμένου να εμβολίσει το αντίπαλο κύτος. Πολλές φορές, αυτό και μόνο είναι αρκετό για να κάνει ένα πλοίο του εχθρού να βυθιστεί.',ship_flamethrower:'Πάνω στο φλογοβόλο υπάρχει ένας εκτοξευτής φωτιάς, ο οποίος ψεκάζει φωτιά πάνω από την θάλασσα. Ακόμα και στην επιφάνεια του ωκεανού, το μείγμα συνεχίζει να καίει και σχηματίζει ένα στρώμα φωτιάς. Ένα τρομακτικό πλοίο για μάχη σε κοντινή απόσταση.',ship_submarine:'Ένα πλοίο που κινείται κάτω από την επιφάνεια της θάλασσας είναι το απόλυτο όπλο στα πελάγη. Μπορεί να εισχωρήσει στις γραμμές του εχθρού σχεδόν απαρατήρητο και να προκαλέσει τεράστιες ζημιές.',ship_ballista:'Αυτό το πλοίο περιέχει μια βαλλίστρα, η οποία προοριζόταν αρχικά για την εκτόξευση γάντζων. Παρόλα αυτά η βαλλίστρα είναι ένα ακριβές πολεμικό όπλο μεγάλης εμβέλειας, καθώς χτυπά τους αντιπάλους κάτω από την ίσαλο γραμμή, αν και δεν προκαλεί μεγάλη ζημιά.',ship_catapult:'Ο καταπέλτης στο κατάστρωμα του πλοίου είναι μικρότερος από τον αντίστοιχο στην ξηρά, λόγω έλλειψης χώρου. Τα κύματα του ωκεανού τον κάνουν πολύ ανακριβή, αλλά εκτοξεύει πήλινες κανάτες με φλεγόμενο πετρέλαιο, οι οποίες αφήνουν επικίνδυνες πετρελαιοκηλίδες στην θάλασσα.',ship_mortar:'Το κανονιοφόρο έχει ένα ιδιαίτερα μεγάλο κύτος με υψηλό εκτόπισμα, ώστε να μπορεί να αντέξει την τεράστια ανάκρουση του κανονιού. Αν το φιτίλι του πυραύλου μετρηθεί σωστά, το ισχυρό βλήμα εκρήγνυται λίγο πάνω από το κατάστρωμα του εχθρού.',ship_steamboat:'Όπως το σκάφος-έμβολο, έτσι και το έμβολο ατμού διαθέτει έναν κριό στην πλώρη. Σε αυτήν την περίπτωση πρόκειται όμως για μια πολύ πιο εξελιγμένη έκδοση. Λόγω της ατμοκίνησης, το πλοίο αυτό μπορεί να επιταχύνει γρηγορότερα και να προκαλέσει ακόμη μεγαλύτερη ζημιά στον εχθρό. Το έμβολο ατμού είναι το πιο επικίνδυνο πλοίο στην μπροστινή γραμμή μάχης.',ship_rocketship:'Χάρη στις έρευνές σας, οι επιστήμονές σας κατάφεραν να βάλουν μια μεγάλη ποσότητα εκρηκτικής σκόνης σε μια ξύλινη κατασκευή, που μπορεί να εκσφενδονιστεί εκατοντάδες μέτρα πάνω από την επιφάνεια της θάλασσας και με τη σωστή ανάφλεξη να προκαλέσει μια τεράστια έκρηξη μόλις πετύχει κάποιο εχθρικό σκάφος. Ο εχθρός πρέπει να φοβάται αυτό το όπλο!',ship_paddlespeedship:'Μια εφεύρεση που θα ζήλευε ακόμη και ο Ήρωνας: Η κωπήλατη τορπιλάκατος χρησιμοποιεί τον τροχό με τα κουπιά και μια τεράστια αιολόσφαιρα για να πέσει επάνω σε εχθρικά πλοία με τεράστια ισχύ και ταχύτητα. Απαιτεί ελάχιστο πλήρωμα για τη λειτουργία του.',ship_ballooncarrier:'Το μεταφορικό αερόστατων είναι ένα τεράστιο πλωτό φρούριο. Με τη βοήθεια των αερόστατων που μεταφέρει, μπορείτε να κάνετε εναέριες επιθέσεις στον εχθρό και από τη θάλασσα.',ship_tender:'Το Βοηθητικό προορίζεται για την υποστήριξη πλοίων. Εκπαιδευμένοι μηχανικοί και δύτες επιδιορθώνουν μικρές ζημιές μέσα στο λιμάνι, ώστε αυτές οι μονάδες να μπορούν να πάρουν μέρος στη μάχη αμέσως. Επίσης, προμηθεύουν τροφή και κρασί στους ναύτες.'},
				blackmarkettxt: ['Η Μαύρη Αγορά σας επιτρέπει να πουλάτε στρατιωτικές μονάδες αντί χρυσού ή άλλου αγαθού. Αναβαθμίστε το κτήριο για να επιτρέπεται η πώληση περισσότερων τύπων μονάδων και για να μειωθεί το ποσοστό φόρου για αυτή την εμπορική συναλλαγή. Οι άλλοι παίκτες θα βλέπουν τις προσφορές σας στο Εμπορικό τους Ανταλλακτήριο.','Προσφορά μονάδων','Οι προσφορές σας','Προσφορά μονάδων: {0} / {1}','Ποσοστό φόρου: {0} %','Το τρέχον ποσοστό φόρου είναι <b>{0} %</b>. Οι φόροι αφαιρούνται σε κάθε σας πώληση.','Όσο εξελίσσεται μάχη στην πόλη, καμιά ανταλλαγή στρατιωτών δεν είναι δυνατή.','Ως μέλος συμμαχίας, μπορείτε να έχετε <b>4</b> επιπλέον προσφορές για πώληση.','Τύπος μονάδας','Ποσότητα','Νόμισμα','Όρια','Τιμή ανά μονάδα','μέγιστο','Προσθήκη','Οι προσφορές μου: {0} / {1}','Επί του παρόντος, δεν έχετε προσφορές πώλησης στη Μαύρη Αγορά.','Μονάδες','Ποσότητα','Τιμή / μονάδα','Φόρος','Κέρδος / μονάδα','Ενέργεια','Ακύρωση προσφοράς'],
				warehousetxt: ['Η αλάνα σας επιτρέπει να αποθηκεύετε μεγάλες ποσότητες αγαθών. Κάθε επίπεδο της αλάνας προσφέρει χώρο για 32.000 τεμάχια ανά αγαθό. Η αλάνα δεν προστατεύεται από λαφυραγωγούς.','Ένα μέρος των προμηθειών σας φυλάσσεται στην αποθήκη εμπορευμάτων, όπου προστατεύεται από λεηλασίες, πουλιά, παράσιτα και βροχή. Ο αποθηκάριος είναι πάντα καλά ενημερωμένος για τους πόρους σας. Η επέκταση της αποθήκης εμπορευμάτων σας επιτρέπει να προστατεύετε περισσότερες προμήθειες.','Επισκόπηση αποθηκευμένων αγαθών','100% αυξημένη ασφάλεια κλοπής','Ανενεργή','Ενεργή','100% αυξημένη ασφαλισμένη χωρητικότητα','Ασφαλή από κλοπή','Πόρος','Ασφαλής<br>ποσότητα','Χωρητικότητα'],
				embassytxt: ['Στην πρεσβεία συμβαίνουν πολλά: Οι διπλωμάτες από όλο τον κόσμο διαπραγματεύονται συμβάσεις, προωθούν συνθήκες και ιδρύουν συμμαχίες. Για να αποκτήσετε μια μεγάλη συμμαχία, πρέπει να αναβαθμίσετε την πρεσβεία σας Κάθε επίπεδο της πρεσβείας σας αυξάνει τους πόντους διπλωματίας σας.','Πόντοι διπλωματίας','Συμμαχία','Λίστα μελών','Εσωτερική σελίδα συμμαχίας','Αναζήτηση συμμαχίας','Ημερομηνία ίδρυσης (Ηλικία)','Μέλη','Περιληπτική περιγραφή','Θέση (Βαθμοί)','Ιστοσελίδα συμμαχίας','Διαθέσιμοι πόντοι διπλωματίας συμμαχίας','Ο βαθμός σας','Ίδρυση Συμμαχίας','Στην πρεσβεία μπορείτε να διαχειριστείτε και να ηγηθείτε της συμμαχίας σας ή να επαναδιανείμετε τους βαθμούς.','Ετικέτα (έως <b>5</b> χαρακτήρες)','Ονομασία συμμαχίας (έως <b>15</b> χαρακτήρες)','Γίνετε μέλος μιας υπάρχουσας συμμαχίας','Μπορεί να σας προταθεί μια συμμαχία που ταιριάζει με τη θέση σας στη βαθμολογία.','Πρόταση συμμαχίας','Ονομασία','Ετικέτα','Συντομογραφία','Ονομασία','Μέλη','Βαθμοί','Ενέργειες','Προβολή σελίδας συμμαχίας','Συμμετοχή στη συμμαχία','Τελευταία σύνδεση','Όνομα','Πόλεις','Βαθμός','Πόντοι','Ενέργειες','Ενέργειες','Αποστολή μηνύματος συμμαχίας','Συνθήκες συμμαχίας','Παραίτηση','Δεν είστε μέλος κάποιας συμμαχίας','Πληροφορίες συμμαχίας'],
				palaceColonytxt: ['Ένας κυβερνήτης, στην αποικία σας, εγγυάται ότι όλα τα καθημερινά διοικητικά θέματα εκτελούνται σωστά. Έτσι μειώνει τη διαφθορά στην αποικία σας. Το Κυβερνείο μπορεί επίσης να αναβαθμιστεί σε Παλάτι, αν θελήσετε ποτέ να μεταφέρετε την πρωτεύουσά σας.','Οι πόλεις της αυτοκρατορίας σας','Μετεγκατάσταση πρωτεύουσας','Μπορείτε να κάνετε αυτήν την αποικία πρωτεύουσα. Έτσι, το Κυβερνείο θα μετατραπεί σε παλάτι ίδιου επιπέδου και η πόλη θα γίνει η πρωτεύουσα της αυτοκρατορίας σας. Το παλάτι στην παλιά σας πρωτεύουσα θα καταστραφεί εντελώς, γι&apos;αυτό θα πρέπει να αποκαταστήσετε την τάξη χτίζοντας εκεί ένα καινούριο Κυβερνείο!','<p><b>Δεν</b> μπορείτε ακόμη να κάνετε αυτήν την αποικία πρωτεύουσά σας. Το επίπεδο του Κυβερνείου πρέπει να αντιστοιχεί στον <b>αριθμό των αποικιών σας</b>, ώστε να μπορείτε να διαχειριστείτε όλες τις αποικίες.</p><p class="red">Πρέπει να επεκτείνετε το Κυβερνείο ακόμη <b>{0}</b> προκειμένου να μεταφέρετε την πρωτεύουσά σας εδώ.</p>','Ανακήρυξη της πόλης ως πρωτεύουσα','Το κτήριο αναβαθμίζεται!'],
				palacetxt: ['Το παλάτι είναι ένα εξαιρετικό μέρος για να οδηγήσετε την αυτοκρατορία σας στο μέλλον! Παρέχει επίσης μια πανέμορφη θέα στη θάλασσα. Κάθε επέκταση του παλατιού στην πρωτεύουσά σας σας επιτρέπει να ιδρύσετε μια επιπλέον αποικία.','Τρέχον πολίτευμα: {0}','Οι πόλεις της αυτοκρατορίας σας',{anarchie:'Η αναρχία είναι μια κατάσταση στην οποία δεν υπάρχει συγκεκριμένος κυβερνήτης. Αυτό το πολίτευμα τίθεται σε ισχύ μόνο κατά τη διάρκεια της επανάστασης.',ikakratie:'Η Ικακρατία είναι το πολίτευμα της κυριαρχίας του καλόβουλου αφέντη του νησιού. Με αυτό το πολίτευμα ξεκινάτε το παιχνίδι.',aristokratie:'Η Αριστοκρατία είναι το πολίτευμα της κυριαρχίας των ευγενών, μιας ομάδας ελίτ.',demokratie:'Η Δημοκρατία είναι το πολίτευμα της κυριαρχίας του λαού.',diktatur:'Η Δικτατορία είναι το πολίτευμα της κυριαρχίας του ενός, αυτού που διατάζει.',nomokratie:'Η Νομοκρατία είναι το πολίτευμα της κυριαρχίας των νόμων, που οι εξουσιαστές δεν μπορούν να αλλάξουν εύκολα.',oligarchie:'Η Ολιγαρχία είναι το πολίτευμα της κυριαρχίας μιας μειοψηφίας. Στο Ikariam αυτή η μειοψηφία είναι οι πλούσιες οικογένειες εμπόρων.',technokratie:'Η Τεχνοκρατία είναι το πολίτευμα της κυριαρχίας των ειδικών. Στο Ikariam αυτοί οι ειδικοί είναι επιστήμονες και ερευνητές.',theokratie:'Η Θεοκρατία είναι το πολίτευμα της κυριαρχίας των ιερέων.'},'Αλλαγή πολιτεύματος',{anarchie:['','25 % πρόσθετη διαφθορά σε όλες τις πόλεις.|Όλες οι μονάδες ξηράς και τα πολεμικά πλοία επιστρέφουν στη βάση τους, αν ήταν σταθμευμένα σε ξένες πόλεις ή καθ&apos;οδόν. Αν βρίσκονταν σε μάχη, σκορπίζουν αυτόματα (Εξαίρεση: Μάχες σε δικές σας πόλεις ή λιμάνια).|Δεν είναι δυνατή η μεταφορά μονάδων.|Δεν είναι δυνατή η εκπαίδευση μονάδων.|Δεν είναι δυνατές οι κατασκοπευτικές αποστολές.'],ikakratie:['Κανένα','Κανένα'],aristokratie:['-20% χρόνος οικοδόμησης κτηρίων.|+20% άμυνα στην κατασκοπεία.','+3% διαφθορά σε όλες τις πόλεις εκτός από την πρωτεύουσα.'],demokratie:['+75 ικανοποίηση σε όλες τις πόλεις|+1 πόντος έρευνας ανά ώρα για κάθε πολιτιστική συνθήκη','20% άμυνα σε κατασκοπεία|+5% χρόνος εκπαίδευσης μονάδων ξηράς'],diktatur:['-2% κόστος συντήρησης μονάδων ξηράς.|-2% κόστος συντήρησης για μονάδες θάλασσας.|-2% χρόνος εκπαίδευσης μονάδων ξηράς.|-2% χρόνος κατασκευής μονάδων θάλασσας.|+2 επιπλέον εμπορικά πλοία.','-75 ικανοποίηση σε όλες τις πόλεις.'],nomokratie:['-5% διαφθορά σε όλες τις πόλεις.|+20% άμυνα στην κατασκοπεία.','+5% χρόνος εκπαίδευσης μονάδων ξηράς.|+5% χρόνος κατασκευής μονάδων θάλασσας.|+50% χρόνοι φόρτωσης σε δικά σας λιμάνια.'],oligarchie:['+5 βεληνεκές θέσεων εμπορικών συναλλαγών.|+10% ταχύτητα εμπορικών πλοίων.|-2% κόστος συντήρησης για μονάδες θάλασσας.|+2 επιπλέον εμπορικά πλοία.','+20% χρόνος οικοδόμησης κτιρίων.|+3% διαφθορά σε όλες τις πόλεις.'],technokratie:['+5% πόντοι έρευνας.|+20% παραγωγικότητα βοηθών εργατών.','+1 κόστος χρυσού ανά ερευνητή.'],theokratie:['-20% χρόνος ηρεμίας θαυμάτων.|Η ικανοποίηση στις πόλεις με ναό αυξάνεται κατά +2 φορές σε σχέση με την τιμή μετατροπής.<br>Η μέγιστη επιβράβευση είναι +150.|+1 παραγωγή χρυσού ανά ιερέα.','-5% πόντοι έρευνας.|-20 ικανοποίηση σε όλες τις πόλεις χωρίς ναούς.']},'Πλεονεκτήματα','Μειονεκτήματα','Κατεχόμενες πόλεις','Κατεχόμενα λιμάνια','Δεν έχετε υπό κατοχή καμία πόλη','Δεν έχετε υπό κατοχή κανένα λιμάνι','Αν θέλετε να αλλάξετε το πολίτευμά σας, αυτό θα σας κοστίσει <b>{0}</b> μονάδες χρυσού για κάθε πόλη που έχετε ιδρύσει (δηλαδή συνολικά: <b>{1}</b> μονάδες χρυσού). Μέχρι να καθιερωθεί το νέο πολίτευμα, θα υπάρχει Αναρχία. Αυτή διαρκεί ένα συγκεκριμένο διάστημα  που αντιστοιχεί σε <b>{2}</b> για κάθε πόλη που έχετε ιδρύσει (δηλαδή συνολικά: <b>{3}</b>).','Πολιτεύματα που έχουν ερευνηθεί','Δεν έχετε αρκετή ποσότητα χρυσού','Αλλαγή πολιτεύματος σε',''],
				safehousetxt: ['Ένας σοφός ηγέτης έχει το νου του στους συμμάχους του και στους εχθρούς του. Το κρησφύγετο σας επιτρέπει να μισθώσετε κατασκόπους, που είναι σε θέση να σας παρέχουν πληροφορίες για άλλες πόλεις. Ένα μεγαλύτερο κρησφύγετο παρέχει χώρο για περισσότερους κατασκόπους.','Αναφορές κατασκοπείας','Αρχειοθέτηση','Εκπαίδευση κατασκόπου','Αυτός ο πολίτης είναι πιστός και διακριτικός. Ένας ιδανικός υποψήφιος για κατάσκοπος. Ώρα εκπαίδευσης για έναν κατάσκοπο:','{0} εργάζονται ήδη στην άμυνα','Ο αριθμός των κατασκόπων έχει φτάσει στο μέγιστο!','Ανεπαρκής ποσότητα αγαθών','Εκπαίδευση','Επαναφορά<br>αριθμού<br>κατασκόπων','Εκπαίδευση<br>μέγιστου αριθμού<br>κατασκόπων','Πληροφορίες','Μπορούν να εκπαιδευτούν έως {0} κατάσκοποι','Μπορεί να εκπαιδευτεί έως {0} κατάσκοπος','<b>{0}</b> σε αναμονή για να εκπαιδευτούν','<b>{0}</b> σε αναμονή για να εκπαιδευτεί','Κανένας πολίτης σε αναμονή για να εκπαιδευτεί','<b>{0}</b> κατάσκοποι εργάζονται ήδη στην άμυνα','<b>{0}</b> κατάσκοπος εργάζεται ήδη στην άμυνα','Κανένας κατάσκοπος δεν εργάζεται στην άμυνα','<b>{0}</b> κατάσκοποι είναι σε αποστολή','<b>{0}</b> κατάσκοπος είναι σε αποστολή','Κανένας κατάσκοπος σε αποστολή','Κατάσκοποι σε αποστολή','Κανένας από τους κατασκόπους σας δεν βρίσκεται σε αποστολή!','Ιδιοκτήτης','Προορισμός','Αποστολή','Αποτελέσματα','Πράκτορες','Αντιπερισπασμοί','Ημερομηνία','Δεν υπάρχουν αναφορές κατασκοπείας!','','',''],
				taverntxt: ['Μετά από μια εργάσιμη μέρα δεν υπάρχει τίποτα καλύτερο από μία δροσερή κανάτα κρασιού. Γι&apos; αυτό στους πολίτες σας αρέσει να συναντιούνται στην ταβέρνα. Και όταν τραγουδήσουν τα τελευταία παλιά τραγούδια στο τέλος της βραδιάς, ξεκινούν χαρούμενοι για το σπίτι. Κάθε επέκταση της ταβέρνας σας δίνει τη δυνατότητα να σερβίρετε περισσότερο κρασί.','Σερβίρισμα ποτών','Σερβίρισμα κρασιού','Μπορείτε να καθορίσετε ακριβώς πόσο κρασί σερβίρεται στον πληθυσμό σας. Όσο περισσότερο κρασί παρέχετε, τόσο πιο χαρούμενοι είναι οι πολίτες σας. Προσοχή: Ο ξενοδόχος σας απαιτεί ένα ωριαίο μερίδιο κάθε φορά που αλλάζετε την ποσότητα που διανέμεται.','Μηδενισμός<br>διανομής','Μέγιστη δυνατή<br>διανομή','ικανοποιημένοι πολίτες','ικανοποιημένος πολίτης','Καθόλου κρασί','{0} μονάδες κρασιού / ώρα','{0} μονάδα κρασιού / ώρα','Το Αποστακτήριο εξοικονομεί για σας','μονάδες κρασιού ανά ώρα','μονάδα κρασιού ανά ώρα','Εις υγείαν!'],
				townhalltxt: ['Μετονομασία πόλης','Τρέχον όνομα πόλης','Νέο όνομα πόλης','Εφαρμογή αλλαγής ονόματος πόλης','Μετονομασία','Θέσεις κατοικίας','Όριο μονάδων ξηράς','Όριο μονάδων θάλασσας','Πόντοι δράσης','Ανάπτυξη','ανά ώρα','Καθαρή πρόσοδος','{0} Πολίτες','Πληθυσμός και παραγωγή','Σημειώσεις','Δεν υπάρχει κανένα ιδιαίτερο γεγονός! Συγχαρητήρια, όλα στην πόλη σας βαίνουν καλώς!','Υπάρχει διαφθορά σε αυτήν την πόλη!','Η παραγωγικότητα και η ικανοποίηση σε αυτήν την πόλη μειώνονται έντονα! Επεκτείνετε {0} για να μειωθεί η διαφθορά.','το Κυβερνείο','το Παλάτι','Η ικανοποίηση στην πόλη σας δημιουργείται από διαφορετικά στοιχεία. Αυτό το διάγραμμα μπορεί να σας βοηθήσει, για να προσδιορίσει τα προβλήματα και τις δυνατότητες.','Θετικές επιδράσεις','Βασικές επιδράσεις','Βασική επίδραση','Επίδραση λόγω πολιτεύματος','Επίδραση λόγω έρευνας','Επίδραση λόγω πρωτεύουσας','Επιδράσεις από συμβάν','Επίδραση από συμβάν','Πρόσθετη επίδραση','Ακόμα ενεργό για','Επίδραση από μεταφορά λογαριασμού','Κρασί','Επίδραση λόγω επιπέδου ταβέρνας','Επίδραση από την ποσότητα κρασιού που σερβίρεται','Δεν υπάρχει ακόμα ταβέρνα στην πόλη σας','Πολιτισμός','Επίδραση λόγω επιπέδου μουσείου','Επίδραση από ενεργές πολιτιστικές συνθήκες','Δεν υπάρχει ακόμα μουσείο στην πόλη σας','Αρνητικές επιδράσεις','Πληθυσμός','Επανάσταση','Πολίτευμα','Συνολική ικανοποίηση','Εγκατάλειψη αποικίας','Μπορείτε να εγκαταλείψετε την αποικία σας. Ωστόσο, όλοι οι αποθηκευμένοι πόροι, οι πολίτες, ο στρατός και ο στόλος θα χαθούν.'],
				walltxt: ['Τα τείχη προστατεύουν τους κατοίκους σας από τους εχθρούς σας, αλλά και τον ήλιο. Προσοχή! Οι εχθροί θα προσπαθήσουν να ανοίξουν τρύπες στα τείχη σας ή να σκαρφαλώσουν επάνω τους. Κάθε επίπεδο των τειχών της πόλης σας αυξάνει την αντοχή του τείχους.','Πληροφορίες','Βαλλίστρες|Καταπέλτες|Βόμβες','Ζημιά','Ακρίβεια','Πόντοι κρούσης','Θωράκιση','Όριο φρουράς'],
				workshoptxt: ['Τα πιο ειδικευμένα άτομα της πόλης σας δουλεύουν στο εργαστήριο. Βελτιώνουν τον εξοπλισμό των στρατευμάτων και των θωρηκτών σας με τις πιο πρόσφατες εφευρέσεις, έτσι ώστε να γίνουν ακόμα καλύτερα και ισχυρότερα! Κάθε στάδιο βελτίωσης σας επιτρέπει περισσότερες αναβαθμίσεις για τα στρατεύματα και τα πλοία.','Μονάδες ξηράς','Πολεμικά πλοία','Βελτίωση επιθετικής δύναμης','Βελτίωση αμυντικής αντοχής','Κόστος: {0} μονάδες χρυσού','Κόστος: {0} μονάδες κρύσταλλου','Διαρκεια: {0}','Ζημία: {0}','Θωράκιση: {0}','Βελτίωση!','Λήψη αγαθών!','Οι αναβαθμίσεις ολοκληρώθηκαν!','Το κτήριο επεκτείνεται!','Ανεπαρκές επίπεδο κτιρίου!','Ανεπαρκής ποσότητα χρυσού!','Ανεπαρκής ποσότητα κρύσταλλου!','Ανεπαρκείς ποσότητες χρυσού και κρύσταλλου!','','',''],
				SCAtxt: ['Στο αρχείο ναυτικών χαρτών αρχειοθετούνται πολύτιμοι χάρτες των θαλασσών. Με αυτούς οι ναύτες μπορούν να ταξιδεύουν γρηγορότερα στις θάλασσες. Όσο μεγαλύτερο το επίπεδο του κτιρίου, τόσο μεγαλύτερη είναι η εξοικονόμηση χρόνου για το ταξίδι τόσο για την μετάβαση όσο και στην επιστροφή.','5 Νησιά','20 Νησιά','50 Νησιά','Απόσταση','Τρέχουσα διάρκεια (Μείωση επόμενου επιπέδου / Τρέχουσα μείωση)'],
				wondertxt: ['Αναβάθμιση μνημείου','Αναβάθμιση σε εξέλιξη','Επόμενο Επίπεδο','Επίπεδο','Απαιτούμενα για το επόμενο Επίπεδο','Δωρηθέντα','Δωρηθέντα υλικά','Δωρεές','Δωρεά μέγιστης ποσότητας','μέγιστο','Δωρεά για αναβάθμιση','Η μέγιστη αναβάθμιση ολοκληρώθηκε!','Απαιτούμενα υλικά','Μνημείο θαύματος','Βαρόμετρο πίστης','Επίπεδο','Επίδραση','Ενεργός Διάρκεια','Διάρκεια ηρεμίας','άμεσα','Παίκτες σε αυτό το νησί','Παίκτης','Πόλη','Ποσ. δωρεάς','Ιερείς','Μετα<br>τροπή','Συμμε<br>τοχή','Μετά<br>βαση','Ενέργειες','','','',''],
				templetxt: ['Ο ναός είναι ένας χώρος πίστης, πεποιθήσεων και προβληματισμού. Εδώ ζουν οι ιερείς, λατρεύουν τον Θεό και διαδίδουν τον λόγο του στην πόλη και όλο το νησί. Μπορείτε κι εσείς να του ζητήσετε χάρες, αν τον σέβεστε αρκετά.','Βαρόμετρο πίστης','Αυτό το νησί πιστεύει κατά {0} %.','Το ποσοστό πίστης του νησιού είναι {0} %.','Χειροτόνηση ιερέων','Μετατροπή του πληθυσμού σας','Ποσοστό μετατροπής νήσου','Έσοδα πόλης','ανά ώρα','{0} ιερείς','{0} ιερέας','Κανένας ιερέας','Μέγιστος αριθμός ιερέων','Επιβεβαίωση','Θαύμα (Μνημείο)','{0} (Επίπεδο {1}/{2})','Διάρκεια επίδρασης θαύματος: {0}','Διάρκεια αναμονής για επαναχρησιμοποίηση: {0}','Ολοκλήρωση δράσης θαύματος','Ολοκλήρωση ηρεμίας μνημείου για επαναχρησιμοποίηση'],
				militaryupgrades: {Units: {archer:[['Σιδερένια Μύτη Βέλους','Ατσάλινη Μύτη Βέλους','Φλεγόμενη Μύτη Βέλους'],['Δερμάτινη Πανοπλία','Ενισχυμένη Δερμάτινη Πανοπλία','Υπερενισχυμένη Δερμάτινη Πανοπλία']],bombardier:[['Βόμβα Φωτιάς','Βόμβα Πυρός Κολάσεως','Βόμβα Κολάσεως'],['Δερμάτινο Καλάθι','Ενισχυμένο Δερμάτινο Καλάθι','Υπερενισχυμένο Δερμάτινο Καλάθι']],catapult:[['Βλήματα Φωτιάς','Βλήματα Πυρός Κολάσεως','Βλήματα της Κολάσεως'],['Χάλκινη Επίστρωση','Σιδερένια Επίστρωση','Ατσάλινη Επίστρωση']],gyrocopter:[['Τόξο','Διπλό Τόξο','Ταχύβολο Τόξο Φωτιάς'],['Χάλκινη Επίστρωση','Σιδερένια Επίστρωση','Ατσάλινη Επίστρωση']],marksman:[['Χάλκινο Μουσκέτο','Σιδερένιο Μουσκέτο','Ατσαλένιο Μουσκέτο'],['Δερμάτινη Πανοπλία','Ενισχυμένη Δερμάτινη Πανοπλία','Υπερενισχυμένη Δερμάτινη Πανοπλία']],mortar:[['Χειροβομβίδα Κεραυνού','Χειροβομβίδα Μεγάλου Κεραυνού','Χειροβομβίδα Αρμαγεδδών'],['Χάλκινο Τείχος','Σιδερένιο Τείχος','Ατσάλινο Τείχος']],phalanx:[['Χάλκινη Λόγχη','Σιδερένια Λόγχη','Ατσάλινη Λόγχη'],['Χάλκινη Ασπίδα','Σιδερένια Ασπίδα','Ατσάλινη Ασπίδα']],ram:[['Χάλκινη Κεφαλή','Σιδερένια Κεφαλή','Ατσάλινη Κεφαλή'],['Χάλκινη Οροφή','Σιδερένια Οροφή','Ατσάλινη Οροφή']],slinger:[['Χάλκινες Μπάλες','Σιδερένιες Μπάλες','Ατσάλινες Μπάλες'],['Δερμάτινη Ενδυμασία','Ενισχυμένη Δερμάτινη Ενδυμασία','Υπερενισχυμένη Δερμάτινη Ενδυμασία']],spearman:[['Χάλκινη Λόγχη','Σιδερένια Λόγχη','Ατσάλινη Λόγχη'],['Δερμάτινη Πανοπλία','Ενισχυμένη Δερμάτινη Πανοπλία','Υπερενισχυμένη Δερμάτινη Πανοπλία']],steamgiant:[['Χάλκινη Γροθιά','Σιδερένια Γροθιά','Ατσάλινη Γροθιά'],['Χάλκινη Επίστρωση','Σιδερένια Επίστρωση','Ατσάλινη Επίστρωση']],swordsman:[['Χάλκινο Σπαθί','Σιδερένιο Σπαθί','Ατσάλινο Σπαθί'],['Χάλκινο Κράνος','Σιδερένιο Κράνος','Ατσάλινο Κράνος']]},Ships: {ballista:[['Βαλλίστρα','Διπλή Βαλλίστρα','Τριπλή Βαλλίστρα'],['Χάλκινη Θωράκιση','Σιδερένια Θωράκιση','Ατσάλινη Θωράκιση']],ballooncarrier:[['Βόμβα Φωτιάς','Βόμβα του Πυρ της Κολάσεως','Βόμβα Κολάσεως'],['Μονό διάφραγμα','Διπλό διάφραγμα','Τριπλό διάφραγμα']],catapult:[['Βλήματα Φωτιάς','Βλήματα του Πυρ της Κολάσεως','Βλήματα Κολάσεως'],['Μονό διάφραγμα','Διπλό διάφραγμα','Τριπλό διάφραγμα']],flamethrower:[['Εκτοξευτής Φωτιάς','Εκτοξευτής του Πυρ της Κολάσεως','Εκτοξευτής Κολάσεως'],['Χάλκινη Θωράκιση','Σιδερένια Θωράκιση','Ατσάλινη Θωράκιση']],mortar:[['Χειροβομβίδα Κεραυνού','Χειροβομβίδα Μεγάλου Κεραυνού','Χειροβομβίδα Αρμαγεδδών'],['Μονό διάφραγμα','Διπλό διάφραγμα','Τριπλό διάφραγμα']],paddlespeedship:[['Χάλκινος Κριός','Σιδερένιος Κριός','Ατσαλένιος Κριός'],['Χάλκινη Θωράκιση','Σιδερένια Θωράκιση','Ατσάλινη Θωράκιση']],ram:[['Χάλκινος Κριός','Σιδερένιος Κριός','Ατσαλένιος Κριός'],['Χάλκινη Θωράκιση','Σιδερένια Θωράκιση','Ατσάλινη Θωράκιση']],rocketship:[['Πύραυλος Φωτιάς','Πύραυλος του Πυρ της Κολάσεως','Πύραυλος Κολάσεως'],['Μονό διάφραγμα','Διπλό διάφραγμα','Τριπλό διάφραγμα']],steamboat:[['Χάλκινο Σφυρί','Σιδερένιο Σφυρί','Ατσάλινο Σφυρί'],['Μονό διάφραγμα','Διπλό διάφραγμα','Τριπλό διάφραγμα']],submarine:[['Ωρολογιακές Τορπίλες','Αυτόματες Τορπίλες','Μηχανικές Τορπίλες'],['Μονό διάφραγμα','Διπλό διάφραγμα','Τριπλό διάφραγμα']]}},
				prodBuildtxt: [{forester:'Οι δυνατοί ξυλοκόποι μπορούν να κόψουν ακόμα και τα ψηλότερα δέντρα. Ξέρουν όμως ότι πρέπει να γίνεται και αναδάσωση ώστε να έχετε πάντα τα καλύτερα ξύλα για τα σπίτια σας. Η παραγωγή οικοδομικού υλικού αυξάνεται κατά <b>2 %</b> με κάθε επίπεδο αναβάθμισης του κτιρίου.',winegrower:'Ένας παραγωγός κρασιού διαλέγει τους πιο φωτεινούς λόφους για να φτιάξει τις κληματαριές του. Έτσι οι αμπελώνες παράγουν καλύτερους καρπούς και η ποιότητα της σοδειάς βελτιώνεται. Με κάθε επίπεδο αναβάθμισης του Οινοποιείου αυξάνεται η παραγωγή κρασιού κατά <b>2 %</b>.',stonemason:'Ένας εκπαιδευμένος μαρμαράς σπάει πάντα με ακρίβεια τα κομμάτια του μαρμάρου. Έτσι υπάρχει λιγότερη φύρα και οι οικοδόμοι σας έχουν πάντα το αναγκαίο υλικό. Με κάθε αναβάθμιση του κτιρίου, η παραγωγή μαρμάρου αυξάνεται κατά <b>2 %</b> της βασικής παραγωγής.',glassblowing:'Οι μεγαλύτεροι καλλιτέχνες δημιουργούν εκθαμβωτικά κομμάτια με το φύσημα των Υάλων στο Υαλουργείο. Μόνο οι Επιστήμονές σας καταλαβαίνουν τη χρήση των σωλήνων φυσήματος, του κρύσταλλου και όλων των άλλων συσκευών και είναι τόσο προσεκτικοί, πού τα κατασκευάσματά τους σπάνια σπάνε. Κάθε επίπεδο του κτιρίου αυξάνεται η παραγωγή Κρύσταλλου κατά <b>2 %</b>.',alchemist:'Δυτικά από τον Πύργο του Αλχημιστή μυρίζει περίεργα και πολλοί πολίτες δεν βγαίνουν από το σπίτι χωρίς μανταλάκι στη μύτη. Οι Αλχημιστές δουλεύουν ακατάπαυστα, ερευνώντας το τέλειο μείγμα και φροντίζοντας να εξορύσετε περισσότερο θείο από το Ορυχείου Θείου. Με κάθε επίπεδο του κτιρίου, η παραγωγή θείου αυξάνεται κατά <b>2 %</b> της βασικής παραγωγής.'},'Παραγωγή {0}','Βασική Παραγωγή','Προνομιούχα Επιβράβευση','Θέατρο προβολών','Πύργος του Ήλιου','Ξυλοκόπος','Διαφθορά','Πόρος','Επιβράβευση','Υπάρχει διαφθορά σε αυτήν την πόλη!','Η παραγωγικότητα και η ικανοποίηση σε αυτήν την πόλη μειώνονται έντονα! Επεκτείνετε {0} για να μειώσετε τη διαφθορά.','το Κυβερνείο','το Παλάτι',{forester:'ξύλου',winegrower:'κρασιού',stonemason:'μαρμάρου',glassblowing:'κρύσταλλου',alchemist:'θείου'}],
				reductBuildtxt: [{carpentering:'Μόνο η καλύτερη ξυλεία χρησιμοποιείται στο εργαστήρι του ξυλουργού. Έτσι, οι έμπειροι τεχνίτες σας είναι σε θέση να κατασκευάσουν ένα σταθερό πλαίσιο, ώστε τα σπίτια σας να μην χρειάζονται συνέχεια επισκευή. Κάθε επίπεδο του ξυλουργού χαμηλώνει της απαιτήσεις για ξυλεία κατά <b>1 %</b> της βασικής απαίτησης.',vineyard:'Στα δροσερά υπόγεια κελάρια της πόλης ωριμάζουν τα καλύτερα κρασιά. Ο υπεύθυνος των κελαριών φροντίζει να μην πάει χαμένο τίποτα και όλο το κρασί να καταλήξει στα στόματα των κατοίκων. Με κάθε επίπεδο του Αποστακτηρίου η κατανάλωση κρασιού στην πόλη μειώνεται κατά <b>1 %</b> της βασικής απαίτησης.',architect:'Τρίγωνο, Διαβήτης και Μέτρο: Το Αρχιτεκτονικό Γραφείο παρέχει όλα τα απαραίτητα για να χτίσετε ίσιους τοίχους και σταθερές στέγες. Ένα καλοσχεδιασμένο σπίτι χρειάζεται πολύ λιγότερο μάρμαρο από ό,τι μια πρόχειρη κατασκευή. Για κάθε επίπεδο του κτηρίου, η απαίτηση για μάρμαρο στην πόλη σας μειώνεται κατά <b>1 %</b>.',optician:'Φακοί και μεγεθυντικά γυαλιά δε βοηθάνε μόνο τους ερευνητές σας να βλέπουν καθαρά για να βρούνε σημαντικά έγγραφα στα γραφεία τους, αλλά είναι απαραίτητα για να ανακαλυφθούν νέες τεχνολογίες που θα σας κάνουν υπερήφανους. Ο Οπτικός αποθηκεύει όλα τα απαραίτητα σε κουτιά στο Εργαστήρι του, ώστε να χάνονται πολύ λίγα πράγματα. Η απαίτηση για κρύσταλλο μειώνεται κατά <b>1 %</b> ανά επίπεδο κτηρίου.',fireworker:'Η συνεχής εξάσκηση στα πυροτεχνήματα, όχι μόνο φωτίζουν τους ουρανούς, αλλά μερικές φορές και τα τριγύρω κτήρια. Οι ερευνητές ωστόσο μπορούν να ρυθμίζουν την απαίτηση σε θείο, κατά την δοκιμασία νέων μιγμάτων ξανά και ξανά. Για κάθε επίπεδο του κτηρίου, μειώνεται η απαίτηση για θείο στην πόλη κατά <b>1 %</b>.'},{carpentering:'ξύλου',vineyard:'κρασιού',architect:'μαρμάρου',optician:'κρυστάλλου',fireworker:'θείου'},'Μείωση κόστους {0} για τα Κτήρια','Μείωση κόστους {0} για τις Μονάδες Ξηράς','Μείωση κόστους {0} για τα Πολεμικά Πλοία','Μείωση κόστους {0} για τα Πειράματα','Μείωση κόστους {0} για τις Αναβαθμίσεις Μονάδων και Πλοίων','Βασικό Κόστος','Έρευνα','Κόστος','Μείωση κόστους {0}','Πόρος'],
				branchOfficetxt: ['Στο Εμπορικό Ανταλλακτήριο, οι έμποροι κάνουν εμπόριο και κυνηγούν τις ευκαιρίες. Οι έμποροι από τις μακρινές χώρες προτιμούν τα μεγάλα και γνωστά Εμπορικά Ανταλλακτήρια! Το βεληνεκές του Εμπορικού Ανταλλακτηρίου σας αυξάνεται με κάθε δεύτερη επέκταση.','Εμπόριο αγαθών','Εμπόριο στρατιωτών','Εμπορικές Συνθήκες','Οι προσφορές σας','Ανιχνευτής ευκαιριών','Αγορά αγαθών','Πώληση αγαθών','Βεληνεκές αναζήτησης','Νησιά εντός βεληνεκούς','Πόλη','Αγαθά / λεπτό','Τεμάχια','Αγαθό','Τιμή','Απόσταση','Εμπόριο;','ανά τεμάχιο','Δεν υπάρχουν προσφορές προς το παρόν.','Αναζήτηση για','Νόμισμα','Μονάδες Ξηράς','Μονάδες Θαλάσσης','Όλες','Όλα','Μονάδα','Προσφορές από εμπορικούς συνεργάτες','Αγαθά','Τύπος προσφοράς','Ποσότητα','Τιμή','Όρια','Αγορά','Πώληση','Δεσμευμένη ποσότητα χρυσού για τις αγορές','Ενημέρωση προσφορών'],
				takeoffertxt: ['Διαχείριση προσφοράς','Επιλέξτε πόσα αγαθά ή και μονάδες θέλετε να αγοράσετε από τον παίκτη με το όνομα {0}. Επίσης, ορίστε και πόσο χρυσό προτίθεστε να πληρώσετε.','Από εδώ μπορείτε να στείλετε στόλο για να πουλήσετε αγαθά στον παίκτη με το όνομα {0}. Η εμπορική συναλλαγή θα ολοκληρωθεί μόνο όταν φτάσουν τα πλοία σας στον προορισμό τους. Γι&apos; αυτό μπορείτε να καθορίσετε μια ελάχιστη τιμή για τα αγαθά σας, αν ο κάτοχος μειώσει στο μεταξύ την προσφορά του.'],
				demolitiontxt: ['Επιβεβαίωση ακύρωσης αναβάθμισης','Προσοχή','Θέλετε να ακυρώσετε την αναβάθμιση αυτού του κτηρίου;','Οι ακόλουθες ποσότητες αγαθών θα επιστραφούν μετά την ακύρωση','Ναι, σίγουρα','Όχι, άστο καλύτερα'],
				abandoncitytxt: ['Εγκατάλειψη της {0} {1}','Εγκατάλειψη αποικίας','Εδώ μπορείτε να εγκαταλείψετε την αποικία σας. Αλλά προσοχή: θα αφήσετε κι όλους τους πόρους που έχετε μαζέψει. Επίσης, όλοι οι πολίτες που ζουν και δουλεύουν σε αυτήν την πόλη, όλα τα κτίρια που χτίσατε, όλα τα στρατεύματα και τα πλοία θα χαθούν για πάντα. Γι&apos; αυτό βεβαιωθείτε ότι όλα είναι ασφαλή, πριν κάνετε αυτό το βήμα. Σίγουρα θέλετε να εγκαταλείψετε την αποικία σας;','Εισάγετε τη λέξη ασφαλείας που φαίνεται στην εικόνα στο πλαίσιο δεξιά για να επιβεβαιώσετε την εγκατάλειψη της αποικίας.','Λέξη ασφαλείας'],
				mayortxt: ['Δήμαρχος','Νέα πόλης','Εμπορικά δρομολόγια','Τρέχοντα συμβάντα ({0})','Όλα','Στρατιωτικά','Αγαθά','Παραγωγή','Κατασκοπεία','Διπλωματία','Νέα','Πειρατεία','Τοποθεσία','Ημερομηνία','Θέμα','Μετάβαση στην πόλη «{0}»','προηγούμενα 10...','...επόμενα 10'],
				troopstxt: ['Στρατεύματα στην πόλη','Επιθεωρείστε τα στρατεύματα που βρίσκονται στην πόλη σας.','Χερσαίες δυνάμεις','Ναυτικές δυνάμεις','Μονάδες','Πλοία','Φρουρά','Υπερασπιστές','Δεν υπάρχουν συμμαχικές μονάδες σε αυτή την πόλη!','Δυνάμεις κατοχής','Δεν υπάρχουν εχθρικές μονάδες κατοχής στην πόλη σας!','Στόλοι αποκλεισμού','Δεν υπάρχουν εχθρικά πλοία στην πόλη σας!'],
				servertimetip: '<b>Ώρα Κόσμου (διακομιστή)</b><br>{0}<br><b>Τοπική ώρα</b><br>{1}',
				summertime: 'Θερινή ώρα',
				wintertime: 'Χειμερινή ώρα',
				lootable: 'Λεηλατήσιμα',
				chrcnt: ['χαρακτήρες','χαρακτήρας'],
				levelcnt: ['επίπεδα','επίπεδο'],
				incr: 'Α/Α',
				traderoutestxt: ['Εμπορικά Δρομολόγια','Επιλογή προέλευσης','Επιλογή προορισμού'],
				museumlvl: 'Επίπεδο Μουσείου',
				island: 'Νησί',
				luxres: 'Πόρος πολυτελείας',
				viewCityMenu: {image_troops:'Στρατεύματα στην πόλη',image_espionage:'Κατασκοπεία',image_resourceShop:'Λήψη αγαθών!',image_trader:'Προνομιούχος έμπορος',image_friends:'Πρόσκληση φίλων',image_constructionlist:'Λίστα κατασκευής κτηρίων',image_fireunit:'Απόλυση μονάδων',image_toggle:'Προβολή ονομάτων κτηρίων',empire_Menu:'Επισκόπηση Αυτοκρατορίας'},
				invfriendtxt: ['Πρόσκληση φίλων','Μπορείτε να επικοινωνείτε πιο γρήγορα με τα άτομα της λίστας των φίλων σας και μπορείτε να βλέπετε αν οι φίλοι σας είναι συνδεδεμένοι. Αν ένας παίκτης ιδρύσει μια νέα αποικία, όλοι οι φίλοι του λαμβάνουν μια γενναιόδωρη επιβράβευση χρυσού. Αν ένας παίκτης ολοκληρώσει μια έρευνα, όλοι οι φίλοι του αποκτούν μια μικρή επιβράβευση πόντων έρευνας.','Προσθήκη παικτών Ikariam','Όνομα χρήστη','Προσθήκη','Ενεργές προσκλήσεις'],
				dismissunits: ['Απόλυση μονάδων-πλοίων','Απόλυση μονάδας(ων)','Απόλυση πλοίου(ων)','Μηδενισμός εισαγωγής','Απόλυση όλων','Απόλυση!','Κόστη',{citizens:'Πολίτες',wood:'Ξύλο',wine:'Κρασί',sulfur:'Θείο',upkeep:'Κόστος συντήρησης ανά ώρα',glass:'Κρύσταλλο'},'Επιβεβαίωση','Αριθμός μονάδων για απόλυση','Ναι','Άκυρο'],
				transprttxt: ['Μεταφορά','Διαλέξτε ποια αγαθά θέλετε να μεταφέρετε και πόσο μεγάλο πρέπει να είναι το φορτίο.','Μίσθωση πλοίων','Κάποιοι ναυτικοί θα ταξίδευαν ως το τέλος του κόσμου για λίγη Αμβροσία. Μπορείτε να χρησιμοποιήσετε τόσα επί μισθώσει πλοία, όσο είναι και το σύνολο των εμπορικών σας πλοίων ({0}). Αυτά θα ταξιδέψουν με τον στόλο σας σε ένα ταξίδι και μπορούν να αυξήσουν τη χωρητικότητα μεταφορών σας έως διπλασιασμού. Το κόστος σε Αμβροσία αυξάνεται με τον αριθμό των επί μισθώσει πλοίων!','Κανένα πλοίο','Ελάχιστο','Μέγιστος αριθμός πλοίων','Μέγιστο','Απαιτούνται ακόμα {0} μονάδες Αμβροσίας!<br>Αγοράστε τώρα!!','Οι προς μίσθωση ναυτικοί θέλουν: {0} (Έχετε {1})','Αγαθά προς μεταφορά','Επιλέξτε τα εμπορεύματα που θέλετε να μεταφέρετε από την πόλη {0} στην πόλη {1}. Λάβετε υπόψη πόσα εμπορικά πλοία θα χρειαστείτε για αυτό.','Μεταφορά {0}',{wood:'ξύλου',wine:'κρασιού',marble:'μαρμάρου',glass:'κρύσταλλου',sulfur:'θείου'},'Μηδενισμός ποσότητας','Μέγιστη δυνατή ποσότητα','λιγότερα','περισσότερα','Χωρητικότητα ανά εμπορικό πλοίο','Μόνο η βασική ταχύτητα των εμπορικών πλοίων θα αυξηθεί. Η επιβράβευση που επιτυγχάνεται με το μνημείο που είναι αφιερωμένο στον Ποσειδώνα θα διατηρηθεί αλλά δεν θα προστεθεί.','Βασική ταχύτητα','Τουρμπίνες Τρίτωνα','Κόστη','Οι τουρμπίνες κατασκευάζονται στον Ναό του Τρίτωνα, γιου του Ποσειδώνα, στην Αυλίδα και μπορούν να τοποθετηθούν εξωτερικά των εμπορικών σας πλοίων. Για μια σεβαστή δωρεά Αμβροσίας ο Προμηθέας γεμίζει τις τουρμπίνες όλων των πλοίων που είναι σε χρήση με θεϊκή φωτιά από την εστία του Ηφαίστου και οδηγεί έτσι τα πλοία με θεϊκή δύναμη πάνω στα κύματα.','Επισκόπηση','Ταξίδι','Φόρτωση','Ημερομηνία / ώρα άφιξης','Προορισμός','Φορτίο',{wood:'Ξύλο',wine:'Κρασί',marble:'Μάρμαρο',glass:'Κρύσταλλο',sulfur:'Θείο'},'Ταχύτητα','Μεταφορά αγαθών','Προγραμματισμός μεταφοράς αγαθών','Ένα εμπορικό δρομολόγιο επιτρέπει καθημερινές μεταφορές αγαθών μεταξύ των πόλεων της αυτοκρατορίας σας. Έτσι μπορείτε, για παράδειγμα, να προμηθεύετε τις πόλεις σας με κρασί. Έχετε ένα δωρεάν εμπορικό δρομολόγιο και μπορείτε να δημιουργήσετε και άλλα χρησιμοποιώντας Αμβροσία.<br><br>Να ελέγχετε πάντα να υπάρχουν αρκετά αγαθά και ελεύθερα εμπορικά πλοία για τις ώρες που έχετε επιλέξει τα εμπορικά δρομολόγια. Να προσέχετε να μην υπάρχουν εχθρικοί στόλοι στα λιμάνια των πόλεων που επιλέξατε.','Ορισμός εμπορικού δρομολογίου','',''],
				transprttxten: ['Transport','Choose, which goods you want to transport and how large the cargo should be.','Charter mercenary transporter','Some seafarers would sail to the end of the world for a bit of Ambrosia. You can charter as many mercenary transporters as you have maximum transport ships available ({0}). They will sail with your fleet for one journey and somewhat expand your transporting capacity. The price increases with the number of mercenary transporters you buy!','Reset entry','Minimum','send along everything','Maximum','{0} Ambrosia is missing!<br>Acquire now!!','The mercenaries want: {0} (You have {1})','Transport Goods','Choose the goods that you want to transport from {0} to {1}. Keep in mind how many merchant ships you will need for this.','{0} transport',{wood:'Wood',wine:'Wine',marble:'Marble',glass:'Cr;ystal',sulfur:'Sulphur'},'Reset entry','send along everything','less','more','Capacity per merchant ship','Only the basic speed of the merchant ships will be increased. The bonus that an activated Poseidon miracle achieves will be retained, but it will not be additionally increased.','Basic speed','Triton Engines','Costs','These engines are crafted in Triton, son of Poseidon&apos;s, temple and can be mounted on the outside of our merchant ships. For a fair Ambrosia donation, Prometheus will fill the engines of all ships used with a divine fire from Hephaestus&apos; forge, which will drive the ships across the seas with divine powers.','Overview','Travel time','Loading time','Arrival date / time','Destination','Cargo',{wood:'Wood',wine:'Wine',marble:'Marble',glass:'Crystal',sulfur:'Sulphur'},'Speed','Transport goods','Schedule goods transport','A trade route allows you to send transports between two of your kingdom`s towns every day. This way you can supply all of your settlements with wine or other goods. You have one free trade route available and can add more for a bit of Ambrosia.<br><br>Please make sure that there are always enough goods and merchant ships available at the allotted times during all trips on the trading routes and that the involved towns` harbours are free of enemy fleets.','Establish as trade route','','',''],
				notEnCap: ['Ανεπαρκής χώρος αποθήκευσης','Μετάβαση στην {0}','Μετάβαση στην {0}','Μετάβαση<br>στην {0} ή στην {1}'],
				click_:'<b>Κλικ</b>'
			}
		},
		Resources:
		{
			GOLD: 'gold',
			WOOD: 'wood',
			WINE: 'wine',
			MARBLE: 'marble',
			GLASS: 'glass',
			SULFUR: 'sulfur'
		},
		ResourceIDs:
		{
			GOLD:'gold',
			WOOD:'resource',
			WINE: 1,
			MARBLE: 2,
			GLASS : 3,
			SULFUR: 4
		},
		Research:
		{
			Seafaring:
			{
				CARPENTRY: 2150,
				DECK_WEAPONS: 1010,
				PIRACY: 1170,
				SHIP_MAINTENANCE: 1020,
				DRAFT: 1130,
				EXPANSION: 1030,
				FOREIGN_CULTURES: 1040,
				PITCH: 1050,
				MARKET: 2070,
				GREEK_FIRE: 1060,
				COUNTERWEIGHT: 1070,
				DIPLOMACY: 1080,
				SEA_MAPS: 1090,
				PADDLE_WHEEL_ENGINE: 1100,
				CAULKING: 1140,
				MORTAR_ATTACHMENT: 1110,
				MASSIVE_RAM: 1150,
				OFFSHORE_BASE: 1160,
				SEAFARING_FUTURE: 1999
			},
			Economy:
			{
				CONSERVATION: 2010,
				PULLEY: 2020,
				WEALTH: 2030,
				WINE_CULTURE: 2040,
				IMPROVED_RESOURCE_GATHERING: 2130,
				GEOMETRY: 2060,
				ARCHITECTURE: 1120,
				HOLIDAY: 2080,
				LEGISLATION: 2170,
				CULINARY_SPECIALITIES: 2050,
				HELPING_HANDS: 2090,
				SPIRIT_LEVEL: 2100,
				WINE_PRESS: 2140,
				DEPOT: 2160,
				SOLDIER_EXCHANGE: 2180,
				BUREACRACY: 2110,
				UTOPIA: 2120,
				ECONOMIC_FUTURE: 2999
			},
			Science:
			{
				WELL_CONSTRUCTION: 3010,
				PAPER: 3020,
				ESPIONAGE: 3030,
				POLYTHEISM: 3040,
				INK: 3050,
				GOVERNMENT_FORMATION: 3150,
				INVENTION: 3140,
				CULTURAL_EXCHANGE: 3060,
				ANATOMY: 3070,
				OPTICS: 3080,
				EXPERIMENTS: 3081,
				MECHANICAL_PEN: 3090,
				BIRDS_FLIGHT: 3100,
				ARCHIVING: 3170,
				LETTER_CHUTE: 3110,
				STATE_RELIGION: 3160,
				PRESSURE_CHAMBER: 3120,
				ARCHIMEDEAN_PRINCIPLE: 3130,
				SCIENTIFIC_FUTURE: 3999
			},
			Military:
			{
				DRY_DOCKS: 4010,
				MAPS: 4020,
				PROFESSIONAL_ARMY: 4030,
				SEIGE: 4040,
				CODE_OF_HONOR: 4050,
				BALLISTICS: 4060,
				LAW_OF_THE_LEVEL: 4070,
				GOVERNOR: 4080,
				PYROTECHNICS: 4130,
				LOGISTICS: 4090,
				GUNPOWDER: 4100,
				ROBOTICS: 4110,
				CANNON_CASTING: 4120,
				MILITARISTIC_FUTURE: 4999
			},
			Costs:{1010:12,1020:24,1030:336,1040:1032,1050:2236,1060:7020,1070:9936,1080:17064,1090:25632,1100:38400,1110:93240,1120:3672,1130:24,1140:53000,1150:120000,1160:475000,1170:18,1999:532800,2010:12,2020:24,2030:56,2040:220,2050:10764,2060:2236,2070:3264,2080:7200,2090:19908,2100:25632,2110:106560,2120:241200,2130:990,2140:48000,2150:8,2160:48000,2170:8242,2180:56000,2999:532800,3010:24,3020:30,3030:420,3040:1428,3050:2652,3060:8694,3070:14952,3080:21360,3081:21360,3090:31968,3100:46848,3110:144720,3120:209880,3130:444000,3140:4320,3150:2836,3160:202074,3170:98000,3999:610560,4010:8,4020:24,4030:336,4040:1032,4050:2236,4060:3264,4070:7020,4080:11592,4090:25632,4100:38400,4110:106560,4120:209040,4130:19908,4999:532800}
		},
		Military:
		{
			HOPLITE: 'phalanx',
			SPARTAN: 'spartan',
			STEAM_GIANT: 'steamgiant',
			SPEARMAN: 'spearman',
			SWORDSMAN: 'swordsman',
			SLINGER: 'slinger',
			ARCHER: 'archer',
			MARKSMAN: 'marksman',
			RAM: 'ram',
			CATAPULT: 'catapult',
			MORTAR: 'mortar',
			GYROCOPTER: 'gyrocopter',
			BALLOON_BOMBADIER: 'bombardier',
			COOK: 'cook',
			DOCTOR: 'medic',
			ARMY: 'army',
			MERCHANT_SHIP: 'ship_transport',
			RAM_SHIP: 'ship_ram',
			FLAME_THROWER: 'ship_flamethrower',
			STEAM_RAM: 'ship_steamboat',
			BALLISTA_SHIP: 'ship_ballista',
			CATAPULT_SHIP: 'ship_catapult',
			MORTAR_SHIP: 'ship_mortar',
			SUBMARINE: 'ship_submarine',
			PADDLE_SPEEDBOAT: 'ship_paddlespeedship',
			BALLOON_CARRIER: 'ship_ballooncarrier',
			TENDER: 'ship_tender',
			ROCKET_SHIP: 'ship_rocketship',
			NAVY: 'navy',
			BARBARIAN_AXE_SWINGER: 'barbarian',
			BARBARIAN_CLUBMAN: 'barbarianClub',
			BARBARIAN_KNIFEMAN: 'barbarianKnive',
			BARBARIAN_AXE_THROWER: 'barbarianAxethrow',
			BARBARIAN_WAR_WALKER: 'barbarianWalker',
			BARBARIAN_RAM: 'barbarianRam',
			BARBARIAN_CATAPULT: 'barbarianCatapult',
			BARBARIAN_FIGHTER: 'barbarianFighter',
			BARBARIAN_DIRIGIBLE: 'barbarianZeppelin',
			DECKWRECKER: 'ship_barbarian_light_battleship',
			SAIL_SHREDDER: 'ship_barbarian_light_ranged',
			PYROBOAT: 'ship_barbarian_heavy_battleship',
			BOULDER_CATAPULT: 'ship_barbarian_heavy_ranged',
			WEDGE_PADDLER: 'ship_barbarian_heavy_battleship_II',
			POWDER_PITCHER: 'ship_barbarian_heavy_ranged_II',
			TERROR_OF_THE_DEEP: 'ship_barbarian_first_strike_I',
			DRAGONFIRE: 'ship_barbarian_first_strike_II',
			DIRIGIBLE_IGNITER: 'ship_barbarian_anti_carrier',
			BARBARIAN_NEST: 'ship_barbarian_carrier',
		},
		unitIds:
		{
			301: 'slinger',
			302: 'swordsman',
			303: 'phalanx',
			304: 'marksman',
			305: 'mortar',
			306: 'catapult',
			307: 'ram',
			308: 'steamgiant',
			309: 'bombardier',
			310: 'cook',
			311: 'medic',
			312: 'gyrocopter',
			313: 'archer',
			315: 'spearman',
			316: 'barbarian',
			319: 'spartan',
			320: 'barbarianClub',
			321: 'barbarianKnive',
			322: 'barbarianAxethrow',
			323: 'barbarianWalker',
			324: 'barbarianRam',
			325: 'barbarianCatapult',
			326: 'barbarianFighter',
			327: 'barbarianZeppelin',
			201: 'ship_transport',
			210: 'ship_ram',
			211: 'ship_flamethrower',
			212: 'ship_submarine',
			213: 'ship_ballista',
			214: 'ship_catapult',
			215: 'ship_mortar',
			216: 'ship_steamboat',
			217: 'ship_rocketship',
			218: 'ship_paddlespeedship',
			219: 'ship_ballooncarrier',
			220: 'ship_tender',
			221: 'ship_barbarian_light_battleship',
			222: 'ship_barbarian_light_ranged',
			223: 'ship_barbarian_heavy_battleship',
			224: 'ship_barbarian_heavy_ranged',
			225: 'ship_barbarian_heavy_battleship_II',
			226: 'ship_barbarian_heavy_ranged_II',
			227: 'ship_barbarian_first_strike_I',
			228: 'ship_barbarian_first_strike_II',
			229: 'ship_barbarian_anti_carrier',
			230: 'ship_barbarian_carrier'
		},
		UnitData:
		{
			archer:{id:313,type:'army',position:'army_ranged',minlevel:7,baseTime:240,baseCost:4,minWlevel:7},
			bombardier:{id:309,type:'army',position:'army_air',minlevel:11,baseTime:1800,baseCost:45,minWlevel:21},
			catapult:{id:306,type:'army',position:'army_seige',minlevel:8,baseTime:1800,baseCost:25,minWlevel:10},
			cook:{id:310,type:'army',position:'army_support',minlevel:5,baseTime:1200,baseCost:10},
			gyrocopter:{id:312,type:'army',position:'army_air',minlevel:10,baseTime:900,baseCost:15,minWlevel:14},
			marksman:{id:304,type:'army',position:'army_ranged',minlevel:13,baseTime:600,baseCost:3,minWlevel:10},
			medic:{id:311,type:'army',position:'army_support',minlevel:9,baseTime:1200,baseCost:20},
			mortar:{id:305,type:'army',position:'army_seige',minlevel:14,baseTime:2400,baseCost:30,minWlevel:18},
			phalanx:{id:303,type:'army',position:'army_front_line',minlevel:4,baseTime:300,baseCost:3,minWlevel:4},
			ram:{id:307,type:'army',position:'army_seige',minlevel:2,baseTime:600,baseCost:15,minWlevel:8},
			slinger:{id:301,type:'army',position:'army_ranged',minlevel:2,baseTime:90,baseCost:2,minWlevel:1},
			spartan:{id:319,type:'army',position:'army_front_line',minLevel:0,baseTime:0,baseCost:0},
			spearman:{id:315,type:'army',position:'army_flank',minlevel:1,baseTime:60,baseCost:1,minWlevel:1},
			steamgiant:{id:308,type:'army',position:'army_front_line',minlevel:12,baseTime:900,baseCost:12,minWlevel:16},
			swordsman:{id:302,type:'army',position:'army_flank',minlevel:6,baseTime:180,baseCost:4,minWlevel:2},
			ship_ballista:{id:213,type:'fleet',position:'navy_ranged',minlevel:3,baseTime:3000,baseCost:20,minWlevel:3},
			ship_ballooncarrier :{id:219,type:'fleet',position:'navy_air',minlevel:7,baseTime:3900,baseCost:100,minWlevel:26},
			ship_catapult:{id:214,type:'fleet',position:'navy_ranged',minlevel:3,baseTime:3000,baseCost:35,minWlevel:12},
			ship_flamethrower:{id:211,type:'fleet',position:'navy_front_line',minlevel:4,baseTime:1800,baseCost:25,minWlevel:9},
			ship_mortar:{id:215,type:'fleet',position:'navy_ranged',minlevel:17,baseTime:3000,baseCost:50,minWlevel:19},
			ship_paddlespeedship:{id:218,type:'fleet',position:'navy_air',minlevel:13,baseTime:1800,baseCost:5,minWlevel:18},
			ship_ram:{id:210,type:'fleet',position:'navy_flank',minlevel:1,baseTime:2400,baseCost:15,minWlevel:1},
			ship_rocketship:{id:217,type:'fleet',position:'navy_seige',minlevel:11,baseTime:3600,baseCost:55,minWlevel:16},
			ship_steamboat:{id:216,type:'fleet',position:'navy_front_line',minlevel:15,baseTime:2400,baseCost:45,minWlevel:23},
			ship_submarine:{id:212,type:'fleet',position:'navy_seige',minlevel:19,baseTime:3600,baseCost:50,minWlevel:22},
			ship_tender:{id:220,type:'fleet',position:'navy_support',minlevel:9,baseTime:2400,baseCost:100}
		},
		Government:
		{
			ANARCHY: 'anarchie',
			XENOCRACY: 'xenokratie',
			IKACRACY: 'ikakratie',
			ARISTOCRACY: 'aristokratie',
			DICTATORSHIP: 'diktatur',
			DEMOCRACY: 'demokratie',
			NOMOCRACY: 'nomokratie',
			OLIGARCHY: 'oligarchie',
			TECHNOCRACY: 'technokratie',
			THEOCRACY: 'theokratie'
		},
		Buildings:
		{
			TOWN_HALL: 'townHall',
			PALACE: 'palace',
			GOVERNORS_RESIDENCE: 'palaceColony',
			TAVERN: 'tavern',
			MUSEUM: 'museum',
			ACADEMY: 'academy',
			WORKSHOP: 'workshop',
			TEMPLE: 'temple',
			EMBASSY: 'embassy',
			WAREHOUSE: 'warehouse',
			DUMP: 'dump',
			TRADING_PORT: 'port',
			TRADING_POST: 'branchOffice',
			WALL: 'wall',
			SAFEHOUSE: 'safehouse',
			BARRACKS: 'barracks',
			SHIPYARD: 'shipyard',
			FORESTER: 'forester',
			CARPENTER: 'carpentering',
			WINERY: 'winegrower',
			VINEYARD: 'vineyard',
			STONEMASON: 'stonemason',
			ARCHITECT: 'architect',
			GLASSBLOWER: 'glassblowing',
			OPTICIAN: 'optician',
			ALCHEMISTS_TOWER: 'alchemist',
			FIREWORK_TEST_AREA: 'fireworker',
			PIRATE_FORTRESS: 'pirateFortress',
			BLACK_MARKET: 'blackMarket',
			MARINE_CHART_ARCHIVE: 'marineChartArchive',
		},
		GovernmentData:
		{
			anarchie:
			{
				corruptionPalace:0,
				governors:0,
				corruption:0.25,
				spyprotection:0,
				unitBuildTime:0,
				fleetBuildTime:0,
				loadingSpeed:0,
				buildingTime:0,
				happiness:0,
				bonusShips:0,
				armySupply:0,
				fleetSupply:0,
				researchPerCulturalGood:0,
				tradeShipSpeed:0,
				branchOfficeRange:0,
				researchBonus:1,
				researcherCost:0,
				productivity:0,
				happinessWithoutTemple:0,
				goldBonusPerPriest:0,
				cooldownTime:0,
				happinessBonusWithTempleConversion:0
			},
			xenokratie:
			{
				corruptionPalace:0,
				governors:0,
				corruption:0,
				spyprotection:0,
				unitBuildTime:0,
				fleetBuildTime:0,
				loadingSpeed:0,
				buildingTime:0,
				happiness:0,
				bonusShips:0,
				armySupply:0,
				fleetSupply:0,
				researchPerCulturalGood:0,
				tradeShipSpeed:0,
				branchOfficeRange:0,
				researchBonus:1,
				researcherCost:0,
				productivity:0,
				happinessWithoutTemple:0,
				goldBonusPerPriest:0,
				cooldownTime:0,
				happinessBonusWithTempleConversion:0
			},
			ikakratie:
			{
				id:0,
				corruptionPalace:0,
				governors:0,
				corruption:0,
				spyprotection:0,
				unitBuildTime:0,
				fleetBuildTime:0,
				loadingSpeed:0,
				buildingTime:0,
				happiness:0,
				bonusShips:0,
				armySupply:0,
				fleetSupply:0,
				researchPerCulturalGood:0,
				tradeShipSpeed:0,
				branchOfficeRange:0,
				researchBonus:1,
				researcherCost:0,
				productivity:0,
				happinessWithoutTemple:0,
				goldBonusPerPriest:0,
				cooldownTime:0,
				happinessBonusWithTempleConversion:0
			},
			aristokratie:
			{
				id:1,
				corruptionPalace:0,
				governors:0,
				corruption:0.03,
				spyprotection:0.2,
				unitBuildTime:0,
				fleetBuildTime:0,
				loadingSpeed:0,
				buildingTime:-0.2,
				happiness:0,
				bonusShips:0,
				armySupply:0,
				fleetSupply:0,
				researchPerCulturalGood:0,
				tradeShipSpeed:0,
				branchOfficeRange:0,
				researchBonus:1,
				researcherCost:0,
				productivity:0,
				happinessWithoutTemple:0,
				goldBonusPerPriest:0,
				cooldownTime:0,
				happinessBonusWithTempleConversion:0
				},
			diktatur:
			{
				id:2,
				corruptionPalace:0,
				governors:0,
				corruption:0,
				spyprotection:0,
				unitBuildTime:-0.02,
				fleetBuildTime:-0.02,
				loadingSpeed:0,
				buildingTime:0,
				happiness:-75,
				bonusShips:2,
				armySupply:-0.02,
				fleetSupply:-0.02,
				researchPerCulturalGood:0,
				tradeShipSpeed:0,
				branchOfficeRange:0,
				researchBonus:1,
				researcherCost:0,
				productivity:0,
				happinessWithoutTemple:0,
				goldBonusPerPriest:0,
				cooldownTime:0,
				happinessBonusWithTempleConversion:0
				},
			demokratie:
			{
				id:3,
				corruptionPalace:0,
				governors:0,
				corruption:0,
				spyprotection:-0.2,
				unitBuildTime:0.05,
				fleetBuildTime:0,
				loadingSpeed:0,
				buildingTime:0,
				happiness:75,
				bonusShips:0,
				armySupply:0,
				fleetSupply:0,
				researchPerCulturalGood:1,
				tradeShipSpeed:0,
				branchOfficeRange:0,
				researchBonus:1,
				researcherCost:0,
				productivity:0,
				happinessWithoutTemple:0,
				goldBonusPerPriest:0,
				cooldownTime:0,
				happinessBonusWithTempleConversion:0
			},
			nomokratie:
			{
				id:4,
				corruptionPalace:0,
				governors:0,
				corruption:-0.05,
				spyprotection:0.2,
				unitBuildTime:0.05,
				fleetBuildTime:0.05,
				loadingSpeed:0.5,
				buildingTime:0,
				happiness:0,
				bonusShips:0,
				armySupply:0,
				fleetSupply:0,
				researchPerCulturalGood:0,
				tradeShipSpeed:0,
				branchOfficeRange:0,
				researchBonus:1,
				researcherCost:0,
				productivity:0,
				happinessWithoutTemple:0,
				goldBonusPerPriest:0,
				cooldownTime:0,
				happinessBonusWithTempleConversion:0
			},
			oligarchie:
			{
				id:5,
				corruptionPalace:0,
				governors:0,
				corruption:0.03,
				spyprotection:0,
				unitBuildTime:0,
				fleetBuildTime:0,
				loadingSpeed:0,
				buildingTime:0.2,
				happiness:0,
				bonusShips:2,
				armySupply:0,
				fleetSupply:-0.02,
				researchPerCulturalGood:0,
				tradeShipSpeed:0.1,
				branchOfficeRange:5,
				researchBonus:1,
				researcherCost:0,
				productivity:0,
				happinessWithoutTemple:0,
				goldBonusPerPriest:0,
				cooldownTime:0,
				happinessBonusWithTempleConversion:0
			},
			technokratie:
			{
				id:6,
				corruptionPalace:0,
				governors:0,
				corruption:0,
				spyprotection:0,
				unitBuildTime:0,
				fleetBuildTime:0,
				loadingSpeed:0,
				buildingTime:0,
				happiness:0,
				bonusShips:0,
				armySupply:0,
				fleetSupply:0,
				researchPerCulturalGood:0,
				tradeShipSpeed:0,
				branchOfficeRange:0,
				researchBonus:1.05,
				researcherCost:1,
				productivity:0.2,
				happinessWithoutTemple:0,
				goldBonusPerPriest:0,
				cooldownTime:0,
				happinessBonusWithTempleConversion:0
			},
			theokratie:
			{
				id:7,
				corruptionPalace:0,
				governors:0,
				corruption:0,
				spyprotection:0,
				unitBuildTime:0,
				fleetBuildTime:0,
				loadingSpeed:0,
				buildingTime:0,
				happiness:0,
				bonusShips:0,
				armySupply:0,
				fleetSupply:0,
				researchPerCulturalGood:0,
				tradeShipSpeed:0,
				branchOfficeRange:0,
				researchBonus:0.95,
				researcherCost:0,
				productivity:0,
				happinessWithoutTemple:-20,
				goldBonusPerPriest:1,
				cooldownTime:-0.2,
				happinessBonusWithTempleConversion:2
			}
		},
		BuildingData:
		{
			academy:
			{
				buildingId:4,
				maxLevel:32,
				wood:[64,68,115,263,382,626,982,1330,2004,2665,3916,5156,7446,9753,12751,18163,23691,33451,43571,56729,73832,103459,144203,175058,243930,317208,439967,536310,743789,1027469,1257244,1736681],
				glass:[0,0,0,0,225,428,744,1089,1748,2454,3786,5216,7862,10729,14599,21627,29321,43020,58213,78724,106414,154857,224146,282571,408877,552141,795252,1006647,1449741,2079650,2642546,3790581],
				marble:0,
				sulfur:0,
				wine:0,
				time:{a:1440,b:1,c:1.2,d:720,e:[983]},
				icon:'skin/img/city/academy_l.png',
				maxScientists:[0,8,12,16,22,28,35,43,51,60,69,79,89,100,111,122,134,146,159,172,185,198,212,227,241,256,271,287,302,318,335,351,368]
			},
			alchemist:
			{
				buildingId:22,
				maxLevel:32,
				wood:[274,467,718,1045,1469,2021,2738,3671,4883,6459,8508,11172,14634,19135,24987,32594,42483,55339,72050,93778,122021,158740,206471,268524,349194,454063,590393,767620,998018,1297535,1686906,2193088],
				glass:0,
				marble:[0,116,255,436,671,977,1375,1892,2564,3437,4572,6049,7968,10462,13705,17921,23402,30527,39790,51830,67485,87835,114289,148680,193389,251512,327069,425294,552986,718987,934789,1215329],
				sulfur:0,
				wine:0,
				time:{a:72000,b:11,c:1.1,d:6120},
				icon:'skin/img/city/alchemist_l.png'
			},
			architect:
			{
				buildingId:24,
				maxLevel:32,
				wood:[185,291,413,555,720,911,1133,1390,1689,2035,2437,2902,3443,4070,4797,5640,6618,7754,9070,10598,12369,14424,16807,19573,22780,26501,30817,35826,41631,48371,56185,65251],
				glass:0,
				marble:[106,160,222,295,379,475,587,716,865,1036,1233,1460,1722,2023,2369,2767,3226,3752,4358,5056,5857,6778,7836,9052,10448,12054,13899,16016,18450,21246,24455,28141],
				sulfur:0,
				wine:0,
				time:{a:125660,b:37,c:1.06,d:2628},
				icon:'skin/img/city/architect_l.png'
			},
			barracks:
			{
				buildingId:6,
				maxLevel:54,
				wood :[48,114,195,296,420,574,766,1003,1297,1662,2115,2676,3371,4234,5304,6630,8275,10314,12843,15979,19868,24690,30669,38083,47277,58676,72812,90341,112076,139028,172448,213889,265276,328996,408008,505984,627473,778121,964924,1196559,1483787,1839950,2281591,2829227,3508295,4350340,5394474,6689202,8294664,10285438,12753995,15815008,19610663,24317276],
				glass:0,
				marble:[0,0,0,0,0,0,0,0,178,431,745,1134,1616,2214,2956,3875,5015,6429,8183,10357,13052,16395,20540,25680,32054,39957,49757,61909,76977,95661,118830,147560,183185,227359,282136,350059,434283,538722,668224,828808,1027933,1274849,1581022,1960678,2431450,3015210,3739070,4636658,5749665,7129795,8841156,10963244,13594633,16857554],
				sulfur:0,
				wine:0,
				time:{a:25200,b:11,c:1.1,d:1728,e:[732]},
				icon:'skin/img/city/barracks_r.png'
			},
			blackMarket:
			{
				buildingId:31,
				maxLevel: 25,
				wood:[440,886,1360,1890,2516,3288,4263,5506,7086,9086,11591,14692,18491,23088,28605,35147,42845,51828,62227,74186,87851,103372,120906,140618,162672],
				glass:0,
				marble:[259,525,807,1126,1508,1988,2600,3390,4403,5693,7315,9331,11809,14812,18423,22711,27761,33659,40491,48355,57343,67556,79099,92078,106603],
				sulfur:0,
				wine:0,
				tax:(function(){var tax = [];for(var i=0;i<25;i++){tax.push(-(i+1)+29-(i==23?1:(i==24?3:0)));}return tax;})(),
				time:{a:4321,b:1,c:1.1,d:4627},
				icon:'skin/img/city/blackmarket_l.png'
			},
			branchOffice:
			{
				buildingId:13,
				maxLevel:39,
				wood:[48,173,346,581,896,1314,1863,2580,3509,4706,6241,8203,10699,13866,17872,22926,29286,37272,47283,59806,75447,94954,119245,149453,186977,233530,291225,362658,451015,560208,695038,861391,1066671,1319984,1632575,2018312,2494311,3081693,3806524],
				glass:0,
				marble:[0,0,0,0,540,792,1123,1555,2115,2837,3762,4945,6450,8359,10774,13820,17654,22469,28503,36051,45482,57240,71883,90092,112712,140776,175556,218617,271878,337705,418978,519260,643007,795710,984146,1216677,1503619,1857705,2294648],
				sulfur:0,
				wine:0,
				time:{a:108000,b:11,c:1.1,d:9360},
				icon:'skin/img/city/branchoffice_l.png'
			},
			carpentering:
			{
				buildingId:23,
				maxLevel:32,
				wood:[63,122,191,274,372,486,620,777,962,1178,1432,1730,2078,2486,2964,3524,4178,4945,5841,6890,8117,9550,11229,13190,15484,18166,21299,24963,29245,34247,40096,46930],
				glass:0,
				marble:[0,0,0,0,0,0,0,359,444,546,669,816,993,1205,1459,1765,2131,2571,3097,3731,4490,5402,6496,7809,9383,11274,13543,16265,19531,23450,28154,33798],
				sulfur:0,
				wine:0,
				time:{a:125660,b:37,c:1.06,d:2808},
				icon:'skin/img/city/carpentering_l.png'
			},
			dump:
			{
				buildingId:29,
				maxLevel:40,
				wood:[640,1152,1766,2504,3388,4450,5724,7253,9088,11289,13931,17101,20905,25470,30948,37522,45410,54876,66236,79867,96223,115852,139407,167672,201592,242293,291136,349749,420081,504483,605763,727300,873143,1048157,1258171,1510191,1812613,2175519,2611007,3133592],
				glass:[701,1146,1668,2278,2991,3526,4803,5946,7283,8847,10678,12819,15324,18257,21687,25700,30395,35889,42316,49837,58635,68929,80973,95065,111553,130843,153414,179821,201716,246864,289157,338642,396536,464274,543528,636253,744742,871676,1020187,1193945],
				marble:[497,932,1445,2051,2762,3609,4604,5778,7164,8799,10728,13005,15691,18862,22602,27016,32225,38371,45623,54181,64278,76194,90256,106847,126424,149528,176787,208956,246913,291702,344555,406921,480512,567350,669817,790730,933408,1101767,1300431,1534855],
				sulfur:[384,845,1398,2061,2858,3813,4960,6336,7987,9968,12346,15199,18623,22731,27661,33578,40677,49197,59420,71688,86409,104076,125274,150714,181241,217872,261830,314581,377881,453842,544994,654378,785638,943149,1132163,1358979,1631159,1957774,2349715,2820041],
				wine:0,
				time:{a:32000,b:13,c:1.17,d:2160},
				icon:'skin/img/city/dump_r.png'
			},
			embassy:
			{
				buildingId:12,
				maxLevel:32,
				wood:[242,415,623,873,1173,1532,1964,2482,3103,3849,4743,5817,7105,8651,10507,12733,15610,18498,22457,27074,32290,33764,47240,56812,70157,84318,101310,121979,146503,175932,222202,266778],
				glass:0,
				marble:[155,342,571,850,1190,1606,2112,2730,3484,4404,5527,6896,8566,10604,13090,16123,19824,24339,29846,36564,45216,47097,66967,81859,104537,129580,158759,193849,236659,288888,358869,437985 ],
				sulfur:0,
				wine:0,
				time:{a:96000,b:7,c:1.05,d:10080},
				icon:'skin/img/city/embassy_l.png'
			},
			fireworker:
			{
				buildingId:27,
				maxLevel:32,
				wood:[272,353,445,551,673,813,974,1159,1373,1618,1899,2223,2596,3025,3517,4084,4736,5485,6346,7338,8478,9790,11297,13030,14990,17317,19954,22986,26472,30484,35096,40398],
				glass:0,
				marble:[135,212,302,405,526,665,827,1015,1233,1486,1779,2120,2514,2972,3503,4119,4834,5662,6623,7738,9032,10534,12275,13355,16636,19354,22507,26163,30404,35325,41033,47652],
				sulfur:0,
				wine:0,
				time:{a:125660,b:37,c:1.06,d:2628},
				icon:'skin/img/city/fireworker_l.png'
			},
			forester:
			{
				buildingId:18,
				maxLevel:32,
				wood:[250,430,664,968,1364,1878,2546,3415,4544,6013,7922,10403,13629,17823,23274,30362,39574,51552,67123,87363,113680,147889,192360,250173,325258,423034,550049,715169,929826,1208878,1571646,2043246],
				glass:0,
				marble:[0,104,237,410,635,928,1309,1803,2446,3282,4368,5781,7617,10422,13108,17142,22386,29204,38068,49589,64569,84041,109356,142266,185046,240663,312965,406956,529144,687989,894489,1162937],
				sulfur:0,
				wine:0,
				time:{a:72000,b:11,c:1.1,d:6120},
				icon:'skin/img/city/forester_l.png'
			},
			glassblowing:
			{
				buildingId:20,
				maxLevel:32,
				wood:[274,467,718,1045,1469,2021,2738,3671,4883,6459,8508,11172,14634,19135,24987,32594,42483,55339,72050,93778,122021,158740,206471,268524,349194,454063,590393,767620,998018,1297535,1686906,2193088],
				glass:0,
				marble:[0,116,255,436,671,977,1375,1892,2564,3437,4572,6049,7968,10462,13705,17921,23402,30527,39790,51830,67485,87835,114289,148680,193389,251512,327069,425294,552986,718987,934789,1215329],
				sulfur:0,
				wine:0,
				time:{a:72000,b:11,c:1.1,d:6120},
				icon:'skin/img/city/glassblowing_l.png'
			},
			museum:
			{
				buildingId:10,
				maxLevel:24,
				wood:[560,1435,2748,4716,7669,12099,18744,28710,43661,66086,99724,150181,225866,339394,509686,765124,1148280,1723016,2585120,3878276,5818010,8727610,13092010,19638612],
				glass:0,
				marble:[280,1190,2573,4676,7871,12729,20112,31335,48394,74323,113736,173643,264701,403110,613492,933272,1419338,2158157,3281164,4988135,7582732,11526516,17521070,26632791],
				sulfur:0,
				wine:0,
				time:{a:18000,b:1,c:1.1,d:14040},
				icon:'skin/img/city/museum_r.png'
			},
			optician:
			{
				buildingId:25,
				maxLevel:32,
				wood:[119,188,269,362,471,597,742,912,1108,1335,1600,1906,2261,2673,3152,3706,4348,5096,5962,6966,8131,9482,11050,12868,14978,17424,20262,23553,27373,31804,36943,42904],
				glass:0,
				marble:[0,35,96,167,249,345,455,584,733,905,1106,1338,1608,1921,2283,2704,3191,3759,4416,5178,6062,7087,8276,9656,11257,13113,15267,17762,20662,24024,27922,32447],
				sulfur:0,
				wine:0,
				time:{a:125660,b:37,c:1.06,d:2772},
				icon:'skin/img/city/optician_l.png'
			},
			palace:
			{
				buildingId:11,
				maxLevel:11,
				wood:[712,5823,16048,36496,77392,159184,322768,649936,1304272,2612944,4743517],
				glass:[0,0,0,0,21188,42400,84824,169672,339368,678760,1357544],
				marble:[0,1433,4546,10770,23218,48114,97906,197490,396658,794994,1591666],
				sulfur:[0,0,3088,10300,24725,53573,111269,226661,457445,919013,1842149],
				wine:[0,0,0,10898,22110,44534,89382,179078,358470,717254,1434821],
				time:{a:11520,b:1,c:1.4,d:0},
				icon:'skin/img/city/palace_l.png'
			},
			palaceColony:
			{
				buildingId:17,
				maxLevel:11,
				wood:[712,5823,16048,36496,77392,159184,322768,649936,1304272,2612944,4743517],
				glass:[0,0,0,0,21188,42400,84824,169672,339368,678760,1357544],
				marble:[0,1433,4546,10770,23218,48114,97906,197490,396658,794994,1591666],
				sulfur:[0,0,3088,10300,24725,53573,111269,226661,457445,919013,1842149],
				wine:[0,0,0,10898,22110,44534,89382,179078,358470,717254,1434821],
				time:{a:11520,b:1,c:1.4,d:0},
				icon:'skin/img/city/palaceColony_l.png'
			},
			pirateFortress:
			{
				buildingId:30,
				maxLevel: 30,
				wood:[450,906,1389,1935,2593,3427,4516,5950,7834,10284,13430,17415,22394,28534,36015,45029,55779,68482,83366,100671,120648,143562,169686,199309,232729,270255,312210,358926,410748,468032],
				glass:0,
				marble:[250,505,783,1112,1534,2103,2883,3949,5388,7296,9782,12964,16970,21938,28019,35370,44162,54573,66793,81020,97463,116341,137883,162325,189915,220912,255580,294197,337048,384429],
				sulfur:0,
				wine:0,
				time :[40,414,817,1253,1721,2228,2779,3370,4010,4702,8989,10487,12150,13997,16045,30528,35449,41058,47455,54745,76684,88880,102906,119034,137585,200203,232974,270994,315090,366246],
				icon:'skin/img/city/pirateFortress_l.png'
			},
			port:
			{
				buildingId:3,
				maxLevel:47,
				wood:[60,150,274,429,637,894,1207,1645,2106,2735,3537,4492,5689,7103,8850,11094,13731,17062,21097,25965,31810,39190,47998,58713,71955,87627,107102,130776,159019,193938,235849,286514,348718,423990,513947,625160,758178,919693,1116013,1353517,1642274,1990223,2411061],
				glass:0,
				marble:[0,0,0,0,0,176,326,540,791,1138,1598,2176,2928,3859,5051,6628,8566,11089,14265,18241,23197,29642,37636,47703,60556,76367,96639,122156,153754,194089,244300,307174,386955,486969,610992,769302,965792,1212790,1523570,1913072,2403313,3015688,3782992],
				sulfur:0,
				wine:0,
				time:{a:50400,b:23,c:1.15,d:1512,e:[588]},
				loadingSpeed:[10,30,60,93,129,169,213,261,315,373,437,508,586,672,766,869,983,1108,1246,1398,1565,1748,1950,2172,2416,2685,2980,3305,3663,4056,4489,4965,5488,6064,6698,7394,8161,9004,9931,10951,12073,13308,14666,16159,17803,19616,21613,23813,26237],
				icon:'skin/img/city/port_r.png'
			},
			safehouse:
			{
				buildingId:16,
				maxLevel:32,
				wood:[113,248,402,578,779,1007,1267,1564,1903,2288,2728,3230,3801,4453,5195,6042,7008,8108,9363,10793,12423,14282,16401,18816,21570,24709,28288,32368,37019,42321,48365,55255],
				glass:0,
				marble:[0,0,0,129,197,275,366,471,593,735,900,1090,1312,1569,1866,2212,2613,3078,3617,4243,4968,5810,6787,7919,9233,10758,12526,14577,16956,19716,22917,26631],
				sulfur:0,
				wine:0,
				time:{a:96000,b:7,c:1.05,d:12960},
				icon:'skin/img/city/safehouse_l.png',
				spytime:{a:900.12,b:-0.0513} // Seconds to create one spy per level (s): y = Math.round(a*exp(b*x))
			},
			shipyard:
			{
				buildingId:5,
				maxLevel:38,
				wood:[98,202,324,477,671,914,1222,1609,2096,2711,3485,4459,5688,7238,9190,11648,14746,18650,23568,29765,37573,47412,59808,75428,95108,119906,151151,190520,240124,302626,381378,480605,605632,763166,961659,1211759,1526886,1923947],
				glass:0,
				marble:[0,0,0,0,0,778,1052,1397,1832,2381,3070,3941,5037,6420,8161,10354,13118,16601,20989,26517,33484,42261,53321,67256,84814,106938,134814,169937,214192,269954,340214,428741,540285,680832,857920,1081051,1362196,1716438],
				sulfur:0,
				wine:0,
				time:{a:64800,b:7,c:1.05,d:7128},
				icon:'skin/img/city/shipyard_l.png'
			},
			stonemason:
			{
				buildingId:19,
				maxLevel:32,
				wood:[274,467,718,1045,1469,2021,2738,3671,4883,6459,8508,11172,14634,19135,24987,32594,42483,55339,72050,93778,122021,158740,206471,268524,349194,454063,590393,767620,998018,1297535,1686906,2193088],
				glass:0,
				marble:[0,116,255,436,671,977,1375,1892,2564,3437,4572,6049,7968,10462,13705,17921,23402,30527,39790,51830,67485,87835,114289,148680,193389,251512,327069,425294,552986,718987,934789,1215329],
				sulfur:0,
				wine:0,
				time:{a:72000,b:11,c:1.1,d:6120},
				icon:'skin/img/city/stonemason_l.png'
			},
			temple:
			{
				buildingId:28,
				maxLevel:38,
				wood:[216,228,333,465,598,760,958,1197,1432,1773,2112,2512,3082,3655,4458,5126,6232,7167,8687,10247,11784,14228,16752,19265,23156,26663,32026,36830,43256,50782,59591,68528,80385,96068,108392,129447,148864,174363],
				glass:[173,190,290,423,567,752,989,1290,1610,2080,2586,3210,4109,5084,6471,7765,9851,11821,14952,18402,22082,27824,34184,41020,51514,61817,77477,92972,113941,139577,170910,205093,251034,313054,368577,459304,551164,673645],
				marble:0,
				sulfur:0,
				wine:0,
				time:{a:2160,b:1,c:1.1,d:0},
				icon:'skin/img/city/temple_l.png'
			},
			tavern:
			{
				buildingId:9,
				maxLevel:47,
				wood:[101,222,367,541,750,1001,1302,1663,2097,2617,3241,3990,4888,5967,7261,8814,10678,12914,15598,18818,22683,27320,32885,39562,47576,57192,68731,82578,99194,119134,143061,171774,206230,247577,297193,356732,428179,513916,616800,740261,888413,1066196,1279537,1535545,1842756,2211407,2653789],
				glass:0,
				marble:[0,0,0,94,122,158,206,267,348,452,587,764,993,1290,1677,2181,2835,3685,4791,6228,8097,10526,13684,17789,23125,30063,39082,50806,66048,85862,111621,145107,188640,245232,318801,414441,538774,700406,910528,1183686,1538791,2000427,2600557,3380725,4394943,5713425,7427454],
				sulfur:0,
				wine:0,
				time:{a:10800,b:1,c:1.06,d:10440},
				icon:'skin/img/city/taverne_r.png',
				wineUse:[0,4,8,13,18,24,30,37,44,51,60,68,78,88,99,110,122,136,150,165,180,197,216,235,255,277,300,325,351,378,408,439,472,507,544,584,626,670,717,766,818,874,933,995,1060,1129,1202,1280,1362],
				wineUse2:[0,12,24,39,54,72,90,111,132,153,180,204,234,264,297,330,366,408,450,495,540,591,648,705,765,831,900,975,1053,1134,1224,1317,1416,1521,1632,1752,1878,2010,2151,2298,2454,2622,2799,2985,3180,3387,3606,3840,4086]
			},
			townHall:
			{
				buildingId:0,
				maxLevel:40,
				wood:[0,158,335,623,923,1390,2015,2706,3661,4776,6173,8074,10281,13023,16424,20986,25423,32285,40232,49286,61207,74804,93956,113035,141594,170213,210011,258875,314902,387656,471194,572580,695615,854728,1037814,1274043,1714396,1876185,2276285,2761291],
				glass:0,
				marble:[0,0,0,0,285,551,936,1411,2091,2945,4072,5664,7637,10214,13575,18254,23250,31022,40599,52216,68069,87316,115101,145326,191053,241039,312128,403825,515593,666228,850031,1084292,1382826,1783721,2273685,2930330,3692589,4756439,6058680,7716365],
				sulfur:0,
				wine:0,
				time:{a:1800,b:1,c:1.17,d:-1080,e:[3186]},
				icon:'skin/img/city/townhall_l.png',
				actionPointsMax:[0,3,3,3,4,4,4,4,5,5,5,5,6,6,6,6,7,7,7,7,8,8,8,8,9,9,9,9,10,10,10,10,11,11,11,11,12,12,12,12,13]
			},
			vineyard:
			{
				buildingId:26,
				maxLevel:32,
				wood:[339,423,520,631,758,905,1074,1269,1492,1749,2045,2384,2775,3225,3741,4336,5019,5813,6875,7941,8944,10319,11900,13718,15809,18215,20978,24159,27816,32021,36857,42419],
				glass:0,
				marble:[123,198,285,387,504,640,798,981,1194,1440,1726,2058,2443,2889,3407,4008,4705,5513,6450,7537,8800,10263,11961,13930,16214,18864,21938,25503,29639,34437,40002,46457],
				sulfur:0,
				wine:0,
				time:{a:125660,b:37,c:1.06,d:2232},
				icon:'skin/img/city/vineyard_l.png'
			},
			wall:
			{
				buildingId:8,
				maxLevel:48,
				wood:[114,361,657,1012,1439,1951,2565,3302,4186,5247,6521,8049,9882,12083,14724,17892,21695,26258,31733,38304,46189,55650,67004,80629,96979,116599,140143,168395,202298,242982,291802,350387,420689,505049,606284,727765,873541,1048473,1258393,1510294,1812577,2175317,2610603,3132948,3759764],
				glass:0,
				marble:[0,203,516,892,1344,1885,2535,3315,4251,5374,6721,8338,10279,12608,15402,18755,22779,27607,33402,40355,48699,58711,70726,85144,102446,123208,148122,178019,213896,256948,308610,370605,444998,534270,641397,769949,924213,1109328,1331467,1598031,1917913,2301767,2762392,3315144,3978446],
				sulfur:0,
				wine:0,
				time:{a:57600,b:11,c:1.1,d:3240,e:[2430]},
				icon:'skin/img/city/wall.png'
			},
			warehouse:
			{
				buildingId:7,
				maxLevel:40,
				wood:[160,288,442,626,847,1113,1431,1813,2272,2822,3483,4275,5226,6368,7737,9380,11353,13719,16559,19967,24056,28963,34852,41918,50398,60574,72784,87437,105021,126121,151441,181825,218286,262039,314543,377548,453153,543880,652752,783398],
				glass:0,
				marble:[0,0,0,96,211,349,515,714,953,1240,1584,1997,2492,3086,3800,4656,5683,6915,8394,10169,12299,14855,17922,21602,26019,31319,37678,45310,54468,65458,78645,94471,113461,136249,163595,196409,235787,283041,339745,407790 ],
				sulfur:0,
				wine:0,
				time:{a:2880,b:1,c:1.14,d:2160,e:[1063,1163]},
				icon:'skin/img/city/warehouse_l.png'
			},
			winegrower:
			{
				buildingId:21,
				maxLevel:32,
				wood:[274,467,718,1045,1469,2021,2738,3671,4883,6459,8508,11172,14634,19135,24987,32594,42483,55339,72050,93778,122021,158740,206471,268524,349194,454063,590393,767620,998018,1297535,1686906,2193088],
				glass:0,
				marble:[0,116,255,436,671,977,1375,1892,2564,3437,4572,6049,7968,10462,13705,17921,23402,30527,39790,51830,67485,87835,114289,148680,193389,251512,327069,425294,552986,718987,934789,1215329],
				sulfur:0,
				wine:0,
				time:{a:72000,b:11,c:1.1,d:6120},
				icon:'skin/img/city/winegrower_l.png'
			},
			workshop:
			{
				buildingId:15,
				maxLevel:32,
				wood:[206,383,569,781,1023,1299,1613,1972,2380,2846,3377,3982,4672,5458,6355,7377,8542,9870,11385,13111,15078,17714,19481,22796,26119,29909,34228,39153,44766,51166,58462,66778],
				glass:0,
				marble:[89,167,251,349,461,592,744,920,1125,1362,1637,1956,2326,2755,3253,3831,4500,5279,6180,7226,8439,9776,11477,13373,15570,18118,21074,24503,28481,33095,38447,44656],
				sulfur:0,
				wine:0,
				time:{a:96000,b:7,c:1.05,d:11880},
				icon:'skin/img/city/workshop_l.png'
			},
			marineChartArchive:
			{
				buildingId:32,
				maxLevel: 40,
				wood:[578,1298,2133,3101,4226,5529,7042,8795,10830,13191,15928,19106,22790,27064,32021,37772,44443,52183,61158,71571,83650,97663,113916,132771,154642,180012,209442,243579,283179,329115,382401,444214,515915,599089,695571,807490,937316,1087914,1262609,1465254],
				glass:[160,610,1142,1769,2507,3379,4409,5624,7057,8750,10745,13100,15879,19158,23028,27594,32984,39342,46843,55696,66143,78470,93015,110179,130434,154332,182532,215809,255077,301411,356087,420603,496733,586566,692571,817653,965252,1139419,1344934,1587444],
				marble:[345,1065,1915,2917,4100,5497,7143,9087,11380,14087,17280,21050,25495,30742,36935,44241,52862,63035,75038,89203,105917,125641,148914,176377,208781,247021,292142,345385,408211,482347,569828,673054,794862,938595,1108199,1308334,1544491,1823158,2151984,2539998],
				sulfur:0,
				wine:0,
				time:{a:1472465,b:509,c:1.12,d:504.5},
				icon:'skin/img/city/marinechartarchive_l.png'
			}
		},
		IslandBuildings:
		{
			forest:
			{
				wood:[0,394,992,1732,2788,3783,5632,8139,10452,13298,18478,23213,29038,39494,49107,66010,81766,101146,134598,154304,205012,270839,311541,411229,506475,665201,767723,1007959,1240496,1526516,1995717,2311042,3020994,3935195,4572136,5624478,7325850,9011590,11085051,13635000,17704143,20630781,26786470,32948197,40527121,52472840,61315353,79388129,97648282,120108270,147734055,181713771,234684263,274916734,355055889,436719671,0,0,0,0],
				workers:[0,30,38,50,64,80,96,117,134,154,174,196,218,240,264,288,314,340,366,394,420,448,478,506,536,566,598,628,660,692,724,758,790,824,860,894,928,964,1000,1036,1072,1110,1146,1184,1222,1260,1300,1338,1378,1418,1458,1498,1538,1578,1618,1658,1698,1738,1778,1818,1858]
			},
			mine:
			{
				wood:[0,1303,2689,4373,7421,10037,13333,20665,26849,37305,47879,65572,89127,106217,152379,193512,244886,309618,414190,552058,660106,925396,1108885,1471979,1855942,2339735,3096779,3903252,5153666,6199765,8185063,10314552,13588513,17122961,21576366,27187657,35747356,45043166,56755887,71513915,93863574,118269663,149021335,187768443,246053390,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
				workers:[0,20,32,48,66,88,110,132,158,184,212,240,270,302,332,366,400,434,468,504,542,578,618,656,696,736,776,818,860,904,946,990,1034,1080,1126,1172,1218,1266,1314,1362,1410,1460,1510,1560,1610,1662,1712,1764,1816,1868,1920,1972,2014,2066,2118,2170,2222,2274,2326,2378,2430]
			}
		}
	};
	Constant.buildingOrder = {
		growth: [Constant.Buildings.TOWN_HALL,Constant.Buildings.PALACE,Constant.Buildings.GOVERNORS_RESIDENCE,Constant.Buildings.TAVERN,Constant.Buildings.MUSEUM],
		research: [Constant.Buildings.ACADEMY,Constant.Buildings.WORKSHOP,Constant.Buildings.TEMPLE],
		diplomacy: [Constant.Buildings.EMBASSY],
		trading: [Constant.Buildings.WAREHOUSE,Constant.Buildings.DUMP,Constant.Buildings.TRADING_PORT,Constant.Buildings.TRADING_POST,Constant.Buildings.BLACK_MARKET,Constant.Buildings.MARINE_CHART_ARCHIVE],
		military: [Constant.Buildings.WALL,Constant.Buildings.SAFEHOUSE,Constant.Buildings.BARRACKS,Constant.Buildings.SHIPYARD],
		wood: [Constant.Buildings.FORESTER,Constant.Buildings.CARPENTER],
		wine: [Constant.Buildings.WINERY,Constant.Buildings.VINEYARD],
		marble: [Constant.Buildings.STONEMASON,Constant.Buildings.ARCHITECT],
		crystal: [Constant.Buildings.GLASSBLOWER,Constant.Buildings.OPTICIAN],
		sulfur: [Constant.Buildings.ALCHEMISTS_TOWER,Constant.Buildings.FIREWORK_TEST_AREA],
		piracy: [Constant.Buildings.PIRATE_FORTRESS]
	};
	Constant.altBuildingOrder = {
		growth: [Constant.Buildings.TOWN_HALL,Constant.Buildings.PALACE,Constant.Buildings.GOVERNORS_RESIDENCE,Constant.Buildings.TAVERN,Constant.Buildings.MUSEUM],
		research: [Constant.Buildings.ACADEMY,Constant.Buildings.WORKSHOP,Constant.Buildings.TEMPLE],
		diplomacy: [Constant.Buildings.EMBASSY],
		trading: [Constant.Buildings.WAREHOUSE,Constant.Buildings.DUMP,Constant.Buildings.TRADING_PORT,Constant.Buildings.TRADING_POST,Constant.Buildings.BLACK_MARKET,Constant.Buildings.MARINE_CHART_ARCHIVE],
		military: [Constant.Buildings.WALL,Constant.Buildings.SAFEHOUSE,Constant.Buildings.BARRACKS,Constant.Buildings.SHIPYARD],
		production: [Constant.Buildings.FORESTER,Constant.Buildings.WINERY,Constant.Buildings.STONEMASON,Constant.Buildings.GLASSBLOWER,Constant.Buildings.ALCHEMISTS_TOWER],
		reducton: [Constant.Buildings.CARPENTER,Constant.Buildings.VINEYARD,Constant.Buildings.ARCHITECT,Constant.Buildings.OPTICIAN,Constant.Buildings.FIREWORK_TEST_AREA],
		piracy: [Constant.Buildings.PIRATE_FORTRESS]
	};
	Constant.compBuildingOrder = {
		growth: [Constant.Buildings.TOWN_HALL,'colonyBuilding',Constant.Buildings.PALACE,Constant.Buildings.GOVERNORS_RESIDENCE,Constant.Buildings.TAVERN,Constant.Buildings.MUSEUM],
		research: [Constant.Buildings.ACADEMY,Constant.Buildings.WORKSHOP,Constant.Buildings.TEMPLE],
		diplomacy: [Constant.Buildings.EMBASSY],
		trading: [Constant.Buildings.WAREHOUSE,Constant.Buildings.DUMP,Constant.Buildings.TRADING_PORT,Constant.Buildings.TRADING_POST,Constant.Buildings.BLACK_MARKET,Constant.Buildings.MARINE_CHART_ARCHIVE],
		military: [Constant.Buildings.WALL,Constant.Buildings.SAFEHOUSE,Constant.Buildings.BARRACKS,Constant.Buildings.SHIPYARD],
		production: [Constant.Buildings.FORESTER,'productionBuilding',Constant.Buildings.WINERY,Constant.Buildings.STONEMASON,Constant.Buildings.GLASSBLOWER,Constant.Buildings.ALCHEMISTS_TOWER],
		reducton: [Constant.Buildings.CARPENTER,Constant.Buildings.VINEYARD,Constant.Buildings.ARCHITECT,Constant.Buildings.OPTICIAN,Constant.Buildings.FIREWORK_TEST_AREA],
		piracy: [Constant.Buildings.PIRATE_FORTRESS]
	};
	Constant.unitOrder = {
		army_front_line: [Constant.Military.HOPLITE,Constant.Military.SPARTAN,Constant.Military.STEAM_GIANT],
		army_flank: [Constant.Military.SPEARMAN,Constant.Military.SWORDSMAN],
		army_ranged: [Constant.Military.SLINGER,Constant.Military.ARCHER,Constant.Military.MARKSMAN],
		army_seige: [Constant.Military.RAM,Constant.Military.CATAPULT,Constant.Military.MORTAR],
		army_air: [Constant.Military.GYROCOPTER,Constant.Military.BALLOON_BOMBADIER],
		army_support: [Constant.Military.COOK,Constant.Military.DOCTOR],
		navy_front_line: [Constant.Military.FLAME_THROWER,Constant.Military.STEAM_RAM],
		navy_flank: [Constant.Military.RAM_SHIP],
		navy_ranged: [Constant.Military.BALLISTA_SHIP,Constant.Military.CATAPULT_SHIP,Constant.Military.MORTAR_SHIP],
		navy_seige: [Constant.Military.SUBMARINE,Constant.Military.ROCKET_SHIP],
		navy_air: [Constant.Military.PADDLE_SPEEDBOAT,Constant.Military.BALLOON_CARRIER],
		navy_support: [Constant.Military.TENDER]
	};
/************************************************
******************* Main Init *******************
************************************************/
	if(debug)
	{
//		console.clear();
		unsafeWindow.empire = {
			s: empire,
			db: database,
			ikariam: ikariam,
			render: render,
			events: events,
			utils: Utils,
			Constant: Constant,
			$: $,
			get tip(){return $('.breakdown_table').text().replace(/\s\s/g,' ').replace(/\s\s/g,' ').replace(/\s\s/g,' ').replace(/\s\s/g,' ').replace(/\s\s/g,' ').replace(/\s\s/g,' ').replace(/\s\s/g,' ').replace(/\s\s/g,' ').replace(/\s\s/g,' ').replace(/\s\s/g,' ').replace(/\s\s/g,' ').replace(/\s\s/g,' ');}
		};
	}
	empire.Init();
	document.cookie = document.cookie.replace(/(ik_video_player=volume%3D)(\d+)(%3Bcontains)/,'$1\0$3');
	if(database.settings!=undefined)
	{
		database.settings.noTheater.value = $('#cityCinema').attr('class')=='invisible' ? true : database.settings.noTheater.value;
		$.each(database.getGlobalData.fleetMovements,function(k,mov)
		{
//			console.log(k,mov);
		});
//		console.log(database.getGlobalData.fleetMovements);
		var LD = Constant.LanguageData[database.settings.languageChange.value];
		moment.locale(database.settings.languageChange.value);
		var serverTimezoneOffset = unsafeWindow.dataSetForView.serverTimezoneOffset;
		var servertimeinterv = setInterval(function()
		{
			$('#empire_servertime').text(moment().add(serverTimezoneOffset-moment().utcOffset()*60,'seconds').format(LD.fulldatelong));
			$('#empire_servertime_tip').html(Utils.format(LD.servertimetip,[moment().utc().utcOffset(serverTimezoneOffset/60).format(LD.fulldatelong)+'<br>'+moment().utc().utcOffset(serverTimezoneOffset/60).format('Z')+Utils.format(' ({0})',[LD[(moment().isDST()?'summer':'winter')+'time']]),moment().format(LD.fulldatelong)+'<br>'+moment().format('Z')+Utils.format(' ({0})',[LD[(moment().isDST()?'summer':'winter')+'time']])]));
		},1000);
		$('#servertime').hide().parent().before('<span id="empire_servertime" style="cursor:default;font:bold 11px Arial, Helvetica, sans-serif;white-space:nowrap">'+moment().add(serverTimezoneOffset-moment().utcOffset()*60,'seconds').format(LD.fulldatelong)+'</span><div id="empire_servertime_tip" class="tooltip-div" style="display:none;text-align:center">'+Utils.format(LD.servertimetip,[moment().utc().utcOffset(serverTimezoneOffset/60).format(LD.fulldatelong)+'<br>'+moment().utc().utcOffset(serverTimezoneOffset/60).format('Z')+Utils.format(' ({0})',[LD[(moment().isDST()?'summer':'winter')+'time']]),moment().format(LD.fulldatelong)+'<br>'+moment().format('Z')+Utils.format(' ({0})',[LD[(moment().isDST()?'summer':'winter')+'time']])])+'</div>').parent().addClass('empiretooltip');
	}
	// var coordsRegex = /\[(\d+)[:,|](\d+)\]/;
//	console.log(Utils.isXYtoID(33,55));
//	console.log(Utils.isIDtoXY(397));
//	console.log(Constant.BuildingData);
//	console.log(Object.keys(Constant.BuildingData));
//	var text = '';
//	$.each(Object.keys(Constant.BuildingData),function(k,n)
//	{
//		var buildtime = Constant.BuildingData[n].time;
//		for(var i=0;i<Constant.BuildingData[n].maxLevel;i++)
//		{
//			text += LD[n]+'\t'+(i+1)+'\t'+((n==Constant.Buildings.PIRATE_FORTRESS?buildtime[i]:Math.round(buildtime.a/buildtime.b*Math.pow(buildtime.c,i+1)-buildtime.d))-(buildtime.e!=undefined?(buildtime.e[i]!=undefined?buildtime.e[i]:0):0))+'\t'+Utils.FormatTimeLengthToStr(((n==Constant.Buildings.PIRATE_FORTRESS?buildtime[i]:Math.round(buildtime.a/buildtime.b*Math.pow(buildtime.c,i+1)-buildtime.d))-(buildtime.e!=undefined?(buildtime.e[i]!=undefined?buildtime.e[i]:0):0))*1000,6)+'\r\n';
//		}
//	});
//	console.log(text);
//	console.log(Utils.FormatTimeLengthToStr(71403169*1000,6));
	$(function()
	{
		var bgViewId = $('body').attr('id');
		if(!(bgViewId === 'city' || bgViewId === 'island' || bgViewId === 'worldmap_iso' || !$('backupLockTimer').length))
		{
			return false;
		}
		(function init(model, data, local, ajax)
		{
			var mod, dat, loc, aj;
			mod = !!unsafeWindow.ikariam && !!unsafeWindow.ikariam.model;
			dat = !!unsafeWindow.ikariam && !!unsafeWindow.ikariam.model.relatedCityData;
			loc = !!unsafeWindow.LocalizationStrings;
			aj = !!unsafeWindow.ikariam.controller && !!unsafeWindow.ikariam.controller.executeAjaxRequest && !!unsafeWindow.ajaxHandlerCallFromForm;
			if (dat && !data)
			{
				events(Constant.Events.CITYDATA_AVAILABLE).pub();
			}
			if (mod && dat && !model && !data)
			{
				events(Constant.Events.MODEL_AVAILABLE).pub();
			}
			if (loc && !local)
			{
				events(Constant.Events.LOCAL_STRINGS_AVAILABLE).pub();
			}
			if (aj && !ajax)
			{
				unsafeWindow.ajaxHandlerCallFromForm = function(ajaxHandlerCallFromForm)
				{
					return function cAjaxHandlerCallFromForm(form)
					{
						events('formSubmit').pub(form);
						return ajaxHandlerCallFromForm.apply(this, arguments);
					};
				}(unsafeWindow.ajaxHandlerCallFromForm);
				unsafeWindow.ikariam.controller.executeAjaxRequest = function(execAjaxRequest)
				{
					return function cExecuteAjaxRequest()
					{
						var args = $.makeArray(arguments);
						args.push(undefined);
						if(!args[1])
						{
							args[1] = function customAjaxCallback(responseText)
							{
								var responder = unsafeWindow.ikariam.getClass(unsafeWindow.ajax.Responder, responseText);
								unsafeWindow.ikariam.controller.ajaxResponder = responder;
								events('ajaxResponse').pub(responder.responseArray);
								unsafeWindow.response = responder;
							};
						}
						var ret = execAjaxRequest.apply(this, args);
					};
				}(unsafeWindow.ikariam.controller.executeAjaxRequest);
			}
			if (!(mod && loc && dat && aj))
			{
				events.scheduleAction(init.bind(null, mod, loc, dat, aj),1000);
			}
			else
			{
				var initialAjax = [];
				$('script').each(function(index, script)
				{
					var match = /ikariam.getClass\(ajax.Responder, (.*)\);/.exec(script.innerHTML);
					if(match)
					{
						events('ajaxResponse').pub(JSON.parse(match[1] || []));
						return false;
					}
				});
			}
		})();
	});
})(jQuery);
